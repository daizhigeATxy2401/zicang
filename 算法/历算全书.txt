　　钦定四库全书　　　　　子部六
　　厯算全书　　　　　　　天文算法类一【推歩之属】提要
　　【臣】等谨厯算全书六十巻
　　国朝梅文鼎撰文鼎字定九宣城人笃志嗜古尤精厯算之学康熙四十一年大学士李光地尝以其厯学疑问进呈防
　　圣祖仁皇帝南廵于徳州
　　召见
　　御书积学参微四字赐之以年老遣归嗣
　　诏修乐律厯算书下江南总督征其孙防成入侍直
　　律吕正义书成复驿致
　　命校勘后年九十余终于家
　　特命织造曹頫爲经纪其防至今传为稽古之至荣所着厯算诸书李光地尝刻其七种余多晚年纂述或已订成帙或畧具草稿魏荔彤求得其本以属无锡杨作枚校正作枚遂附以已説并为补所未备而刋行之凡二十九种名之曰厯算全书然序次错杂未得要领谨重加编次以立厯者居前而以言算者列于后首曰厯学疑问论厯学古今疏宻及中西二法与囘囘厯之异同即尝防
　　圣祖仁皇帝亲加定者谨以冠之简编次曰厯学疑问补亦杂论厯法纲领次曰厯学答问乃与一时公卿大夫以厯法往来问答之辞次曰弧三角举要乃用浑象表弧三角之形式次曰环中黍尺乃弧三角以角代算之法次曰岁周地度合考乃考髙卑嵗实及西国年月地度弧角里差次曰平立定三差説推七政赢缩之故次曰冬至考用统天大明授时三法考春秋以来冬至次曰诸方日乃以北极髙二十度至四十二度各地日按时节为立成表次曰五星纪要总论五星行度次曰火星本法専论火星迟疾次曰七政细草载推步日月五星法及恒星交宫过度之术次曰揆日星纪要列直江南河南陜西四省表景并三垣列宿经纬定为立成表次曰二铭补注解仰仪铭简仪铭次曰厯学骈枝乃所注大统厯法次曰交防管见乃以交食方位向称南北东西者改为上下左右次曰交食防求乃推算法数次曰古算衍畧次曰筹算次曰茟算次曰度算释例俱为歩算之根源次曰方程论次曰勾股阐微次曰三角法举要次曰觧割圜之根次曰方圆幕积次曰防何补编次曰少广拾遗次曰堑堵测量皆以推阐算法或衍九章之未备或着今法之形或论中西形体之变化或释弧矢勾股八线之比例盖厯算之术至是而大备矣我
　　国家修明律数探赜索隠集千古之大成文鼎以草野书生乃能覃思切究洞悉源流其所论著皆足以通中西之防而折今古之中自郭守敬以来罕见其比其受
　　圣天子特逹之知固非偶然矣乾隆四十六年十月
　　恭校上
　　总纂官【臣】纪昀【臣】陆锡熊【臣】孙士毅
　　总　校　官　【臣】　陆　费　墀







　　壬午十月扈
　　驾南巡驻
　　跸徳州有
　　防取所刻书集回奏匆遽未曽携带且多系经书制举
　　时文应塾校之需不足尘
　　览有宣城处士梅文鼎厯学疑问三巻【臣】所订刻谨呈
　　求
　　圣诲奉
　　防朕留心厯算多年此事朕能决其是非将书留览再
　　发二日后承
　　召面见
　　上云昨所呈书甚细心且议论亦公平此人用力深矣
　　朕带回宫中仔细看阅【臣】因求
　　皇上亲加御笔批駮改定庶草野之士有所取裁【臣】亦
　　得以预闻一二不胜幸甚
　　上肯之越明年春
　　驾复南巡遂于
　　行在发回原书
　　面谕朕已细细看过中间圏涂抹及签贴批语皆上手笔也臣复请此书疵缪所在
　　上云无疵缪但算法未备盖梅书原未完成
　　圣谕遂及之窃惟自古怀抱道业之士承诏有所述作者无论已若乃私家蔵录率多尘埋瓿覆至厯象天官之奥尤世儒所谓专门絶学者盖自好事耽奇之徒往往不能竟篇而罢曷能上烦
　　乙夜之观句谭字议相酬酢如师弟子梅子之遇可谓
　　千载一时方今
　　宸翰流行天下独未有裁自
　　圣手之书蓄于人间者岂特若洛下之是非坚定而子云遗编所谓遭遇时君度越诸子者亦无待乎桓谭之屡叹矣既以书归之梅子而为叙其时月因起俾梅宝奉焉甲申五月壬戌【臣】李光地恭记
　　序
　　厯学疑问梅子定九之所着也先生于是学覃思博考四十年余凡所撰述满家自专门者不能殚览也余谓先生宜撮其指要束文伸义章缝之士得措心焉夫列代史志掀及律厯则几而不视况一家之书哉先生肯余言以受馆之暇为之论百十篇而托之疑者或曰子之强梅子以成书也于学者信乎当务欤曰畴人星官之所专司不急可也夫梅子之作辨于理也理可不知乎乾坤父母也继志述事者不离乎动静居息色笑之间故书始厯象诗咏时物礼分方设官春秋以时纪事易观于隂阳而立卦合乎嵗闰以生蓍其所谓秩叙命讨好恶美刺治教兵刑朝防搂伐建侯迁国之大涉川畜牝之细根而本之则始于太乙而殽于隂阳日星以为纪月以为量四时以为柄鬼神以为徒故曰思知人不可以不知天仰则观于天文穷理之事也此则儒者所宜尽心也圣之多才艺而精创作必称周公自大司徒土圭之法周髀盖天之制后世少有知者汉唐而下最著者数家率推一时一处以为定论其有四出测逾数千里则已度越古今而未能包八极以立説海外之士乘之真谓吾书之所未有微言既逺冺冺棼棼可胜诘哉梅子闵焉稽近不遗矣而源之务索其言之成则援
　　熙朝之厯以合于轩姬虞夏洙泗闽洛冺然也此固我皇上膺厯在躬妙极道数故草野之下亦笃生异士见知而与闻之而梅子用心之勤不惮探赜表微以归于至当一书之中述圣尊王兼而有焉昔刘歆三统文具汉志子云太平子以为汉家得嵗二百年之书也彼刘扬乌知天皆据洛下一家法而傅防以经义云尔今先生之论罗罔千载明
　　皇厯之得天即象见理综数归道异日兰台编次必有取焉七政三统殆不足儗而书体简实平易不为枝离佶屈吾知其説亦大行于经生家非如太之覆醤瓿者
　　而终不显矣先生之归也谓余叙之余不足以知厯姑叙其大意以质知先生者先生续且为之图表数术以继斯巻余犹得竟学而观厥成焉淸溪李光地书













　　钦定四库全书
　　厯算全书巻一
　　宣城梅文鼎撰
　　厯学疑问一
　　论厯学古疏今密
　　问三代典制厄于秦火故儒者之论谓古厯宜有一定不变之法而不可复考后之人因屡变其法以求之葢至于今日之宻合而庶几克复古圣人之旧非古疏而今密也曰圣人言治厯明时盖取于革故治厯者当顺天以求合不当为合以验天若预为一定之法而不随时修改以求无弊是为合以验天矣又何以取于革乎且吾尝徴之天道矣日有朝有禺有中有昃有夜有晨此厯一日而可知者也月有朔有生明有有望有生魄有下有晦此厯一月而可知者也时有春夏秋冬昼夜有永短中星有推移此歴一嵗而可知者也乃若荧惑之周天则厯二年嵗星则十二年土星则二十九年【皆约整数】夫至于十二年二十九年而一周已不若前数者之易见矣又其毎周之间必有过不及之余分所差甚防非厯多周岂能灼见乃若嵗差之行六七十年始差一度厯二万五千余年而始得一周虽有期颐上夀所见之差不过一二度亦安从辨之迨其厯年既乆差数愈多然后共见而差法立焉此非前人之智不若后人也前人不能预见后来之差数而后人则能尽考前代之度分理愈乆而愈明法愈修而愈密势则然耳问者曰若是则圣人之智有所穷欤曰使圣人为一定之法则穷矣惟圣人深知天载之无穷而不为一定之法必使随时修改以求合天是则合天下万世之聪明以为其耳目圣人之所以不穷也然则厯至今日而愈密者皆圣人之法之所该矣
　　论中西二法之同
　　问者曰天道以乆而明厯法以修而密今新厯入而尽变其法以从之则前此之积举不足用乎曰今之用新厯也乃兼用其长以补旧法之未备非尽废古法而従新术也夫西厯之同乎中法者不止一端其言日五星之髙加减也即中法之盈缩厯也在太隂则迟疾厯也其言五星之嵗轮也即中法之段目也【迟留逆伏】其言恒星东行也即中法之嵗差也其言节气之以日躔过宫也即中法之定气也其言各省直节气不同也即中法之里差也但中法言盈缩迟疾而西説以最髙最卑明其故中法言段目而西説以嵗轮明其故中法言嵗差而西説以恒星东行明其故是则中厯所著者当然之运而西厯所推者其所以然之源此其可取者也若夫定气里差中厯原有其法但不以注厯耳非古无而今始有也西厯始有者则五星之纬度是也中厯言纬度惟太阳太隂有之【太阳出入于赤道其纬二十四度太隂出入于黄道其纬六度】而五星则未有及之者今西厯之五星有交防有纬行亦如太阳太隂之详明是则中厯缺陷之大端得西法以补其未备矣夫于中法之同者既有以明其所以然之故而于中法之未备者又有以补其缺于是吾之积者得彼説而益信而彼説之若难信者亦因吾之积而有以知其不诬虽圣人复起亦在所兼收而亟取矣
　　论中西之异
　　问今纯用西法矣若子之言但兼用其长耳岂西法亦有大异于中而不可全用抑吾之用之者犹有未尽欤曰西法亦有必不可用者则正朔是也中法以夏正为嵗首此万世通行而无弊者也西之正朔则以太阳防恒星为嵗其正月一日定于太阳躔斗四度之日而恒星既东行以生嵗差则其正月一日亦屡变无定故在今时之正月一日定于冬至后十一日溯而上之可七百年则其正月一日在冬至日矣又溯而上之七百年又在冬至前十日矣由今日顺推至后七百年则又在冬至后二十日矣如是不定安可以通行乎此徐文定公造厯书之时弃之不用而亦畧不言及也然则自正朔外其余尽同乎曰正朔其大者也余不同者尚多试畧举之中法歩月离始于朔而西法始于望一也中法论日始子半而西法始午中二也中法立闰月而西法不立闰月惟立闰日三也黄道十二象与二十八舍不同四也余星四十八象与中法星名无一同者五也中法纪日以甲子六十日而周西法纪日以七曜凡七日而周六也中法纪嵗以甲子六十年而周西法纪年以以总积六千余年为数七也中法节气起冬至而西法起春分八也以上数端皆今厯所未用徐文定公所谓镕西算以入大綂之型模葢谓此也【就中推闰日用之于恒表积数而不废闰月犹弗用也其总积之年厯指中偶一举之而不以纪嵗】
　　论今法于西厯有去取之故
　　问者曰皆西法也而有所弃取何也曰凡所以必用西法者以其测算之精而己非好其异也故凡高卑加减黄道经纬之属皆其测算之根而不得不用者也若夫测算之而既合矣则纪日于午何若纪于子之善也纪月于朢何若纪于朔之善也四十八象十二象之星名与三垣二十八宿虽离合不同而其星之大小逺近在天无异也又安用此纷纷乎此则无闗于测算之用者也乃若正朔之颁为国家礼乐刑政之所出圣人之所定万世之所遵行此则其必不可用而不用者也又何惑焉
　　论囘囘厯与西洋同异
　　问囘囘亦西域也何以不用其厯而用西洋之厯曰囘囘厯与欧罗巴【即西洋厯】同源异派而踈宻殊故囘囘厯亦有七政之髙以为加减之根又皆以小轮心为平行其命度也亦起春分其命日也亦起午正其算太隂亦有第一加减第二加减算交食三差亦有九十度限亦有影径分之大小亦以三百六十整度为周天亦以九十六刻为日亦以六十分为度六十秒为分而逓析之以至于防亦有闰日而无闰月亦有五星纬度及交道亦以七矅纪日而不用干支其立象也亦以东方地平为命宫其黄道上星亦有白羊金牛等十二象而无二十八宿是种种者无一不与西洋同故曰同源也然七政有加减之小轮而无均轮太隂有倍离之经差加减而无交均之纬差故愚尝谓西厯之于囘囘犹授时之于纪元统天其踈密固较然也然在洪武间未尝不密其西域大师马哈麻马沙亦黒颇能精于其术但深自秘惜又不着立表之根后之学者失其本法之用反借大统春分前定气之日以为立算之基何怪其乆而不效耶然其法之善者种种与西法同今用西法即用囘囘矣岂有所取舎于其间哉【按囘囘古称西域自明郑和奉使入洋以其非一国槩称之曰西洋厥后欧罗巴入中国自称大西洋谓又在囘囘西也今厯书题曰西洋新法盖囘囘厯即西洋旧法耳论中举新法皆曰欧罗巴不敢混称西洋所以别之也】
　　论回回厯厯元用截法与授时同
　　问论者谓回回厯元在千余年之前故乆而不可用其説然欤曰回回厯书以隋开皇己未为元谓之阿刺必年然以法求之实用洪武甲子为元而托之于开皇己未耳何以知之盖回回厯有太阳年太隂年自洪武甲子逆溯开皇己未距算七百八十六此太阳年也而回囘厯立成所用者太隂年也回回厯太隂年至第一月一日与春分同日之年则加一嵗约为三十二三年而积闰月十二所谓应加次数也然则洪武甲子以前距算七百八十六年当有应加闰月之年二十四次而今不然即用距算查表至八百一十七算之时始加头一次然则此二十四个闰年之月日将何所归乎故知其即以洪武甲子为元也惟其然也故其总年立成皆截从距开皇六百年起其前皆缺盖皆不用之数也然则何以不竟用七百八十算为立成起处而用六百年曰所以涂人之耳目也又最髙行分自六百六十算而变以前则渐减以后则渐増其减也自十度以至初度其増也又自初度而渐加此法中厯所无故存此以见意也【初度者盖指巨蠏初防惟六百六十算之年最髙与此防合以嵗计之当在洪武甲子年前一百二十六算其前渐减者盖是未到巨蠏之度故渐减也】由是言之其算宫分虽以开皇己未为元而其查立成之根则在己未元后二十四年【即立成所谓一年】既退下二十四年故此二十四次应加之数可以不加自此以后则皆以春分所入月日挨求亦可不必细论惟至闰满十二个月之年乃加一次此其巧防之法也然则其不用积年而截取现在为元者固与授时同法矣
　　论天地人三元非回回本法
　　问治回回厯者谓其有天地人三元之法天元谓之大元地元谓之中元人元谓之小元而以己未为元其简法耳以子言观之其説非欤曰天地人三元分算乃吴郡人陈壤所立之率非回回法也【陈星川名壤袁了凡师也嘉靖间曽上疏改厯而格不行】其説谓天地人三元各二千四百一十九万二千年今嘉靖甲子在人元己厯四百五十六万六千八百四十算所以为此迂逺之数者欲以求太乙数之周纪也【按太史王肯堂笔廛云太乙多不能算厯故以厯法求太乙多不合惟陈星川之太乙与厯法合】然其立法皆截去万以上数不用故各种立成皆止于千其为虚立无用之数可知矣夫三式之有太乙不过占家一种之书初无闗于厯算乂其立法以六十年为纪七十二年为元五元则三百六十年谓之周纪纯以干支为主而西域之法不用干支安得有三元之法乎今天地人三元之数现在厯法新书初未尝言其出于回回也盖明之知回回厯者莫精于唐荆川顺之陈星川壤两公而取唐之説以成书者为周云渊述学述陈之学以为书者为袁了凡黄然云渊厯宗通议中所述荆川精语外别无发眀【有厯宗中经余未见】而荆川亦不知最髙为何物【唐荆川曰要求盈缩何故减那最髙行度只为嵗差积乆年年欠下盈缩分数以此补之云云是未明厥故也】若云渊则直以毎日日中之晷景当髙尤为臆説矣了凡新书通回回之立成于大统可谓苦心然竟削去最髙之算又直用大统之嵗余而弃授时之消长将逆推数百年亦已不效况数千万年之乆乎人惟见了凡之书多用回回法遂误以为西域土盘本法耳又若薛仪甫凤祚亦近日西学名家也其言囘囘厯乃谓以己未前五年甲寅为元此皆求其説不得而强为之解也总之回回厯以太隂年列立成而又以太阳年查距算巧藏其根故虽其专门之裔且不能知无论他人矣【查开皇甲寅乃回教中所彼国圣人辞世之年故用以纪嵗非厯元也薛仪甫盖以此而误】
　　论回回厯正朔之异
　　问回回厯有太阳年又有太隂年其国之纪年以何为定乎曰回回国太隂年谓之动的月其法三十年闰十一日而无闰月惟以十二个月为一年【无闰则三百五十四日有闰则三百五十五日】故遇中国有闰月之年则其正月移早一月【如首年春分在第一月遇闰则春分在第二月而移其春分之前月为第一月】故曰动的月其太阳年则谓之不动的月其法以一百二十八年而闰三十一日皆以太阳行三十度为一月即中厯之定气其白羊初即为第一月一日嵗嵗为常故曰不动的月也然其纪嵗则以太隂年而不用太阳年此其异于中厯而并异于欧罗巴之一大端也然又有异者其毎嵗斋月又不在第一月而在第九月满此斋月至第十月一日则相贺如正旦焉不特此也其所谓月一日者又不在朔不在朢而在哉生明之后一日其附近各国皆然瀛涯胜览诸书可考而知也
　　马欢瀛涯胜览曰占城国无闰月但十二月为一年昼夜分为十更用鼓打记又曰阿丹国无闰月气温和常如八九月惟以十二个月为一年月之大小若头夜见新月明日即月一也又曰榜葛刺国亦无闰月以十二个月为一年按马欢自称防稽山樵曽従郑和下西洋故书其所见如此盖其国俱近天方故风俗并同其言月一者即月之第一日在朔后故不言朔厥后张升改其文曰以月出定月之大小夜见月明日又为一月也文句亦通然非月一字义也又按一统志天方国古筠冲之地旧名天堂又名西域有回回厯与中国前后差三日葢以见新月之明日为月之一日故差三日○又按素问云一昼一夜五分之隋志云昼有朝有禺有中有晡有夕夜有甲乙丙丁戊则昼夜十更之法中法旧有之○又熊防石岛夷志曰舶舟视旁罗之针罗罗处甚幽密惟开小扄直舵门灯长燃不分昼夜夜五更昼五更合昼夜十二辰为十更其针路悉有谱按此以十更记程而百刻匀分不论冬夏长短与记里鼓之意略同若素问隋志所云则以日出入为断而昼夜有长短更法因之而变两法防别占城用鼔打记不知若何要不出此二法
　　论夏时为尧舜之道
　　问古有三正而三王迭用之则正朔原无定也安在用太隂年用恒星年之为非是乎曰古圣人之作厯也以敬授民时而已天之气始于春盛于夏敛于秋伏藏于冬而万物之生长收藏因之民事之耕耘收获因之故圣人作厯以授民时而一切政务皆顺时以出令凡郊社禘尝之礼五祀之祭搜苗狝狩之节行庆施惠决狱治兵之典朝聘之期饮射读法劝耕省敛土功之事洪纎具举皆于是乎在故天子以颁诸侯诸侯受而藏诸祖庙以毎月告朔而行之厯之重葢如是也而顾使其游移无定何以示人遵守乎如回回厯则毎二三年而其月不同是春可为夏夏可为冬也如欧罗巴则毎七十年而差一日积之至乆四时亦可互为矣是故惟行夏之时斯为尧舜之道大中至正而不可易也然则又何以有三正曰三正虽殊而以春为民事之始则一也故建丑者二阳之月也建子者一阳之月也先王之于民事也必先时而戒事犹之日出而作而又曰鸡鸣而起中夜以兴云尔岂若毎嵗迁徙如是其纷纷者哉虽其各国之风俗相沿而不自觉然以数者相较而孰为正大孰为烦碎则必有辨矣
　　论语行夏之时古注云据见万物之生以为四时之始取其易知
　　论西厯亦古疏今宻
　　问中厯古疏今密实由积固己西厯则谓自古及今一无改作意者其有神授欤曰殆非也西法亦由积而渐至精密耳隋以前西厯未入中国其见于史者在唐为九执厯在元为万年厯在明为回回厯在
　　本朝为西洋厯新法然九执厯课既疏逺
　　唐大衍厯既成而一行卒瞿昙怨不得与改厯事讼于朝谓大衍写九执厯未尽其法诏厯官比验则九执厯课最防
　　万年厯用亦不乆
　　元太祖庚辰西征西域厯人奏五月朢月当蚀耶律楚材曰否卒不蚀明年十月楚材言月当蚀西域人曰不蚀至期果蚀八分
　　世祖至元四年西域札玛鲁丹撰进万年厯世祖稍颁行之至十八年改用授时厯
　　回回厯明用之三百年后亦渐防
　　明洪武初设回回司天台于雨花台寻罢回回司天监设回回科钦天监毎年西域官生依其本法奏进日月交蚀及五星凌犯等厯
　　欧罗巴最后出而称最精岂非后胜于前之明验欤诸如厯书所述多禄某之法至歌白泥而有所改订歌白泥之法至地谷而大有变更至于地谷法畧备矣而逺镜之制又出其后则其为累测益精大畧亦如中法安有所谓神授之法而一成不易者哉是故天有层数西法也而其説或以为九重或以为十二重今则以金水太阳共为一重矣又且以火星冲日之时比日更近而在太阳天之下则九重相裹如葱头之説不复可用矣太阳大于地西説也而其初説日径大于地径一百六十五倍竒今只筭为五倍竒两数相悬不啻霄壤矣太阳最髙卑嵗嵗东移西法也然先定二至后九度后改定为六度今复移进半度为七度竒矣又何一非后来居上而谓有神授不由积验乎
　　浑盖通宪定奥日在巨蠏九度即最髙也其时为万厯丁未在戊辰厯元前二十年是利西泰所定厥后厯书定戊辰年最髙冲度在冬至后五度五十九分五十九秒以较万厯丁未所定之奥日凡改退三度有竒是徐文定公及汤罗诸西士所定今康熙永年厯法重定康熙戊午髙冲在冬至后七度○四分○四秒以较厯书二百恒年表原定戊午髙冲六度三十七分二十九秒凡移进二十六分三十五秒其书成于厯书戊辰元后五十年是治理厯法南懐仁所定
　　论地圎可信
　　问西人言水地合一圆球而四面居人其地度经纬正对者两处之人以足版相抵而立其説可信欤曰以浑天之理徴之则地之正圆无疑也是故南行二百五十里则南星多见一度而北极低一度北行二百五十里则北极髙一度而南星少见一度若地非正圎何以能然至于水之为物其性就下四皆天则地居中央为最下水以海为壑而海以地为根水之附地又何疑焉所疑者地既浑圎则人居地上不能平立也然吾以近事徴之江南北极髙三十二度浙江髙三十度相去二度则其所戴之天顶即差二度【江南天顶去北极五十八度浙江天顶去北极六十度】各以所居之方为正则遥防异地皆成斜立又况京师极髙四十度琼海极髙二十度【京师以去北极五十度之星为天顶琼海以去北极七十度之星为天顶】若自京师而观琼海其人立处皆当倾跌【琼海望京师亦复相同】而今不然岂非首戴皆天足履皆地初无欹侧不忧环立欤然则南行而过赤道之表北逰而至戴极之下亦若是已矣是故大戴礼则有曽子之説
　　大戴礼单居离问于曽子曰天圆而地方诚有之乎曽子曰如诚天圆而地方则是四角之不揜也参尝闻之夫子曰天道曰圆地道曰方
　　内经则有岐伯之説
　　内经黄帝曰地之为下否乎岐伯曰地为人之下太虚之中也曰凭乎曰大气举之也素问又曰立于子而面午立于午而面子皆曰北面立于午而负子立于子而负午皆曰南靣释之者曰常以天中为北故对之者皆南也
　　宋则有邵子之説
　　邵子观物篇曰天何依曰依地地何附曰附天曰天地何所依附曰自相依附
　　程子之説
　　程明道语録曰天地之中理必相直则四边当有空阙处地之下岂无天今所谓地者特于天中一物尔又曰极须为天下之中天地之中理必相直今人所定天体只是且以眼定视所极处不见遂以为尽然向曽有于海上见南极下有大星数十则今所见天体葢未定以土圭之法騐之日月升降不过三万里中然而中国只到鄯善莎车已是一万五千里就彼观日尚只是三万里中也
　　地圆之説固不自欧逻西域始也
　　元西域札玛鲁丹造西域仪像有所谓库哩叶阿喇斯汉言地里志也其制以木为圆毬七分为水其色緑三分为土地其色白画江河湖海贯串于其中画作小方井以计幅员之广袤道里之逺近此即西説之祖
　　论葢天周髀
　　问有圆地之説则里差益明而浑天之理益着矣古乃有葢天之説殆不知而作者欤曰自扬子云诸人主浑天排葢天而葢説遂诎由今以观固可并存且其説实相成而不相悖也何也浑天虽立两极以言天体之圆而不言地圎直谓其正平焉耳若葢天之説具于周髀其説以天象盖笠地法覆槃极下地髙滂沲四隤而下则地非正平而有圆象明矣故其言昼夜也曰日行极北北方日中南方夜半日行极东东方日中西方夜半日行极南南方日中北方夜半日行极西西方日中东方夜半凡此四方者昼夜易处加四时相及此即西厯地有经度以论时刻早晚之法也其言七衡也曰北极之下不生万物北极左右夏有不释之冰中衡左右冬有不死之草五谷一嵗再熟凡北极之左右物有朝生暮获【赵君卿注曰北极之下从春分至秋分为昼从秋分至春分为夜】即西厯以地纬度分寒暖五带昼夜长短各处不同之法也使非天地同为浑圎何以能成此算周髀本文谓周公受于商髙虽其详莫攷而其説固有所本矣然则何以不言南极曰古人著书皆详于其可见而略于所不见即如中高四下之説既以北极为中矣而又曰天如倚盖是亦即中国之所见拟诸形容耳安得以辞害意哉故写天地以圆器则葢之度不违于浑图星象于平楮则浑之形可存于葢唐一行善言浑天者也而有作葢天圗法元郭太史有异方浑盖圗今西厯有平浑仪皆深得其意者也故浑盖之用至今日而合浑盖之説亦至今日而合浑盖之説亦至今日而益明元札马鲁丁西域仪象有兀速都儿刺不定汉言昼夜时刻之器其制以铜如圆镜而可挂面刻十二辰位昼夜时刻上加铜条缀其中可以圆转铜条两端各屈其首为二窍以对望昼则视日影夜则窥星辰以定时刻以则休咎背嵌镜片二面刻其圗凡七以辨东西南北日影长短之不同星辰向背之有异故各异其图以尽天地之变焉按此即今浑盖通宪之制也以平诠浑此为著
　　论周髀仪器
　　问若是则浑盖通宪即盖天之遗制欤抑仅平度均布如唐一行之所云耶曰皆不可考矣周髀但言笠以写天天青黒地黄赤天数之为笠也赤黒为表丹黄为里以象天地之位此盖写天之器也今虽不以意度之当是圆形如笠而图度数星象于内其势与仰观不殊以视平圗浑象转为亲切何也星圗强浑为平则距度之防密改观浑象图星于外则星形之左右易位若写天于笠则其圆势屈而向内星之经纬距皆成弧度与测筭脗合胜平圗矣又其星形必在内面则星之上下左右各正其位胜浑象矣
　　论厯元
　　问造厯者必先立元元正然后定日法法立然后度周天古厯数十家皆同此术至授时独不用积年日法何欤曰造厯者必有起算之端是谓厯元然厯元之法有二其一逺溯初古为七曜齐元之元自汉太初至金重修大明厯各所用之积年是也其一为截算之元自元授时不用积年日法直以至元辛巳为元而今西法亦以崇祯戊辰为元是也二者不同然以是为起算之端一而已矣则二者无优劣乎曰授时优夫所谓七曜齐元者谓上古之时嵗月日时皆防甲子而又日月如合璧五星如连珠故取以为造厯之根数也使其果然虽万世遵用可矣乃今卄一史中所载诸家厯元无一同者是其积年之乆近皆非有所受之于前直以巧算取之而已然谓其一无所据而出于胸臆则又非也当其立法之初亦皆有所验于近事然后本其时之所实测以旁证于书之所约其合者既有数端遂援之以立术于是溯而上之至于数千万年之逺庶几各率可以齐同积年之法所由立也然既欲其上合厯元又欲其不违近测畸零分秒之数必不能齐势不能不稍为整顿以求巧合其始也据近测以求积年其既也且将因积年而改近测矣又安得以为定法乎授时厯知其然故一以实测为凭而不用积年虚率上考下求即以至元十八年辛巳嵗前天正冬至为元其见卓矣按唐建中时术者曺士蔿始变古法以显庆五年为上元雨水为嵗首号符天厯行于民间谓之小厯又五代石晋髙祖时司天监马重绩造调元厯以唐天寳十四载乙未为上元用正月水为气首此二者亦皆截筭之法授时厯葢采用之耳然曺马二厯未尝密测逺徴不过因时厯之率截取近用若郭太史则制器极精四海测验者二十七所又上考春秋以来至于近代然后立术非舍难而就易也　又按孟子千嵗日至赵注只云日至可知其日孙奭疏则直云千嵗以后之日至可坐而定初不言立元
　　论西法积年
　　问厯元之难定以嵗月日时皆防甲子也若西厯者初不知有甲子何难溯古上元而亦截自戊辰欤曰西人言开辟至今止六千余年是即其所用积年也然厯书不用为元者何也既无干支则不能合于中法一也又其法起春分与中法起冬至不同以求上古积年毕世不能相合二也且西书所不一其积年之説先有参差三也故截自戊辰为元亦镕西算入中法之一事葢立法之善虽巧算不能违矣
　　天地仪书自开辟至崇祯庚辰凡五千六百三十余年圣经直解开辟至崇祯庚辰凡六千八百三十六年
　　通雅按诸太西云自开辟至崇祯甲申六千八百四十年依所制稽古定仪推之止五千七百三十四年月离厯指曰崇祯戊辰为总期之六千三百四十一年
　　天文实用云开辟初时适当春分又云中西皆以角为宿首因开辟首日昬时角为中星也今以恒星本行逆推约角宿退九十度必为中星计年则七千矣与圣经纪年合
　　开辟至洪水天地仪书云一千六百五十余年圣经直解则云二千二百四十二年相差五百九十二年洪水至汉哀帝元夀二年庚申天主降生天地仪书云二千三百四十余年圣经直解则云二千九百五十四年相差六百一十四年遗诠又云二千九百四十六年比圣经直解又少八年
　　论日法
　　问上古积年荒忽无凭去之诚是也至于日法则现在入用之数也而古厯皆有日法授时何以独无曰日法与厯元相因而立者也不用积年自可不用日法矣盖古厯气朔皆定大小余大余者日也小余者时刻也凡七曜之行度不能正当时刻之初而或在其中半难分之处非以时刻剖析为若干分秒则不能命筭此日法所由立也自日法而析之则有辰法刻法分法秒法自日法而积之则有气防法朔实法嵗实法旬周法与日日法同用者则有度法宿次法周天法又有章法蔀法纪法元法一切诸法莫不以日法为之纲古厯首定日法而皆有畸零葢以此也惟日法有畸零故诸率从之而各有畸零之数矣夫古厯岂故为此繁难以自困哉欲以上合于所立之厯元而为七曜之通率有不得不然者也【如古法以九百四十分为日法其四分之一则为二百三十五所以然者以十九年一章有二百三十五月也又古法月行十九分度之七是以十九分为度法亦以十九年一章有七闰也他皆类此】今授时既不用积年即章蔀纪元悉置不用而一以天验为徴故可不用畸零之日法而竟以万分为日日有百刻刻有百分故一万也自此再析则分有百秒秒有百微皆以十百为等而递进退焉数简而明易于布算法之极善者也是故授时非无日法也但不用畸零之日法耳用畸零之日法乘除既繁而其势又有所阻故分以下复用秒母焉用万分之日可以析之屡析至于无穷【日躔之用有秒则日为百万月离之用有防则日为亿万】而乘除之间转觉其易是小余之细未有过于授时者也而又便于用岂非法之无可以万世遵行者哉
　　按宋蔡季通欲以十二万九千六百为日法而当时厯家不以为然畏其细也然以较授时犹未及其秒数而不便于用者有畸零也有畸零而又于七曜之行率无闗何怪厯家之不用乎若回回泰西则皆以六十递析虽未尝别立日法而秒防以下必用通分颇多纡折若非逐项立表则其繁难不啻数倍授时矣薛仪甫着天学防通以六十分改为百分诚有见也





　　厯算全书巻一
　　钦定四库全书
　　厯算全书巻二
　　宣城梅文鼎撰
　　厯学疑问二
　　论嵗实【闰余】
　　问岁实有一定之数而何以有闰余曰惟岁实有一定之数所以生闰余也凡纪岁之防有二自今年冬至至来年冬至凡三百六十五日二十四刻二十五分而太阳行天一周是为一嵗二十四莭气之日【据授时大统之数或自今年立春至来年立春亦同】
　　周礼太史注中数曰岁朔数曰年自今年冬至至明年冬至岁也自今年正月朔至明年正月朔年也古有此语要之岁与年固无大别而中数朔数之不齐则气盈朔虚之所由生
　　自正月元旦至腊月除夕凡三百五十四日三十六刻七十一分一十六秒而太阴防太阳于十二次一周是为一岁十二月之日【亦据授时平朔言之】两数相较则莭气之日多于十二月者一十日八十七刻五十三分八十四秒是为一岁之通闰积至三年共多三十二日六十二刻六十一分五十二秒而成一闰月仍多三日零九刻五十五分五十九秒积至五年有半共多五十九日八十一刻四十六分一十二秒而成两闰月仍多七十五刻三十四分二十六秒古云三岁一闰五岁再闰者此也然则何以不竟用莭气纪歳则闰月可免矣曰晦朔望易见者也莭气过宫难见者也敬授人时则莫如用其易见之事而但为之闰月以通之则四时可以不忒尧命羲和以闰月定四时成歳此尧舜之道万世不可易也若囘囘厯有太阴年为动的月有太阳年为不动的月夫既谓之月安得不用晦朔望而反用莭气乎故囘囘厯虽有太阳年之算而天方诸国不以纪歳也沈存中欲以莭气纪歳而天经或问亦有是言此未明古圣人之意者矣
　　论歳余消长
　　问歳实既有一定之数授时何以有消长之法曰此非授时新法而宋綂天之法然亦非綂天亿创之法而合古今累代之法而为之者也盖古厯周天三百六十五度四分度之一一歳之日亦如之故四年而增一日【今西厯永年表亦同】其后渐觉后天皆以为斗分太强因稍损之【古厯起斗终斗故四分之一皆寄斗度谓之斗分】自汉而晋而唐而宋毎次改厯必有所减以合当时实测之数故用前代之厯以顺推后代必至后天以斗分强也【斗分即嵗余】若用后代之厯据近测以逆溯往代亦必后天以斗分弱也【前推后而歳余强则所推者过于后之实测矣后推前而嵗余弱则所推者不及于前之实测矣故皆后天】綂天厯见其然故为之法以通之于歳实平行之中加一古多今少之率则于前代诸厯不相戾而又不违于今之实测此其用法之巧也然綂天厯蔵其数于法之中而未尝明言消长授时则明言之今遂以为授时之法耳郭太史自述创法五端初未及此也然则大綂厯何以不用消长曰此则元綂之失也当时李徳芳固巳上疏争之矣然在洪武时去授时立法不过百年所减不过一分积之不过一刻故虽不用消长无甚差殊也崇祯厯书谓元綂得之测验窃不谓然何也元綂与徳芳辨但自言未变旧法不言测騐有差又其所着通轨虽便初学殊昧根宗间有更张辄违经防【如月食时差既内分等俱妄改背理】岂能于冬至加时后先一刻之间而测得真数乎然则消长必不可废乎曰上古则不可知矣若春秋之日南至固可考据而唐宋诸家之实测有据者史册亦具存也今以消长之法求之其数皆合若以大綂法求之则皆后天而于春秋且差三日矣安可废乎然则綂天授时之法同乎曰亦不同也綂天厯逐年逓差而授时消长之分以百年为限则授时之法又不如綂天矣夫必百年而消长一分未尝不是乃以乗距算其数骤变殊觉不伦郑世子黄钟厯法所以有所酌改也【假如康熙辛酉年距元四百算该消四分而其先一年庚申距算三百九十九只消三分是庚申年嵗余二十四刻二十二分而辛酉年歳余二十四刻二十一分也以此所消之一分乗距算得四百分则辛酉嵗前冬至忽早四刻而次年又只平运以实数计之庚申年反只三百六十五日二十刻二十二分辛酉年则又是三百六十五日二十四刻二十一分其法舛矣】
　　论嵗实消长之所以然
　　问嵗实消长之法既通于古亦宜合于今乃今实测之家又以为消极而长其説安在岂亦有所以然之故欤曰授时虽承统天之法而用消长但以推之旧厯而合耳初未尝深言其故也惟厯书则为之説曰嵗实渐消者由日轮之毂渐近地心也余尝窃疑其説今具论之夫西法以日天与地不同心疏盈缩加减之理其所谓加减皆加减于周天三百六十度之中非有所増损于其外也如最髙则视行见小而有所减最卑则视行见大而有所加加度则减时矣减度则加时矣然皆以最卑之所减补最髙之所加及其加减既周则其总数适合平行畧无余欠也若果日轮之毂渐近地心不过其加减之数渐平耳加之数渐平则减之数亦渐平其为迟速相补而归于平行一也岂有日轮心逺地心之时则加之数多而减之数少日轮心近地心时则减之数少而加之数多乎必不然矣又考日躔永表彼固原未有消长之説日躔厯指言平嵗用授时消分定嵗则用最髙差及查恒年表之用则又只用平率是其説未有所决也又厯书言日轮渐近地心数千年后将合为一若前之渐消由于两心之渐近则今之消极而长两心亦将由近极而逺数千年后又安能合为一乎彼盖见授时消分有据而姑为此説非能极论夫消长之故者也然则将何以求其故曰授时以前之渐消既徴之经史而信矣而今现行厯之嵗实又稍大于授时其为复长亦似有据窃考西厯髙卑今定于二至后七度依永年厯毎年行一分有竒则授时立法之时最髙卑正与二至同度而前此则在至前过此则在至后岂非髙冲渐近冬至而嵗余渐消及其过冬至而东又复渐长乎余观七政厯于康熙庚申年移改最髙半度弱而其年歳实骤増一刻半强此亦一徴也存此以竢后之知厯者【巳未年最髙在夏至后六度三十九分庚申年最髙在夏至后七度七分除本行外计新移二十七分己未年冬至庚戌日亥正一刻四分庚申年冬至丙辰日寅正二刻二分实计三百六十五日二十四刻十三分前后各年俱三百六十五日二十三刻四分或五分以较庚申年嵗实骤増一刻九分】王寅旭曰嵗实消长其説不一谓由日轮之毂渐近地心其数寖消者非也日轮渐近则两心差及所生均数亦异以论定嵗诚有损益若平嵗嵗实尚未及均数则消长之源与两心差何与乎识者欲以黄赤极相距逺近求嵗差朓朒与星嵗相较为节嵗消长终始循环之法夫距度既殊则分至诸限亦宜随易用求差数其理始全然必有平嵗之嵗差而后有朓朒之嵗差有一定之嵗实而后有消长之嵗实以有定者纪其常以无定者通其变始可以永乆而无弊
　　按寅旭此论是欲据黄赤之渐近以为嵗实渐消之根盖见西测黄赤之纬古大今小今又觉稍赢故断以为消极复长之故然黄赤逺近其差在纬嵗实消长其差在经似非一根又西测距纬复赢者彼固自疑其前测最小数之末真则亦难为确据愚则以中厯嵗实起冬至而消极之时髙冲与冬至同度髙冲离至而嵗实亦増以经度求经差似较亲切愚与寅旭生同时而不相闻及其卒也乃稍稍见其书今安得起斯人于九原而相与极论以质所疑乎
　　论恒星东移有据
　　问古以恒星即一日一周之天而七曜行其上今则以恒星与七曜同法而别立宗动是一日一周者与恒星又分两重求之古厯亦可通欤曰天一日一周自东而西七曜在天迟速不同皆自西而东此中西所同也然西法谓恒星东行比于七曜今考其度盖即古厯嵗差之法耳嵗差法昉于虞喜而畅于何承天祖冲之刘焯唐一行厯代因之讲求加密然皆谓恒星不动而黄道西移故曰天渐差而东嵗渐差而西所谓天即恒星所谓嵗即黄道分至也西法则以黄道终古不动而恒星东行假如至元十八年冬至在箕十度至康熙辛未厯四百十一年而冬至在箕三度半在古法谓是冬至之度自箕十度西移六度半而箕宿如故也在西法则是箕星十度东行过冬至限六度半而冬至如故也其差数本同所以致差者则不同耳然则何以知其必为星行乎曰西法以经纬度恒星则普天星度俱有嵗差不止冬至一处此盖得之实测非臆断也然则普天之星度差古之测星者何以皆不知耶曰亦尝求之于古矣盖有三事可以相证其一唐一行以铜浑仪二十八舍其去极之度皆与旧经异今以歳差考之一行铜仪成于开元七年其时冬至在斗十度而自牵牛至东井十四宿去极之度皆小于旧经是在冬至以后厯春分而夏至之半周其星自南而北南纬増则北纬减故去北极之度渐差而少也自舆鬼至南斗十四宿去极之度皆大于旧经是在夏至以后厯秋分而冬至之半周其星自北而南南纬减则北纬増故去北极之度渐差而多也【星度详后】向使非恒星移动何以在冬至后者渐北在夏至后渐南乎【恒星循黄道行实只东移无所谓南北之行也而自赤纬观之则有南北之差盖横斜之势使然】其一古测极星即不动处齐梁间测得离不动处一度强【祖暅所测】至宋熈宁测得离三度强【沈存中测详梦溪笔谈】至元世祖至元中测得离三度有半【郭太史极仪径七度终夜见极星循行环内切边而行是也】向使恒星不动则极星何以离次乎其一二十八宿之距度古今六测不同【详元史】故郭太史疑其动移此盖星既循黄道东行而古测皆依赤道黄赤斜交勾异视所以度有伸缩正由距有横斜耳不则岂其前人所测皆不足慿哉故仅以冬至言差则中西之理本同而合普天之星以求经纬则恒星之东移有据何以言之近两至处恒星之差在经度故可言星东移者亦可言嵗西迁近二分处恒星之差竟在纬度故惟星实东移始得有差若只两至西移诸星经纬不应有变也如此则恒星之东移信矣恒星既东移不得不与七曜同法矣恒星东移既与七曜同法即不得不更有天挈之西行此宗动所由立也
　　唐一行所测去极度与旧不同者列后
　　旧经　　　　　　　　唐测
　　牵牛【去极】百　六度　　牵牛【去极】百　四度须女　百　　度【有脱字】　须女　百　一度
　　虚　　百　四度　　　虚　　百　一度
　　危　　九十七度【有误字】　危　　九十七度
　　营室　八十五度　　　营室　八十三度
　　东壁　八十六度　　　东壁　八十四度
　　奎　　七十六度　　　奎　　七十三度
　　娄　　八十度　　　　娄　　七十七度
　　胃昴　七十四度　　　胃昴　七十二度
　　毕　　七十八度　　　毕　七十六度
　　觜觹　八十四度　　　觜觹　八十二度
　　参　　九十四度　　　参　　九十三度
　　东井　七十度　　　　东井　六十八度
　　以上十四宿去极之度皆古测大而唐测小是所测去极之度少于古测为其星自南而北也又按唐开元冬至在斗十度则此十四宿为自冬至后厯春分而夏至之半周
　　旧经　　　　　　　　　唐测
　　舆鬼　六十八度　　　　舆鬼　六十八度
　　栁　　七十七度　　　　栁　　八十度半
　　七星　九十一度　　　　七星　九十三度半张　　九十七度　　　张　　百度
　　翼　　九十七度　　　翼　　百　三度
　　轸　　九十八度　　　轸　　百度
　　角　　九十一度【正当赤道】　角　　九十三度半【在赤道南二度半】亢　　八十九度　　　亢　　九十一度半氐　　九十四度　　　氐　　九十八度
　　房　　百　八度　　　房　　百一十度半心　　百　八度　　　心　　百一十度
　　尾　　百二十度　　　尾　　百二十四度箕　　百一十八度　　箕　　百二十度
　　南斗　百一十六度　　南斗　百一十九度以上十四宿去极之度皆古测小而唐测大是所测去极之度多于古测为其星自北而南也以冬至斗十度言之则此十四宿为自夏至后厯秋分而冬至之半周
　　论七政髙下
　　问言日月星辰系焉而今谓七政各有一天何据曰屈子天问圜则九重孰营度之则古有其语矣七政运行各一其法此其説不始西人也但古以天如棊局不动而七政错行如碁子之推移西人之説则谓日月五星各丽一天而有髙下其天动故日月五星动非七政之自动也其所丽之天表里通彻故但见七政之动耳不然则将如彗孛之类旁行斜出安得有一定之运行而可以施吾筹防乎且既各丽一天则皆天也虽有髙下而总一浑灏之体于中庸所谓击焉者初无抵牾也然则何以知其有髙下曰此亦古所有但言之未详耳古今厯家皆言月在太阳之下故月体能蔽日光而日为之食是日髙月下日逺月近之证也又歩日食者以交道表里而论其食分随地所见深浅各异故此方见食既者越数千里而仅亏其半古人立法谓之东西南北差是则日之下月之上相距甚逺之证也又月与五星皆能掩食恒星是恒星最在上而于地最逺也月又能掩食五星是月最在下而于地最近也五星又能互相掩是五星在恒星之下月之上而其所居又各有髙下于地各有逺近也向使七政同在一规而无髙下之距则相遇之时必相触击何以能相掩食而过乎是故居七政之上最近大圜最逺于地者为恒星恒星之下次为土星又次为木星次为火星次为太阳为金为水最近于地者为月以视差言之与人目逺者视差防近则视差大故恒星之视差最防以次渐増至月而差极大也以行度言之近大圜者为动天所掣故左旋速而右移之度迟渐近地心则与动天渐逺而左旋渐迟即右移之度反速故左旋之势恒星最速以次渐迟至月而为最迟也右移之度恒星最迟以次渐速至月而反最速也是二者宛转相求其数巧合髙下之理可无复疑【梦溪笔谈以月盈亏明日月之形如丸可谓明悉而又以问者之疑其如丸则相遇而相碍故輙漫应之曰日月气也有形无质故相值而无碍此则未明视差之理为智者千虑之失】
　　论无星之天
　　问古以恒星不动七曜常移故有蚁行磨上之喻今恒星东移既与七曜同法则恒星亦是蚁而非磨故虽宗动无星可信其有也然西法又谓动天之外有静天何以知之曰此亦可以理信者也凡物之动者必有不动者以为之根动而不息者莫如天则必有常不动者以为之根矣天之有两极也亦如硙之有脐戸之有枢也枢不动故户能开阖脐不动故硙能运旋若枢与脐动则开阖运旋之用息矣然枢能制户脐能运硙而此二者又谁制之而能不动哉则以其所丽者常静也【如户之枢附于屋而屋仍有基基即地也脐植于硙之下半而硙安于架架仍在地也人但知枢之于戸脐之于硙能以至小为至大之君而不知此至小者之根又实连于大地之体】唯天亦然动天之周系于两极而此两极者必有所丽其所丽者又必常静故能终古凝然而为动天之枢也使其不然极且自动而何以为动天之所宗乎或曰天不可以戸硙拟也戸硙物也天则一气旋转而已岂必有所附着而后其枢不动哉曰天之异于物者大小也若以不动为动之根无异理也且试以实测徴之自古言北极出地三十六度而阳城之测至今未改也元史测大都北极之髙四十度半今以西测徴之亦无分寸之移故言嵗差者不及焉【如黄赤古逺今近日轮毂渐近地心之类皆有今昔之差惟北极出地之度不变】使天惟兀然浮空而又常为动而不息之物北极髙下亦将改易而何以髙度常有定测乎朱子尝欲先论太虚之度然后次及天行太虚者静天之谓也
　　【朱子曰而今若就天里看时只是行得三百六十五度四分度之一若把天外来説则是一日过了一度蔡季通尝言论日月则在天里论天则在太虚空里若在太虚空里观那天自是日日裏得不在旧时处又曰厯法蔡季通説当先论天行次及七政此亦未善要当先论太虚以见三百六十五度四分度之一一一定位然后论天行以见天度加损虚度之嵗分嵗分既定然后七政乃可齐耳】
　　【临川吴氏曰天与七政八者皆动今人只将天做硬盘却以七政之动在天盘上行今当以太虚中作一空盘却以八者之行较其迟速】
　　论无星之天【其二】
　　问静天为两极所丽即朱子所言太虚是已然西法又设东西嵗差南北嵗差二重之天其説何居曰西人象数之学各有授受师説故其法亦多不同此两嵗差之天利西泰言之徐文定公作厯书时汤罗诸西士弃不复用厥后穆氏着天歩真原北海薛氏本之着天学防通则又用之故知其授受非一家也今即其説推之则穆与利又似不同何也西人测验谓黄赤之距渐近此亦可名南北差若东西嵗差则恒星之东移是已而恒星既为一重天不应复有东西嵗差之天则西泰所言不知何指也至于穆薛之説则又不正言南北东西两嵗差而别有加算谓之黄道差春分差其法皆作小圏于心而大圏之心循之而转若干年在前若干年在后其年皆以千计有图有数有法且谓作厯书时弃之非是也然于西泰初説亦不知同异何如耳然则何以断其有无曰天动物也但动而有常耳常则乆乆则不能无秒忽之差差在秒忽固无损于有常之大较而要之其差亦自有常也善歩者以数合差而得其衰序则俨然有形可説有象可图焉如小轮之类皆是物也要之为图为説总以得其差数而止其数既明其差既得又何必执其形象以生聚讼哉
　　论天重数
　　问七政既有髙下恒星又复东移动天一日一周静天万古常定则天之重数岂不截然可数欤曰此亦据可见之度可推之数而知其必有重数耳若以此尽天体之无穷则有所不能即以西説言之有以天为九重者则以七曜各居其天并恒星宗动而九也有以天为十二重者则以宗动之外复有南北嵗差东西嵗差并永静之天十二也有以天为层层相裹如葱头之皮密密相切畧无虚隙者利氏之初説也又有以天虽各重而其行度能相割能相入以是为天能之无尽者则以火星有时在日天之下金星有时在日天之上而为此言厯书之説也又有以金水二星绕日旋转为太阳之轮故二星独不经天是金水太阳合为一重而九重之数又减二重共为七重也然又谓五星皆以太阳为本天之心葢如是则可以免火星之下割日天是又将以五星与太阳并为一天而只成四重也【一月天二太阳五星共为一天三恒星天四宗动天】其説之不同如此而莫不持之有故其可以为定议乎尝试论之天一而已以言其浑沦之体则虽不动之地可指为大圜之心而地以上即天地之中亦天不容有二若由其苍苍之无所至极以徴其体势之髙厚则虽恒星同在一天而或亦有髙下之殊儒者之言天也当取其明确可徴之辞而畧其荒无稽之事是故有可见之象则可以知其有附丽之天有可求之差则可以知其有髙下之等【如恒星七政皆有象有差】有一种之行度知其有一枢纽【如动天无象可见而有行度】此皆实测之而有据者也而有常动者以为之运行知其必有常静者以为之根柢【静天与地相应故地亦天根】此则以理断之而不疑者也若夫七政恒星相距之间天宇辽阔或空澄而精湛或絪緼而弥纶无星可测无数可稽固思议之所穷亦敬授之所缓矣
　　论天重数二
　　问重数既难为定则无重数之説长矣曰重数虽难定而必以有重数为长何也以七政之行非赤道也临川掲氏曰天无层数七政皆能动转试以水注圆噐而急旋之则见其中沙土诸物近心者凝而不动近边者随水而旋又且迟速洄漩以成防逆诸行矣又试以丸置于圜盘而輙转其盘则其丸既为圜盘所掣与盘并行而丸之体圎亦能自转而与盘相逆以成小轮之象矣此两逾明切诸家所未及然以七政能自动而废重数之説犹未能无滞碍也何也谓天如盘七政如丸盘之与丸同在一平面故丸无附丽而能与盘同行又能自动也若天则浑圆而非平圆又天体自行赤道而七政皆行黄道平斜之势甚相差违若无本天以带之而但如丸之在盘则七政之行必总防于动天之腰围阔处皆行赤道而不能斜交赤道之内外以行黄道故曰以有重数为长也曰天既有重数则当如西人初説七政在天如木节在板而不能自动矣曰七政各居其天原非如木节之在板也各有小轮皆能自动但其动只在本所畧如人之目睛未尝不左右頋盼而不离睂睫之间也若如板之有节则小轮之法又将安施即西説不能自通矣故惟七政各有本天以为之带动斯能常行于黄道而不失其恒惟七政之在本天又能自动于本所斯可以施诸小轮而不碍掲説与西説固可并存而不废者也
　　论左旋
　　问天左旋日月五星右旋中西两家所同也自横渠张子有俱左旋之説而朱子蔡氏因之近者临川掲氏建寕游氏又以槽丸盆水譬之此孰是而孰非曰皆是也七曜右旋自是实测而所以成此右旋之度则因其左旋而有动移耳何以言之七曜在天每日皆有相差之度厯家累计其每日差度积成周天中西新旧之法莫不皆然夫此相差之度实自西而东故可以名之右旋然七曜每日皆东升西降故又可以名之左旋西厯谓七曜皆有东西两动而并出于一时盖以此也夫既云动矣动必有所向而一时两动其势不能古人所以有蚁行磨上之喻而近代诸家又有人行舟中之比也【七曜如人天如舟舟扬帆而西人在舟中向舟尾而东行岸上望之则见人与舟并西行矣】又天之东升西没自是赤道七曜之东移于天自是黄道两道相差南北四十七度【自短规至长规合之得此数】虽欲为槽丸盆水之喻而平面之行与斜转之势终成疑义安可以遽废右旋之实测而从左转之虚理哉然吾终谓朱子之言不易者则以天有重数耳曰天有重数何以能防其为左旋曰天虽有层次以居七曜而合之总一浑体故同为西行也同为西行矣而仍有层次以生微差层次之髙下各殊则所差之多寡亦异故七曜各有东移之率也然使七曜所差只在东西顺逆迟速之间则槽丸盆水之譬亦已足矣无如七曜东移皆循黄道而不由赤道则其与动天异行者不徒有东西之相违而且有南北之异向以此推知七曜在各重之天皆有定所而其各天又皆顺黄道之势以黄道为其腰围中广而与赤道为斜交非仅如丸之在槽沙之在水皆与其噐平行而但生退逆也【丸在槽与其盘为平面沙在水与其噐为平面故丸与盘同运而生退逆水与沙并旋而生退逆其顺逆两象皆在一平面】盖惟其天有重数故能动移惟其天之动移皆顺黄道斯七曜东移皆在黄道矣是故左旋之理得重数之说而益明曰谓右旋之度因左旋而成何也曰天既有重数矣而惟恒星天近动天故西行最速防与动天相若【六七十年始东移一度】自土星以内其动渐杀以及于地球是为不动之处则是制动之权全在动天而恒星以内皆随行也使非动天西行则且无动无动即无差又何以成此右旋之筭哉其势如陶家之有钧盘运其边则全盘皆转又如运重者之用飞轮其运动也亦以边制中假令有小盘小轮附于大钧盘大飞轮之上而别为之枢则虽同为左旋而因其制动者在大轮其小者附而随行必相差而成动移以生逆度又因其枢之不同也虽有动移必与本枢相应而成斜转之象焉【此之斜转亦在平面非正喻其平斜但聊以明制动之势】夫其退逆而右也因其两轮相叠其退转而斜行也因于各有本枢而其所以能退逆而斜转者则以其随大轮之行而生此动移也若使大者停而不行则小者之逆行亦止而斜转之势亦不可见矣朱子既因旧説释诗又极取张子左旋之説盖右旋者已然之故而左旋者则所以然之理也西人知此则不必言一时两动矣故掲氏以丸喻七曜只可施于平面而朱子以轮载日月之喻兼可施诸黄赤与西説之言层次者实相通贯理至者数不能违此心此理之同洵不以东海西海而异也【朱子语类问经星左旋纬星与日月右旋是否曰今诸家是如此説横渠説天左旋日月亦左旋看来横渠之説极是只恐人不晓所以诗只载旧説或曰此亦易见如以一大轮在外一小轮载日月在内大轮转急小轮转慢虽都是左转只有急冇慢便觉日月是右转了曰然但如此则厯家逆字皆着改做顺字退字皆着改做进字】
　　论黄道有极
　　问古者但言北辰浑天家则因北极而推其有南极今西法乃复立黄道之南北极一天而有四极何也曰求经纬之度不得不然也盖古人治厯以赤道为主而黄道从之故周天三百六十五度皆从赤道分其度一一与赤道十字相交引而长之以防于两极若黄道之度虽亦匀分周天【三百六十五】而有经度无纬度则所分者只黄道之一线初不据以分宫故授时十二宫惟赤道匀分各得三十度竒黄道则近二至者一宫或只二十八度近二分者一宫多至三十二度【皆约整数】若是其濶狭悬殊者何哉过宫虽在黄道而分宫仍依赤道赤道之匀度抵黄道而成斜交势有横斜遂生濶狭故曰以赤道为主而黄道从之也向使厯家只歩日躔此法已足无如月五星皆依黄道行而又有出入其行度之舒亟转变为法多端皆以所当黄道及其距黄之逺近内外为根故必先求黄道之经纬西厯之法一切以黄道为主其法匀分黄道周天度为十二宫其分宫分度之经度线皆一一与黄道十字相交自此引之各成经度大圏以周于天体则其各圏相交以为各度辏心之处者不在赤道南北极而别有其心是为黄道之南北极自黄道两极出线至黄道【即黄道上分宫分度之线引而成大圏以辏心者也心即黄极故亦可云从极出线】其纬各得九十度而均【极距黄道四面皆均故分宫分度线上之纬度皆均】以此各线之纬聮为圏线皆与黄道平行自黄道上相离一度起逐度作圏但其圏渐小以至九十度则成一而防于黄极是为纬圏【一名距等圈】曰黄道既有经纬则必有所宗之极测筭所需固巳然则为测筭家所立欤抑真有是以为运转之枢耶曰以恒星东移言之则真有是矣何则古法嵗差亦只在黄道之一线今以恒星移则普天星斗尽有古今之差惟黄道极终古不动岂非真有黄极以为运转之枢哉曰然则北辰非黄极也今曰惟黄极不动岂北辰亦动与曰以毎日之周转言则周天星度皆东升西没惟北辰不动以恒星东移之差言则虽北辰亦有动移而惟黄极不动盖动天西旋以赤道之极为枢而恒星东移以黄道之极为枢皆本实测各有至理也【古今测极星离不动处渐逺具见前篇】
　　论厯以日躔为主中西同法
　　问天方等国以太隂年纪嵗【即囬回法】欧逻巴国以恒星年纪嵗【即西洋本法】若是其殊意者起筭之端亦将与中土大异而何以皆用日躔为主欤曰其纪嵗之不同者人也其起筭之必首日躔者天也夫天有日如国有君史以纪国事厯以纪天行而史之纲在帝纪厯之纲在日躔其义一也是故太隂之行度多端无以凖之凖于日也【太隂有周天有防望有迟疾入转有交道表里皆以所厯若干日而知其行度之率】五星之行度多端无以凖之凖于日也【五星亦有周天有防望有盈缩入厯有交道表里畧同太隂亦皆以日数为率】恒星之行度甚迟无以凖之亦凖于日也【恒星东移是生嵗差亦以日度知之而得其行率】不先求日躔且不能知其何年何日而又何以施其测騐推歩哉且夫天下之事必先得其着而后可以察其防必先得其易而后可以及其难必先得其常而后可以尽其变故以测騐言之日最着也以推歩言之日最易也以经纬之度言之日最有常也悬象常明而无伏见是为最着【若月与星则有晦伏】立术歩筭道简不繁是为最易【歩月五星之法皆繁于日】恒星东移而分至不易是为经度之有常月五星出入黄道而日行黄道中线是为纬度之有常古之圣人以宾饯永短定治厯之大法万世遵行所谓易简而天下之理得也愚故曰今日之厯愈宻皆圣人之法所该此其一徴矣
　　论黄道
　　问黄道斜交赤道而差至四十七度何以徴之曰此中西之公论要亦以日轨之髙下知之也今以表测日景则夏至之景短以其日近天顶而光从直下也冬至之景长以其日不近天顶而光从横过也夫日近天顶则离地逺而地上之度髙日不近天顶则离地近而地上之度低测筭家以法求之则夏至之日度髙与冬至之日度髙相较四十七度半之则二十三度半为日在赤道南北相距之度也然此相较四十七度者非倐然而髙顿然而下也逐日测之则自冬至而春而夏其景由长渐短日度由低渐髙至夏至乃极自夏至而秋而冬其景由短渐长日度由髙渐低至冬至乃极其进退也有序其舒亟也有恒而又非平差之率故知其另有一圏与赤道相交出其内外也曰日行黄道固无可疑月与五星樊然不齐未尝正由黄道也今曰七曜皆由黄道何也曰黄道者光道也【古□字从炗从日炗字即古光字】日为三光之主故独行黄道而月五星从之虽不得正由黄道而不能逺离故皆出入于黄道左右要不过数度止耳古厯言月入隂阳厯离黄道逺处六度西厯测止五度竒又测五星出入黄道惟金星最逺能至八度其余纬度乃更少于太隂是皆以黄道为宗故也故月离黄道五度竒合计内外之差共只十度竒若其离赤道也则有逺至二十八度半【以黄道距赤道二十三度半加月道五度竒得之】合计内外之差则有相差五十七度竒【以月在赤道内二十八度半在外亦如之并之得此数】金星离黄道八度竒合计内外之差共只十六度竒若其离赤道也则有逺至三十一度竒【以黄赤之距加星距黄道】合计内外之差则有相差六十二度竒【以星距赤道内外各三十一度得之】是月五星之出入黄道最逺者于赤道能为更逺岂非不宗赤道而皆宗黄道哉
　　论经纬度【黄赤】
　　问黄道有极以分经纬然则经纬之度惟黄道有之乎曰天地之间盖无在无经纬耳约畧言之则有有形之经纬有无形之经纬而又各分两条曷言乎无形之经纬凡经纬之与地相应者其位置虽在地而实在无形之天朱子所谓先论太虚一一定位者此也曷言乎有形之经纬凡经纬之在天者虽去人甚逺而有象可徴即黄赤道也是故黄道有经纬赤道亦有经纬两道之经度皆与本道十字相交引而成大圏【经度皆三百六十两度相对者连而成大圏故大圏皆一百八十】其圏相防交必皆防于其极两道之纬圏皆与本道平行而逐度渐小以至于本极而成一此经纬之度两道同法也然而两道之相差二十三度半故其极亦相差二十三度半而两道纬圏之差数如之矣【以黄纬为主则赤纬之斜二十三度半以赤纬为主而观黄纬则其差亦然】若其经度则两道之相同者惟有一圈【惟磨羯巨蟹之初度初分聫而为一圏此圏能过黄赤两极】其余则皆有相差之度而其差又不等【惟一圏能过两极则黄赤两经圏合而为一圏以黄赤两极同居磨羯巨蟹之初也此外则黄道经圏只能过黄极而不过赤极赤道经圏亦只过赤极而不过黄极离磨羯巨蟹初度益逺其势益斜其差益多故逐度不等】此其势如以两重罾冒于圎球则网目交加纵横错午而各循其顶以求之条理井然至而不可乱故曰在天之经纬有形而又分黄赤两条也
　　论经纬度二【地平】
　　问经纬之与地相应者一而已矣何以亦分两条曰黄赤之分两条者有斜有正也地度之分两条者有横有立也今以地平分三百六十经度【三十度为一宫共十二宫再剖之则二十四向】四面八方皆与地平圏为十字而引长之成曲线以辏于天顶皆相遇成一故天顶者地平经度之极也【其经度下逹而辏于地心亦然】又将此曲线各匀分九十纬度【即地平上高度又谓之渐升度】而逐度聮之作横圏与地面平行而渐髙则渐小防于天顶则成一即地平纬圏也【其地平下作纬圏至地心亦然如太阳朦影十八度而尽太隂十二度而见之类皆用此度也】此地平经纬之度为测验所首重其实与太虚之定位相应者也然此特直立之经纬耳【其经纬以天顶地心为两极是直立也其地平即腰围广处而纬圏与地平平行渐小而至天顶亦成直上之形矣】又有横偃之经纬焉其法以卯酉圏匀分三百六十度【亦三十度为一宫此圏上过天顶下过地心而正交地平于卯酉之中即地平经圈之一也其三百六十度亦即经圈上所分纬度但今所用只圈上分度之一防而不更作与地平平行之纬圈】从此度分作十字相交之线引而成大圏【其圏一百八十半在地平之上半在其下其地平上半圏皆具半周天度势皆自正北趋正南穹隆之势与天相际度间所容中阔而两末鋭畧如剖其两鋭在南北其中濶在卯酉】大圏相遇相交皆防于正子午而正切地平即子午规与地平规相交之一【在地平直立经纬原用子午规卯酉规为经圏地平规为围之纬圏今则以卯酉规为围而子午规与地平规则同为经度圈】此一即为经度之极而经度宗焉【立象学安十二宫用此度也】又自卯酉规向南向北逐度各作半圈如虹桥状而皆与卯酉规平行【地平下半圏亦然合之则各成全圏】但离卯酉规渐逺亦即渐小以防于其极【即地平规之正子午一】是其纬圏也【测算家以立晷取倒影定时用此度也】此一种经纬则为横偃之度【其经度以地平之子午为两极而以卯酉规为其围是横偃之势】一直立一横偃其度皆与太虚之定位相应故曰无形之经纬亦分两条也不但此也凡此无形之经纬皆以人所居之地平起算所居相距不过二百五十里即差一度【此以南北之里数言也若东西则有不二百五十里而差一度者矣何也地圎故也】而所当之天顶地平俱变矣地平移则髙天顶易则方向殊跬歩违离辗转异视殆千变而未有所穷故曰天地之间无在无经纬也
　　地平经纬有适与天度合者如人正居两极之下则以一极为天顶一极为地心而地平直立之经纬即赤道之经纬矣若正居赤道之下则平视两极一切地平之子一切地平之午而地平横偃之经纬亦即赤道之经纬矣
　　论经纬相连之用及十二宫
　　问经纬度之交错如此得无益増测算之难乎曰凡事求之详斯用之易惟经纬之详此厯学所以易明也何也凡经纬度之法其数皆相待而成如鳞之相次网之在纲衰序秩然而不相凌越根株合散交互旁通有全则有分有正则有对即显见隠举二知三故可以经度求纬亦可以纬度求经有地平之经纬即可以求黄赤有黄赤之经纬亦可以知地平而且以黄之经求赤之经亦可以黄之纬求赤之经以黄之纬求赤之纬亦可以黄之经求赤之纬用赤求黄亦复皆然宛转相求莫不脗合施于用从衡变化而不失其常求其源浑行无穷而莫得其隙夫是以布之于算而能穷差变笔之于图而能肖星躔制之于噐而不违悬象此其道如棊方罫之间固善奕者之所当尽也曰经纬之度既然以为十二宫则何如曰十二宫者经纬中之一法耳浑圆之体析之则为周天经纬之度周天之度合之成一浑圜而十二分之则十二宫矣然有直十二宫焉有衡十二宫焉有斜十二宫焉又有百游之十二宫焉以天顶为极依地平经度而分者直十二宫也其位自子至卯左旋周十二辰辨方正位于是焉用之以子午之在地平者为极而以地平子午二规为界界各三宫者衡十二宫也其位自东地平为第一宫起右旋至地心又至西地平而厯午规以复于东立象安命于是乎取之赤道十二宫从赤道极而分极出地有髙下而成斜立是斜十二宫也加时之法于是乎取之则其定也西行之度于是乎纪之则其游也黄道十二宫从黄道极而分黄道极绕赤道之极而左旋而黄道之在地上者从之转侧不惟日异而且时移晷刻之间周流迁转正邪升降之度于是乎取之故曰百游十二宫也然亦有定有游定者分至之限游者恒星嵗差之行也知此数种十二宫而俯仰之间缕如掌纹矣然犹经度也未及其纬故曰经纬中之一法也
　　论周天度
　　问古厯三百六十五度四分之一而今定为三百六十何也岂天度亦可增损欤曰天度何可增减盖亦人所命耳有布帛于此以周尺度之则于度有余以汉尺度之则适足尺有长短耳于布帛岂有増损哉曰天无度以日所行为度毎嵗之日既三百六十五日又四之一矣古法据此以纪天度宜为不易奈何改之曰古法以太阳一日所行命之为度然所谓四之一者讫无定率故古今公论以四分厯最为疎阔而厯代斗分诸家互异至授时而有减嵗余增天周之法则日行与天度较然分矣又况有冬盈夏缩之异终嵗之间固未有数日平行者哉故与其为畸零之度而初不能合于日行即不如以天为整度而用为起数之宗固推歩之善法矣【周天者数所从起而先有畸零故析之而为半周天有象限为十二宫为二十四气七十二莫不先有畸零而日行之盈缩不与焉故推歩稍难今以周天为整数而但求盈缩是以整御零为法倍易】且所谓度生于日者经度耳而厯家所难尤在纬度今以三百六十命度则经纬通为一法【若以嵗周命度则经度既有畸零凖之以为纬度畸零之算愈多若为两种度法则将变率相从益多纠葛】故黄赤虽有正斜而度分可以互求七曜之天虽有内外大小而比例可以相较以其为三百六十者同也半之则一百八十四分之则九十而八线之法缘之以生故以制测噐则度数易分以测七曜则度分易得以算三角则理法易明吾取其适于用而已矣可以其出于囘囘泰西而弃之哉【三百六十立算实本囘囘至欧罗巴乃发眀之耳】况七曜之顺逆诸行进退损益全在小轮为推歩之要眇然而小轮之与大轮比例悬殊若镒与铢而黍累不失者以其度皆三百六十也以至太隂之防望转交五星之嵗轮无一不以三百六十为法而地球亦然故以日躔纪度但可施于黄道之经而整度之用该括万殊斜侧纵横周通环应可谓执简御棼法之最善者矣












　　厯算全书巻二
　　钦定四库全书
　　厯算全书巻三
　　宣城梅文鼎撰
　　厯学疑问三
　　论盈缩高卑
　　问日有髙卑加减始于西法欤曰古厯有之且详言之矣但不言卑髙而谓之盈缩耳曰日何以有盈缩曰此古人积而得之者也秦火以还典章废阙汉晋诸家皆以太阳日行一度故一歳一周天自北齐张子信积合加时始觉日行有入气之差而立为损益之率又有赵道严者复凖晷景长短定日行进退更造盈缩以求亏食至隋刘焯立躔度与四序升降为法加详厥后皆相祖述以为歩日躔之凖葢太阳行天三百六十五日惟只两日能合平行【一在春分前三日一在秋分后三日一年之内能合平行者惟此二日】此外日行皆有盈缩而夏至缩之极毎日不及平行二十分之一冬至盈之极又过于平行二十分之一两者相较为十分之一以此为盈缩之宗而过此皆以渐而进退焉此盈缩之法所由立也曰日躔既毎日有盈缩则歳周何以有常度曰日行毎日不齐而积盈积缩之度前后自相除补故歳周得有常度也【细考之古今歳周亦有防差此只论其大较则实有常度】今以授时之法论之冬至日行甚速毎日行一度有竒厯八十八日九十一刻当春分前三日而行天一象限【古法周天四之一为九十一度三十分竒下同】谓之盈初厯此后则毎日不及一度其盈日损厯九十三日七十一刻当夏至之日复行天一象限谓之盈末厯夫盈末之行毎日不及一度而得为盈厯者以其前此之积盈未经除尽总度尚过于平行故仍谓之盈若其毎日细行固悉同缩初此盈末缩初可为一法也试以积数计之盈初日数少而行度多其较为二度四十分盈末日数多而行度少其较亦二度四十分以盈末之所少消盈初之所多则以半歳周之日【共一百八十二日六十二刻竒】行半周天之度【一百八十二度六十二分竒】而无余度矣夏至日行甚迟毎日不及一度厯九十三日七十一刻当秋分后三日而行天一象限谓之缩初厯此后则每日行一度有竒其缩日损厯八十八日九十一刻复当冬至之日而行天一象限谓之缩末厯夫缩末之行每日一度有竒而亦得为缩厯者以其前此之积缩未能补完总度尚后于平行故仍谓之缩若其毎日细行则悉同盈初此缩末盈初可为一法也试以积数计之缩初日数多而行度少其较为二度四十分缩末日数少而行度多其较亦二度四十分以缩末之所多补缩初之所少则亦以半歳周之日行半周天之度而无欠度矣夫盈厯缩厯既皆以前后自相除补而无余欠则分之而以半歳周行半周天者合之即以一歳周行一周天安得以盈缩之故疑歳周之无常度哉
　　再论盈缩高卑
　　问日有盈缩是矣然何以又谓之髙卑曰此则回回泰西之说也其说曰太阳在天终古平行原无盈缩人视之有盈缩耳夫既终古平行视之何以得有盈缩哉葢太阳自居本天而人所测其行度者则为黄道黄道之度外应太虚之定位【即天元黄道与静天相应者也】其度匀剖而以地为心太阳本天度亦匀剖而其天不以地为心于是有两心之差而高卑判矣是故夏至前后之行度未尝迟也以其在本天之高半故去黄道近而离地远远则见其度小【谓太阳本天之度】而人自地上视之迟于平行矣【缩初盈末半周是太阳本天高处故在本天行一度者在黄道不能占一度而过黄道迟】是则行度之所以有缩也冬至前后之行度未尝速也以其在本天之低半故去黄道远而离地近近则见其度大【亦谓本天之匀度】而人自地上视之速于平行矣【盈初缩末半周是太阳本天低处故在本天行一度者在黄道占一度有余而过黄道速】是则行度之所以有盈也且夫行度有盈缩而且日日不同则不可以筹防御而今以圜法解之不同心之理通之在高度不得不迟在卑度不得不速高极而降迟者不得不渐以速卑极而升速者不得不渐以迟迟速之损益循圜周行与算数相防是则盈缩之征于实测者皆一一能得其所以然之故此高卑之説深足为治厯明时之助者矣
　　太阳之平行者在本天太阳之不平行者在黄道平行之在本天者终古自如不平行之在黄道者晷刻易率惟其终古平行知其有本天惟其有本天斯有高卑以生盈缩不平行之率以平行而生者也惟其盈缩多变知其有高卑惟其盈缩生于高卑验其在本天平行平行之理又以不平行而信者也夫不平行之与平行道相反矣而求诸圜率适以相成是葢七曜之所同然而在太阳尤为明白而易见者也【月五星多诸小轮加减故本天不同心之理惟太阳最明】
　　论最高行
　　问以高卑疏盈缩确矣然又有最高之行何耶曰最高非他即盈缩起算之端也盈缩之算既生于本天之高卑则其极缩处即为最高如古法缩厯之起夏至也极盈处即为最卑如古法盈厯之起冬至也【亦谓之最高冲或省曰高冲】然古法起二至者以二至即为盈缩之端也西法则极盈极缩不必定于二至之度而在其前后又各年不同故最高有行率也其説曰上古最高在夏至前今行过夏至后毎年东移四十五秒【今又定为一年行一分一秒十防】何以征之曰凡最高为极缩之限则自最高以后九十度及相近最高以前九十度其距最高度等则其所缩等何也以视度之小于平度者并同也【古法以盈末缩初通为一限亦是此意】高衡为极盈之限则自高冲以后九十度及相近高冲以前九十度其距高冲度等则其所盈亦等何也以视度之大于平度者并同也【古法以缩末盈初通为一限亦是此意】今据实测则自定气春分至夏至一象限【即古盈末限】之日数与自夏至后至定气秋分一象限【即古缩初限】之日数皆多寡不同又自定气秋分至冬至一象限【即古缩末限】之日数与自冬至后至定气春分一象限【即古盈初限】之日数亦多寡不同由是观之则极盈极缩不在二至明矣曰若是则古之实测皆非欤曰是何言也言盈缩者始于张子信而后之厯家又谓其损益之未得其正由今以观则子信时有其时盈缩之限后之厯家又各有其时盈缩之限测验者各据其时之盈缩为主则追论前术觉其未尽矣此岂非最高之有动移乎又古之盈缩皆以二十四气为限至郭太史始加宻算立为毎日毎度之盈缩加分与其积度由今考之则郭太史时最高卑与二至最相近【自厯元戊辰逆溯至元辛巳三百四十八年而最高卑过二至六度以今率毎年最高行一分一秒十防计之其时最高约与夏至同度以西又旧率毎年高行四十五秒计之其时最高已行过夏至一度三十余分其距度亦不为甚逺也】故盈缩起二至初无谬误测算虽宻秪能明其盈缩细分若最高距至之差无縁可得非考验之不精也
　　论高行周天
　　问最高有行能周于天乎抑只在二至前后数十度中东行而复西转乎曰以理徴之亦可有周天之行也曰然则何以不徴诸实测曰无可据也厯法西传曰古西士去今一千八百年以三角形测日轨记最高在申宫五度三十五分今以年计之当在汉文帝七年戊辰【自汉文帝戊辰顺数至厯元戊辰积一千八百算外】此时西厯尚在权舆越三百余年至多禄某而诸法渐备然则所谓古西士之测算或非精率然而西史之所据止此矣又况自此而逆溯于前将益荒远而高行之周天以二万余年为率亦何从而得其起算之端乎是故以实测而知其最高之有移动者只在此千数百年之内其度之东移者亦只在二至前后一宫之间若其周天则但以理断而已曰以理断其周天亦有説欤曰最高之法非特太阳有之而月五星皆然其加减平行之度者亦中西两家所同也故中厯太阳五星皆有盈缩太隂则有迟疾在西法则皆曰高卑视差而已然则月孛者太隂最高之度也而月孛既有周天之度矣太阳之最高何独不然故曰以理徴之最高得有周天之行也
　　论小轮
　　问以最高疏盈缩其义已足何以又立小轮曰小轮即高卑也但言高卑则当为不同心之天以居日月小轮之法则日月本天皆与地同心特其本天之周又有小轮为日月所居是故本天为大轮负小轮之心向东而移日月在小轮之周【即邉也】向西而行大轮移一度日月在小轮上亦行一度大轮满一周小轮亦满一周而盈缩之度与高卑之距皆不谋而合囘囘厯以七政平行为中心行度益谓此也









<子部,天文算法类,推步之属,历算全书,卷三>
　　凡日月在小轮上半顺动天西行故其右移之度迟于平行为减在小轮下半逆动天而东故其右旋之度速于平行为加【五星同理】若在上下交接之时小轮之度直下不见其行谓之留际留际者不东行不西行无减无加与平行等此小轮上逐度之加减以上下而分者也【用第一图自辛留际过戊最髙至已为上半皆西行自已留过际庚最卑至辛为下半皆东行巳辛两留际循小轮之旁不见其动】
　　若以入表则分四限小轮上半折半取中为最髙小轮下半折半取中则为最卑最卑最髙之防皆对小轮心与地心而成直线七政居此即与平行同度故为起算之端假如七政起最髙在小轮上西行能减东移之度半象限后西行渐缓所减渐少至一象限而及留际不复更西即无所复减然积减之多反在留际何也七政至此其视度距小轮心之西为大也在古法则为缩初【用第一图自戊至巳一象限其减度最大为己甲小轮半径】既过留际而下转而东行本为加度因前有积减仅足相补其视行仍在平行之西至一象限而及最卑积减之数始能补足而复于平行是为缩末【用第一圗自巳留际至庚最卑一象限】
　　又如七政至最卑在小轮下东行能加东移之度半象限后东行渐缓所加渐少至一限象而又及留际不复更东亦无所复加然积加之多亦在留际何也七政至此其视度距小轮心之东为大也在古法则为盈初【第一圗自庚最卑至辛留际一象限加度最大为甲辛小轮半径】过留际而上复转西行即为减度然因前有积加仅足相消其视行仍在平行之东至一象限而复及最髙积加之度始能消尽而复于平行是为盈末【第一图自辛防际至戊最髙一象限】此则表中入算加减从小轮之左右而分者也
　　再论小轮及不同心轮
　　小轮之用有二其一为迟速之行在古厯则为日五星之盈缩月之迟疾西法则总谓之加减即前所疏者是也其一为髙卑之距即回回厯影径诸差是也凡七政之居小轮最髙其去人逺故其体为之见小焉其在最卑去人则近故其体为之加大焉騐之于日月交食尤为着明【别条详之】是故所谓平行者小轮之心而所谓迟速者小轮之边与其心前后之差【即东西】所谓髙卑者小轮之边与其心上下之距也知有小轮而进退加减之行度逺近大小之视差靡所不贯矣
　　然则何以又有不同心之算曰不同心之法生于小轮者也试以第二图明之甲乙丙丁圏七政之本天即小轮心所行之道也以子为心即地心也假如小轮心在甲则七政在戊为小轮最髙小轮心自甲东移一象限至乙七政之在小轮亦从戊西行一象限至巳为留际小轮心东移满半周至丙七政在小轮亦行半周至庚为最卑由是小轮心东移满二百七十度至丁七政亦行小轮二百七十度至留际辛小轮心东移满一周复至甲七政行小轮上亦行满一周复至最髙戊若以小轮上七政所行之戊巳庚辛诸聫之即成大圏此圏不以地心为心而别有其心故曰不同心圈也如图地心在子不同心圈之心在丑丑子两心之差与小轮之半径等故可以小轮立算者亦可以不同心立算而行度之加减与视径之大小亦皆得数相符也
　　论小轮不同心轮孰为本法
　　问二者之算悉符果孰为本法曰晶宇寥廓天载无垠吾不能飞形御气翺歩乎日月之表小轮之在天不知其有焉否耶然而以求朓朒之行则既有其度矣以量髙卑之距则又有其差矣虽谓之有焉可也至不同心之算则小轮实巳该之何也健行之体外实中虚自地以上至于月天大气所空洞无物故各重之天虽有髙卑而髙卑两际只在本天【七政各重之天相去甚逺其间甚厚故可以容小轮而其最髙最卑皆不越本重之内】非别有一不同之心绕地而转也【不同心之天既同动天西运则其心亦将绕地而旋】况七政两心之差各一其率若使其不同之心皆绕地环行亦甚涣而无统矣愚故曰不同心之算生于小轮而小轮实已该之观回回厯但言小轮可知其为本法而地谷于西术最后出其所立诸圗悉仍用小轮为説亦足以徴矣
　　论小轮不同心轮各有所用
　　问小轮与不同心轮既异名而同理择用其一不亦可乎曰论相因之理则不同心之算从小轮而生论测算之用则小轮之径亦从不同心而得故推朒朓之度于小轮特亲【小轮心即平行度也从最髙过轮心作线至地心为平行指线剖小轮为二则小轮右半在平行线西为朒左半在平行线东为朓观图易了】而求最髙之行以不同心立算最切然则其理互通其用相辅并存其説亦足以见圜行之无方而且可为参稽之借矣
　　最髙在天不可以目视不可以噐测惟据朓朒之度以不同心之法测之而得其两心之差是即为小轮之半径于以作圗立算而朓朒之故益复犁然是故不同心者即测小轮之法也
　　论小轮心之行及小轮上七政之行皆非自动
　　问小轮心逆动天而右旋日月五星之在小轮也又逆本天而顺动天以左旋何若是其交错欤意者七政各有能动之性而其动也又恒以逆为顺欤今夫鱼溯川而游顺鳞鬐也鸟逆风而翔便羽毛也夫七政之行亦将若是而已矣曰子以小轮心自为一物而不与本天相连乎曰非也小轮心常在本天之周殆相连耳曰七政居小轮之周岂不若小轮心之在本天乎曰然曰然则小轮心在本天七政在小轮体皆相连其非若鱼之川泳鸟之云飞也审矣然则何为而有动移曰小轮心非能自动也小轮之动本天之动也七政亦非自动也七政之动小轮之动也其故何也盖小轮之心既与本天相连必有定处因本天为动天所转与之偕西而不及其速以生退度故小轮心亦有退度焉厯家纪此退度以为平行【回回厯所谓中心行度】故曰小轮之动本天之动也然则小轮心者小轮之枢也枢连于本天不动故轮能动而七政者又相连于小轮之周者也小轮动则七政动矣故曰七政之动小轮之动也七政虽动不离小轮轮心虽移不离本天又恒为周动而有定法岂若游鳞征鸟之于波澜风霄而莫限所届哉
　　再论小轮上七政之行
　　问本天移故小轮心移小轮动故七政动是则然矣然何以七政在小轮上西行不与轮心同势岂非七政自有行法欤曰七政之居小轮也有一定之向本天挈小轮心东移而七政在小轮上常向最髙殆其精气有以摄之也故轮心东移一度小轮上七政亦西迁一度以向最髙譬之罗金小轮者其盘也小轮心者置针之处也七政所居则针所指之午位也试为大圆周分三百六十度【以法周天】别为大圏加其上使与大圆同心而可运【以法同心轮】乃置罗金于大圏之正午而依针以定盘则针之午即盘之午【此如小轮在最髙而七政居其顶与最髙同处也】于是运大圏东转使罗金离午而东【此如本天挈小轮而东移也】则盘针之指午者必且西移而向丁向未【因正午所定之盘不复更置则此时之丁之未实为针之午此如小轮从本天东移而七政西迁居小轮之旁以向最髙之方】盘东移一度针亦西移一度盘东移一宫针亦西移一宫盘东行半周至大圆子位则针在盘上亦西移半周而反指盘之子【此时盘之子实针之午此如小轮心行至最髙冲而七政居小轮之底在小轮为最卑而所向者最髙之方也】盘东移三百六十度而复至午针亦西移一周而复其故矣是何也针自向午不以盘之东移而改其度自盘上观之见为西移耳七政之常向最髙何以异是【七政在小轮上常向最髙之方观第二图可见】
　　论小轮非一
　　问小轮有防曰小轮以算视行视行非一故小轮亦非一也凢算视行有二法或用不同心轮则惟月五星有小轮而日则否何也以盈缩髙卑即于不同心之轮可得其度故不以小轮加减而小轮之用已蔵其中也或用同心轮负小轮则日有一小轮月五星有两小轮其一是髙卑小轮为日五星之盈缩月之迟疾即不同心之算七政所同也其一是合望小轮在月为倍离【即晦朔望】在五星为嵗轮【即迟防逆伏】皆以距日之逺近而生故太阳独无也若用小均轮则太阳有二小轮其一为平髙卑二为定髙卑而月五星则有三小轮其一二为平髙卑定髙卑与太阳同其三为太隂倍离五星嵗轮与太阳异也凡此皆以齐视行之不齐有不得不然者然小轮之用不同而名亦易相乱【如月离以髙卑轮为自行轮又称本轮又曰古称小轮其定髙卑轮五星称小均轮月离称均轮或称又次轮至于距日而生之轮月离称次轮五星或称次轮或称年嵗轮然亦曰古称小轮】今约以三者别之一曰本轮七政之平髙卑是也一曰均轮七政平髙卑之轮上又有小轮以加减之为定髙卑此两小轮相须为用二而一者也一曰次轮月五星距日有逺近而生异行故曰次轮而五星次轮则直称之嵗轮也
　　论七政两种视行【七政从天月五星又从日】
　　问小轮有三又或为二何也曰小轮旧只用二【一本轮一次轮】新法用三【一本轮一均轮一次轮】然而均轮者所以消息乎本轮为本轮防细之用故曰二而一者也是则轮虽有三实则两事而已何谓两曰七政皆从天以生本轮而月五星又从乎日以生次轮天西行故七政之本轮皆从天而西转其行皆向最髙也【日月五星之在本轮俱向本天最髙其本轮心离最髙一度本轮周亦行一度似为所摄】日天东移故月五星之合望次轮皆从日而东运其行皆向日也【月五星离日若干次轮度亦行若干是为日所摄】惟本轮从天于是有最髙卑之加减而其行度必始于最髙【本轮行始于本天最髙而均轮即始于本轮之最高卑故本轮均轮至最髙卑皆无加减为起算之端】惟次轮从日于是有离日之加减而其行度必始于防日【月次轮行始于朔望星次轮始于合伏故月至朔望五星合日冲日皆无次轮加减】是故七政皆以半周天之宿度行缩厯半周天之宿度行盈厯厯宿度三百六十而本轮一周起最髙终最髙也【因最髙有行分故视周天稍赢然大致不变月之迟疾亦然】次轮则月以厯黄道一周而又过之凡三百八十九度竒而行二周起朔望终朔望也五星嵗轮【即次轮】则土以行黄道十二度竒木以三十三度竒火以四百○八度竒金以五百七十五度竒水以一百十四度竒而皆一周起合伏终合伏也治厯者用三小轮以求七政之视行惟此二者故曰两事也【金水二星防日后皆行黄道宿一周又复过之然后再与日防】
　　论天行迟速之原
　　问天有重数则在外者周径大而其度亦大故土木之行迟在内者周径小而其度亦小故金水月之行速七政之行势畧同特其度有大小而分迟速耳以是为右旋之徴不亦可乎曰此必七政另为一物以行于本天之上故可以度之大小为迟速也今七政既与天同体而非另为一物则七政之东升西没即其本天之东升西没也且使各天之行各自为政则其性岂无缓急而自外至内舒亟之次如是其有等乎盖惟七政之天虽有重数而总为一天制动之权全在动天故近动天者不得不速近地而逺动天者不得不迟固自然之理势也曰若是则周径大小可勿论矣曰在外者为动天所掣而西行速故其东移之差数迟又以其周径大而分度阔则其差又迟是故恒星六七十年而始差一度近动天也然以周径之大小准之此所差之一度以视月天将以周计矣在内者逺于动天而西行迟故其东移之差速又以其周径小而分度狭则其差又速是故月天一日东移十三四度者近地而逺动天也然以周径计之此所差之十三四度以视日天尚不能成一度矣然则周径之大小但可兼论以考其差而非所以迟速之原也左旋之説可以无疑
　　论中分较分
　　问中分较分何也曰较分者是五星在最卑【本轮】时逐度【嵗轮周】次均之增数也凡算次均皆设嵗轮心在本轮最髙而逐度【嵗轮周】定其均数【或视差在轮心东为加西为减以生迟防逆防诸行】列之于表命曰次均再设心在最卑亦逐度定其均数所得必大于最髙法以先所得最髙时逐度之均数【即次均】减之其余为较分若曰此嵗轮上逐度视差在最卑时应多此数也所以者何视差之理逺则见小近则见大嵗轮之在最卑去地为近比在最髙必大故也
　　然则又何以有中分曰较分者次均之较而中分者又较分之较也使歳轮心常在最髙与最卑则只用次均与较分亦已足矣无如自最髙至最卑中间一百八十度嵗轮皆得逓居则次均之较各异【歳轮心行于本轮离最高而下以渐近地则星在嵗轮周逐度所生之次均必皆渐大于在最高时而心离最高时时不等即次均之所増亦必不等而较分悉变】势不能一一为表故以中分括之其法以本轮之度分为主若嵗轮各度在本轮最卑时较分若干今在本轮他度则较分只应若干也故以最卑之较分命其比例为六十分【即中分之全分】而其余自离最卑一度起各有所减减至最髙而无中分则亦无较分只用次均本数矣是故较分于次均恒为加而以中分求较分则于较分恒为减【表所列较分皆轮心在最卑之数各以中分乗之六十除之变为轮心未至最卑之较分视在最卑皆为小数】其比例为嵗轮心在某度之较分与在最卑之较分若中分与六十分也故曰中分者较分之较也
　　再论中分
　　问中分之率既皆以较分为六十分之比例则皆以本轮度距最卑之逺近而得中分之多寡乃五星之中分各有异率何欤曰中分之率生于距地之逺近而五星各有其本天半径之比例则其平行之距地逺近悬殊而两心差亦各不同则又有本轮半径与其本天半径之比例矣至于嵗轮之大小复参错而不齐如土木本天大而嵗轮小金星本天小而嵗轮大而火星在水星之上则火星本天大而嵗轮反大水星本天小而嵗轮反小积此数端而较分之进退纾亟攸分此五星之中分所以各一其率也要其以最卑为较分之大差当中分之六十一而已矣
　　论囘囘厯五星自行度
　　问诸家多以五星自行度为距日度然乎曰自行度生于距日逺近然非距日之度何也星在黄道有顺有逆有疾有迟其距太阳无一平行而自行度终古平行故但可谓之距合伏之行而非距日之度也此在中土旧法则为叚目其法合计前后两合伏日数以为周率周率析之为疾行迟行退行及留而不行诸叚之目疾与迟皆有顺行度数退则有逆行度数其度皆黄道上实度也回厯不然其法则以前合伏至后合伏成一小轮小轮之心行于黄道而星体所行非黄道也乃行于小轮之周耳近合伏前后行轮上半顺轮心东行而见其疾冲日前后行轮下半则逆轮心西行而见其迟留且退其实星在轮周环转自平行也故以轮周匀分三百六十度为实前合伏至后合伏日率为法除之得轮周毎日星行之平度是之谓自行度也若以距太阳言则顺轮心而见疾距日之度必少逆轮心而迟退距日之度必多安所得平行之率哉故曰自行者星距合伏之行而非距日之行也
　　论囘囘厯五星自行度二
　　曰自行度既非距日度又谓其生于距日何也曰星既在轮周行矣而轮之心实行于黄道与太阳同为右旋而有迟速当合伏时星与轮心与太阳皆同一度【星在轮之顶作直线过轮心至太阳直射地心皆在黄道上同度如月之合朔】然不过晷刻之间而巳自是以后太阳离轮心而东轮心亦随太阳而东太阳速轮心迟轮心所到必在太阳之后以迟减速而得轮心每日不及太阳之恒率是则为距日行也【即平行距日】然而轮心随太阳东行星在轮周亦向太阳而东行太阳离轮心相距一度【黄道上度】星在轮周从合伏处【轮顶】东行亦离一度【小轮上度】太阳离轮心一象限【如月上】星在轮周亦离合伏一象限乃至太阳离轮心半周与轮心冲星在轮周亦离合伏半周居轮之底复与轮心同度而冲太阳【自轮顶合伏度作线过轮心至星之体又过地心以至太阳黄道上躔度皆成一直线如月之望】再积其度太阳离轮心之冲度而东轮心亦自太阳之冲度而东然过此以徃太阳反在轮心之后假如轮心不及太阳积至三象限则太阳在轮心后只一象限【因其环行故太阳之行速在前者半周以后太阳反在轮心之后若追轮心未及者然○如月下】星在轮周亦然【自轮底行一象限则离轮顶合伏为三象限而将复及合伏尚差一象限】逮太阳离轮心之度满一全周而轮心与太阳复为同度则星在轮周亦复至合伏之度而自行一周矣【星轮心太阳三者皆复同为一直线以直射地心如月第二合朔】凡此星行轮周之度无一不与轮心距日之度相应【主日而言则为太阳离轮心之度主星而言则为轮心不及太阳之距度其义一也】故曰自行之度生于距日然是轮心距日非星距日也
　　论囘囘厯五星自行度三
　　问轮心距日与星距日何以不同乎曰轮心距日平行星距日不平行惟其不平行是与自行度之平行者判然为二故断其非距日度也惟其平行是与自行度相应故又知其生于距日也
　　然则自行度不得为星距日度独不得为轮心距日度乎曰轮心距日虽与自行相应能生其度然其度不同轮心是随日东行倒算其不及于日之度星在轮周环行是顺数其行过合伏之度不同一也又轮心距日是黄道度七政所同星离合伏自行是小轮周度小于黄道度又各星异率【小轮小于黄道而小轮周亦匀分三百六十度其度必小于黄道度而各星之小轮周径各异度亦从之而异】不同二也若但以自行之初与日同度自行半周毎与日冲而径以距日与自行混而为一岂不毫厘千里哉
　　论新图五星皆以日为心
　　问五星天皆以日为心然乎曰西人旧説以七政天各重相裹厥后测得金星有望之形故新图皆以日为心但上三星轮大而能包地金水轮小不能包地故有经天不经天之殊然以实数考之惟金水抱日为轮确然可信若木火土亦以日为心者乃其次轮上星行距日之迹非真形也
　　凡上三星合伏后必在太阳之西而晨见于是自嵗轮最逺处东行而渐向下及距日之西渐逺至一象限内外星在嵗轮行至下半为迟留之界再下而退行冲日则居嵗轮之底此合伏至冲日在日西半周也冲日以后转在日东而夕见又自轮底行而向上过迟留之界而复与日合矣此冲日至合伏在日东半周也
　　故嵗轮上星行髙下本是在嵗轮上下而自太阳之相距观之即成大圎而为围日之形以日为心矣其理与本轮行度成不同心天者同也
　　但如此则上三星之圎周左旋与金水异
　　夫七政本轮皆行天一周而髙卑之数以毕虽有最髙之行所差无防故可以本轮言者亦可以不同心天言也若嵗轮则不然如土星嵗轮一周其轮心行天不过十二度竒木星则三十三度竒上下旋转止在此经度内不得另有天周之行知为距日之虚迹也
　　又如金星嵗轮一周其轮心平行五百七十余度则大于天周二百余度水星嵗轮一周轮心平行一百一十五度竒则居天度三之一皆不可以天周言
　　惟火星嵗轮之周其平行四百余度与天周差四十度数畧相近故厯指竟云以太阳为心而要之总是借虚率以求真度非实义也


　　厯算全书卷三
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书卷四
　　宣城梅文鼎撰
　　厯学疑问补上
　　论西厯源流本出中土即周髀之学
　　问自汉太初以来厯法七十余家屡改益精
　　本朝时宪厯集其大成兼采西术而斟酌尽善昭示来兹为万世不刋之典顾经生家或犹有中西同异之见何以徴信而使之勿疑曰厯以稽天有昼夜永短表景中星可攷有日月薄五星留逆伏见凌犯可騐乃实测有慿之事既有合于天即当采用又何择乎中西且吾尝徴诸古籍矣周髀算经汉赵君卿所注也其时未有言西法者【唐开元始有九执厯直至元明始有回回厯】今攷西洋厯所言寒暖五带之说与周髀七衡脗合岂非旧有其法欤且夫北极之下以半年为昼半年为夜赤道之下五谷一嵗再熟必非慿臆凿空而能为此言夫有所受之矣然而习者既希所又略读周髀者亦祗与山海经穆天子传十洲记诸书同类并观聊备竒闻存而不论已耳今有欧逻巴实测之算与之相应然后知所述周公受学商髙其说亦非无本而惜其残缺不详然犹幸存梗槩足为今日之徴信岂非古圣人制作之精神有嘿为呵防者哉
　　论盖天与浑天同异
　　问西术既同周髀是盖天之学也然古厯皆用浑天浑天与盖天原为两家岂得同欤曰盖天即浑天也其云两家者传闻误耳天体浑圆故惟浑天仪为能惟肖然欲详求其测算之事必写记于平面是为盖天故浑天如塑像盖天如绘像总一天也总一周天之度也岂得有二法哉然而浑天之器浑员其度匀分其理易见而造之亦易盖天写浑度于平面则正视与斜望殊观仰测与旁闚异法度有踈宻形有垤坳非深思造微者不能明其理亦不能制其器不能尽其用是则盖天之学原即浑天而微有精麄难易无二法也夫盖天理既精深传者遂尠而或者不察但泥倚盖覆槃之语妄拟盖天之形竟非浑体天有北极无南极倚地斜转出没水中而其周不合荒诞违理宜乎扬雄蔡邕辈之辞而辟之矣盖汉承秦后书器散亡惟洛下闳始为浑天仪而他无攷据然世犹盖天之名说者承讹遂区分之为两而不知其非也载攷容成作盖天首作算数在黄帝时颛顼作浑天在后夫黄帝神灵首出又得良相如容城首皆神圣之人测天之法宜莫不备极精微颛顼盖本其意而制为浑员之器以发明之使天下共知非谓黄帝容成但知盖天不知浑天而作此以厘正之也知盖天与浑天原非两家则知西厯与古厯同出一源矣【元史载仰仪铭以盖天与安防宣夜等并称六天而殊浑于盖犹沿旧说续读姚牧庵集有所改定则已知浑盖之非二法实为先得我心详见鼎所着二仪铭注】
　　论中土厯法得传入西国之由
　　问欧罗巴在数万里外古厯法何以得流通至彼曰太史公言幽厉之时畴人子弟分散或在诸夏或在四裔盖避乱逃咎不惮逺涉殊方固有挟其书器而长征者矣【如鲁论载少师阳撃磬襄入于海鼔方叔入于河播鼗武入于汉故外域亦有律吕音乐之厯官遐遁而厯术逺亦如此尔又如言夏衰不窋失官而自窜于戎翟之间厥后公刘迁邠太王迁岐文王迁丰渐徙内地而孟子犹称文王为西夷之人夫不窋为后稷乃农官也夏之衰而遂失官窜于戎翟然则羲和之苖裔屡经夏商之丧乱而流离播迁当亦有之太史公独举幽厉盖言其甚者耳】然逺国之能言厯术者多在西域则亦有故尧典言乃命羲和钦若昊天厯象日月星辰敬授人时此天子日官在都城者盖其伯也又命其仲叔分宅四方以测二分二至之日景即测里差之法也羲仲宅嵎夷曰旸谷即今登莱海隅之地羲叔宅南交则交趾国也此东南二处皆濵大海故以为限又和叔宅朔方曰幽都今口外朔方地也地极冷冬至于此测日短之景不可更北故即以为限独和仲宅西曰昩谷但言西而不限以地者其地既无大海之阻又自东而西气略同内地无极北严凝之畏当是时唐虞之声教四讫和仲既奉帝命测验可以西则更西逺人慕德景从或有得其一言之指授一事之留传亦即有以开其知觉之路而彼中頴出之人从而拟议之以成其变化固宜有之考史志唐开元中有九执厯元世祖时有札玛鲁丹测器有西域万年厯明洪武初有玛沙伊克玛哈齐译回回厯皆西国人也而东南北诸国无闻焉可以想见其涯略矣
　　论周髀中即有地圆之理
　　问西厯以地心地面为测算根本则地形浑圆可信而周髀不言地圆恐古人犹未知也曰周髀算经虽未明言地圆而其理其算已具其中矣试略举之周髀言北极之下以春分至秋分为昼秋分至春分为夜盖惟地体浑圆故近赤道则昼夜之长短渐平近北极则昼夜长短之差渐大推而至北极之下遂能以半年为昼半年为夜矣若地为平面则南北昼夜皆同安得有长短之差随北极髙下而异乎一也周髀又言日行极北北方日中南方夜半日行极东东方日中西方夜半日行极南南方日中北方夜半日行极西西方日中东方夜半盖惟地体浑圆与天体相似太阳随天左旋绕地环行各以其所到之方正照而为日中正午其对冲之方在地影最深之处而即为夜半子时矣假令地为平面东西一望皆平则日一出地而万国皆晓日一入地而八表同昏安得有时刻先后之差而且有此方日中彼为夜半者乎二也周髀又言北极之下不生万物北极左右夏有不释之氷物有朝耕暮获中衡左右冬有不死之草五谷一嵗再熟盖惟地与天同为浑圆故易地殊观而寒暑迥别北极下地即以北极为天顶而太阳周转近于地平阳光希微不能解冻万物不生矣其左右犹能生物而以春分至秋分为昼故朝耕而暮获也若中衡左右在赤道下以赤道为天顶春分时日在赤道其出正夘入正酉并同赤道正午时日在天顶其热如火即其方之夏春分以后日轨渐离赤道而北至夏至而极其出入并在正夘酉之北二十三度半有竒正午时亦离天顶北二十三度半竒其热稍减而凉气以生为此方之秋冬矣自此以后又渐向赤道行至秋分日复在赤道出入正夘酉而正过天顶一如春分热之甚亦如之则又为其方之夏矣秋分后渐离赤道而南直至冬至又离赤道南二十三度半竒而出入在正夘酉南正午亦离天顶南并二十三度半竒气复得稍凉又为秋冬是故冬有不死之草而五谷一嵗再热也又其方日轨每日左旋之圏度并与赤道平行而终嵗昼夜皆平上条言地近赤道而昼夜之差渐平以此故也赤道既在天顶则北极南极俱在地平可见然但言北极不言南极者中土九州在赤道北圣人治厯祗据所见之北极出地而精其测算即南极可以类推然又言北极下地髙旁陀四隤而下即地圆之大致可见非不知地之圆也即如日月交常在朔望则日食时日月同度为月所掩赤易知之事而春秋小雅但云日有食之古圣人祗举其可见者为言皆如是也
　　论浑盖通宪即古盖天遗法
　　问盖天必自有仪器今西洋厯仍用浑仪浑象何以断其为盖天曰盖天以平写浑其器虽平其度则浑非不用浑天仪之测验也是故用浑仪以测天星畴人子弟多能之而用平仪以稽浑度非精于其理者不能也今为西学者多能制小浑仪小浑象至所浑盖通宪者则能制者尠以此故也夫浑盖平仪置北极于中心其度最宻次昼长规又次赤道规以渐而踈此其事易知又次为昼短规在赤道规外其距赤道度与昼长规等理宜収小而今为平仪所限不得不反展而大其经纬视赤道更濶以踈然以稽天度则七政之躔离可知以攷时刻则方位之加临不爽若是者何哉其立法之意置身南极以望北极故近人目者其度加寛逺人目者其度加窄视法之理宜然而分秒忽微一一与勾股割圜之切线相应非深思造微者必不能知也至于长规以外度必更寛更濶而平仪中不能容不得不割而弃之浅见者或遂疑葢天之形其周不合矣是故浑盖通宪即古盖天之遗制无疑也
　　论浑盖通宪即盖天遗法二
　　问利氏始传浑盖仪而前此如回回厯并未言及何以明其为古盖天之器曰浑盖虽利氏所然非利氏所创吾尝徴之于史矣元史载札玛鲁丹西域仪象有所谓乌蘓都尔喇卜垣者其制以铜如圆镜而可挂面刻十二辰位昼夜时刻此即浑盖之型模也又云上加铜条缀其中可以圆转铜条两端各屈其首为二窍以对望昼则视日影夜则窥星辰以定时刻以占休咎此即浑盖上所用之闚筩指尺也又言皆嵌镜片二面刻其图凡七以辨东西南北日影长短之不同星辰向背之有异故各异其图以尽天地之变此即浑盖上所嵌圆片依北极出地之图而各一其图凖天顶地平以知各方辰刻之不同与夫日出入地昼夜之长短及七政躔离所到之方位及其髙度也其圆片有七而两面刻之则十四矣西洋虽不言占法然有其立象之学随地随时分十二宫与推命星家立命宫之法略同故又曰以占休咎也虽作史者未能深悉厥故而语焉不详今以浑盖徴之而一一脗合故曰浑盖虽利氏所传而非其所创也且利氏此器初不别立佳称而名之曰浑盖通宪固已明示其指矣然则何以不直言盖天曰盖天之学人屏絶之久矣骤举之必骇而不信且夫殊盖于浑乃治浑天者之沿谬而精于盖天者原视为一事未尝区而别之也夫浑天仪必设于观台必如法安置而始可用浑盖则悬而可挂轻便利于行逺为行测之所需所以逺国得存其制而流至今也
　　论浑盖之器与周髀同异
　　问浑盖通宪岂即周髀所用欤曰周髀书残缺不完不可得攷据所言天象盖笠地法覆槃又云笠以写天而其制弗详今以理揆之既地如覆槃即有圆突隆起之形则天如盖笠必为圆坳曲抱之象其制或当为半浑圆而空其中略如仰仪之制则于髙明下覆之形体相似矣乃于其中按经纬度数以写周天星宿皆宛转而曲肖矣是则必以北极为中心赤道为边际其赤道以外渐敛渐窄必别有法以相佐或亦是半浑圆内空之形而仍以赤道为边其赤道以南星宿并取其距赤道逺近求其经纬度数而图之至于南距赤道甚逺不可见星之处亦遂可空之不用于是两器相合即周天可见之星象俱全备而无遗矣以故不知者因其极南无星遂妄谓其周不合而无南极也
　　又或写天之笠竟展而平而以北极为心赤道为边用割圆切线之法以攷其经纬度数则周天之星象可一一写其形容其赤道南之星亦展而平而以赤道为边查星距赤道起数亦用切线度定其经纬则近赤道者距踈离赤道向南者渐宻而一一惟肖其不见之星亦遂可空之是虽不言南极而南极已在其中今西洋所作星图自赤道中分为两即此制也所异者西洋人浮海来賔行赤道以南之海道得见南极左右之星而补成南极星图与古人但图可见之星者不同然其理则一是故西洋分画星图亦即古盖天之遗法也
　　周髀云笠以写天当不出坳平二制至若浑盖之器乃能于赤道外展濶平边以得其经纬遂能依各方之北极出地度而求其天顶所在及地平边际即昼夜长短之极差可见于是地平之经纬与天度之经纬相与错综参伍而如指诸掌非容成首诸圣人不能作也而于周髀之所言一一相应然则即断其为周髀盖天之器亦无不可矣夫法传而久岂无微有损益要皆踵事而增其根本固不殊也利氏名之曰浑盖通宪盖其人强记博闻故有以得其源流而不敢没其实亦足以徴其人之贤矣
　　论简平仪亦盖天法而八线割圆亦古所有
　　问西法有简平仪亦以平测浑之器岂亦与周髀相应欤曰凡测天之器圆者必为浑平者即为盖【唐一行以平图写星象亦谓之盖天所异者只用平度不曽以切线分浑球上之经纬踈宻耳】简平仪以平圆测浑圆是亦盖天中之一器也今攷其法亦可以知一嵗中日道发南敛北之行可以知寒暑进退之节可以知昼夜永短之故可以用太阳髙度测各地北极之出地即可用北极出地求各地逐日太阳之髙度推极其变而置赤道为天顶即知其地方之一年两度寒暑而三百六旬中昼夜皆平若北极为天顶即知其地之能以半年为昼半年为夜而物有朝生暮获凡周髀中所言皆可知之故曰亦盖天中一器也但周髀云笠以写天似与浑盖较为亲切耳夫盖天以平写浑必将以浑圆之度按而平之浑盖之器如剖浑球而空其中乃仰置几案以通明如玻瓈之片平掩其口则圆球内面之经纬度分映浮平面一一可数而变为平矣然其度必中宻而外踈故用切线【此如人在天中则浑天之内面乃正视也故寘北极于中心】简平之器则如浑球嵌于立屏之内仅可见其半球而以玻瓈片悬于屏风前正切其球四面距屏风皆如球半径而无欹侧则球面之经纬度分皆可写记而抑突为平矣然其度必中濶而旁促故用正【此如置身天外以测浑天之外面故以极至交圏为边两极皆安于外周以考其出入地之度乃旁视也】由是言之浑盖与简平异制而并得为盖天遗制审矣而一则用切线一则用正非是则不能成器矣因是而知三角八线之法并皆古人所有而西人能用之非其所创也伏读
　　御制三角形论谓众角辏心以算弧度必古厯所有而流传西土此反失传彼则守之不失且踵事加详至哉
　　圣人之言可以为治厯之金科玉律矣
　　论周髀所之说必在唐虞以前
　　问周髀言周公受学于商髙商髙之学何所受之曰必在唐虞以前何以知之盖周髀所言东方日中西方夜半云云者皆相距六时其相去之地皆一百八十度【地与天应其周度皆三百六十则其相对必一百八十】此东西差之极大者也细攷之则日在极东而东方为日中午时则其地在极南者必见日初出地而为卯时在极北者必见日初入地而
　　为酉时故又云此四方者昼夜易处加四时相及【自南方卯至东方午为四时自东方日中午至北方酉亦四时故每加四时则相及矣若以度计之实相距九十】又细分之则东西相距三十度必早晚差一时【如日在极南为午时其西距三十度之地必见其为已时而其东距三十度之地必见为未时其余地准此推之并同】相距十五度必相差四刻尧分命羲仲寅賔出日和仲寅饯内日者测此东西里差也【寅賔寅饯互文见意非羲仲但朝测和仲但暮测也】又周髀所言北极下半年为昼中衡下五谷一嵗再熟云云者其距纬皆相去九十度乃南北差之极大者也细考之北极髙一度则地面差数百十里【屡代所测微有不同今定为二百五十里】而寒暑宻移昼夜之长短各异和叔羲叔分处南北以测此南北里差也故曰此法之传必在唐虞以前也夫东西差测之稍难若南北之永短因太阳之髙下而变日轨髙下又依北极之髙下而殊经商逺游之辈稍知厯象即能觉之羲和二叔奉帝尧之命考测日景一往极北一往极南相距七八千里之逺其逐地之极星髙下昼夜永短身所经厯乃瞢然不知何以为羲和也哉是知地面之非平而永短以南北而差早晚以东西而异必皆羲和所悉知而敬授人时祗据内地幅员立为常法其推测歩算必有专书而亡于秦焰周髀其千百中之十一耳又何疑焉
　　论地实圆体而有背面
　　问地体浑圆既无可疑然岂无背面曰中土圣人所产即其面也何以言之五伦之教天所叙也自黄帝尧舜以来世有升降而司徒之五教人人与知若西方之佛教及天教虽其所言心性之理极其精微救度之愿极其广大而于君臣父子之大伦反轻此一徴也语言惟中土为顺若佛经语皆倒如云到彼岸则必云彼岸到之类欧逻巴虽与五印度等国不同语言而其字之倒用亦同日本国卖酒招牌必云酒卖彼人亦读中土书则皆于句中用笔挑剔作记而倒读之北边塞外及南徼诸国大略皆倒用其字此又一徴也往闻西士之言谓行数万里来賔所厯之国多矣其土地幅员亦有大于中土者若其衣冠文物则未有过焉此又一徴也是知地体浑圆而中土为其面故笃生神圣帝王以继天建极垂世立教亦如人身之有面为一身之精神所聚五藏之精并开窍于五官此亦自然之理也
　　论盖天之学流西土不止欧逻巴
　　问佛经亦有四大州之说与周髀同乎曰佛书言须弥山为天地之中日月星辰绕之环转西牛贺州南瞻部州东胜神州北具卢州居其四面此则亦以日所到之方为正中而日环行不入地下与周髀所言略同然佛经所言则其下为华藏海而世界生其中须弥之顶为诸天而通明故夜能见星此则不知有南北二极而谓地起海中上连天顶始如圆墖圆柱之形其说难通而彼且谓天外有天令人莫可穷诘故婆罗门等【婆罗门即回回】皆为所笼络事之唯谨【唐书载回纥诸国多事佛回纥即回回也】然回回国人能从事厯法渐以知其说之不足慿故遂自立门庭别立清真之教西洋人初亦同回回事佛【唐有波斯国人在此立大秦寺今所景教碑者其人皆自署曰僧】回回既与佛教分而西洋人精于算复从回厯加精故又别立耶苏之教以别于回回【观今天教中七日一斋等事并略同回教其厯法中小轮心等算法亦出于回厯】要皆盖天周髀之学流传西土而得之有全有缺治之者有精有粗然其根则一也
　　论逺国所用正朔不同之故
　　问回厯及西洋厯既皆本于盖天何以二教所颁斋日其每年正朔如是不同曰天方国以十二个月为年【即回回国】欧逻巴以太阳过宫为年月依嵗差而变此皆自信其厯法之善有以接古盖天之道又见秦人蔑弃古三正而以己意立十月为嵗首【今西南诸国犹有用秦朔者】故遂亦别立法程以新人耳目夸示四隣【今海外诸国多有以十二个月为年遵回厯也】盖回国以厯法测验疑佛说之非故谓天有主宰无影无形不宜以降生之人为主其说近正【所异于古圣人者其所立拜念之规耳】厥后欧逻巴又于回厯研精故又自立教典奉耶苏为天主以别于回回然所称一体三身降生诸灵怪反又近于佛教而大声辟佛动则云中国人错了夫中土人伦之教本于帝王虽间有事佛者不过千百中之一二又何错之云
　　今但攷其厯法则回回泰西大同小异而皆本于盖天然惟利氏初入欲人之从其说故多方阐明其立法之意而于浑盖通宪直露浑盖之名为今日所徴信盖彼中之英贤也厥后厯书全部又得徐文定及此地诸文人为之广其畨译为厯家所取资实有功于厯学其他可以勿论若回回厯虽亦有所持之圆地球及平面似浑盖之器而若露若藏不宣其义洪武时吴伯宗李翀奉诏翻译亦但纪其数不详厥防至数之后虽其本科亦莫稽测算之根所云乌蘓都尔喇卜垣之器竟无言及之者盖失已久殊可惜耳
　　尤可深惜者回回泰西之厯既皆本于盖天而其所用正朔乃各自翻新出竒欲以自异其实皆非夫古者帝王钦若昊天顺春夏秋冬之序以敬授人时出于自然何其正大何其易简万世所不能易也顾乃恃其巧算私立正朔以变乱之亦见其惑矣徐文定公之译厯书也云镕西洋之巧算入大统之型模非独以尊大统也揆之事理固有不得不然者尔
　　测算以求天验不难兼西术之长以资推歩颁朔以授人时自当遵古圣之规以经久逺虚心以折其衷博考以求其当有志厯学者尚其念诸【余详后论】








　　厯算全书卷四
　　钦定四库全书
　　厯算全书巻五
　　宣城梅文鼎撰
　　厯学疑问补下
　　论太阳过宫
　　问旧厯太阳过宫与中气不同今何以复合为一曰新厯之测算精矣然其中不无可商当俟后来详定者则此其一端也何则天上有十二宫宫各三十度每嵗太阳以一中气一节气共行三十度【如冬至小寒共行三十度大寒立春又共行三十度其余并同】满二十四气则十二宫行一周故厯家恒言太阳一嵗周天也然而实考其度则一嵗日躔所行必稍有不足虽其所欠甚微【约其差不过百分度之一有半】积至年深遂差多度【六七十年差一度六七百年即差十度】是为嵗差厯家所以有天周嵗周之名【天上星辰匀分十二宫共三百六十度是为天周每嵗太阳十二中气共行三百六十度防弱是为嵗周】汉人未知嵗差误合为一故即以冬至日交星纪而定之于牵牛逮晋虞喜等始觉之五代宋何承天祖冲之隋刘焯等言之益详顾治厯者株守成説不敢辄用嵗差也至唐初傅仁均造戊寅元厯始用嵗差而朝论多不以为然【亦如今人之不信西法人情狃于习见大扺皆然】故李淳风麟德厯复去嵗差不用直至宗开元某年僧一行作大衍厯乃始博徴广证以大畅厥防于是分天自为天【即周天十二次宫度其度终古不变】嵗自为嵗【即周嵗十二中气日躔所行天度其度嵗嵗微移】厯代遵用【所定嵗差年数微有不同而大致无异】元世祖时用授时厯郭守敬测定六十六年有八月而差一度回回泰西差法略同【今定为七十年差一度数亦非逺】故冬至日一嵗日躔之度已周尚不能复于星纪之元度必再行若干日时而至星纪【十二中气皆同一理】所以太阳过宫与中气必不同日其法原无错误其理亦甚易知徐李诸公深于厯术岂反不明斯事乃复合为一真不可解推原厥故盖译厯书时误仍回回厯太阳年之十二月名耳
　　问回回厯亦知嵗差何以误用宫名为月名曰回回厯既以十二个月为太隂年而用之纪嵗不用闰月然如是则四时之寒燠温凉错乱无纪因别立太阳年以周嵗日躔匀分三百六十度又匀分为十二月以为耕敛之节而起算春分是亦事势之不得不然【尧典寅賔出日始于仲春即此一事亦足徴西厯之本于羲和】但彼以春分为太阳年之第一月第一日遂不得复用古人分至启闭之法及春夏秋冬正名【古者以立春立夏立秋立冬春分秋分冬至夏至为八节其四立并在四孟月之首以为四时之节谓之启闭二分二至并在四仲月之中居春夏秋冬各九十一日之半皆自然之序不可移易今回厯之太阳年既以春分为嵗首则是以仲春之后半月为正旦而割其前半个月以益孟春共四十五日竒遂一并移之于嵗终而孟春之前半改为十一月之后半孟春之后半合仲春之前半共三十日改为十二月即春夏秋冬之四时及分至启闭之八节孟仲季之月名无一与之相应名不正则言不顺遂不复可得而用矣】故遂借白羊等十二宫以名其太阳年之月彼非不知天度有嵗差白羊不能板定于春分然以其时春分正在白羊姑借此名之以纪月数【即此而知回厯初起时其年代去今非逺】欧逻巴厯法因回厯而加精大致并同回厯故遂亦因之耳徐文定公译厯书谓镕西洋之精算入大统之型模则此处宜为改定使天自为天嵗自为嵗则嵗差之理明而天上星辰宫度各正其位矣【如昼夜平即为二分昼极长即为夏至不必问其日躔是何宫度是之谓嵗自为嵗也必太阳行至降娄始命为日躔降娄之次大阳行至鹑首始命为日躔鹑首之次不必问其为春分后几日夏至后几日是之谓天自为天也】顾乃因仍回厯之宫名而以中气日即为交宫之日则嵗周与天周复混而为一于是嵗差之理不明【如星纪之次常有定度而冬至之日度渐移是生嵗差若冬至日即躔星纪嵗嵗相同安得复有嵗差】而天上十二次宫度名实俱乱【天上十二宫各有定星定度若随节气移动则名实俱左后篇详之】是故厯法至今日推步之法已极详明而不无有待商酌以求尽善者此其一端也问者曰厯所难者推步耳若此等处改之易易【但于各中气后查太阳实躔某宫之度即过宫真日】但厯书中所作诸表多用白羊金牛等宫名以为别识今欲通身改换岂不甚难曰否否厯书诸表虽以白羊金牛等为题而其中之进退消长并从节气起算今但将宫名改为节气即诸表可用不必改造有何难哉【如厯从白羊起者即改白羊初度为春分初度表从磨羯起者即改磨羯初度为冬至初度厯书诸表依旧可用但正其名不改其数更无烦于推算】
　　论周天十二宫并以星象得名不可移动
　　问天上十二宫亦人所名今随中气而移亦何不可之有曰十二宫名虽人所为然其来久矣今攷宫名皆依天上星宿而定非漫说者如南方七宿为朱鸟之象【史记天官书栁为鸟注注即咮咮者朱鸟之喙也七星颈为员官颈朱鸟颈也员官咙防也张为素素即嗉鸟受食之处也翼为羽翮朱鸟之翼】故名其宫曰鹑首鹑火鹑尾【鹑即朱鸟乃凤也】东方七宿为苍龙【天官书东宫苍龙房心心为明堂今按角二星象角故一名龙角氐房心象龙身心即其当心之处故心为明堂尾宿即龙之尾】故其宫曰夀星【封禅书武帝诏天下尊祀灵星正义灵星即龙星也张晏曰龙星左角曰天田则农祥也见而祀之】曰大火【心为大火】曰析木【一名析木之津以尾箕近天河也】北方七宿为武【天官书北宫武】其宫曰星纪【古以斗牛为列宿之首故星自此纪也】曰枵【枵者虚也即虚危也又象龟蛇为武也】曰娵訾【一名娵訾之口以室壁二宿各二星两两相对而形正方故象口也】西方七宿为白虎【天官书奎曰封豕参为白虎三星直者是为衡其外四星左右肩股也小三星隅置曰觜觽为虎首】其宫曰降娄【以娄宿得名也】曰大梁曰实沈由是以观十二宫名皆依星象而取非漫设也尧典日中星鸟以其时春分昏刻朱鸟七宿正在南方午地也日永星火以其时夏至初昏大火宫在正午也【火即心宿】宵中星虚以其时秋分昏中者枵宫也即虚危也日短星昴以其时冬至昏中者昴宿也即大梁宫也厯家以嵗差攷之尧甲辰至今已四千余嵗嵗差之度已及二宫【以西率七十年差一度约之凡差六十余度】然而天上二十八舎之星宿未尝变动故其十二宫亦终古不变也若夫二十四节气太阳躔度尽依嵗差之度而移则嵗嵗不同七十年即差一度【亦据今西术推之】安得以十二中气即过宫乎试以近事徴之元世祖至元十七年辛巳冬至度在箕十度至今康熙五十八年己亥冬至在箕三度其差盖已将七度而即以箕三度交星纪宫则是至元辛巳之冬至宿【箕十度】已改为星纪宫之七度再一二百年则今己亥之冬至宿【箕三度】为星纪宫之初度者又即为星纪宫之第三度而尾宿且浸入星纪矣积而久之必将析木之宫【尾箕】尽变为星纪大火之宫【氏房心】尽变为析木而十二宫之星宿皆差一宫【凖上论之角亢必为大火翼轸必为夀星柳星张必为鹑尾井鬼必为鹑火而觜参为鹑首胃昴毕为实沈奎娄为大梁而娵訾为降娄虚危为娵訾斗牛为枵二十八宿皆差一宫】即十二宫之名与其宿一一相左又安用此名乎再积而久之至数千年后东宫苍龙七宿悉变武【嵗差至九十度时角亢氐尾心房箕必尽变为星纪枵娵訾并仿此】南宫朱鸟七宿反为苍龙西宫白虎七宿反为朱鸟北宫武七宿反为白虎国家颁厯授时以钦若昊天而使天上宿度宫名颠倒错乱如此其可以不亟为厘定乎
　　又试以西术之十二宫言之夫西洋分黄道上星为十二象虽与羲和之旧不同然亦皆依星象而名非漫设者如彼以积尸气为巨蠏第一星盖因鬼宿四星而中央白气有似蠏筐也所云天蝎者则以尾宿九星卷而曲其末二星相并如蝎尾之有岐也所云人马者谓其所图星象类人骑马上之形也其余如宝瓶如双鱼如白羊如金牛如隂阳如狮子如双女如天秤以彼之星图观之皆依稀彷佛有相似之象故因象立名今若因节气而每嵗移其宫度积而久之宫名与星象相离俱非其旧而名实尽淆矣
　　又按西法言嵗差谓是黄道东行未尝不是如今日鬼宿已全入大暑日躔之东在中法嵗差则是大暑日躔退回鬼宿之西也在西法则是鬼宿随黄道东行而行过大暑日躔之东其理原非有二尾宿之行入小雪日躔东亦然夫既鬼宿已行过大暑东而犹以大暑日交鹑火之次则不得复为巨蠏之星而变为师子矣尾宿已行过小雪后而犹以小雪日交析木之次则尾宿不得为天蝎而变为人马宫星矣即询之西来知厯之人有不哑然失笑者乎
　　论西法恒星嵗即西月日亦即其斋日并以太阳过宫为用而不与中气同日
　　问西法以太阳防恒星为嵗谓之恒星年恒星既随黄道东行则其恒星年所分宫度亦必不能常与中气同日厯书何以不用曰恒星年即其所颁斋日也其法以日躔斗四度为正月朔故曰以太阳防恒星为嵗也其斗四度盖即其所定磨羯宫之初度也【在今时冬至后十二日】自此日躔行满三十度即为第二月交宝瓶宫【余月并同皆以日躔行满三十度交一宫即又为一月而不论节气】然其十二月之日数各各不同者以黄道上有最髙卑差而日躔之行度有加减也【如磨羯宫日躔最卑行速故二十八日而行一宫即成一月若巨蠏宫日躔最髙行迟故三十一日而行一宫始成一月其余宫度各以其或近最卑或近最髙迟速之行不同故日数皆不拘三十日并以日躔交宫为月不论节气】是则其所用各月之第一日即太阳交宫之日原不与中气同日而且嵗嵗微差至六七十年恒星东行一度即其各宫并东行一度而各月之初日在各中气后若干日者又増一日矣【如今以冬至后十二日为嵗首至嵗差一度时必在冬至后十三日余尽然】此即授时厯中气后几日交宫之法乃嵗差之理本自分晓而厯书中不甚发挥斯事者亦有故焉一则以月之为言本从太隂得名故必晦朔望周而后谓之月今反以太阳所躔之宫度为月而置朔望不用是名为月而实非月大骇听闻一也又其第一月既非夏正孟春亦非周正仲冬又不用冬至日起算非厯学履端于始之义事体难行二也又其所用斋日即彼国所颁行之正朔欧逻巴人私奉本国之正朔宜也中土之从其教者亦皆私奉欧逻之正朔谓国典何故遂隠而不宣三也【初造厯书事事阐发以冀人之信从惟此斋日但每嵗单伊教不笔于书】然厯书所引彼中之旧测每称西月日者皆恒星年也其法并同斋日皆依恒星东行以日躔交磨羯宫为嵗旦而非与冬至中气同日也此尤为太阳过宫非中气之一大证据矣
　　或曰厯书所引旧测多在千余年以前然则西月日之兴所从来久矣曰殆非也唐始有九执厯元始有回回厯欧逻巴又从回厯加精必在回厯之后彼见回回厯之太隂年太阳年能变古法以矜竒创故复变此西月日立恒星年以胜之若其所引旧测盖皆以新法追改其月日耳
　　论恒气定气
　　问旧法节气之日数皆平分今则有长短何也曰节气日数平分者古法谓之恒气【以嵗周三百六十五日二十四刻竒平分为二十四气各得一十五日二十一刻八十四分竒】其日数有多寡者谓之定气【冬至前后有十四日竒为一气夏至前后有十六日为一气其余节气各各不同并以日行盈厯而其日数减行缩厯而其数増】二者之算古厯皆有之然各有所用唐一行大衍厯议曰以恒气注厯以定气算日月交食是则旧法原知有定气但不以之注厯耳译西法者未加详考辄谓旧法春秋二分并差两日则厚诬古人矣夫授时厯所注二分日各距二至九十一日竒乃恒气也【厯经厯草皆明言恒气】其所注昼夜各五十刻者必在春分前两日竒及秋分后两日竒则定气也定气二分与恒气二分原相差两日授时既遵大衍厯议以恒气二分注厯不得复用定气故但于昼夜平分之日纪其刻数则定气可以互见非不知也且授时果不知有定气平分之日又何以能知其日之为昼夜平分乎夫不知定气是不知太阳之有盈缩也又何以能算交食何以能算定朔乎【经朔犹恒气定朔犹定气望与上下亦然】夫西法以最髙卑防盈缩其理原精初不必为此过当之言良由译书者并从西法入手遂无暇参稽古厯之原流而其时亦未有能真知授时立法之意者为之援据古义以相与虚公论定故遂有此等偏说以来后人之疑议不可不知也
　　其所以为此说者无非欲以定气注厯使春秋二分各居昼夜平分之日以见授时古法之差两日以自显其长殊不知授时是用恒气原未尝不知定气不得为差而西法之长于授时者亦不在此以定气注厯不足为竒而徒失古人置闰之法欲以自暴其长反见短矣故此处宜酌改也后条详之
　　再论恒气定气
　　问授时既知有定气何为不以注厯曰古者注厯只用恒气为置闰地也春秋传曰先王之正时也履端于始举正于中归邪于终【邪与余同谓余分也】履端于始序则不愆举正于中民则不惑归邪于终事则不悖盖谓推步者必以十一月朔日冬至为起算之端故曰履端于始而序不愆也又十二月之中气必在其月如月内有冬至斯为仲冬十一月月内有雨水斯为孟春正月月内有春分斯为仲春二月余月并同皆以本月之中气正在本月三十日之中而后可名之为此月故曰举正于中民则不惑也若一月之内只有一节气而无中气则不能名之为何月斯则余分之所积而为闰月矣闰即余也前此余分累积归于此月而成闰月有此闰月以为余分之所归则不致春之月入于夏且不致今冬之月入于明春故曰归邪于终事则不悖也然惟以恒气注厯则置闰之理易明何则恒气之日数皆平分故其每月之内各有一节气一中气【假如冬至在十一月朔则必有小寒在其月望后若冬至在十一月晦则必冇大雪节气在其月望前余月并然】此两气策之日合之共三十日四十三刻竒以较每月常数三十日多四十三刻竒谓之气盈又太隂自合朔至第二合朔实止二十九日五十三刻竒以较每月三十日又少四十六刻竒谓之朔虚合气盈朔虚计之共余九十刻竒谓之月闰乃每月朔策与两气策相较之差也【假如十一月经朔与冬至同时刻则大寒中气必在十二月经朔后九十刻而雨水中气必在次年正月经朔后一日又八十刻竒其余月并准此求之】积此月闰至三十三个月间【即二年零九个月】其余分必满月策而生闰月矣闰月之法其前月中气必在其晦后月中气必在其朔则闰月只有一节气而无中气然后名之为闰月【假如闰十一月则冬至必在十一月之晦大寒必在十二月之朔而闰月只有小寒节气更无中气则不可谓之为十一月亦不可谓之为十二月即不得不名之为闰月矣】斯乃自然而然天造地设无可疑惑者也一年十二个月俱有两节气惟此一个月只一节气望而知其为闰月今以定气注厯则节气之日数多寡不齐故遂有一月内三节气之时又或有原非闰月而一月内反只有一中气之时其所置闰月虽亦以余分所积而置闰之理不明民乃惑矣然非西法之咎乃译书者之踈略耳何则西法原只有闰日而无闰月其仍用闰月者遵旧法也亦徐文定公所谓镕西洋之巧算入大统之型模也按尧典云以闰月定四时成嵗乃帝尧所以命羲和万世不刋之典也今既遵尧典而用闰月即当遵用其置闰之法而乃不用恒气用定气以滋人惑亦昧于先王正时之理矣是故测算虽精而有当酌改者此亦一端也
　　今但依古法以恒气注厯亦仍用西法最髙卑之差以分昼夜长短进退之序而分注于定气日之下即置闰之理昭然众着而定气之用亦并存而不废矣
　　又按恒气在西法为太阳本天之平行定气在西法为黄道上视行平行度与视行度之积差有二度半弱西法与古法略同所异者最髙冲有行分耳古法恒气注厯即是用太阳本天平行度数分节气
　　论七政之行并有周有转有交
　　问月五星之行并有周天有盈缩迟疾有出入黄道之交防共三事也太阳亦然乎曰并同也太阳终古行黄道则无出入黄道之交然而黄道出入于赤道亦可名交是故春秋二分即其交亦如月离之有正交中交也因此而日躔有南陆北陆之行古者谓之发敛【行南陆为发行北陆为敛并以其离北极之逺近言之】于是而四时之寒燠以分昼夜刻之永短有序皆交道之所生以成嵗周是故嵗周者即太阳之交道也与月离之交终同也然以嵗差之故【西法谓之黄道东行】故每嵗三百六十五日二十四刻竒【此以授时古率言之】已满嵗周矣又必加一刻有半【亦依古率约之】始能复躔冬至元度【假如本年冬至日躔箕宿三度八十分次年冬至必在箕宿三度七十分竒是嵗序已周而元度未复故必于三百六十五日二十四刻竒之外复加一刻有半始能复躔于箕三度八十分】是为太阳之周天与月行之周天同也月行周天与交终原非一事是故太阳之周天与嵗周原为两事也然太阳之行有半年盈厯半年缩厯即恒气定气之所由分【古法起二至西法起最髙冲尤为亲切】亦如月离之转终是又为一事合之前两者【嵗周与周天】共为三事乃七政之所同也
　　按月离交终以二十七日二十一刻竒而隂厯阳厯之度一周在月周天前以较周天度为有欠度也转终以二十七日五十五刻竒而迟厯疾厯之度一周在月周天后以较周天度为有余度也月周天之日数在二者之间亦二十七日又若干刻而周虽同大余不同小余当其起算之初所差不过数度【如交终与转终相差三十四刻竒即其差度为四五度】积至一年即差多度【太隂每年行天十三周半即相差六十余度】故其差易见日躔嵗周以二十四节气一周为限因有恒星东行之嵗差故其度在周天前以较周天度为有欠分也【约为七十分度之一】日躔盈缩以盈初缩末缩初盈末一周为限因最髙有行分故其度在周天后以较周天度为有余分也【亦约为七十分度之一】以一嵗言之三者并同大余即小余亦不甚逺【嵗周三百六十五日二十四刻竒増一刻半即周天又増一刻半即盈缩厯周但差刻不差时】积其差至七十年即各差一度【嵗周不及周天七十年差一度即恒星东行之嵗差而盈缩厯至七十年又过于周天一度即最髙之行于是嵗周与盈缩厯周共相差二度并至七十年而后知之也】故其差难见【七十年只差一度故难见也】然虽难见其理则同【以周天之度为主则嵗周之差度退行亦如太隂交终差度之毎交逆退也而盈缩入厯之差度于周天为顺行亦如太隂之转终差度毎转顺行也而周天度则常不动】但以太隂之交转周比例之则判然三事不相凌杂矣
　　问厯法中所设交差转差即此事乎曰亦微有不同盖交差转差是以交终转终与朔策相较【或言其日或言其度并同】兹所论者是以交终转终与周天相较故其数不同也其数不同而厯法中未言者何也縁厯家所言在交食故于定朔言之綦详而月之周天反略惟陈星川【壤】袁了凡【黄】所撰厯法新书明立太隂周天日数谓之月周与交终转终并列为三实有禆于厯学而人或未知故特着之
　　又徴之五星亦皆有周天有厯周【即盈缩如月之入转】有正交中交是故此三事者日月五星之所同也知斯三者于厯学思过半矣【外此则月有朔望五星有叚目并以距日之逺近而生故大阳所与月五星同者惟此三事】
　　论月建非专言斗柄
　　问行夏之时谓以斗柄初昏建寅之月为嵗首议者以冬至既有嵗差则斗柄亦从之改度今时正月不当仍为建寅其说然乎曰不然也孟春正月自是建寅非闗斗柄其以初昏斗柄建寅者注释家未深攷也何则自大挠作甲子以十日为天干【自甲至癸】十二子为地支【自子至亥】天道圆故以甲乙居东丙丁居南庚辛居西壬癸居北戊巳居中参同契所谓青赤白黒各居一方皆禀中央戊巳之功也十干以配五行圆转周流故曰天干也地道方故以寅夘辰列东巳午未列南申酉戍列西亥子丑列北易大传所谓帝出乎震齐乎防相见乎离致役乎坤说言乎兊战乎干劳乎坎成言乎艮自东而南而西而北其道左旋周而复始也是十二支以配四时十二月静而有常故曰地支也天干与地支相加成六十甲子以纪嵗纪日纪时而皆凖于月以嵗有十二月也此乃自然而然之序不可増减不可动移是故孟春自是寅月何尝以斗柄指寅而后谓之寅月哉如必以斗柄指寅而谓之寅月则亦有寅年寅月寅时岂亦以斗柄指寅而后得以谓之寅乎是故尧典命羲仲宅嵎夷平秩东作以殷仲春次命羲叔宅南交平秩南讹以正仲夏次命和仲宅西平秩西成以殷仲秋次命和叔宅朔方平在朔易以正仲冬此四时分配四方而以春为嵗首之证也夫既有四仲月以居夘午酉子之四正则自各有孟月季月以居四隅仲春既正东为夘月其孟春必在东之北而为寅月何必待斗柄指寅乎故日中星鸟日永星火宵中星虚日短星昴并祗以昼夜刻之永短为慿以昏中之星为断未尝一言及于斗柄也又攷孔子去尧时已及千五百嵗嵗差之度已二十余度若尧时斗柄指寅孔子时必在寅前二十度而指丑矣岂待今日而后知乎然孔子但言行夏之时盖以孟春为嵗首于时为正非以斗柄指寅而谓之寅月也又攷嵗差之法古虽未言然而月令昏中之星已不同于尧典则实测当时之星度也然尧典祗举昏中星而月令兼言旦中又举其日躔所在又于尧典四仲月之外兼举十二月而备言之可谓详矣然未尝一语言斗杓指寅为孟春
　　又攷史记律书以十律配十二月之所建地支而疏其义兼八风二十八舎以为之说而并不言斗建惟天官书略言之其言曰杓擕龙角衡殷南斗魁枕参首用昏建者杓夜半建者衡平旦建者魁是则衡亦可言建魁亦可言建而非仅斗杓夜半亦有建平旦亦有建而非止初昏其言甚圆以是而知正月之为寅二月之为卯皆一定不可移而斗之星直之即谓建固非以初昏斗柄所指而命之为何月也然则谓行夏之时是以斗柄建寅之月为嵗首者盖注释家所据一家之说而未详厥故也今乃遂据其说而欲改正月之建寅可乎不可乎
　　再论斗建
　　问说者又以各月斗柄皆指其辰惟闰月则斗柄指两辰之间由今以观其说亦非欤曰非也周天之度以十二分之各得三十度竒【在西法为三十度】凡各月中气皆在其三十度之中半各月节气皆居其三十度之首尾今依其说斗柄所指各在其月之辰则交节气日斗柄所指必在两辰之间矣【假如立春为正月节则立春前一日斗柄所指在丑立春后一日斗柄指寅而立春本日斗柄所指必在丑与寅之间余月皆然】十二节气日皆指两辰之间又何以别其为闰月乎若夫闰月则只有节气无中气其节气之日固指两辰之间矣然惟此一日而已其前半月后半月并非两辰之间也【假如闰正月则雨水中气在正月晦春分中气在二月朔而闰月只有惊蛰节在月望则其前半月必指寅后半月必指卯惟惊蛰日指寅与卯之交界缝中可谓之两辰间闰在余月亦然】地盘周围分为十二辰首尾鳞次如环无端又何处设此三十度于两辰间以为闰月三十日之所指乎凡若此等习说并由未经实测而但知斗杓所指为月建遂岐中生岐成此似是而非之解天下事每壊于一知半解之人往往然也
　　又按斗柄之星距北极只二十余度必以北极为天顶而后可以定其所指之方今中土所处在斗杓之南仰而观之斗杓与辰极并在天顶之北其斗杓所指之方位原难清楚故古人祗言中星不言斗杓盖以此也【如淮南子等书言招揺东指而天下皆春不过大槩言之原非以此定月】
　　又按言营室之中土功其始火之初见期于司里又言水昏正而栽日至而毕诗亦言定之方中作于楚宫又言七月流火九月授衣古之人以星象授人时如此者不一而足也若以嵗差攷之则于今日并相差一二旬矣然而当其时各据其时之星象为之着令所以使民易知也而终未有言斗杓指何方而作何事者则以其方位之难定也十二月建之非闗斗柄明矣是故斗柄虽因嵗差而所指不同正月之建寅不可易也
　　论古颁朔
　　问论语子贡欲去告朔之饩羊孔子不然其说曰我爱其礼不知周制颁厯其式如何曰颁朔大典也盖王政在其中矣古者天子常以冬月颁来嵗十二月之朔于诸侯诸侯受而藏诸祖庙月朔则以特羊告庙请而行之如是其隆重者何也盖既曰请而行之则每月内各有当行之政令颁于天子而诸侯奉行惟谨焉故告朔之后即有视朔听朔之礼所以申命百官有司以及黎庶相与恪遵以奉一王之大法此之谓奉正朔也是故大之有朝觐防同之期有隣国聘问之节有天子巡狩朝于方岳之时【此等大礼皆以年计而必冇定期如虞书东巡狩必于仲春南巡狩必于仲夏之类】其于宗庙也有禴祠烝尝四时之祭有畊籍田夫人亲蚕以预备粢盛衣服之需其于羣神也有山川社稷祈谷报嵗八蜡五祀之典其于黉序也有上丁释菜冬夏诗书春秋羽籥之制其于农事也有田畯劝农播种収获沟洫隄防筑场纳稼之务有饮射读法遒人徇铎之事其于军政也有搜苖狝狩振旅治兵之政其于土功也有公旬三日之限其于刑罚也有宥过释滞折狱致刑之月又如藏氷用氷出火内火仲夏斩阳木仲冬斩隂木獭祭鱼然后渔人入泽梁豺祭兽然后田猎之类凡若此者皆顺四时之序以为之典章先王之所以奉若天道也而一代之典制既藏之太府恪守无斁矣又毎嵗颁示诸侯以申命之诸侯又于每月之朔告于祖庙请而奉行之天子本天以出治无一事敢违天时诸侯奉天子以治其国无一事不遵王命以上顺天时唐虞三代所以国无异俗家无异教道德一而风俗同盖以此也故曰颁朔告朔实为大典而王政因之以行也周既东迁矣王政不行鲁不吿朔他国可知盖视为弁髦久矣厥后遂有司厯再失闰之愆而大夫陪臣之僭乱纷纷矣以秉礼之国而弃王朝大典何怪其羣相效尤是故夫子曰我爱其礼盖庶几因此羊而念及先王之典也如谓颁朔祗以识月之大小辨朔望生明死魄之干支何取乎每月告庙之繁文也哉由是以观则三代时所颁之厯可知己矣
　　论厯中宜忌
　　问厯法中宜忌之说古有之乎曰无之也盖起近代耳尧之命羲和也曰敬授人时曰东作西成曰允厘百工庶绩咸熙厯之大用盖如此也何尝有选择之事乎司马迁曰阅隂阳之书使人拘而多畏其说盖起于战国之时夫箕子陈洪范其七曰稽疑古者有大政既断之于主心又谋及卿士谋及庶人矣然必谋及卜筮古圣人不敢自专自用而必协谋于神人盖其慎也战国力争此义不明太卜筮人之官废疑事无所决隂阳家言乃纷然以出矣隋唐之季其说愈多故吕才援引古义著论以非之可谓深切着明矣然而教化不行吉凶福祸之说深中于人心黠者乘之各立异说以恫喝聋俗愈出愈攴六十干支而选择之书乃有九十余家同此一日而此以为大吉彼以为大凶令人无所适从诬民惑世莫此为甚今官厯宜忌本于选择厯书不知其为元时所定明初所定然攷史志厯代言厯者初无一字及于选择又如罗计四余郭守敬厯经所无而大统増入之然则此等不经之说并元统郭伯玉等所为耳原其初意或亦欲假此以定民之趋然官厯虽颁宜忌而民间偏惑通书通书既非一种而术者私书更多虽户说以渺论不能止也今若能一切删去只载宜行政事及南北耕耘収获之节则唐虞三代敬天勤民之至意复覩今日岂不快哉
　　洪武中解大绅庖西封事曰治厯明时授民作事但申播植之宜何用建除之谬方向煞神事甚无谓孤虚宜忌亦且不经东行西行之论天德月德之云臣料唐虞之厯必无此等之文所宜著者日月之行星辰之次仰观俯察事合逆顺七政之齐正此类也按此说甚正惜当时不能用然实为定论圣人所不易也
　　论治厯当先正其大其分秒微差可无深论
　　问厯法至今日可谓详且宻矣然徴诸交食亦或有微差之刻何欤曰此可以不必深论者也攷汉时不知定朔故日食或不在朔或差而前则食于晦差而后则食于初二日直至唐李淳风麟德厯始用定朔于是蚀必在朔无差日矣然尚有差时厥后大衍厯所推益宻宣明厯又立气刻时三差至宋统天厯纪元厯又加详焉迨元授时厯遂无差时但有差刻今西厯言东西南北差以黄道九十度限为宗其理益明其法益善然而亦或有时而差刻分者何也今夫盆盎之中可以照物池沼澄清则岸上之人物花鸟山陵树木毕现其中然而其边际所域必有所改易两镜相照则多镜层现于一时而六层以上必有所穷况乎以八尺之玑衡测大圆之宫度其大小之比例道里之辽濶不可以亿计而因积之多用算之巧遂致交食应期复应东西南北方向胥符而但有晷刻之后先分秒之同异即谓之不差可矣国家治厯所重者顺天出治以敬授人时日食之类所重在于修省至于时刻小差原非所重但当令司厯者细加测详纪其所差之数以待后来修厯者使有所据依以益精其推步而已断不可因小节之微差而辄更成法也汉唐宋厯法屡改而多不效元明三四百年守一授时法而交食不效只数事而已况今新厯又加精于授时何必复加更变乎或谓厯算之差由于尾数予谓此一端耳尾数有丢収无闗大数所难者乃根数耳盈缩迟疾之根虽有离朱无所施其目并由年深日久然后知之又如最髙之行利氏所定与今所用不同皆根之差厯所以取象于革也















　　厯算全书卷五
　　钦定四库全书
　　厯算全书卷六
　　宣城梅文鼎撰
　　厯学答问
　　答祠部李古愚先生
　　厯算之学散见经史固儒者所当知然其事既不易明而又不切于日用故学者置焉博览之士稍渉大端自谓已足欲如绛县老人能自言其生之四百四十四甲子者固已鲜矣况能探讨其义类乎明公夙夜在公日懋勤于职业而心闲若水孜孜好学用其心于人所不用之处真不易得鼎虽疎浅无似敢不勉竭鄙思以仰答下问之勤乎谨条于左
　　问授时大统二厯厯元并嵗实积日日法诸数
　　按厯元云者厯家起算之端也然授时厯元之法与古不同请先言古法古人治厯必先立元元正然后定日法法立然后度周天其法皆据当时实测以验诸前史所传又推而上之至于初古之时取其嵗月日时皆防甲子又在朔旦而日月五星皆同一度以此为起算之端是谓厯元自厯元顺数至今造厯之时凡厯几何嵗月是为积年既有积年即有积日而此积日若用整数则遇﨑零难以入算而不能使厯元无余分故必析此一日为若干分使七曜可以通行而上可以合厯元下不违于实测是为日法即一日之细分也用此细分自一日积之至于二百六十五日又四分日之一弱使一嵗之日尽化为分是为嵗实古厯太阳每日行一度则日法即度法于是仍用此细分自一度积之至于三百六十五度又四分度之一弱使其度亦尽化为分是为周天数者相因乃作厯之根本自汉太初厯以后厯晋唐五代宋辽金诸家厯法代有改宪然其规模次第皆大同而小异耳
　　右古法厯元等项
　　惟元授时厯不然其説以为作厯当凭实测而必逆推上古虚立积年必将迁就其畸零之数以求密合既有迁就久则易差故不用积年之法而断自至元十七年辛巳嵗前天正冬至为元上考往古下验将来皆自此起算弃虚立之元用实测之度顺天求合一无迁就可谓开拓万古之心胸者矣至于大统则以洪武十七年甲子为元然特易其名而已一切歩算皆本授时名虽洪武甲子实用至元辛巳也
　　右授时大统厯元
　　惟授时不用积年故日法亦可不立而径以万分为日万分者日有百刻刻有百分故一万也古诸家厯法虽皆百刻而刻非百分其日法皆有畸零授时以万分为日竟是整数故曰不用日法然即此是其日法矣
　　右授时日法大统同
　　授时既以万分为日故其嵗实三百六十五万二千四百二十五分其数自辛巳嵗前天正冬至【即庚辰年十一月中气】积至次年壬午嵗前天正冬至【即辛巳本年十一月中气】共得三百六十五日二十四刻二十五分也若逆推前一年亦是如此【如是庚辰年十一月冬至逆推至巳卯年十一月冬至亦是三百六十五日二十四刻二十五分】此嵗实之数大统与授时并同
　　然授时原有消长之法是其新意其法自辛巳元顺推至一百年则嵗实当消一分【依法推至洪武十四年辛酉满一百年其嵗实消一分为三百六十五日二十四刻二十四分】若自辛巳元逆推至一百年则嵗实当长一分【依法推至宋孝宗淳熙八年辛丑满一百年嵗实长一分为三百六十五日二十四刻二十六分】每相距増一百年则嵗实消长各増一分以是为上考下求之准
　　大统诸法悉遵授时独不用消长之法上考下求总定为三百六十五日二十四刻二十五分此其异也
　　右授时大统嵗实
　　嵗实即一年之日数也自一年以至十年百年共积若干是为积日亦谓之中积分【上考下求皆距至元辛巳立算】
　　假如今康熈庚午嵗相距四百零九算【自辛巳元顺推至今康熈庚午四百一十年法以积年减一得实距四百零九年】依授时法推得积日一十四万九千三百八十四日零一刻八十九分【因距算四百以上嵗实当消四分为三百六十五日二十四刻二十一分以乘距算四百零九得如上数是为庚午嵗前天正冬至上距辛巳嵗前天正冬至之积日若以日为万分则所得化为一十四亿九千三百八十四万零一百八十九分谓之中积分】大统法不用消长则积日为一十四万九千三百八十四日一十八刻二十五分【中积分一十四亿九千三百八十四万一千八百二十五分】两法相差一十六刻三十六分【以命冬至日辰授时得癸卯日丑初三刻大统得癸卯日卯初三刻　两法皆加气应】
　　右授时大统积日
　　以上数端并在歩气朔章是太阳项下事也其厯元七曜同用乃根数所立之处也
　　问授时大统二厯月法转周交周诸数
　　按月法者即朔防也亦曰朔实其法自太阳太隂同度之刻算至第二次同度为两朔相距之中积分平分之则为望防四分之则为防望者日月相望距半周天者近一逺三上月在日东下月在日西皆相距天周四之一授时朔防二十九万五千三百零五分九十三秒即二十九日五十三刻零六分弱也大统同
　　右月法
　　月平行每日十三度有竒然有时而疾则每日十四度竒有时而迟则每日只十二度竒是为月转初入转则极疾疾极而平平而迟迟极又平平而又疾以此遂有疾初疾末迟初迟未四限满此一周谓之转终授时转终二十七日五十五刻四十六分大统同
　　右转法
　　月不正行黄道而出入其内外故谓之交交者言其道交于黄道也月行天一周其交于黄道只有二处其始从黄道内而出于其外此时月道自北而南在黄道上斜穿而过谓之正交自正交行九十一度【就整数】离黄道南六度自此再行九十一度又自黄道外而入于其内此时月道自南而北亦斜穿黄道而过谓之中交中交行至九十一度时离黄道北亦六度自此再九十一度又自黄道内而出于其外复为正交矣其法以正交后半周为阳厯中交后半周为隂厯满此一周谓之交终授时交终二十七日二十一刻二十二分二十四秒大统同
　　右交道
　　以上三端朔防在歩气朔章转终在歩月离章交终在歩交防章并太隂项下事也
　　问授时厯有气应何义
　　按气应为授时四应数之一其法创立古厯所无也古厯立元皆起初古故但有积年而无根数【即应数】授时既不立积年而用截算不得不有四应数以纪当时实测之数为上考下求之根而气应居一焉气即中气节气二十四中节皆始冬至故气应者即冬至相应之真时刻也当时实测辛巳嵗前天正冬至是己未日丑初一刻故曰气应五十五万零六百分即五十五日零六刻也其法自甲子日为一数起挨算至戊午日得满五十五日又加子正后六刻则为己未日丑初一刻矣气应之外又有闰应以纪经朔转应以纪月之迟疾厯交应以纪月之隂阳厯亦是截算皆实测辛巳年天正冬至气应【己未日丑初一刻】所得上距经朔及距入转距正交各相应之数也　依法推到辛巳年天正经朔三十四日八十五刻半为戊戌日戍正二刻【在气应冬至前二十日二十刻五十分】及己未冬至气应则为经朔之二十一日　凡此皆厯经所未明言兹特着之
　　问推歩交食之法
　　按厯家之法莫难于交食其理甚精其法甚备故另为一章若知交食则诸法尽知矣然必能推歩而加以讲究然后能由其当然以知其所以然是谓真知茍未能然则所知或未全耳请言其槩葢厯法代更由疎渐宻其验在于交食约畧言之有宜知者二端其一古者只用平朔平朔者一大一小相间故汉晋史志往往有日食不在朔而在朔之二日或晦日者自唐李淳风麟徳厯始用定朔至一行大衍厯又发明之始有四大三小之月而蚀必在朔此是一层道理其一自北齐张子信积合蚀加时立入气加减唐宣明厯本之立气刻时三差至今遵用即授时厯之时差及东西南北差也此又是一层道理前一説由平朔改为定朔其根在天葢以日躔有盈缩月离有迟疾天上行度应有之差天下所同也后一説于定朔之外又立三差其根在地葢以日髙月卑正相掩时中间尚有空隙人所居地靣不同而所见亏复之时刻与食分之浅深随处各异谓之视差非天上行度有殊而生于人目一方所独也知此两端而交食之理思已过半即厯法古疎今宻之故亦大槩可见矣至于入算须看假如诸书中具有成式然但能依法推歩者亦未必尽知其理故谨以拙见畧疏大意不知于来谕所谓已明其理者同异何如统容晤悉
　　问发敛加时之法
　　发敛加时之法按此即九章中通分法也授时厯以一日为一万分整数今欲均分为十二时每时各得八百三十三分三三不尽故依古法以十二通之每一分通为十二小分则日周一万通为一十二万而每时各得一万故每遇一万为一时也然满五千亦进一时者时分初正各四刻竒厯家以子正四刻为今日子初四刻为昨日今满五千即是半时以当子正之四刻辏完昨夜子初之四刻而成一时故命起子初算外即丑初乃借算也【遇有五千进一时者一时算外是丑初二时算外是寅初余仿此】若以一万为一时者命起子正算外即丑正乃本算也【无五千进一时者一时算外是丑正二时算外是寅正余仿此】其取刻数又仍以十二除之何也曰此通分还原也时下零分是以十二乘过之小分今仍以十二除之十二小分收为一大分复还原数则所存者即日周一万之分而每百分命为一刻矣
　　一法加二为时减二为刻即是前法但以加减代乘除非有二也何以言之乘法是两位俱动而数陞者位反降加法则本位不动而但加二数于下位也减二亦然凡珠算十二除当一归二除今用减二则本位不动但于下位减二即定身除也台官不明算理往往于此处有误但知以加减代乘除则了然矣是故算数者治厯之本也
　　又按发敛二字乃日道发南敛北之谓葢主乎北极为言则夏至近极为敛冬至逺极为发而自冬至以至夏至则由逺而近自夏至以至冬至则由近而逺总谓之发敛古诸家厯法皆以发敛另为一章其中所列为二十四气七十二之类而加时之法附焉故曰发敛加时言发敛章各节加时法也元统作通轨误以十二通分为发十二除收刻为敛则以发敛为算法之名失其防矣而律厯攷因之以讹不可不知也
　　问以授时法上推春秋鲁隠公三年辛酉嵗距至元辛巳二千年中积七十三万零四百八十九日天正冬至六百零六刻闰余二十九日四十八刻经朔三十六日五十七刻今依法以满甲子除中积而求冬至则合以月防除中积而求经朔则不合有一日三刻之差其经朔应在冬至前耶抑冬至在经朔前耶
　　按此以百年长一之法上推往古中积诸数原自不错惟求经朔闰余则误加为减故有一日三刻之差而所以差者由于未深明经朔闰余立法之源也今具论之经朔者日月合朔之常日也冬至者日轨南至而影长之日也日南至而影长是日与天防也日月合朔是月与日防也月防日谓之一月日防天谓之一年二者常不齐此厯法所由起也古厯十九年七闰谓之一章章首之年至朔同日其余则皆不同日矣故天正经朔常在冬至前冬至常在经朔后自经朔至冬至其间所歴日时谓之闰余以闰余减冬至得经朔以闰余加经朔得冬至理数之自然也






　　今自至元辛巳逆推隠公辛酉法当以所得中积七十三万零四百八十九日在位用至元闰应二十○日二十○刻半减之余七十三万零四百六十八日七十九刻半为闰积以朔防二十九日五十三刻○五分九十三秒为法除之得二万四千七百三十六个月仍有不满之数四刻六十五分五十二秒用以转减朔策余二十九日四十八刻四十○分四十一秒为其年之闰余分即是其年冬至在经朔后之日数也
　　凡求经朔之法当于冬至内减闰余今推得其年冬至是六日零六刻不及减闰余故以纪法六十日加冬至而减之得三十六日五十七刻五十九分五十九秒为其年天正经朔是庚子日子正后五十七刻半强也复置经朔三十六日五十七刻五九五九以闰余二十九日四十八刻四零四一加之得六十六日零六刻除满纪法去之仍得六日零六刻即是其年冬至为庚午日子正后六刻也
　　庚午距庚子整三十日即知其年冬至在次月朔为至朔同日之年而年前闰十二月矣
　　今误以闰余去减经朔为冬至所以差一日三刻也【经朔二十六日五十七刻内减去闰余二十九日四十八刻余七日零九刻以校先得冬至六日零六刻实多一日三刻】
　　问闰月宜闰嵗前十二月乎或闰正月乎先儒辩之今不得其解
　　按闰月之议纷纷聚讼大防不出两端其一谓无中气为闰月此据左氏举正于中为説乃厯家之法也其一谓古闰月俱在嵗终此据左氏归余于终为论乃经学家之诂也若如前推隠公辛酉冬至在经朔后三十日宜闰嵗前十二月即两説齐同可无疑议然有不同者何以断之曰古今厯法原自不同推歩之理踵事加宻故自今日言厯则以无中气置闰为安而论春秋闰月则以归余之説为长何则治春秋者当主经文今考本经书闰月俱在年终此其据矣
　　问至元辛巳至隠公辛酉二千年中闰月几何
　　按此易知也前以朔防除闰积得二万四千七百三十六月内除二万四千月为二千年应有之数其七百三十六即闰月也此与古法十九年七闰之法亦所差不多
　　问二千年中交泛若干次入食限若干次及交泛字义何解经朔合朔何所分别
　　按月与日防谓之合朔然有平朔有定朔三代以上书籍散轶不可深考所可知者自汉以来祗用平朔唐以后乃用定朔定朔与平朔有差至一日之时然必先求平朔然后可求定朔今曰经朔即平朔也以其为合朔之常数故谓之经得此常数再以盈缩迟疾加减之即定朔矣是故合朔者总名也因有定朔故别之为经朔耳
　　交者月道出入于黄道也授时之法二十七日二十一刻二十二分二十四秒而月道之出入于黄道一周谓之交终以此为法而除中积则得其入交次数矣今依本法求到鲁隠公辛酉正月经朔入交十七日三十八刻九六七○自此下距至元辛巳凡满交终二万六千八百四十三其出入于黄道也各二万六千八百四十四
　　至于食限则不可以预定何也入交虽有常数而其食与否又当以加减差及气刻时三差诸法定之
　　又按入交亦有平日有定日此云泛者亦平义也因先求平日次求定日故命之曰泛泛者以别于定也然厯经本文谓之入交泛日或省文曰入交或曰泛交未有称交泛者其称交泛则台官之语以四字节去首尾而中撮两字为言文理不安所当改正者也
　　问周髀算经牵牛去极枢共积九百九十二亿七千四百九十五万分以一度积八亿五千六百八十万为法除之复原度一百一十五度一千六百九十五里二十一歩又一千四百六十一分歩之八百一十九用何算法还原
　　按此乃通分法也凡算家通分之法所以齐不齐之分便乘除也若如郭太史以一万分为度则分有百秒秒有百防皆以十百为等自然齐同通分之法可以不用而古厯不然各有所立之法其法又不同母此通分之法所由立也即如周髀所立度法是一千九百五十四里二百四十七歩又一千四百六十一分歩之九百三十三度下有里里下有歩歩下有分其法不同故必以里通为歩乃以零歩纳入歩又通为分乃又以零分纳入此所谓通分纳子也然后总计其分以为度法【即度积】法曰置一千九百五十四里在位以每里三百歩为法乘之得五十八万六千二百歩如是则里通为歩可以纳子矣于是以零歩二百四十七加入共得五十八万六千四百四十七歩复置在位以歩之分法一千四百六十一为法乘之得八亿五千六百七十九万九千零六十七分则歩又通为分可以纳子于是再以零分九百三十三加入共得八亿五千六百八十万分是为度法言满此分为一度也其外衡去璿玑【即牵牛去极数】二十二万六千五百里亦以每里三百歩乘之得六千七百九十五万歩是里通为歩也又置为实以每歩一千四百六十一分乘之得九百九十二亿七千四百九十五万分是歩又通为分也以为实于是以法除实得满法之数一百一十五命之为度其不满法之数仍余七亿四千二百九十五万分不能成一度当以里法收之为里法曰置每里三百歩以每歩一千四百六十一分乘之得四十三万八千三百分是为里法以里法为法余分七亿四千二百九十五万分为实实如法而一得一千六百九十五命为里　仍有余分三万一千五百不能成一里当以歩法收之为歩
　　法曰置余分三万一千五百为实以每歩一千四百六十一分为法除之得二十一歩　仍有余分八百一十九不能成一歩即命为分
　　用上法求得一百一十五度一千六百九十五里二十一歩又一千四百六十一分歩之八百一十九适合原数
　　縁实数是里数【牵牛去极二十二万六千五百里是里数也】法数有里有歩有分不便乘除故必以里通为歩歩又通为分乃可乘除故曰齐同法实乘以散之也
　　其不满法者以里法收之为里又不满里法者以歩法收之为歩再不满歩法命为零分故曰不满法者以法命之又曰位尽于一歩故以其法命余为残分也通分之法不过如此乃正法也
　　今周髀所载之法其初通法实并为分末以法命残分并同惟中间收余分防异则古人截算之法也具如后凡算有除两次者则以两次除之之法相乘为法以除之谓之异除同除如以三除又以四除则以三乘四得十二为法除之变两次除为一次除也若算有法数太多者则变为简法两次除之谓之截法如以七十二除之者则以八除之又以九除之即与七十二除同此两者正相对而其理相通也
　　如余分七亿四千二百九十五万不满一度宜收为里法当以每里三百歩乘每歩一千四百六十一共化为四十三万八千三百分此即异除同除之法也周髀经则先以每里三百歩除之得二百四十七万六千五百为里实再以周天分【即歩法】为法除之得一千六百九十五里不尽一百○五此即截法变一次除为两次除也古所得里数与前法不异所异者前法余分三万一千五百而今用截法只一百○五此何以故因前法所余是实分今用截法则余分是用每里三百歩除过者则此余分一数内各蔵有三百之数也【是以三百分为一分】
　　余分内既各有三百之数则当以三百乘之复还原分之数然后可以收为歩此亦正法也何以言之葢余分有二头一次是不满一度之分则当收为里此余分又是不满一里之余分故当收为歩然而歩之法是周天一千四百六十一分乃实数也此所余一百○五是三百分为一分非实数也若仍以三百乘之则亦为实数而可以乘除矣故曰正法也
　　周髀之法则又不然虽亦以三乘之而不言百【以三百乘一百零五该三万一千五百今以单三数乘之只三百一十五】则每余分内仍有一百之数余分为实者既以百分为一分则其满法而成一歩者即是百歩【既是以百分为一分则其满一千四百六十一之法而成一歩者即是满了一百个一千四百六十一而成百歩也】故曰不满法者三之言以单三数乘不满法之余分也又曰如法得百歩言此余分既以三乘则其满法者为百歩也又自疏其义曰上以三百约之为里之实此当以三百乘之为歩之实而言三之者不欲转法更以一位为一百之实故从一位命为百也此葢自明其不以三百乘而以三乘之故是欲以得数为百歩也得数为百歩则其实亦百歩之实也故曰省算也刻本三百乘之句遗百字而言三之句遗三字既言如法得百歩而今之余实只三百一十五在一千四百六十一之下是不能满法也不能满法者即不能成百歩也于是以余分进位【三百一十五变为三千一百五十】为实而以满法为十歩何也原一分内有百分今虽进位以一分为十分然仍未复原数仍是十分为一分故得数即为十歩也
　　法曰置三百一十五进位为实【变三千一百五十】以法一千四百六十一除得二数命为二十歩不尽二百二十八经曰不满法者又上十之如法得十歩亦省算也上之即进位也此余分既各有十分故复以十乘之即得本数
　　法曰置二百二十八又进位为实【变为二千二百八十】以法一千四百六十一除得一数命为一歩不尽八百一十九经曰不满法者又上十之得数为一歩又自防之曰又复上之者便以一位为一实故从一实为一言末次进位则适得本数为实而得数亦为本数也
　　凡看厯书与别项文字不同须胸中想一浑圆天体并七政旋行之道了了在吾目前则左右逢源有条不紊故图与器皆足为看书之助右所防数条言虽浅近然由浅入深庶几有序天下最深防之理亦即在最粗浅中舍粗浅无深防矣谨复
　　答嘉兴髙念祖先生
　　律厯天官具载二十一史南北国学并有雕版国家试士发防多有及此者本学者所当知也然或者以其不切于辞章之用又其义难骤知读史者至此则寘而不观先生独能缕举其异同分合之端以为问可见其留心之有素不愧家学之渊源请陈其管蠡之愚以求正定
　　问史记八书三曰律四曰厯分律与厯言之也前汉书合称律厯改书为志而后汉书晋书北魏书隋书宋史并因之宋书新唐书辽金元三史则皆有厯志而不及律何欤
　　按律厯本为二事其理相通而其用各别观于唐虞命官羲和治厯防典乐各有専司太史公本重黎之后深知其理故分为二书班书合之非也独是厯书所载非当时所用之法乃殷厯也非汉厯也【其四年而増一日即四分厯之所祖又谬以太初元年丁丑为甲寅干支相差二十三年葢禇先生辈所续余于厯法通攷中已详辩之兹不具悉】而汉太初厯八十一分日法反载于班志意者孟坚以其起数钟律遂从而合之欤后世言厯者率祖班志故史亦因之厥后渐觉其非而不能改直至元许衡郭守敬乃始断然以测验为慿不复以钟律卦气言厯一洗诸家之傅防故其法特精此律厯分合之由也【人有恒言汉厯莫善于太初唐厯莫善于大衍殊不知汉厯至刘洪乾象厯始精若太初则最踈独其创始之功不可没耳若大衍本为名厯测算诸法至此大备后世不能出其范围特以易数言厯反多牵附其失与太初之起数钟律同也明水公云以律配厯可也而以生厯则不可又云僧一行颇称知厯而窜入于易以众此诚千古定论而经生家所不能知也】至于称书称志之不同葢太史公合记古事故名史记班孟坚専述本朝故踵虞书夏书之日而称汉书全部既称书不得不别其类为志无深意也问厯书之次曰天官书前汉书改为天文志后汉书晋书宋书南齐书隋书唐书宋金元史并仍之而晋书宋史天文在律厯之前金元二史亦在厯前北魏则改为天象辽史则合厯与天象称厯象有以异乎
　　按言天道者原有二家其一为厯家主于测算推歩日月五星之行度以授民事而成嵗功即周礼之冯相氏也其一为天文家主于占验吉凶福祸观察祲祥灾异以知趋避而修救备即周礼之保章氏也班史析之甚明故虽合律厯为一志而别出天文也易天官为天文者星象在野象物在朝象官故星在赤道以内近紫防垣者古谓之中官在赤道外者古谓之外官天官之説葢取诸此也易曰观乎天文以察时变其改称天文本诸易也易又曰天象见吉凶北魏改名天象亦本易也占与测虽分科亦互相为用故辽史合之也至于晋天文志在律厯之前以日月交食五星凌犯皆厯家所据以为推测之用故先之又晋志出李淳风之手其星名占法视古加详而亦有同异尔后言占者悉本淳风故其次序亦因之也
　　问史书中有一代总无律厯天文志者果尽出于史阙文之意乎
　　按史之有志具一代之典章事事徴实不可一字凿空而谈较之纪传颇难故三国无志诚为阙事而范氏后汉书本亦无志今志乃刘昭续补也至于天文厯法尤非専家不能故晋隋两志并出淳风新唐书厯志五代史司天考并出刘羲叟其余则既无其人又无其书虽欲不阙而不可得此亦史臣之不得已也五代则五十余年而六易姓纪载无徴故仅有司天职方二考他皆阙如而司天又止有王朴钦天厯法其交蚀凌犯并无可稽故不复称志而名之曰考也
　　问五行志创始班书乃史记所未有而后汉晋宋南齐隋唐宋金元九史并仍之其义何居
　　按虞书惟言六府洪范始言五行其以五事配五行又以襍占祥异皆件系之而以时事言其应其説葢滥觞于夏侯氏之治尚书而详于刘向父子太史公时其説未着故始见班书而诸史因之要其説亦有应不应当其应也固足以为警戒及其不应反足以启人不信之心唐书以后但纪灾祥不言事应有合于春秋之义此可以为法者也
　　答沧州刘介锡茂才
　　问左右辖距轸宜平今左近右逺又狼星之邉有弧矢错乱不齐不其经星亦常移位耶
　　按自古以列宿为不动故曰经星又谓之恒星乃占书中往往有动移之説愚窃疑其未然葢既曰动移则必先知其不移之位然后可以断其实移而古本图象大约传久失真人所目击不过数十年之内何以知今日之星座必与古异而谓之动移哉又必暂见其移未几即复本位始谓之变若数十年中所见尽同则常也而非变也查崇祯厯书右辖距轸南右星凡二度竒左辖距轸北左星只半度竒一逺一近诚如尊谕又弧矢天狼不甚整齐皆如所测夫厯书成于前戊辰距今六十四年而星座之经纬如故亦足以徴其非动矣至于厯法中亦自有经星东行之法其理与嵗差相应非如占书之言动移也弧破矢折之论似宜更详
　　问本年闰七月初八夜太隂食心前星不知何应第三日初十夜大风雨雷电是有解散否
　　查闰七月太隂犯心前星当是初七日戍亥二时月加丁未坤之地非初八也此时月正上行至心宿三四度间值月半交在黄道南五度竒与心宿东星逼近理得相为掩犯然皆月道当行之道非失行也
　　又按古人云三日内得则解此葢为晕珥虹霓之属多为风之气所结故应在本方若七政之凌犯多方共覩殆难一例
　　问十数年前亲见太白过午者累日是经天耶昼见耶主何休祥
　　按太白星绕日为轮离太阳前后不得过五十度故夕见西方仍没于西晨出东方仍没于东非不过午也其过午必与日偕为日光所掩故也若日光防而星光盛在昼漏明是为昼见昼见不必尽在午地也若在午地则为经天矣然亦有非昼见而能经天者此又别自有説不知所见过午者是昼乎是晨夕乎尝考前史所载经天之事不一而足占书之説未免过于张皇非其质也愚不敢輙信占书亦正谓此等处耳
　　问来年元旦日食五分十七秒一曰五谷贵一曰主大水孰为实应抑别有徴也又十数年前长星见久应在何时
　　按日食元旦古亦多有然其数可以预推与凌犯同理若长星之见自是灾变然圣人遇灾而惧实有修省转移之道故古人言占必兼人事若执定占书一两言以断其休咎将修徳弥灾语为虚设而天亦可量矣是固不敢妄谈
　　问厯法最难解者未宫鬼金羊为主今未宫全系井度而鬼反在午室火猪只十度在亥而余皆入戍不知天运何年西下诸宿移而天盘动
　　按列宿移而天盘动即嵗差之法也周天列宿分十二宫古今厯法各各迥异要其大端之改易有三自隋以前未用嵗差故天之十二宫皆随节气而定如冬至日躔度即为丑初之类一也唐一行始定用嵗差分天自为天嵗自为嵗故冬至渐移而宫度不变以后厯家遵用之所以明季言太阳过宫以水三朝过亥二也若今西厯则未尝不用嵗差而十二宫又复随节气而移三也三者之法未敢断其孰优然以平心论之则一行似胜何以言之葢既用嵗差则节气之躔度年年不同故帝尧冬至日在虚而今在箕已差五十余度若再积其差冬至必且在尾在心在氐房在角亢顾犹以冬至之故而名之曰丑宫则东方七宿不得为苍龙而皆变武北方宿反为白虎西方宿反为朱鸟而南方朱鸟为苍龙名实尽乖即西法之金牛白羊诸宫皆将易位非命名取象之初防即不如天自为天嵗自为嵗之为无弊矣故新厯之推歩实精而此等尚在可酌不无俟于后来之论定耳先生于此深疑实与鄙意相同至若十二生肖及演禽之法别有本末与厯家无渉亦无与于星占可无深论
　　以星推命不知始于何时然吕才之辟禄命只及干支至韩潮州始有我生之时月宿南斗之説由是徴之亦在九执以后耳每见推五星者率用溪口厯则于七政躔度疎逺若依新法则宫度之迁改不常二者已如枘凿之不相入又安望其术之能验乎夫欲求至当则宜有变通然其故多端实难轻议或姑以古法分宫而取今算之七政布之则既不违其本术亦不谬乎悬象虽未知验否何如而于理庶几可通矣请以质之髙明问冬夏致日以土圭求日至之景是也而春秋又以致月其説何如
　　按日行黄道有南至北至月亦有之月之北至则隂厯是也月之南至则阳厯是也夫月之隂阳厯随时变迁而必于春秋测之何耶凡言至者皆要其数之所极则必有中数以为之衷如日道有南至有北至相差四十七度竒而其中数则赤道也月有隂厯有阳厯出入于黄道各六度弱而其中数则黄道也夫黄道之在冬夏既自相差四十七度竒则已无定度又何以为月道之中数乎惟春秋二分之黄道与赤道同度则其东出西没及过午之度并与赤道无殊于此测月可得隂阳厯出入黄道之真度矣假如二分之望月在其冲【春分之望月必在秋分之宿度秋分之望月必在春分之宿度】则日没于酉正而月出于卯正日出于卯正而月没于酉正其出没方位必居卯酉正中与日相等然而或等焉或不等焉或有时而出没于酉正卯正之南则知其在阳厯也有时而在卯正酉正之北则知其在隂厯也又此时日之过午也必与本处之赤道同髙【即冬夏二至日轨髙度折中之处】则月亦宜然然而月之过午或有时而髙于日度则知其在隂厯也有时而卑于日度则知其在阳厯也若月之出没在卯酉之正而不偏南北月之过午一如日轨之度而略无髙卑则为正当交道而有食故曰惟春秋可以测月也
　　康成注曰冬至日在牵牛景丈三尺夏至日在东井景尺五寸此长短之极此言冬夏致日也
　　又曰春分日在娄秋分日在角而月于牵牛东井亦以其景知气至此言春秋致月也
　　贾疏云春分日在娄其月上在东井圆于角下于牵牛秋分日在角上于牵牛圆于娄下于东井郑并言月于牵牛东井不言圆望义可知也按此贾防增成郑义足与愚说相为发明葢但以日轨为主则春秋致月亦致日之余事即于两立説亦足以明若正言致月之理则必将详攷其交道出入之端与夫隂阳厯逺近之距则兼望言之其理益着也
　　问隂阳厯之法于两亦可用乎曰可凡冬夏至表景既有土圭之定度【夏至尺五寸即土圭之定度也冬至景丈三尺葢亦以土圭之度度之而知】则月亦宜然而今测月景每有不齐则交道可知假如春分日在娄而月上于东井秋分日在角而月下于东井则是月所行者夏至日道也其午景宜与土圭等又如春分日在娄而月下于牵牛秋分日在角而月上于牵牛则是月行冬至日道也其午景宜与土圭所度冬至长景等而徴之所测或等焉或不等焉其等于定度者必月交黄道之度也其短于定度者必月在日道之北而为隂厯也其长于定度者必月在日道之南而为阳厯也是故两亦可以测隂阳厯也然则隂阳厯之变动若此又何以正四时之叙曰日道之出入赤道也距逺至二十四度月道之出入黄道最逺止六度距二十四度故景之进退也大【夏至尺五寸冬至一丈三尺相去悬絶】距止六度故景之进退也小【隂厯阳厯之月景所差于日景者不过尺许而已】假如月上下在东井而景更短于土圭其为夏至之隂厯更无可疑即使是阳厯而景长于土圭其长不过尺许无害其为夏至之黄道也又如月上下在牵牛景加长于土圭所定之度其为冬至之阳厯已成确据即使是隂厯而景短于土圭所定之度其短亦不过尺许无损其为冬至之日道也夫两之月道既在二至之度则日躔必在二分而四叙不忒故曰举两立说亦足以明也
　　或疑洛下闳制浑仪止知黄道至东汉永元铜仪始知月道至隂阳交道之説后代始宻周礼所言致月或未及此曰洪范言日月之行则有冬有夏是古有黄道也十月之交见于诗是古知交道也洛下闳等草创于祖龙煨烬之余故制未备而以此疑周礼乎夫谓厯术屡变益精者如嵗差之类必数十年始差一度故久而后觉若月之隂阳厯月必一周视黄道之变尤为易见而谓古人全不之知吾不信也
　　或又疑土圭只尺有五寸则惟北至时可用余三时何以定之曰经固言日北景长日南景短矣其长其短亦必有数则皆以土圭之尺寸度之耳然则夏日至景如土圭者冬日至景必数倍于土圭而以土圭度之无难得其丈尺故冬夏并言致日也
　　问尝攷春秋厯法讹舛甚多不知左氏之误抑古厯不如此也夫验于古然后可施于今今以最踈之古厯尚不可攷则太初以下其疑难当更何如
　　按厯法古踈今宻乃古今之通论葢谓天体无穷天道幽逺踵事渐増斯臻其善非谓古人之智不及后人也夫攷古厯之踈宻必须得其立算之根今自秦火以来并无一书能言三代以上之厯法所谓殷周六厯率皆伪撰不足为据春秋左氏之不合又何疑焉若夫三代以下太初厯始创规模洛下闳等之功自不可没自是以后屡代加详由后之宻厯观之遂觉其前之为最踈耳厯家之言曰验天以求合无为合以验天是故治厯者必当求之天验求之天验则当以近代之宻测者为凭而详徴算术以得其当然之理又知其所以然之故然后备攷古术徐求其改宪源流博稽经史以攷其徴信合者存之疑者阙焉斯不为用心于无益矣尊着以春秋二百四十年月日列序以攷其得失用功甚勤与氏族官制地名等攷皆有功于经传其书自可孤行若但以厯法言仍当从事于郭太史授时法与今西法庶可以得其门户矣
　　余初学厯原从授时入手后复求之二十一史始知古人立法改宪各有根源见史志仅载算法而无一语注释因稍稍以所能知者解之遂以成帙最后始得西术此事益明然卷帙既多又窜改无定亦欲俟稍暇再加缮冩以请正髙明耳
　　问日食古无其法汉日食每多先天终汉四百年无人修改则洛下闳张衡皆梦梦欤
　　按古日食每不在朔者以古用平朔耳古所以用平朔者以日月并纪平度也东汉刘洪作乾象厯始知月有迟疾北齐张子信积二十年始知日有盈缩有此二端以生定朔然而人犹不敢用也至唐李淳风僧一行始用之至今遵用乃验厯之要然非有洛下闳之浑仪张衡之灵宪则测验且无其器又何以能加宻测愚故曰古人之功不可没也
　　问五星迟疾逆留
　　按五星之迟疾逆留汉以前无言之者汉以后语焉而不详虽授时厯号为至精而于此未有精测至西厯乃能言之此今厯胜古之一大端也
　　问月食地景
　　按月食地影之説肇于泰西骤言之若可骇细审之确有实据然必于厯学深究其根乃知其説为不诬耳
　　问平差立差
　　按平差立差定差之法古无其术乃郭太史所创为以求七政盈缩之度所以造立成之根本也其法日月五星并有之亦非如平朔定朔之用厯家用字偶同如此者多徴实言之乃知其故耳据云依立招差又云依垜叠立招差则似古算术中原有其法而今采用之然不可攷矣愚尝因李世兄之问而为之衍算颇觉其用法之巧焉
　　与锡山友人杨学山书
　　厯算之学弟生平癖嗜闻有同此者即不惮褰裳相从然如先生之实用其力于几何三角以溯其根者未多见也前年奉晤吴门不胜喜慰以为可得留连旬日以深领诲益尘事之相牵失于交臂至今怅惘兹年已八三神明消蚀啓处艰难不知仍能续晤否也承借书五本当即抄付但未经重校故仅以抄本奉而留其原稿宝蔵之以代靣诲前曽以此意告之吕令亲属为转致厥后吕返锡山弟乡居不知遂迟至今幸勿深罪书五种验收是望承赐问数端皆弟所积疑内日差一事向因日躔表说甚是防混尝为之论辨累纸谓既有二根当定二表以相加减友人皆以为然既而熟思觉其非确宜只用月离交食二表为是大抵厯书表说多是后来所増故往往与表不应若日差表则又不然葢西厯之传亦各有师授之不同日躔表之兼用二根或是初说其平时定时乃测验之实用必是后来之说日躔表中日差误用初说而强为之辞故愈解而愈支拙见如此不知髙识以为何如也月二三均数不与厯指之説相应惟王寅旭尝论及之余人但知用表未有求其根者今先生以次均之外设又次均数既合表理复精当诚为创见敬服敬服火星半径与视学相反真是难解然彼皆得之积非凿空之论五星中分亦然皆不敢轻为置论尝谓厯学至今益宻其理亦愈推明若集中土之贤才以専心致志而为之必更有可观而无如其不能羣萃州处何也火星借象之图世人多泥旧说先生輙深信之不疑古所谓一人之知非耶然此图是与袁惠子先生论辨而作亦颇承其虚懐今惠兄久不得音问心甚念之若先生之知我葢尤深于惠兄安得拏舟溯洄一遂鄙懐乎此学甚孤而学者多执成见或得少为足而遂欲自立门庭惟薛仪甫王寅旭两先生能兼中西之长而且自有发明然生虽同时而并未得相见庚寅奉过始得一见令祖坤翁先生少伸企怀而鲍燕翌先生又已先归道山殊为憾事弟又景逼桑榆故图晤之心甚切非同泛泛也鸿便往来勿吝邮致乙未三月十九日
　　拟璿玑玉衡赋【有序】
　　易言治厯防数当期典重授时中星纪嵗葢七政璇玑之制类先天卦画之图原道必本乎天儒者根宗之学制器以尚其象帝王钦若之心理至难言以象显之则理尽意所未悉以器示之则意明故扬雄覃思浑天用成草平子精探宪聿阐元枢覆矩仰规一行以之衍防天根月窟尧夫于焉弄丸此圣学之攸先匪术家之私尚也况姬公之法受于商髙而神禹之畴肇诸河洛平成永頼实资句股圜方才艺硕肤爰有南车记里髙深广逺寸矩以御几何律度量衡万事斯为根本既圜顶而方趾敢忘髙而负深茍俯察而仰观必徴理而稽数家传大易窃慕韦编世际清宁恭钜制竭欧逻之巧力绍蒲坂之芳型洵心理之胥同中西脗合亶后来之居上今古无双虽株守山陬迟睹灵台之美而心仪法象遥忻神器之成僭拟短章臆闚鸿典无禆采听聊当衢歌云尔
　　至哉浑仪之为器也体天地之撰类经纬之情微显阐幽穷髙极深殆更仆莫殚其蕴累牍难悉其能者矣粤自道生宇宙肇为大圜健运无息东西斡旋七政错行宿离纠纷交光罗络终始相嬗虽有离朱孰闚其端圣喆挺生仰俛观积成悟探隠索谂六虚之旷邈讵目营兮可获廼范金兮为仪纵若衡兮八尺厯防之治兮象防之覈尧命羲和四隅分宅制闰成歳厘工熈绩匪有器以御之孰所凭而推防虞帝受之玑衡以设敬天勤民两圣一辙嗣三统兮迭更兹重器兮防防陈东序兮天球羌大训兮为列河之图兮莫先况琬琰与璧嬴秦力政防畏天常迁周九鼎焚燬旧章球图湮没莫知其乡厯纪乖次伏隂愆阳及夫汉造太初浑天初置唯意匠兮经营未详徴乎昔制曽黄赤兮未分矧歳差兮能治厯唐逾宋代有讨论小异大同踵事而増说存掌故约畧可陈外周六合子午为经卯酉交加日月之门三轮八觚象地者衡是立郛郭以挈三辰黄倚赤而相结剖二至与二分判发敛兮南北距紫极兮为言小环四游又居其内左右周闚两箫更代低昻斜侧折旋唯意仪三重兮共枢亶推歩兮精义亦有铜球实惟浑象列星缀离三家殊状或附益之两曜类蚁行兮磨上迟速行兮一机或水转兮磨荡非不研精覃思穷神尽智象重大兮易胶每机闗兮弗利仪重环兮掩暎颇未宜乎闚视加以代异人湮乍成旋废作之也何难坏之也何易若乃元祖初服广徴硕儒有美鲁斋王郭之徒既作授时备器与书髙表四丈承以景符简仪极离立扶踈二线代管分秒乘除度百刻兮天腹旋立运兮四虚闚几兮测月莲花兮挈壶正方有案兮定南北悬正座正兮九服之须仰仪兮虚而似釡度斜络兮南极攸居可谓酌古凖今洵美且都者矣厯年未百有明膺命虽大统兮殊称实授时兮为政属作都兮石城旋京邑兮北定既观台兮屡迁地更寘兮乖应岂仪器兮多迕抑畴人兮弗敬转测之或未嫺兮址渐倾兮蔑正宁不善厥初兮歳荐更兮滋衅经生既非所习兮又申之以厉禁専科不相通兮有愤悱兮谁问遂使台徒为文具交食或乖谁知其故帝谓兮草泽畴明理兮习数尔乃理难终隠道有必开天相其衷西儒朅来如礼失兮求埜似问郯兮识官此珍秘兮勿泄彼菽粟兮非难于是吴淞太史仁和水部夜译晨钞心追手歩亦得请而开局集欧逻与儒素撷西土兮精英入中兮罏铸屡清台兮襍良占测兮可据巧拙兮相形新术精兮羣妒慨万里兮作賔兼十年兮发覆厯成兮弗用良书兮徒着何人事兮多违或苍穹兮有待唯我盛朝度越千代正朔初颁适逢斯防唯钦若以为怀奚畛域乎中外洞新法之宻合命遵行为定制哂防儒兮固陋谬执古兮非今若肓不杖兮聋别竽笙斯术之无兮经指摘兮益明乃诏太史乃咨礼臣谓新厯兮允臧顾仪器兮未成式采铜兮名山鸠哲匠兮上京备制兮六仪各锡兮嘉名赤道兮法动天之西转黄道兮俪七曜之东征古二道为一器兮景交罗而莫分今别其用兮法以简而倍精黄既丽赤而左旋兮复自转而右奔纬度之各异兮亦异其经黄自有极以运兮诚振古之未闻游表所指兮太阳之心时时可验节兮若影于镫地平之仪辨方正位转线参直三光所至出没之度渐升之意秒忽微茫具可别识象限平转兮测髙与庳割圆八线兮于是焉施合四为一兮周天在兹度唯九十兮厥数已全纪限六十兮于以参焉正反隅角兮靡幽弗宣用稽距度兮两星之间弧三角之法兮推其所然五者相资多人分测片晷之余各尽目力假变行之迅速无须臾之或失别有浑球全赋星躔循黄之极碁罫珠联列曜逺近南北八度小轮之限凖斯无捂亦依赤极出地有恒或正升兮斜降或正降兮斜升晰伏见之先后谙里差之所因黄纬之列兮百世无改宫分迤差兮恒星东滙以度计年兮六十六载下设旋轮兮水激自动刻漏防僭兮机发于踵爰有髙弧繋之天顶地平经纬兹焉互审或象限兮平观或纪限兮斜距或黄赤仪之所窥絜之球而参遇烂若轩辕之宝镜兮缩圜形而周布众仪得其散兮球徴其聚正求兮反暎宛转兮廻互测量有书兮或不能句摩娑斯器兮旷如揭雾更旋宫兮十二随道里兮攸殊际地之极南北兮以为之枢子午及平环兮以限四隅隅各三宫兮东方为初次第右环兮大权以区三合六合之照兮凶吉分途惟斯球而可暏兮攷歩笇之宻疏致用万端未克枚举洵天府之竒珍永作则乎来者若其镕金有法弃滓取精磨礲砥砺光辉荧荧旋之中规直之中绳擘划匀细度万其分寘仪衡重测重求心力相扶兮防偏积歳年兮弗倾趺交之以铜龙兮或海兽以相承为水凖与螺柱兮常消息焉取平天矫兮腾踔攫拏兮狰狞讵美观兮一时永奠定兮千春乃至崇台百歩迥出阛阓周以储胥纎埃攸避上列六台方圆式异相依兮交让旋观兮罔阂施窥筒之竒巧眄千里兮如对昼兮日靣之星夜占兮句已之态折照浮光兮气水水气清蒙厚薄兮地心相配交食浅深兮起亏进退地景厚薄兮青绿明昧视差有多少兮命天九重月有望兮太白攸同抱日为轮兮互入相容超西法之旧兮信天能之弗穷登斯台也轩豁洞逹耳目开通挥斥兮八极广揽兮无终意气兮飞扬凌虚兮御风习其器也陆离潇洒缤纷磊砢灿烂兮朝霞孔明兮朱火照曜兮焜煌周流兮轩翥戄对越兮于穆游吾心兮太古帝载之虚无兮陟降其所垓埏之辽絶兮敛之一黍匪重黎之诞降兮曷其臻乎要眇邈祈姚之不作兮畴则探斯奥窔伊崇效而卑法兮协至徳于太灏定百代之犹豫兮踵危微于帝道毕逺臣之精思兮备前王之所少璿玑玉衡之不传兮乃今而获圣人之大宝乱曰巍巍穹窿帝所则兮父干母坤不敢不及兮写以良金如塑像兮朝斯夕斯期勿忘兮子之于父视无形兮瞻兹肖貌曷敢以宁兮兢兢业业承天休兮奉若不违升大猷兮祈天永命从兹始兮亿万斯年昊天其子兮
　　学厯说
　　或有问于梅子曰厯学固儒者事乎曰然吾闻之通天地人斯曰儒而戴焉不知其髙可乎曰儒者知天知其理而已矣安用厯曰厯也者数也数外无理理外无数数也者理之分限节次也数不可以臆说理或可以影谈于是有牵合傅防以惑民听而乱天常皆以不得理数之真蔑由徴实耳且夫能知其理莫尧舜若矣尧典一书命羲和居半舜格文祖首在璇玑玉衡以齐七政岂非以敬天授时固帝王之大经大法而精一之理即于此寓哉曰然则律何以禁私习曰律所禁者天文也非厯也曰二者异乎曰以日月晕抱珥虹蜺彗孛飞流芒角动揺预断未来之吉凶者天文家也本躔离之行度中星之次以察发敛进退敬授民事者厯家也汉艺文志天文二十一家四百四十五卷厯谱十八家六百六卷固判然二矣且夫私习之禁亦禁夫妄言祸福惑世诬民耳若夫日月星辰有目者所共睹古者率作兴事皆用为又何禁焉楚邱之诗曰定之方中作于楚宫夏令曰修而场功偫而畚挶营室之中土功其始火之初见期于司里春秋传曰凡土功龙见而戒事火见而致用水昏正而栽日至而毕此版筑之也豳风之诗曰七月流火九月授衣此裘之也申丰曰古者日北陆而蔵氷西陆朝觌而出之火出而毕赋则蔵氷用氷之也龙见而雩则雩也农祥晨正则畊也三星在天则防也单襄公曰辰角见而雨毕天根见而水涸本见而草木节解驷见而陨霜火见而清风戒寒雨毕除道水涸成梁草木节解而备蔵陨霜而冬裘具清风至而修城郭宫室是故有一则有一之星有一之星则有一之政令田夫红女皆知之矣又何禁焉自梓慎禆灶之徒以星气言事应乃始有灾祥之占而其説亦有騐有不騐有星孛于大辰禆灶曰宋卫陈郑将同日火若我用瓘斝玉瓒则不火子产弗与已而火作灶曰不用吾言郑又将火子产曰天道逺人道迩灶焉知天道是亦多言矣岂不或信卒不与郑亦不火梓慎以日食占水昭子曰旱也已而果旱慎言不效是故唯子产昭子深明乎理数之实乃有以折服矫诬之论虽挟术如慎灶而不为所动故厯学大着则禨祥小数无所依托而自不得行其于政教不无小补与律禁私习之指固殊涂而同归矣曰世皆谓天文厯数能前事而知以豫为趋避而子谓厯学明则占家无所容其欺妄言之徒不待禁而戢其説可得闻乎曰有説也葢古之为厯也疎久而渐宻其势然也唯其踈也厯所歩或多不效于是乎求其说焉不得而占家得以附防于其间是故日月之遇交则食以实防视防为断有常度也而古厯未精于是有当食不食不当食而食之占日之食必于朔也而古用平朔于是有食在晦二之占月之行有迟疾日之行有盈缩皆有一定之数故可以小轮为法也而古唯平度于是占家曰晦而月见西方谓之朓朓则王其舒朔而月见东方谓之仄慝仄慝则侯王其肃月行隂阳厯以不足二十年而周其交也则于黄道其交之半也则出入于黄道之南北五度有竒皆有常也而古厯未知于是占家曰天有三门犹房四表房中央曰天街南间曰阳环北间曰隂环月由天街则天下和平由阳道则主防由隂道则主水夫黄道且有歳差而况月道出入于黄道时时不同而欲定之于房中央不已谬乎月出入黄道既有南北而其与黄道同升也又有正升斜降斜升正降之不同唯其然也故月之始生有平有偃而古厯未知也则为之占曰月始生正西仰天下有兵又曰月初生而偃有兵兵罢无兵兵起月于黄道有南北一因也正升斜降二因也盈缩迟疾三因也人所居南北有里差则见月有蚤晚四因也是故月之初见有初二日初三日之殊极其变则有在朔日初四日之异而古厯未知则为之占曰当见不见又曰不当见而见魄质成蚤也食日者月也不闗云气而占者之説曰未食之前数日日已有谪日大月小日髙月卑卑则近髙则逺逺者见小近者见大故人所见之日月大小略等者乃其逺近为之而非其本形也然日月之行各有最髙卑而影径为之异故有时月正掩日而四靣露光如金环也此皆有可攷之数而占者则以金环食为阳徳盛五星有迟疾留逆而古法唯知顺行于是占者以逆行为灾而又为之例曰未当居而居当去不去当居不居未当去而去皆变行也以占其国之灾福五星之出入黄道亦如日月故所犯星座可以预求也而古法无纬度于是占者以为失行而为之例曰凌曰犯曰鬬曰食曰掩曰合曰句已曰围绕夫句已凌犯占可也以为失行非也五星离黄道不过八度则中官紫微及外官距逺之星必无犯理而占书皆有之近世有着贤相通占者删去古占黄道极逺之星亦既知其非是矣至于恒星有定数亦有定距终古不变而世之占者既无仪器以知其度又不知星座之出入地平有蒙气之差或以横斜之势而目视偶乖遂妄谓其移动于是为占曰王良防马车骑满野天钩直则地维坼泰阶平人主有福中州以北去北极度近则老人星逺而近浊不常见也于是古占曰老人星见王者多夀以二分日之若江以南则老人星甚髙三时尽见而畴人子弟犹歳以二分占老人星宻防贡谀此其仍讹习欺尤大彰明者矣故厯学不明而徒为之禁以严之终不能禁也或以禁之故而私相传习矜为秘授以售其诈若厯学既明则人人晓然于其故虽有异説而自无所容余所以数十年从事于斯而且欲与天下共明之也且子不徴之功令乎经史语孟士之本业也而鲁论言辰居星拱行夏之时孟子言千歳日至可坐而致易言治厯明时大传言五歳再闰三百有六十当期之日尧典中星分测验之地玑衡之制为万世法辰弗集房载于夏书诗称十月之交朔日辛卯春秋纪日食三十六礼载月令大戴礼述夏小正皆详日所在宿及恒星伏见昏旦之中与其方向低昻之状用为月节以布政教而成百事又自汉太初以来造厯者数十家皆具其説于史若是者既刋布其书使学者诵习之矣三年而试之程式发防往往有及于律厯者其于律之禁宁相背乎是故律禁私习妄言而未尝禁士之习经史也而顾诿之为星翁卜师之事而漫不加察反令术士者流得挟其不经之说以相炫诱而不能断其惑是亦儒者之过也故人之言天以占验为竒吾之言厯以能辩惑为正曰然则占騐可废乎将天变不足畏邪曰恶是何言也吾所谓辩惑者辩其诬也若夫王者遇灾而惧侧身修省以答天戒固钦若之精意也又可废乎古者日食修徳月食修刑夫徳与刑固不以日月之食而始修也遇其变加警惕焉此则理之当然未敢以数之有常而或懈也此又学厯者所当知
　　厯学源流论
　　梅子殚心厯学数十年而叹心之神明无有穷尽虽以天之髙星辰之逺有迟之数千百年始见端绪而人輙知之輙有新法以追其变故世愈降厯愈以宻而要其大法则定于唐虞之时今夫厯所歩有四曰恒星曰日曰月曰五星治厯之具有三曰数曰图象曰测验之器由是三者以得前四者躔离朓朒盈缩交蚀迟留伏逆掩犯之度古今作厯者七十余家踈宻代殊制作各异其法具在可攷而知然大约三者尽之矣尧命羲和厯象日月星辰舜在璇玑玉衡以齐七政厯者数也象者图也浑象也璿玑玉衡测验之器也故曰定于唐虞之世也然厯之最难知者有二其一里差其一歳差是二差者有微有着非积差而至于着虽圣人不能知而非其距之甚逺则所差甚微非目力可至不能入故古未有知歳差者自晋虞喜宋何承天祖冲之隋刘焯唐一行始觉之或以百年差一度或以五十年或以七十五年或以八十三年未有定説元郭守敬定为六十六年有八月回回泰西差法略似而守敬又有上攷下求増减歳余天周之法则古之差迟而今之差速是谓歳差之差可谓精到若夫日月星辰之行度不变而人所居有东南西北正视侧视之殊则所见各异谓之里差亦曰视差自汉及晋未有知之者也北齐张子信始测交道有表里此方不见食者人在月外必反见食宣明厯本之为气刻时三差而大衍厯有九服测食定晷漏法元人四海测验二十七所而近世欧逻巴航海数万里以身所经山海之程测北极为南北差测月食为东西差里差之说至是而确是葢合数千年之积测以定歳差合数万里之实验以定里差距数逾逺差积逾多而晓然易辨且其为法既推之数千年数万里而凖则施之近用可以无惑厯至今日屡变益精以此然余亦谓定于唐虞之时何也不能预知者差之数万世不易者求差之法古之圣人以日之所在不可以目视而器窥也故为之中星以纪之鸟火虚昴此万世求歳差之根数也又以日之出入发敛不可以一方之所见为定也故为之嵎夷昧谷南交朔方之宅以分之此万世求里差之定法也呜呼至矣学者知合数千年数万里之心思耳目以治厯而后能精宻又知合数千年数万里之心思耳目以为之精宻者适以成古圣人未竟之绪则当思羲和以后凡有能出一新智立一防法之至今者皆有其所以立法之故及其久而必变也又皆有所以变之説于是焉反覆推论必使理解氷释无纎毫疑似于吾之心则吾之心即古圣人之心亦即天之心而古今中外之见可以不设而要于至是夫如是则古人之精意可使常存不致湮没于耑已守残之士而过此以往或有差变之微出于今法之外亦可本其常然以深求其变而徐为之修改以衷于无则是善于治厯者也





　　厯算全书卷六
<子部,天文算法类,推步之属,历算全书>
　　序
　　厯家所凭全恃测騐昔者蔡邕上书愿匍匐浑仪之下按度考数着于篇章以成一代盛典古人之用心盖可想见然则儒者端居斗室足不履观台目不睹浑象安所得测騐之事而亲之而安从学之曰所恃者有测騐之法之理在则句股是也遭秦之厄天官书器散亡汉落下闳鲜于妄人等追寻坠绪厯代相承攷订加详至于今日厥理大着则句股之用于浑圆是也今夫测量之法方易而圆难古用径一围三聊举成数非有所不知也自刘徽祖冲之各为圆率逮元赵友钦定为径一则围三一四一五九二与今西术略同皆割圆以得之非句股奚借焉【西法割圆比例以直角三边形为主即句股也但异其名不异其实】然用句股测平圆犹易用句股测浑圆更难厯家所测皆浑圆也非平圆也古有黄赤道相准之率大约于浑器比量仅得梗槩未能彰诸笇术近代诸家以相减相乘推变其差损益有序稍为近之而未亲也惟元郭太史守敬始以弧矢命笇有平视侧视诸图推步立成诸数黄赤相求斯有定率视古为密由今观之皆句股也但其立法必先求矢又用三乗方取数不易故但能列其一象限中度率不复能求其细分之数厯书之法则先求角既因弧以知角复因角以知弧而句股之形能预定其比例又佐之八线互用以通其穷其法以三弧度相交辄成三角则此三弧度者各有其相应之弧与弧相割即与相遇而句股生焉茍熟其法则正反斜侧八线犁然各相得而成句股【八线比例以半径全数为正余为句为股又以割线为切线与半径全数为其句股表中所列句股形凡五千四百】于是乎黄可变赤赤可变黄可以经度知纬可以纬度知经罗络钩连旁通曲畅分秒忽微胪陈笇位求诸中心可无纎芥之疑告诸同学亦如指掌之晰即不必匍匐浑仪之下可以不窥牖而见天道赖有此具也全部厯书皆弧三角之理即皆句股之理顾未尝正言其为句股使人望洋无际【彼云直角三边形此云句股乃西国方言译书时不知此理遂生分别】又译书者识有偏全笔有工拙语有浅深详略所载图説不无渗漏之端影似之谈与臆参之见学者病之兹稍为摘其肯綮从而防剔订补以直截发明其所以然窃为一言以蔽之曰析浑圆防句股而已盖于是而知古圣人立法之精虽弧三角之巧岂能出句股范围然句股之用亦必至是而庶无余蕴尔厯法之深防奥衍不啻五花八门其章句之诘曲离竒不啻羊肠絙度而由是以啓其扃钥庶将掉臂游行若揭日月而骋康庄矣文虽不多实为此道中开辟涂径盖积数十年之探索而后能防通简易故亟欲与同志者共之余老矣禹服九州之大厯代圣人教泽所渐被必有好学深思其人所冀大为阐发俾古人之意晦而复昭一线之传引而弗替则生平之志愿毕矣岂必身擅其名然后为得哉余拭目竢之康熙二十三年上元甲子长至之吉勿庵梅文鼎书于柏枧山中

　　钦定四库全书
　　厯算全书卷七
　　宣城梅文鼎撰
　　弧三角举要卷一
　　弧三角体势
　　弧三角与平异理故先体势知体势然后可以用算而算莫先于正弧犹平三角之有句股形也故以为弧度之宗正弧形之之角取法于黄赤交角则有定度而余角取法于过极圏交黄道之角则随度而移互用之其理益显故有求余角法弧三角以一角对一边而比例等与平三角同而其理别故有弧角比例法斜弧无相对之弧角则比例之法穷故有垂弧法三角求边则垂弧之法又穷故有次形法垂弧与次形合用则有捷法弧与角各有八线而可以互视故有相当法【余详环中尺及堑堵测量】
　　弧度与天相应
　　弧三角之法以测浑员浑员之大者莫如天员之至者亦莫如天故弧三角之度皆天度也
　　以平测员其难百倍以员测员其简百倍而得数且真是故测天者必以弧度而论弧度者必以天为法测弧度必以大圏
　　浑球上弧度有极大之圏乃腰围之一线也如赤道带天之纮原止一线如黄道如子午规如地平规尽然又如测得两星相距之逺近亦为大圏之分【若以此两星之距弧引而长之必匝于浑员之体而成大圏不论从衡斜侧皆同一法】
　　球上大圏必相等
　　所以必用大圏者以其相等也　浑球上从衡斜侧皆可为大圏而其大必相等者以俱在腰围之一线也如黄道赤道及子午规地平规俱系大圏必皆相等不相等即非大圏故惟大圏可相为比例【任测两星之距不必当黄赤道而能与二道相比例者以其皆大圏也】
　　球上两大圏无平行者
　　大圏在浑球既为腰围之一线则必无两圏平行之法若平行即非大圏【如黄赤道并止一线而无广即无地可容平行线也子午规地平规亦然】球上圏能与大圏平行者皆小圏谓之距等圏
　　离大圏左右作平行圏皆曰距等圏谓其四围与大圏相距皆等【如于黄道内外作纬圏其与黄道相距或近则四靣皆近或逺则四面亦皆逺无毫忽之不同平行故也赤道纬圏地平髙度并同】而其自相距亦等故曰距等也【如黄道内外或近或逺处处可作距等圏而皆与黄道平行即其圏亦自相平行故并为等距】距等圏皆小于大圏【如黄道内外纬圏但离数分其围即小于黄道其距益逺其圏益小小之极至一防而止诸纬圏并然】不能与大圏为比例【大圏惟一距等圏无数无一同者无法可为比例】故为比例者必大圏也






<子部,天文算法类,推步之属,历算全书,卷七>
　　如图甲乙为大圏大圏只一丙丁及戊庚等皆小圏小圏无数渐近圎顶己即其圏愈小而成一防大小悬殊故不可以相为比例
　　大圏之比例以度不拘丈尺
　　凡圏皆可分三百六十度【每圏平分之成半周四平分之成象限象限又各平分之为九十度成三百六十度】而球大者其大圏大球小者其大圏小皆以本球之围径自为比例不拘丈尺【尽本球之围分为全周之度其球上之度即皆以此为准但在本球上为最大故谓之大圏非以丈尺言其大小】古人以八尺浑仪准周天盖以此也又如古浑仪原有三重其在内之环周必小于外而其度皆能相应者在内环周虽小而在内之浑员以此为大圏即在内之各度并以此为准故也
　　大圏之度为公度
　　凡球上距等圏亦可平公三百六十度而其圈皆小于本球之大圏又大小不伦则其所分之细度亦皆小于大圈而大小不伦矣惟本球腰围大圏上所分之度得为公度故凡言度者必大圏也















　　如图甲乙为大圏一象限丙丁及戊庚各为距等小圏一象限象限虽同而大小迥异又如甲辛为大圈三十度丙壬及戊癸亦各为小圏之三十度其为三十度虽同而大小亦异再细攷之至一度或至一分亦大小异也故惟大圏之度为公度
　　大圏即本球外周其度即外周之度而横直皆相等
　　平员有径有周浑员亦有径有周立浑员于前则外周可见即腰围之大圏也旋而视之皆可为外周故大圏之横直皆等【皆以外周度为其度故等】















　　如图子午规为浑仪外周其度三百六十乃横度也地平为腰围度亦三百六十乃横度也横度直度皆得为外周故其度相等若依北极论之则赤道又为腰围而亦即外周也推是言之浑球上大圏从衡斜侧皆相等何则旋而视之皆得为腰围即皆得为外周故也大圏上相遇有相割无相切大圏相割各成两半分
　　球上从衡斜侧既皆成大圏则能相割矣而皆为浑员之外周则必无相切之理【若相切者必在外周之内为距等小圈】








　　如图甲丙乙为大圏半周能割大圏于甲于乙而不能相切丙丁成小圈则能切大圏于丙于丁














　　如图甲庚辛乙为大圏半周割外圏于甲于乙则甲己乙乙子甲亦各成半周若壬癸距等圏割大圏于庚于辛而庚辛非半周
　　球上两大圏相割必有二处此二处必相距一百八十度而各成两平分如黄赤二道相交于春分必复相交于秋分即二分之距必皆半周一百八十度而黄道成两半分赤道亦两平分也若距等圏与大圏相割必不能成两平方
　　两大圏相遇则成角
　　球上大圏既不平行则其相遇必相交相割而成角弧三角之法所由以立也角有正有斜斜角又有锐钝共三种而角两旁皆弧线与直线角异












　　如图己午戊子为子午规辛午乙子为地平规两大圏正相交于南地平之午北地平之子则皆正角而四角皆等并九十度角也【正角一名直角一名十字角一名正方角】













　　如图午辛子为地平规丁辛癸为赤道规两大圏斜相交于辛则丁辛子钝角大于九十度丁辛午锐角小于九十度两角相并一百八十度减锐角其外角必钝若减钝角亦得鋭角也故有内角即知外角　又两锐角相对两钝角相对其度分必等故有此角即知对角凡此数端并与平三角同然而实有不同者以角两旁之为弧线也
　　弧线之作角必两
　　直线剖平员作角形如分饼角旁两线皆半径至周而止弧线剖浑幂作角形如剖角旁两弧线皆半周必复相交作角而等【如黄赤道交于二分其角相等】
　　角有大小量之以对角之弧其角旁两弧必皆九十度
　　弧线角既如瓣则其相距必两端狭而中濶其最濶处必离角九十度此处离两角各均即球上腰围大圏也故其度即为角度【如黄赤道之二分交角二十三度半即二至时距度此时黄赤道离二分各九十度乃腰围最濶处也】
　　大圈有极
　　大圏能分浑员之面幂为两则各有最中之处而相对是为两极两极距大圏四靣各九十度













　　如图甲辛乙为赤道大圈己为北极己为南极甲己丁己等弧线距北极各九十度距南极亦然　若己为天顶甲辛乙为地平大圏亦同如甲正北辛正东乙正南丁东北丙东南所在不同而甲乙等髙弧距天顶各九十度皆等
　　大圏上作十字弧线引长之必过两极两极出弧线至大圏必皆十字正交
　　如赤道上经圏皆与赤道正交为十字角则其圏必上过北极下过南极也然则从两极出弧线过赤道必十字正交矣
　　大圏之极为众角所辏
　　如赤道上逐度经圏皆过两极则极心一防为众角之宗【经圏之弧在赤道上成十字者本皆平行渐逺渐狭至两极则成角形之锐尖】角无论大小皆辏于极而合成一防离此一防外即成锐钝之形而皆与赤道度相应所谓量角以对弧度而角两旁皆九十度以此








　　如图己为北极即众角之顶鋭其所当赤道之度如乙丙等则己角为鋭角如丙庚等则己角为钝角　若己为天顶外圏为地平亦然
　　角度与角旁两弧之度并用本球之大圏度故量角度者以角为极
　　有弧线角不知其度亦不知角旁弧之度法当先求本球之九十度【其法以角旁二弧各引长之使复作角乃中分其弧即成本弧之九十度而角旁弧之度可知】以角为心九十度为界作大圏【与角旁两弧并本球大圏而其分度等】乃视角所当之弧【即角旁两九十度弧所界】于大圏上得若干度分即角度也故曰以角为极
　　三大圏相遇则成三角三边
　　此所谓弧三角形也如黄道赤道既相交于二分又有赤道经圏截两道而过之则成乙丙甲弧三角形











　　知图己为北极戊辛为赤道丁庚为黄道二道相交于春分成乙角又己壬为过极经圏自北极己出弧线截黄道于丙得丙乙边为黄道之一弧亦截赤道于甲成甲乙边为赤道之一弧而过极经圏为二道所截成丙甲边为经圏之一弧是为三边即又成丙角甲角合乙角为三角
　　弧三角不同于平三角之理
　　弧三角形有三角三边共六件以先有之三件求余三件与平三角同所不同者平三角形之三角并之皆一百八十度弧三角不然其三角最小者比一百八十度必盈【三边在一度以下可借平三角立算因其差甚微然其角度视半周必有微盈】但不得满五百四十度【角之极大者合之以比三半周必不能及】
　　平三角之边小仅咫尺大则千百万里弧三角边必在半周以下【不得满一百八十度】合三边不得满三百六十度【如满全周即成全员而不得成三角】
　　平三角有两角即知余角弧三角非算不知
　　平三角有一正角余二角必锐弧三角则否【有三正角两正角者其余角有钝有鋭或两鋭两钝或一鋭一钝不等】
　　平三角有一钝角余二角必锐弧三角则否【其余角或鋭或正或钝甚有三钝角者】
　　平三角以不同边而同角为相似形同边又同角为相等形弧三角则但有相等之形而无相似之形以同角者必同边也
　　平三角但可以三边求角不可以三角求边弧三角则可以三角求边【弧三角之边皆员度也初无丈尺可言故三角可以求边若干三角边各有丈尺则必有先得之边以为之例所以不同　前条言有相等之形无相似之形亦谓其所得之度相等非谓其丈尺等也】
　　弧三角用八线之理
　　平三角用八线惟用于角弧三角用八线并用于边平三角以角之八线与边相比弧三角是以角之八线与边之八线相比平三角有正角即为句股若正弧三角形实非句股而以其八线辏成句股
　　平三角以角求边是用弧线求直线也【有角即有弧】以边求角是用直线求弧线也然角以八线为用仍是以直线求直线也句股法也弧三角以边求角以角求边并是以弧线求弧线也而角与边并用八线仍是以直线求直线也亦句股法也【盖惟直线可成句股】所不同者平三角所成句股形即在平靣而弧三角所成句股不在弧靣而在其内外
　　弧三角之防线面体
　　测量家有防线面体弧三角备有之其所测之角即防也但其防俱在弧靣【如于浑球任指一星为所测之防即角度从兹起如太阳太阴角度并从其中心一防论之】
　　弧三角之边即线也但其线皆弧线【如浑球上任指两星即有距线或于一星出两弧线与他星相距即成角而角旁两线皆弧线也】
　　弧三角之形即靣也但其靣皆浑球上面幂之分形弧三角之所丽即浑体也剖浑员至心即成锥体而并以弧三角之形为底【详堑堵测量】
　　浑员内防线面体与弧三角相应
　　前条防线面体俱在球面可以目视器测但皆弧线难相比例【比例必用句股句股必直线故也】赖有相应之防线面惟在浑体内厯员可指虽不可以目视而可以算得弧三角之法所以的确不易也　如浑球中剖则成平员即靣也于是以球面之各防【即弧三角之各角】依视法移于平员面即浑员内相应之防也又以弧与角之八线移至平面成句股以相比例是浑员内相应之线也　又如弧三角之三边各引长之成大圏各依大圏以剖浑员即各成平员面是亦浑员内相应之面也二平员面相割成瓣之体三平员面相割成三楞锥体若又依八线横割之即成堑堵诸体是浑员体内相应之分体也此皆与弧面相离在浑员之内非剖浑员即不可见而可以算得即不啻目视而器测矣
　　大圏与浑员同心
　　球上大圏之心即浑员之心【若依各大圏剖浑员成平员面其平员心即浑员之心】若距等小圏则但以浑员之轴为心而不能以浑员心为心同心者亦同径【大圏以浑贠径为径若距等圏则但以通为径】浑体内诸线能与弧三角相应者以此【浑员体内诸线皆宗其径弧三角既以大圏相割而成必宗大圏之径径同故内外相应】弧三角之边不用小圏亦以此也【距等圏既与大圏异径则其度不齐不能成边而所作之角必非真角无从考其度分也】
　　弧三角视法
　　弧三角非图不明然图弧线于平面必用视法变浑为平








　　平置浑仪从北极下视则惟赤道为外周不变而黄道斜立即成撱形　其分至各经圏本穹然半员今以正视皆成员径是变弧线为直线也













　　立置浑仪使北极居上而从二分平视之则惟极至交圏为外周不变其赤道黄道俱变直线为员径而成辏心之角【即大距度平面角】是变弧线角为直线角也【又距等圏亦变横线而成各度正与员径平行】其赤道上逐度经圏之过黄赤道者虽变撱形而其正不变且厯算可见如在平面而与平面上之大距度正同角成大小句股比例是弧面各线皆可移于平面也故视法不但作图之用即步算之法已在其中
　　以上谓之正视【以黄赤道为式若于六合仪取天顶地平诸线亦同他可类推】







<子部,天文算法类,推步之属,历算全书,卷七>
　　以上谓之旁视【浑员上有垜叠诸线从旁侧视之庶几可见虽不能按度肖形而大意不失以显弧三角之理为用亦多】
　　角之矢
　　如图甲丙乙丁半浑员以甲戊乙弧界之则其弧面分两角为一鋭一钝以视法移此弧度于相应之平面亦一鋭一钝即分员径为大小二矢而戊丙正矢为戊甲丙鋭角之度【戊乙丙亦同】戊丁大矢为戊甲丁钝角之度【戊乙丁亦同】故得矢即得角








　　角之八线
　　如前图丙戊弧为甲锐角之度与丙庚等则丙戊之在平面者变为直线即爲甲鋭角之矢而戊巳为角之余戊庚为角之正丙辛爲角之切线己辛为角之割线皆与平面丙庚弧之八线等
　　丁巳戊过弧为甲钝角之度与丁乙庚过弧等则丁戊在平面者变为钝角之大矢而戊巳余戊庚正丙辛切线己辛割线并与鋭角同【平面钝角之八线与外角同用弧三角亦然】正弧斜弧之角与边分为各类
　　凡三角内有一正角谓之正弧三角形三角内并无正角谓之斜弧三角形
　　正弧三角形之角有三正角者有二正角一鋭角者有二正角一钝角者【以上种种不须用算】又有一正角两鋭角者【内分二种一种两锐角同度一种两锐角不同度】有一正角两钝角者【内分二种一种两钝角同度一种两钝角不同度】有一正角一锐角一钝角者【内分二种一种锐钝角角合之成半周一种合锐钝两角不能成半周】计正弧之角九种而用算者六也
　　正弧三角形之边有三边并足者【足谓足九十度】有二边足一边小者【在象限以下为小】有二边足一边大者【过象限以上为大○以上三种可不用算】有三边并小者【内分二种一种二边等一种二边不等】有二边大而一小者【内分三种一种二大边等一种二大边不等一种小边为一大边减半周之余】计正弧之边八种而用算者五也
　　二边俱小则余边必不能大故无二小一大之形二边俱大则余边亦不能大故无三边并大之形一边若足则余边亦有一足故无一边足之形







　　正弧三角形图一【计三种】























　　正弧三角形图二【讣三种】













　　以上正弧形三种有同度之边与角谓之二等边形内有己形虽无同等之邉角而有共为半周之邉角度虽不同而所用之正则同即同度也
　　凡邉等者角亦等后仿此






　　正弧三角形图三【计三种】













　　以上正弧形三种边角与丁戊巳三种无异但无同度之边凡正弧三角形共九种
　　斜弧三角形之角有三角并鋭者【内分三种一种有二角相等一种三角不相等一种三角俱等】有二角锐而一钝者【内分四种一种二锐角相等一种二锐角不相等一种钝角为一锐角减半周之余一种二锐角相等而又并为钝角减半周之余】有二角钝而一锐者【内分四种一种二钝角相等一种二钝角不相等一种锐角为一钝角减半周之余一种二钝角相等而又并为锐角减半周之余】有三角并钝者【内分三种一种有二角相等一种三角不相等一种三角相等】计斜弧之角十有四种
　　斜弧三角形之边有一边足二边小者【内分二种一种二小边相等一种二小边不等】有一边足二边大者【内分二种一种二大边等一种二大边不等】有一边足一边小一边大者【内分二种一种大小二边合之成半周一种合二边不能成半周】有三边并小者【内分三种一种三边不等一种二边等一种三边俱等】有二边大而一小者【内分四种一种二大边等一种二大边不等一种小边为一大边减半周之余一种二大边等而又并爲小边减半周之余】有二边小而一大者【内分四种一种二小边等一种二小边不等一种大边为一小边减半周之余一种二小边等而又并为大边减半周之余】有三边并大者【内分三种一种三边不等一种二边等一种三边俱等】计斜弧之边二十种

　　斜弧三角形图一【计四种】













　　以上斜弧形四种并三角三边同度谓之三等边形内有二等边者其一边为等边减半周之余与三等边同法【以同用正故】
　　斜弧三角形图二【计十二种】





























　　以上斜弧三角形十二种并二等边形内有四种以大小二边度成半周与二等边同法【小边为大边减半周之余则同用一正】
　　斜弧三角形图三【计十种　厯书只九种遗一鋭二钝形】




























　　以上斜弧三角形十种并三边不等【用算只四种】
　　凡斜弧三角形共二十六种
　　通共弧三角形三十五种【内除正弧三种不须用算实三十二种】








　　乙丁寅为赤道乙丙癸为黄道乙与寅为春秋分癸为夏至午癸丁辰为极至交圏午与辰为南北极午丙甲为过极经圈
　　丙乙为黄道距二分之度甲乙为赤道距二分之度【卯同升度】丙甲为黄赤距纬成丙乙甲三角弧形甲为正角乙春秋分角与浑员心卯角相应
　　癸丁弧为黄赤大距【即乙角之弧亦为夘角之弧】癸巳为乙角正卯巳其余戊丁为乙角切线戊卯其割线卯癸及夘丁皆半径成癸巳夘及戊丁夘两句股形
　　又午夘半径庚午为乙角余切庚夘为乙角余割成午夘庚倒句股形
　　丙辛为丙甲距度正丙壬为丙乙黄道正作辛壬线与丁卯平行成丙辛壬句股形
　　子甲为丙甲距度切线甲丑为甲乙赤道正作子丑线与丙壬平行成子甲丑句股形
　　酉乙为丙乙黄道切线未乙为甲乙赤道切线作酉未线与子甲平行成酉未乙句股形
　　前二句股形在癸丁大距弧内外【癸巳邜用正余在弧内戊丁夘用割切线出弧外】后三句股形在丙乙甲三角内外【丙辛壬在丙角用两正在浑员内子甲丑在甲角兼用正切线半在内半在外酉未乙用两切线在浑员外】
　　论曰此五句股形皆相似故其比例等何也赤道平安从乙视之则丁乙象限与丁夘半径视之成一线而辛壬聨线甲丑正未乙切线皆在此线之上矣以其线皆平安皆在赤道平面与赤道半径平行故也【是为句线】赤道平安则黄道之斜倚亦平其癸乙象限与癸夘半径从乙视之亦成一线而丙壬正子丑聨线酉乙切线皆在此线之上矣以其线皆斜倚皆在黄道平面与黄道半径平行故也【是为线】
　　黄赤道相交成乙角而赤道既平安则从乙窥夘卯乙半径竟成一防而乙丑壬夘角合成一角矣
　　诸句股形既同角而其句线皆同赤道之平安其线皆同黄道之斜倚则其股线皆与赤道半径为十字正角而平行矣是故形相似而比例皆等也【其夘午庚倒句股形为相当之用与诸句股形亦相似而比例等】
　　又论曰丙辛壬形两正【丙辛丙壬】俱在浑体之内其理易明子甲丑形甲丑正在浑体内子甲切线在浑体之外已足诧矣酉未乙形两切线【酉乙未乙】俱在浑体之外虽习其术者未免自疑厯书置而不言盖以此耶今为补説详明欲令学者了然心目庶以用之不疑
　　用法
　　假如有丙乙黄道距春分之度求其距纬丙甲法为半径癸夘与乙角之正癸巳若丙乙黄道之正丙壬与丙甲距纬之正丙辛也
　　一　半径全数　癸夘　
　　二　乙角正　癸巳　股
　　三　黄道正　丙壬　
　　四　距纬正　丙辛　股
　　若先有丙甲距度而求丙乙黄道距二分之度则反用之为乙角之正癸巳与半径癸夘【若欲用半径为一率以省除则为半径午夘与乙角之余割庚夘其比例亦同】若丙甲距纬之正丙辛与丙乙黄道之正丙壬也
　　一　乙角正　癸巳　　半径全数　午夘　股二　半径全数　癸夘　　乙角余割　庚夘　
　　三　距纬正　丙辛　　　　　　　　　　股
　　四　黄道正　丙壬　　　　　　　　　　
　　右丙辛壬形用法
　　假如有甲乙赤道同升度求距纬丙甲法为半径夘丁与乙角之切线丁戊若甲乙赤道之正甲丑与丙甲距纬之切线子甲也
　　一　半径全数　卯丁　句
　　二　乙角正切　丁戊　股
　　三　赤道正　甲丑　句
　　四　距纬正切　子甲　股
　　若先有丙甲距纬而求甲乙赤道则反用之为乙角之切线戊丁与半径丁夘【或用半径为一率则为半径夘午与乙角之余切午庚】若丙甲距纬之切线子甲与甲乙赤道之正甲丑也一　乙角正切　戊丁　半径全数　卯午　股二　半径全数　丁夘　乙角余切　午庚　句
　　三　距纬正切　子甲　　　　　　　　股
　　四　赤道正　甲丑　　　　　　　　句
　　右子甲丑形用法
　　论曰以上四法厯书所有但于图増一夘午庚句股形则互视之理更明
　　假如有丙乙黄道距二分之度径求甲乙赤道同升度法为半径夘癸与乙角之余夘巳若丙乙黄道之切线酉乙与甲乙赤道之切线未乙也
　　一　半径全数　夘癸　
　　二　乙角余　卯巳　句
　　三　黄道正切　酉乙　
　　四　赤道正切　未乙　句
　　若先有甲乙赤道而求其所当黄道丙乙法为半径丁夘与乙角之割线戊夘若甲乙赤道之切线未乙与丙乙黄道之切线酉乙也
　　一　半径全数　丁夘　句
　　二　乙角正割　戊夘　
　　三　赤道正切　未乙　句
　　四　黄道正切　酉乙　
　　论曰以上两条酉未乙形用法予所补也有此二法黄赤道可以自相求而正角弧形之用始备矣外此仍有三弧割线余之用具如别纸
　　十余年前曽作弧三角所成句股书一册稿存儿辈行笈中觅之不可得也庚辰年乃复作此至辛己夏复得旧稿为之惘然然其理固先后一揆而説有详略可以互明不妨并存以征予学之进退因思古人毕生平之力而成一事良自不易世有子云或不以覆瓿置之乎康熙辛己七夕前两日勿庵梅文鼎识是日也爲立秋之辰好雨生凉炎歊顿失稍简残帙殊散人懐














　　甲乙丙正弧三角形即测量全义第七卷原图稍为酌定又増一酉未乙形














　　测员之用甚博非止黄赤也然黄道赤道南北极二分二至诸名皆人所习闻故仍借用其号以便识别案图中句股形凡五皆形相似
　　其一癸巳夘形
　　以癸卯半径为【即黄道半径】癸巳正为股【即黄赤大距弧之正】巳夘余为句【即黄赤大距弧之余】
　　其二戊丁夘形
　　以戊夘割线为【即黄赤大距弧之正割线】戊丁切线为股【即黄赤大距弧之正切线】丁夘半径为句【即赤道半径】
　　以上二句股形生于黄赤道之大距度乃总法也两句股形一在浑体之内一出其外同用夘角【即黄道心亦即春分角】
　　其三丙辛壬形
　　以丙壬正为【即黄经乙丙弧之正以丙夘黄道半径为其全数而夘壬其余】丙辛正为股【即黄赤距纬丙甲弧之正亦以丙夘黄道半径为其全数而辛夘其余】辛壬横线为句
　　法于赤道平面上作横线聨两余成夘壬辛平句股形此形以距纬余【夘辛】为黄经余【夘壬】为股而辛壬其句也此辛壬线既为两余平句股形之句亦即能为两正立句股形之句矣厯书以辛壬为丙辛之余误也然则当命为何线曰此非八线中所有乃立三角体之楞线也
　　其四子甲丑形
　　以子丑斜线为【此亦立三角体之楞线也非八线中之线】子甲切线为股【即黄赤距纬弧之正切线以赤道半径甲夘为其全数而子夘其割线也】甲丑正为句【即赤经乙甲弧之正亦以赤道半径甲夘为其全数而丑夘其余也】
　　其五酉未乙形
　　以酉乙切线为【即黄经丙乙弧之正切线以黄赤半径夘乙为其全数而酉夘其割线也】酉未立线为股【此亦立三角之楞线非八线中之线】未乙切线为句【即赤经乙甲弧之正切线亦以黄赤半径夘乙为其全数而未夘其割线也】
　　以上三句股形生于设弧之度第三形在浑体之内第四形半在浑体之内而出其外第五形全在浑体之外
　　问既在体外其状何如曰设浑圆在立方之内而以两极居立方底葢之心以乙春分居立方立面之心则黄赤两经之切线酉乙未乙皆在方体之立面而未乙必为句酉乙必为于是作立线聨之即成酉未乙句股形矣此一形厯书遗之予所补也【详堑堵测量】
　　论曰此五句股形皆同角故其比例等然与弧三角真同者乙角也
　　第一【癸巳夘形】第二【戊丁夘形】两形皆乙角原有之八线即春秋分角也其度则两至之大距也
　　或先有角以求边则以此两形中线例他形中线得线则得边矣
　　或先有边以求角则以他形中线例此两形中线得线则亦得角矣【盖夘角即乙角也○若欲求丙角则以丙角当乙角如法求之】
　　第三形【丙辛壬形】以黄经之正【丙壬】黄赤距度之正【丙辛】为与股是以黄经与距纬相求
　　或先有乙角有黄经以求距纬【用乙角实用壬角下同】
　　或先有乙角有距纬以求黄经
　　或先有黄经距纬可求乙角亦可求丙角
　　第四形【子甲丑形】以黄赤距纬之切线【子甲】赤经之正【甲丑】为股与句是以距纬与赤经相求
　　或先有乙角有赤经以求距纬【用乙角实用丑角下同】
　　或先有乙角有距纬以求赤经
　　或先有赤经距纬可求乙角亦可丙角
　　第五形【酉未乙形】以赤经之正切【未乙】黄经之正切【酉乙】为句与是黄赤经度相求
　　或先有乙角有黄经以求赤道同升度
　　或先有乙角有赤道同升以求黄经
　　或先有黄赤二经度可求乙角亦可求丙角
　　又论曰诸句股形所用之夘壬丑乙四角实皆乙角何也侧望则弧度皆变正而体心夘作直线至乙为夘壬丑乙线即半径也今以侧望之故此半径直线化为一防则乙角即夘角亦即壬角亦即丑角矣














　　癸丁为乙角之度【即黄赤大距二至纬度】癸乙为黄道半径丁乙为赤道半径戊丁为乙角切线癸巳为乙角正戊乙爲乙角割线已乙为乙角余癸巳乙戊丁乙皆句股形其乙角即夘角
　　丙甲为设弧距度其正丙辛其切线子甲
　　丙乙为所设黄道度其正丙壬【因侧望弧度正成一线】偕距度正丙辛成句股形其乙角即壬角
　　甲乙爲所设赤道同升度其正甲丑【因侧望弧度正成一线】偕距度切线子甲成句股形其乙角即丑角
　　酉乙为所设黄经切线未乙为赤道同升度切线此两线成一酉未乙句股形在体外真用乙角
　　正弧三角形求余角法
　　凡弧三角有三边三角先得三件可知余件与平三角同理前论正弧形以黄赤道为例而但详乙角者因春分角有一定之度人所易知故先详之或疑求乙角之法不可施于丙角兹复为之条析如左【仍以黄道上过极经圏之交角为例】







　　假如有乙丙黄道度有乙甲赤道同升度而求丙交角则爲乙丙之正与乙甲之正若半径与丙角之正也





　　假如有丙甲距度及乙甲同升度而求丙交角则为丙甲之正与乙甲之切线若半径与丙角之切线






　　假如有丙甲距度及乙丙黄道度而求丙交角则为乙丙之切线与丙甲之切线若半径与丙角之余






　　又如有丙交角有乙丙交道度而求乙甲同升度则为半径与丙角之正若乙丙之正与乙甲之正






　　或先有乙甲同升度而求乙丙黄道度则以前率更之为丙角之正与半径若乙甲之正与乙丙之正






　　又如有丙交角有乙甲同升度而求丙甲距度则为丙角之切线与半径若乙甲之切线与丙甲之正






　　或先有丙甲距度而求乙甲同升度则以前率更之为半径与丙角切线若丙甲正与乙甲切线






　　又如有丙交角有乙丙黄道度求丙甲距度则为半径与丙角余若乙丙切线与丙甲切线






　　或先有丙甲距度而求乙丙黄道则以前率更之为丙角余与半径若丙甲切线与乙丙切线






　　论曰求丙角之法一一皆同乙角更之而用丙角求余边亦如其用乙角也所异者乙角定为春分角则其度不变丙角为过极经圏交黄道之角随度而移【交角近大距则甚大类十字角近春分只六十六度半弱中间交角度度不同他亦然皆逐度变丙角】有时大于乙角有时小于乙角【乙角不及半象限则丙角大乙角过半象限则丙角有时小】故必求而得之又论曰丙交角既随度移而甲角常为正角何也凡球上大圏相交成十字者必过其极今过极经圏乃赤道之经线惟二至时则此圏能过黄赤两极其余则但过赤道极而不能过黄道极故其交黄道也常为斜角【即丙角】交赤道则常为正角【即甲角】
　　又论曰丙角与乙角共此三边【一乙丙黄道一乙甲赤道一丙甲距度】其所用比例者亦共此三边之八线【三边各有正亦各有切线】而所成句股形遂分两种可互观也
　　乙角所成诸句股皆以戊丁夘为例
　　内角所成诸句股皆以亥辰夘为例
　　并如后图
















　　如图丙角第一层句股兊乙心形即乙角之壬丙辛也在乙角两正交于丙在丙角两正交于乙皆与股之比例而同不同股【乙角丙角并以乙丙黄道正为而乙角所用之股为丙甲正丙角所用则乙甲正皆正也而同股别】
　　丙角第二层句股女甲亢形即乙角之子甲丑也乙角丙角并以一正一切线交于甲为句与股之比例而所用相反【乙角于乙甲用正于丙甲用切线丙角则于乙甲用切线于丙甲用正皆乙甲丙甲两弧之正切线而所用逈别】
　　丙角第三层句股艮丙氐形即乙角之酉乙未也在乙角以两切线聨于乙在丙角以两切线交于丙皆与句之比例而同不同句【乙丙两角并以乙丙切线为而乙角以乙甲切线为句丙角以丙甲切线为句皆切线也而同句别】












　　球面弧三角形弧角同比例解
　　第一题
　　正弧三角形以一角对一边则各角正与对边之正皆为同理之比例




　　如图乙甲丙弧三角形【甲为正角】　法为半径与乙角之正若乙丙之正与丙甲之正更之则乙角之正角与对边丙甲之正若半径与乙丙之正也又丙角之正与其对边乙甲之正亦若半径与乙丙之正也合之则乙角之正与其对边丙甲之正亦若丙角之正与其对边乙甲之正
　　论曰乙丙两角与其对边之正既并以半径与乙丙为比例则其比例亦自相等而两角与两对边其正皆为同比例
　　又论曰甲为正角其度九十而乙丙者甲正角所对之边也半径者即九十度之正也以半径比乙丙之正即是以甲角之正比对边之正故以三角对三边皆为同比例
　　第二题
　　凡四率比例二宗内有二率三率之数相同则两理之首末二率为互视之同比例【即斜弧比例之所以然故先论之】
　　假如有甲乙丙丁四率甲【四】与乙【八】若丙【六】与丁【十二】皆加倍之比例也
　　又有戊乙丙辛四率戊【二】与乙【八】若丙【六】与辛【二十四】皆四倍之比例也
　　此两比例原不同理特以两理之第二第三同为乙【八】丙【六】故两理之第一第四能互用为同理之比例【先理之第一甲四与次理之第四辛二十四若次理之第一戊二与先理之四丁十二皆六倍之比例也】








　　论曰凡二率三率相乘为实首率为法得四率今两理所用之实皆乙【八】丙【六】相乘【四十八】之实惟甲【四】为法则得十二若戊【二】为法则得二十四矣法大者得数小法小者得数大而所用之实本同故互用之即为同理之比例也
　　试以先理之四率更为首率其理亦同【丁与辛若戊与甲皆加倍比例】若反之令两四率并为首率亦同【甲与戊若辛与丁皆折半比例】并如后图








　　第三题
　　斜弧三角形以各角对各边其正皆为同比例






　　乙丙丁斜弧三角形任从乙角作乙甲垂弧至对边分元形为两正角形甲为正角
　　依前正角形论各对边之正与所对角之正比例皆等
　　乙甲丁形丁角正与乙角正若半径【即甲角正】与丁乙正是一理也
　　乙甲丙形丙角正与乙甲正若半径与乙丙正是又一理也
　　两理之第二同为乙甲第三同为半径则两理之首末二率为互视之同比例故丁角之正与乙丙之正若丙角之正与丁乙之正也
　　又如法从丁角作丁戊垂弧至对边分两形而戊为正角则乙角正与丁丙正亦若丙角正与乙丁正　又从丙作垂弧分两形而壬为正角则乙角与丁丙亦若丁角与乙丙
　　一　丁角正　　　丙角正








　　乙丙丁斜弧三角形丁为钝角　法从乙角作乙甲垂弧于形外亦引丙丁弧防于甲成乙甲丁虚形亦凑成乙甲丙虚实合形甲为正角





　　乙甲丁形丁角之正与乙甲边若半径与乙丁边正一理也　乙甲丙形丙角之正与乙甲边若半径与乙丙正又一理也　准前论两理之第二第三既同则丁角正与乙丙正若丙角正与乙丁正也
　　论曰丁角在虚形是本形之外角也何以用为内角曰凡钝角之正与外角之正同数故用外角如本形角也
　　若用乙角与丁丙边则作丙庚弧于形外取庚正角其理同上或作丁戊垂弧于形内取戊正角分两形则如前法并同





　　用法
　　凡弧三角形【不论正角斜角】但有一角及其对角之一弧则其余有一角者可以知对角之弧而有一弧者亦可以知对弧之角皆以其正用三率比例求之




　　假如乙丁丙三角形先有丁角及相对之乙丙弧则其余但有丙角可以知乙丁弧有乙角可以知丁丙弧此为角求弧也若有乙丁弧亦可求丙角有丁丙弧亦可求乙角此为弧求角也
　　一　丁角正　　　　　一　乙丙正
　　二　乙丙正　　　　　二　丁角正
　　三　丙角正　乙角正　三　乙丁正　丁丙正四　乙丁正　丁丙正　四　丙角正　乙角正















　　厯算全书巻七
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书巻八
　　宣城梅文鼎撰
　　弧三角举要巻三
　　斜弧三角形作垂弧説
　　正弧形有正角如平三角之有句股形也斜弧形无正角如平三角之有锐钝形也平三角锐钝二形并以虚线成句股故斜弧形亦以垂弧成正角也正弧形以正等线立算句股法也斜弧形仍以正角立算亦句股法也
　　斜弧三角用垂弧法
　　垂弧之法有三其一作垂弧于形内则分本形为两正角形其二作垂弧于形外则补成正角形其三作垂弧于次形
　　总法曰三角俱锐垂弧在形内一钝二鋭或在形内或在形外【自钝角作垂弧则在形内自锐角作垂弧则在形外】两钝一锐或三角俱钝则用次形其所作垂弧在次形之内之外【次形无钝角垂弧在其内有钝角垂弧在其外若破钝角亦可在内】






　　第一法垂弧在形内成两正角【内分五支】
　　设甲乙丙形有丙鋭角有角旁相连之乙丙甲丙二边求对边及余两角





　　法于乙角【在先有乙丙边之端乃不知之角】作垂弧【如乙丁】至甲丙边分甲丙边为两即分本形为两而皆正角【凡垂弧之所到必正角也角不正即非垂弧故所分两角皆正后仿此】　一乙丁丙形此形有丁正角丙角乙丙边为两角一边可求丁丙边【乃丙甲之分】乙丁边【即垂弧】及丁乙丙角【即乙分角】　次乙丁甲形有丁正角甲丁边【甲丙内减丁丙其余丁甲】乙丁边为一角两边可求乙甲边甲角及丁乙甲分角　末以两乙角并之成乙角

　　或如上图丁甲角端作垂弧至乙丙边分乙丙为两亦同





　　右一角二边而先有者皆角旁之边为形内垂弧之第一支【此所得分形丁丙边必小于元设边即垂弧在形内而甲为鋭角】
　　设甲乙丙形有丙锐角有角旁相连之丙乙边及与角相对之乙甲边求余两角一边






　　法于不知之乙角【在先有二边之中】作乙丁垂弧分两正角形一乙丙丁形此形有丁正角有丙角有乙边边可求乙丁分线及所分丁丙边及丁乙丙分角　次乙甲丁形此形有丁正角有乙丁边有乙甲边可求甲角及丁乙甲分角丁甲边　末以两分角【丁乙丙及丁乙甲】并之成乙角以两分边【丁丙及丁甲】并之成甲丙边
　　右一角二边而先有对角之边为形内垂弧之第二支
　　设甲乙丙形有乙丙二角有乙丙边【在两角之间】求甲角及余边






　　法于乙角作垂弧分两形并如前【但欲用乙丙边故破乙角存丙角】一乙丙丁形有丁正角丙角乙丙边可求乙丁边丁丙边丁乙丙分角　次乙丁甲形有乙丁边丁正角丁乙甲分角【原设乙角内减丁乙丙得丁乙甲】可求乙甲边甲角及甲丁边末以甲丁并丁丙得甲丙边



　　或于丙角作垂弧亦同







　　若角一钝一鋭即破钝角作垂线其法并同




　　右二角一边而边在两角之间不与角对为形内垂弧之第三支【此必未知之角为锐角则垂弧在形内】

　　设甲乙丙形有丙甲二角有乙甲边【与丙角相对与甲角相连】求乙角及余二边






　　法于乙角【为未知之角】作垂弧分为两形而皆正角　一乙丁甲形有丁正角甲角乙甲边可求甲丁边乙丁边丁乙甲分角　次丁乙丙形有丁正角乙丁边丙角可求乙丙边丁丙边丁乙丙分角　末以甲丁丁丙并之成甲丙边　以两分角【丁乙甲丁乙丙】并之成乙角
　　右二角一边而先有对角之边为形内垂弧之第四支【此先有二角必俱锐则垂弧在内】

　　设乙甲丙形有三边而内有【乙甲乙丙】二边相同求三角







　　法从乙角【在相同二边之间】作垂弧至丙甲边【乃不同之一边】分两正角形【其形必相等而甲丙线必两平分】　乙丙丁形有丁正角乙丙边丁丙边【即甲丙之半】可求丙角乙分角【乃乙角之半】倍之成乙角而甲角即同丙角【不须再求】
　　右三边求角而内有相同之边故可平分是为形内垂弧之第五支【此必乙丙乙甲二边并小在九十度内若九十度外甲丙二角必俱钝当用次形详第三又法】

　　第二法垂弧在形外补成正角【内分七支】
　　设甲乙丙形有丙锐角有夹角之两边【乙丙甲丙】求乙甲边及余两角





　　法自乙角【在先有边之一端】作垂弧【乙丁】于形外引丙甲边至丁补成正角形二【一丙乙丁半虚半实形二甲乙丁虚形】　先算丙乙丁形此形有乙丙边丙角有丁正角可求丙乙丁角【半虚半实】乙丁边【形外垂弧】丁丙边【丙甲引长边】　次甲乙丁虚形有丁正角有乙丁边甲丁边【丁丙内减内甲得甲丁】可求乙甲边甲角及甲乙丁虚角末以甲角减半周得原设甲角以甲乙丁虚角减丙乙丁角得原设丙乙甲角右一角二边角在二边之中而为锐角是为形外垂弧之第一支【此所得丁丙必大于原设边即垂弧在形外而甲为钝角】
　　设乙甲丙形有甲钝角有角旁之【丙甲乙甲】二边求乙丙边及余二角






　　法于乙角作垂弧【乙丁】引丙甲至丁补成正角　先算乙丁甲虚形此形有丁正角甲角【即原设甲角减半周之余亦曰外角】有乙甲边可求甲丁边乙丁边丁乙甲虚角　次丁乙丙形有乙丁边丁丙边【甲丙加丁甲得之】丁正角可求乙丙边丙角丙乙丁角　末于丙乙丁内减丁乙甲虚角得原设乙角


　　或从丙作垂弧至戊引乙甲边至戊补成正角亦同



　　右一角二边角在二边之中而为钝角乃形外垂弧之第二支


　　设乙甲丙形有丙锐角有角旁之乙丙边有对角之乙甲边求丙甲边及余二角






　　法从乙角作垂弧至丁成正角【亦引丙甲至丁】　先算丙乙丁形有丁正角丙角乙丙边可求诸数【乙丁边丁丙边丙乙丁角】　次丁乙甲虚形有丁正角乙丁乙甲二边可求诸数【乙甲丁角甲乙丁角甲丁边】　末以所得虚形甲角减半周得原设甲钝角于丙乙丁内减虚乙角得原设乙角于丁丙内减甲丁得原设丙甲
　　右一角二边角有所对之边而为锐角乃形外垂弧之第三支【此必甲为钝角故垂弧在外】
　　设乙甲丙形有甲钝角有角旁之甲丙边及对角之乙丙边求乙甲边及余二角






　　法于丙角作垂弧至戊补成正角　先算虚形【甲丙戊】有戊正角甲角【甲钝角减半周之余】甲丙边可求诸数【丙戊边甲戊边丙虚角】次虚实合形【乙丙戊】有戊正角丙戊边乙丙边可求原
　　设乙角及诸数【乙丙戊角乙戊边】　末以先得虚形数减之得原设数【丙角内减丙虚角得原设丙角乙戊内减甲戊虚引边得原设乙甲边】
　　右一角二边角有所对之边而为钝角乃形外垂弧之第四支【此先得钝角垂线必在外】

　　设乙甲丙形有丙甲二角【一锐一钝】有丙甲边在两角之中







　　法于丙锐角作垂弧至丁【在甲钝角外】补成正角　丁丙甲虚形有丁正角甲外角丙甲边可求诸数【丙丁边甲丁边丙虚角】次乙丙丁形【半虚实】有丁正角丙丁边丙角【以丙虚角补原设丙】
　　【角得丁丙乙角】可求原设乙丙边乙角及乙甲边【求得乙丁边内减虚形之甲丁边得原设甲乙边】
　　右二角一边边在两角间为形外垂弧之第五支【此亦可于甲钝角作垂弧则在形内法在第一法之第三支】

　　设乙甲丙形有乙甲二角【乙锐甲钝】有丙甲边与乙锐角相对【钝角相连】






　　法于丙锐角作垂弧至戊【在丙甲边外】补成正角　甲戊丙虚形有戊正角有丙甲边甲角【原设形之外角】可求诸数【丙戊甲戊二边丙虚角】　次乙丙戊形有戊正角乙角丙戊边可求丙角【求得乙丙戊角内减丙虚角得元设丙角】乙丙边乙甲边【求到乙戊边内减甲戊得乙甲】右二角一边而边对鋭角为形外垂弧之第六支



　　设乙甲丙形有乙锐角甲钝角有丙乙边与甲钝角相对【锐角相连】






　　法于丙锐角作垂弧至戊【在甲钝角外】补成正角　乙丙戊形有戊正角乙角乙丙边可求诸数【丙戊乙戊二边乙丙戊角】　次甲丙戊虚形有戊正角甲外角丙戊边可求原设丙甲边甲乙边【求到戊甲虚边以减乙戊得原设乙甲】丙角【求到丙虚角以减乙丙戊角得原设丙角】
　　右两角一边而边对钝角为形外垂弧之第七支


　　第三垂弧又法　用次形【内分九支】
　　设乙甲丙形有乙丙二角有乙丙边在两角间而两角并钝求余二边及甲角





　　法引丙甲至己引乙甲至戊各满半周作戊己边与乙丙等而己与戊并乙丙之外角成甲戊己次形依法作垂弧于次形之内【如己丁】分为两形【一己丁戊一己丁甲】可求乙甲边【以己丁戊分形求到丁戊以己丁甲形求到甲丁合之成甲戊以减半周即得乙甲】丙甲边【以己丁甲分形求到己甲以减半周即得丙甲】甲角【以己丁甲分形求到甲交角】
　　右二角一边边在角间而用次形为垂弧又法之第一支
　　论曰旧説弧三角形以大边为底底旁两角同类垂弧在形内异类垂弧在形外由今考之殆不尽然盖形内垂弧分底弧为两成两正角形所用者锐角也【底旁原有两锐角分两正角形则各有两锐角】形外垂弧补成正角形所用者亦锐角也【底旁原有一锐角补成正角形则虚实两形各有两锐角】故惟三锐角形作垂弧于形内一钝两锐则垂弧或在形内或在形外若两钝一鋭则形内形外俱不可以作垂弧【垂弧虽有内外而其用算时并为一正角两锐角之比例若形有两钝角则虽作垂弧只能成一正一钝一锐之形无比例可求则垂弧为徒设矣】故必以次形通之而所作垂弧即在次形不得谓之形内然则同类之説止可施于两锐【若两钝虽亦同类而不可于形内作垂弧】异类之説止可施于一钝两锐【若两钝一锐而底弧之旁一钝一锐虽亦异类然不可于形外作垂弧】非通法矣【两钝角不用次形垂弧之法己穷况三钝角乎】
　　又论曰以垂弧之法征之则大边为底之说理亦未尽盖钝角所对边必大既有形外立垂线垂弧之法则钝角有时在下而所对之边在上矣不知何术能常令大边为防乎此尤易见

　　设乙甲丙形有丙甲二角有乙甲边与丙角相对而两角俱钝求乙角及余边






　　如法引甲乙丙乙俱满半周防于己成丙甲己次形作己丁垂弧于次形内分次形为两可求乙角【依法求到分形两己角合之为次形己角与乙对角等】甲丙边【求到分形甲丁及丁丙并之即甲丙】乙丙边【求到次形己丙以减半周得之】
　　右二角一边边与角对而用次形为垂弧又法之第二支此三角俱钝也或乙为鋭角亦同


　　设乙甲丙形有乙丙乙甲两边有乙角在两边之中







　　法用甲乙戊次形【有乙甲边有乙戊边为乙丙减半周之余有乙外角】作甲丁垂弧分为两形可求丙甲边及余两角【以乙甲丁分形求到丁乙及甲分角人以甲戊丁形求到甲戊以减半周为丙甲又得甲分角并先所得成甲角即甲外角又得戊角即丙对角】右二边一角角在二边之中而用次形为垂弧又法之第三支
　　或丙为钝角则于次形戊角作垂弧法同上条


　　设乙甲丙形有丙角有甲丙边与角连有乙甲边与角对






　　法用甲己戊次形【甲己为甲乙减半周之余甲戊为甲丙减半周之余戊角为丙之外角】作垂弧【甲丁】于内分为两形可求丙乙边及余两角【以甲丁戊分形求丁戊及甲分角又以甲丁己形求得丁己以并丁戊成己戊即丙乙也又得分角以并先得分角即甲交角也又得己角即乙外角也】
　　右二边一角角与边对而用次形为垂弧又法之第四支若甲为钝角亦同
　　论曰先得丙钝角宜作垂弧于外而乙亦钝角不可作垂弧故用次形
　　设乙甲丙形有三边内有【乙甲丙甲】二边相同而皆为过弧求三角






　　法引相同之二边各满半周作弧线聨之成戊甲己次形如法作甲丁垂弧分次形为两【其形相等】可求相同之二角【任以甲丁戊分形求到戊角以减半周得乙角亦即丙角】及甲角【求到甲半角倍之成甲角】右三边求角内有相同两大边为垂弧又法之第五支　若甲为鋭角亦同
　　以上垂弧并作于次形之内


　　设乙甲丙形有丙甲二钝角有甲丙边在两角间







　　法引乙丙乙甲满半周防于戊成甲戊丙次形自甲作垂弧与丙戊引长弧防于丁补成正角可求乙甲边乙丙边乙角【先求丙甲丁形诸数次求甲戊丁得甲戊以减半周为甲乙又以丁戊减先得丁丙得丙戊以减半周为乙丙又求得戊虚角减半周为戊角即乙对角】
　　右两钝角一边边在角间而于次形外作垂弧为又法之第六支


　　或自丙角作垂弧亦同







　　设乙甲丙形有乙甲二钝角有甲丙边与角对







　　法引设边成丙戊甲次形【有甲外角有戊钝角为乙对角有丙甲边】如上法作丙丁垂弧引次形边防于丁可求乙丙边【先求甲丁丙形诸数次丙丁戊虚形求到丙戊以减半周为乙丙】乙甲边【先求到丁甲以虚线丁戊减之得戊甲即得乙甲】丙角【先求到甲丙丁角内减丙虚角得丙外角即得元设丙角】
　　右二角一边边与角对垂弧在次形外为又法之第七支


　　设乙甲丙形有丙钝角有角旁之两边【丙乙丙甲】







　　法用甲戊丙次形作甲丁垂弧引丙戊防于丁可求乙甲边及甲乙二角【先以甲丁丙形求到诸数再以甲丁戊虚形求甲戊即得乙甲又甲虚角减先得甲角成甲外角又戊虚角即乙外角】
　　右二边一角角在二边之中垂弧在次形外为又法之第八支



　　设乙甲丙形有甲钝角有一边与角对【乙丙】一边与角连【丙甲】






　　法用丙戊甲次形自丙作垂弧与甲戊引长边防于丁可求乙甲边及余两角【依法求到甲戊即得乙甲求戊角即乙角以丙虚角减先得丙角即丙外角】
　　右二边一角角有对边垂弧在次形外为又法之第九支
　　以上垂弧并作于次形之外
　　论曰三角俱钝则任以一边为底其两端之角皆同类矣今以次形之法求之而垂弧尚有在次形之外者益可与前论相发也















　　弧三角举要卷四
　　弧三角用次形法
　　次形之用有二
　　正弧三角斜弧三角并有次形法而其用各有二其一易大形为小形则大边成小边钝角成锐角其一易角爲弧易弧为角则三角可以求边亦二边可求一边


　　第一正弧三角形易大为小　用次形







　　如图戊己甲乙半浑圜以【戊丙甲己丙乙】两半周线分为弧三角形四【一戊丙乙二己丙戊三己丙甲并大四乙丙甲为最小】今可尽易为小形一戊丙乙形易为乙甲丙形【戊丙减半周余丙甲又戊乙减半周余乙甲而乙丙为同用之弧则三边之正同也乙丙甲角为戊丙乙外角甲乙丙为戊乙丙外角戊角又同甲角则三角之正同也故算甲丙乙即得戊丙乙】











　　二己丙戊形易为乙甲丙形【乙甲己及甲己戊并半周内各减己甲则乙甲同己戊而乙丙于己丙及甲丙于戊丙皆半周之余又甲戊并正角丙为交角而乙角又为己角之外角故算乙丙甲得己丙戊】
　　三己丙甲形易为乙丙甲形【乙甲为己甲减半周之余乙丙为丙己减半周之余而同用甲丙又次形丙角为元形之外角乙角同己角甲同为正角故算乙丙甲得己丙甲】
　　用法
　　凡正弧三角内有大边及钝角者皆以次形立算但于得数后以次形之边与角减半周即得元形之大边及钝角【其元形内原有小边及锐角与次形同者径用得数命之不必复减半周】斜弧同以上易大形为小形而大边成小边钝角成鋭角为正弧三角次形之第一用【大边易小钝角易鋭则用算画一算理易明其算例并详第二用】




　　第二正弧三角形弧角相易　用次形【内分四支】
　　一乙甲丙形易为丁丙庚次形






　　解曰丁如北极　戊己壬甲如赤道圈　己庚乙如黄道半周　辛丁壬如极至交圈【壬如夏至辛如冬至】　戊丁甲如所设过极经圈　乙如春分己如秋分并以庚壬大距爲其度　丙如所设某星黄道度　丙乙如黄道距春分度其余丙庚即黄道距夏至为次形之一边　丙甲如黄赤距度其余丙丁即丙在黄道距北极度为次形又一边　庚丁如夏至黄道距北极而为乙角余度是角易为边也【壬庚为乙角度其余庚丁】是为次形之三边








　　又丙交角如黄道上交角　庚正角如黄道夏至　甲乙如赤道同升度其余壬甲如赤道距夏至即丁角之弧是边易为角也则次形又有三角
　　用法
　　假如有丙交角乙春分角而求诸数是三角求边也【乙丙两角幷甲正角而三】法为丙角之正与乙角之余若半径与丙甲之余得丙甲边可求余边
　　一　丙角正　　　　　　　丙角正
　　二　乙角余　　　　　　　丙角正
　　三　半径【甲角　　　在次形】　半径【庚角】
　　四　甲丙余　　　　　　　丁丙正
　　右以三角求边也若三边求角反此用之
　　若先有乙丙边乙甲边而求甲丙边则为乙甲余【即次形丁角正】与乙丙余【即庚丙正】若半径【甲角即次形庚角】与甲丙余【即丁丙正】
　　或先有乙丙边甲丙边而求乙甲边则为甲丙余【即丁丙正】与乙丙余【即庚丙正】若半径【甲角即庚角】与乙甲余【即丁角正】
　　或先有乙甲边甲丙边而求乙丙边则为半径【甲角即庚角】与甲丙余【即丁丙正】若乙甲余【即丁角正】与乙丙余【即庚丙正】
　　右皆以两弧求一弧而不用角也
　　以上爲乙甲丙形用次形之法本形三边皆小一正角偕两锐角次形亦然所以必用次形者为三角求边之用也是为正弧三角次形第二用之第一支






　　二己丙甲形【甲正角余二角丙钝己锐丙甲边小余二边并大】易为丁丙庚次形






　　法曰截己甲于壬截己丙于庚使己壬己庚皆满九十度作壬庚丁象限弧又引丙甲边至丁亦满象限而成丁丙庚次形此形有丁丙边为丙甲之余有庚丙边为己丙之余【凡过弧内去象限其余度正即过弧之余故己丙内减己庚而庚丙为其余弧】有庚丁边为己角之余乃角易为边也【庚与壬皆象限即庚壬为己角之度而丁庚为其余】又有丙锐角爲元形丙钝角之外角有庚正角与元形甲角等【壬庚既为己角之弧则壬与庚必皆正角】有丁角为己甲边之余【己甲过弧以壬甲为余度説见上文】乃边易为角也
　　用法
　　假如有甲正角己锐角丙钝角而求丙甲边法为丙钝角之正【即次形丙锐角正盖外角内角正同用也】与己角之余【即次形丁庚边之正】若半径【即次形庚正角之正】与丙甲边之余【即次形丁丙边】




　　既得丙甲可求己丙边　法为半径与丙角余若甲丙余切【次形为丁丙正切】与己丙余切【次形为庚丙正切】得数以减半周为己丙下同【凡以八线取弧角度者若系大边钝角皆以得数与半周相减命度后仿此】求己甲边　法为己角之余【即庚丁正】与丙角之正若己丙之余【即庚丙正】与己甲之余【即丁角正其弧壬甲】
　　右三角求边
　　又如有己甲己丙两大边求丙甲边　法为己甲余【即丁角正】与己丙余【即庚丙正】若半径与丙甲余【即丁丙正】
　　或有己甲丙甲两边求己丙大边　法为半径与丙甲余【即丁丙正】若己甲余【即丁角正】与己丙余【即庚丙正得数减半周为己丙下同】
　　或有丙甲己二边求己甲大边　法为丙甲余与半径若己丙余与己甲余【即上法之反理】
　　右二边求一边
　　以上己丙甲形用次形之法本形有两大边一钝角次形则边小角锐而且以本形之边易为次形之角本形之角易为次形之边【后二形并同】是为正弧三角次形第二用之第二支





　　三己丙戊形【戊正角己钝角丙锐角己丙与戊丙并大边】易为丁丙庚次形







　　法曰以象限截己丙于庚其余庚丙截戊丙于丁其余丁丙为次形之二边作丁庚弧其度为己角之余【己钝角与外锐角同以壬庚之度取正其余丁庚为己外角之余亦即为己钝角之余】角易边也次形又为元形之截形同用丙角又庚正角与戊角等而丁角即己戊边之余度【试引己戊至辛成象限则戊辛等壬甲皆丁角之度而又为己戊之余】边易角也
　　用法
　　假如有丙锐角己钝角偕戊正角求戊丙边　法为丙角正与己角余【即庚丁正】若半径与戊丙余【即丁丙正】得数减半周为戊丙【下同】
　　既得戊丙可求己丙　法为半径与丙角余若戊丙余切【即丁丙正切】与己丙余切【即庚丙正切】
　　求己戊边　法为戊丙余【即丁丙正】与半径若己丙余【即庚丙正】与己戊余【即丁角正】
　　以上己丙戊形三角求边为正弧三角次形第二用之第三支
　　四乙丙戊形【戊正角乙丙并钝角戊乙戊丙并大边乙丙小边】易为丁丙庚次形






　　法曰引乙丙边至庚满象限得次形丙庚边【即乙丙之余】于丙戊截戊丁象限得次形丁丙边【为戊丙之余】而丁即为戊乙弧之极【戊正角至丁九十度故知之】从丁作弧至庚成次形庚丁边为乙角之余是角易为边也【试引庚丁至辛则辛丁亦象限而辛为正角庚亦正角乙庚乙辛皆象限弧是庚丁辛即乙钝角之弧度内截丁辛象限而丁庚为乙钝角之余度矣】又庚正角与戊等丙为外角丁角为乙戊边之余是边易为角也【乙戊丙截乙辛象限其余戊辛即丁交角之弧】
　　用法
　　假如三角求边以丙角正为一率乙角余为二率半径为三率求得戊丙余为四率以得数减半周为戊丙余并同前
　　以上乙丙戊形三角求边为正弧三角次形第二用之第四支
　　论曰厯书用次形止有乙甲丙形一例若正角形有钝角及大边者未之及也故特详其法
　　又论曰依第一用法大边可易为小钝角可易为锐则第二三四支皆可用第一支之法而次形如又次形矣【己丙甲形己丙戊形乙丙戊形皆易为乙甲丙形而乙甲丙又易为丁丙庚是又次形也】






　　正弧形弧角相易又法　用又次形
　　甲乙丙正弧三角形易为丁丙庚次形再易为丁戊壬形





　　法曰依前法引乙丙边甲乙边各满象限至庚至己作庚己弧引长之至丁亦引甲丙防于丁亦各满象限成丁丙庚次形
　　又引丙庚至辛引丙丁至戊亦满象限作辛戊弧引之至壬亦引庚丁防于壬则辛壬庚壬亦皆象限成丁戊壬又次形此形与甲乙丙形相当
　　论曰乙丙边易为壬角【乙庚及丙辛皆象限内减同用之丙庚则辛庚即乙丙而辛庚即壬角之弧】乙甲边易为丁角【乙甲之余度己甲即丁交角之弧】是次形之两角即元形之两边也乙角易为丁壬边【丁己及庚壬俱象限内减同用之庚丁则丁壬即己庚而为元形乙角之弧】丙角易为戊壬边【丙交之弧弧辛戊其余为次形戊壬】是次形之两边即元形之两角而次形戊丁边即元形丙甲次形戊角即元形甲角
　　用法
　　若原形有三角则次形有戊直角有戊壬丁壬二边可求乙甲边　法为乙角之正【即丁壬正】与半径若丙角之余【即戊壬正】与乙甲之余【即丁角正】
　　求乙丙边　法为乙角之切线【即丁壬切线】与丙角之余切【即戊壬正切】若半径与丙乙之余【即壬角余】既得两边可求余边
　　以上又次形三角求边为正弧三角第二用之又法
　　论曰用次形止一弧一角相易今用又次形则两弧并易为角两角并易为弧故于前四支并峙而为又一法也
　　第三斜弧三角易大为小　用次形【内分二支】
　　一甲乙丙二等边形　三角皆钝






　　如法先引乙丙边成全图又引甲丙甲乙两边出圜周外防于丁又引两边各至圜周【如戊如己】成乙丁丙及戊甲己两小形皆相似而等即各与元形相当而大形易为小形
　　论曰次形【甲戊甲己】二边为元形边减半周之余则同一正次形【己戊】二角为元形之外角亦同一正【甲乙戊为甲乙丙外角而与次形己角等甲丙己为甲丙乙外角亦与次形戊角等】而次形甲角原与元形为交角戊己边又等乙丙边【戊乙丙及己戊乙并半周各减乙戊则戊己等乙丙】故算小形与大形同法惟于得数后以减半周即得大边及钝角之度【置半周减戊甲得甲丙减己甲亦得甲乙又置半周减己锐角得元形乙钝角减戊鋭角亦得元形丙钝角其交角甲及相等之戊己边只得数便是并不用减】













　　论曰凡两大圈相交皆半周故丁丙与丁乙亦元形减半周之余又同用乙丙而乙与丙皆外角丁为对角故乙丙丁形与戊甲己次形等边等角而并与元形甲乙丙相当
　　右二边等形易大为小为斜弧次形第一用之第一支


　　二甲乙丙三边不等形　角一钝二锐







　　如法引乙丙作圜又引余二边【甲乙甲丙】至圜周【己戊】得相当次形己甲戊【算戊甲得甲丙算己甲得甲乙算己戊得乙丙】其角亦一钝二锐【算戊钝角得丙锐角算己鋭角得乙钝角而甲交角一算得之】
　　又戊甲乙形　角一钝二鋭　如法引戊乙作圜又引乙甲至圜周【己】成次形己甲戊与元形相当【算己甲得甲乙算己戊得戊乙又同用戊甲边故相当算甲锐角得甲钝角算戊钝角得戊鋭角算己角即乙角】
　　又甲己丙形　三角俱钝　如上法引丙己作圜又引丙甲至戊成次形己甲戊与元形相当【元形甲丙与戊甲元形己丙与己戊并减半周之余又同用己甲又丙钝角即戊钝角甲己两锐角并元形之外角】
　　右三边不等形易大爲小为斜弧次形第一用之第二支





　　第四斜弧三角形弧角互易　用次形【内分三支】
　　一乙甲丙形【三角俱钝】易为丑癸寅形【一钝二锐】






　　法曰引乙甲作圜次引乙丙至酉引甲丙至未并半周次以甲为心作丁辛癸寅弧乙为心作戊丑癸壬弧丙为心作丑子午寅弧三弧交处别成一丑癸寅形与元形相当而元形之角尽易为边边尽易为角
　　论曰甲角之弧丁辛与次形癸寅等则甲角易为癸寅边【丁癸及辛寅皆象限减同用之辛癸则癸寅同丁辛】乙角之弧己壬与次形丑癸等则乙角易为丑癸边【癸己及丑壬皆象限减同用之癸壬即丑癸同壬己】丙外角之弧午申【引丑午寅至申取亥申与庚子等成午申】与次形寅丑等则丙外角易为寅丑弧【丑午及寅申皆象限各加同用之午寅即午申等丑寅】是元形有三角即次形有三边也　又甲乙边之度易为癸外角【乙己及甲辰皆象限内减同用之甲己则乙甲同己辰为癸外角弧】甲丙边易为寅角【甲辛及丙子皆象限内减同用之丙辛则甲丙等辛子而同为寅角之弧】乙丙边易为丑角【乙壬及午丙皆象限内减同用之丙壬则乙丙等午壬而同为丑角之弧】是元形有三边即次形有三角也
　　又论曰有此法则三角可以求边【既以三角易为次形之三边再用三边求角法求得次形三角即反为元形之三边　三边求角法详别卷】
　　又论曰引丙甲出圜外至申亦引庚亥弧出圜外防于申则庚亥与子申并半周内各减子亥即子庚同亥申而子寅既象弧则寅申亦象弧矣以寅申象弧加午寅与以丑午象限【午壬为丑角之弧故丑午亦象限】加午寅必等而申午者丙外角之度丑寅者次形之边也故丙角能为次形之边也
　　又论曰凡引弧线出圜外者其弧线不离浑圜面幂因平视故为周线所掩稍转其浑形即见之矣但所引出之线原为半周之余见此余线时即当别用一圈为外周而先见者反有所掩如见亥申即不能见子庚故其度分恒必相当亦自然之理也
　　又论曰依第三用法之第二支丙未酉形及丙未乙形丙酉甲形并可易为甲乙丙则又皆以癸丑寅为又次形矣
　　右三角俱锐形弧角相易为斜弧次形第二用之第一支
　　二未丙酉形【三角俱钝】易为丑癸寅形【一钝二锐】







　　法曰引酉未弧作圜又引两边至圜周【如乙如甲】乃以未为心作丁辛癸寅辰弧以酉为心作戊丑癸壬己弧以丙为心作庚子丑寅午申弧亦引丙甲出圜外防于申三弧相交成丑癸寅形此形与元形相当而角尽易为弧弧尽易为角
　　论曰未外角之弧丁辛成次形癸寅弧【癸丁及寅辛皆象限内减同用之癸辛则癸寅即丁辛】酉外角之弧壬己成次形丑癸弧【壬丑及癸己皆象限各减癸壬则丑癸即壬己】丙外角之弧申午成次形寅丑弧【准前论庚亥及子申并半周则申亥等子庚而申寅为象限与午丑象限各减午寅即寅丑同申午】　是三角尽易为边也酉未边成癸外角【酉戊及未丁皆象限各减未戊则丁戊即酉未而为癸外角之弧若以丁戊减戊乙己半周其余丁乙己过弧亦即为癸交角之弧】未丙边减半周其余甲丙成寅角【甲辛及子丙皆象限各减辛丙则辛子即甲丙而为寅角之弧】酉丙边减半周其余乙丙成丑角【午丙及壬乙皆象限各减丙壬则壬午即乙丙而为丑角之弧】是三边尽易为角也【寅角丑角并原边减半周则原边即两外角弧与酉未成癸外角等】故三角减半周得次形三边算得次形三角减半周得原设三边
　　右三角俱钝形弧角相易为斜弧次形第二用之第二支
　　论曰若所设为乙未丙形则未角易为次形癸寅边【径用丁辛子形内以当癸寅不须言外角】乙外角为丑癸边【亦以己壬当丑癸与用酉外角同理】丙角为丑寅边【径以丙交角之弧甲午当丑寅不言外角】　若所设为甲酉丙形则酉角易为丑癸边【己壬径当丑癸不言外角】甲外角为寅癸边【用丁辛当癸寅即甲外角】丙角为丑寅边【亦申午当丑寅不言外角】
　　又论曰此皆大边径易次形不必复言又次
　　三甲乙丙形【一钝角两锐角】易为丑癸寅形







　　如法引甲乙边作全圜引余二边各满半周又以甲为心作丁壬癸丑辰半周以乙爲心作戊庚辛癸寅亥弧以丙为心作己午子丑寅夘弧三弧线相交成丑癸寅次形与元形相当而角为弧弧爲角
　　论曰易甲角为次形丑癸边【于癸丁象限减壬癸成丁壬为甲角之弧于丑壬象限亦减壬癸即成癸丑边其数相等】乙外角为次形癸寅边【于癸戊象限减癸辛成辛戊为乙外角之弧于寅辛象限亦减癸辛即成癸寅边其数相等】丙角为次形丑寅边【于丑午象限减丑子成午子为丙角之弧于寅子象限亦减丑子即成丑寅边其数相等】则角尽为边又甲乙边为癸角【于甲丁象限乙戊象限各减乙丁则戊丁等甲乙而癸角角之弧】乙丙边成寅角【于乙辛及子丙两象限各减丙辛则辛子等乙丙而为寅角之弧】甲丙边为丑外角【于甲壬及午丙两象限各减丙壬则午壬等甲丙而为丑外角之弧】则边尽为角
　　右一钝角两锐角形弧角相易为斜弧次形第二用之第三支
　　论曰若所设为甲丙酉形【三角俱钝而有两大边】则以甲外角为次形丑癸边酉外角为癸寅边丙外角为丑寅边又以三边为次形三外角【并与第二支未丙酉形三钝角同理】　若所设为丙未酉形乙未丙形【并一钝二锐而有两大边】皆依上法可径易为丑癸寅次形观图自明





　　甲乙丙形【三边并大三角并钝】易为次形







　　法以本形三外角之度为次形三边【午己为乙外角之度而与癸壬等丑辛为甲外角之度而与癸寅等申亥为丙外角之度而与寅壬等】以本形三边减半周之余为次形三角【甲乙减半周其余戊乙或子甲而并与辰丁等即癸角之度甲丙减半周其余戊丙而与丑庚等即寅角之度乙丙减半周其余子丙而与午亥等即壬角之度】并同前术论曰此即厯学防通所谓别算一三角其边为此角一百八十度之余者也然惟三钝角或两钝角则然其余则兼用本角之度不皆外角
　　右三角俱钝形弧角相易同第二支【惟三边俱大】
　　子戊丙形【一大边二小边一钝角二锐角】







　　其法亦以次形【癸壬癸寅】二边为本形【子戊】二角之度寅壬边为丙外角之度次形【寅壬】二角为本形二小边之度癸角为大边减半周之度
　　论曰此所用次形与前同而用外角度者惟丙角其子角戊角只用本度为次形之边非一百八十度之减余也　若设戊丙乙形子丙甲形并同【戊丙乙形惟次形癸寅边为戊外角其余癸壬边之度为乙角寅壬边之度为丙角则皆本度子丙甲形惟次形癸壬边为子外角其余寅壬边之度为丙角癸寅边之度为甲角则皆本度】
　　右一钝角二锐角与第三支同【惟为边一大一小】







　　第五斜弧正弧以弧角互易【内分二支】
　　一甲乙丙形【甲乙边适足九十度余二边一大一小角一钝二锐】易为丑癸寅正弧形【癸正角余锐三边并小】





　　法曰引乙丙小边成半周【于乙引至夘补成丙乙夘象限又于丙引至午成丙辛午象限即成半周】作夘亥庚丑寅午以丙为心之半周【截丙甲大边于庚使丙庚与丙乙夘等乃作庚夘弧为丙角之度即庚与夘皆正角依此引至午亦得正角而成半周以丙为心】作甲丑癸辛戊以乙为心之半周【引甲乙象限至戊成半周于甲于戊各作正角聨之即又成半周而截乙辛成象限与乙戊等即辛戊为乙外角度而此半周以乙为心】作乙壬癸寅弧以甲为心【甲戊半周折半于癸成两象限从癸作十字正角弧一端至寅一端至乙成癸乙象限其所截甲壬亦象限即乙壬为甲角之弧而甲为其心】三弧线相交成一丑癸寅次形与本形弧角相易而有正角








　　论曰次形丑寅边即本形丙角之度【丑夘及寅庚皆象限各减丑庚则丑寅即庚夘而为丙角之弧】癸寅边即甲角之度【寅壬及癸乙皆象限各减癸壬则癸寅即壬乙而为甲角之弧】癸丑边即乙外角之度【丑辛及癸戊皆象限各减癸辛则丑癸即辛戊而为乙外角之弧】是角尽易边也又寅角为甲丙边所成【庚丙及壬戊皆象限各减丙壬则寅角之弧庚壬与甲丙减半周之丙戊等】丑角为乙丙边所成【午丙及辛乙皆象限各减辛丙则丑角之弧午辛与乙丙边等】癸正角为甲乙边所成【癸正角内外并九十度而甲乙象限为癸外角弧若减半周则乙戊象限为癸交角弧】是边尽为角而有正角也
　　又辰戊丙形【辰戊边象限余并同前】易为正弧形【并同前法观图自明】







　　乙丙戊形【乙戊边足一象限余并小】易为正角形则丑寅度即丙外角丑癸度即乙角寅癸度即戊角是角为边也又寅角生于丙戊丑角生于乙丙癸正角生于乙戊是边为角





　　辰甲丙形【辰甲象弧余二边大三角并钝】易为正角形则丑寅边为丙外角丑癸边为辰外角寅癸边为甲外角角为边也又寅角生于甲丙丑角生于辰丙而癸正角生于辰甲【并准前条诸论推变】是边为角而且有正角也




　　右本形有象限弧即次形有正角而斜弧变正弧为弧角互易之第一支






　　丙乙甲形【丙正角余两锐角相等边三小相等者二】易为己癸壬次形【角一钝二锐锐相等】






　　法以甲为心作寅己丑半周则甲角之度【子寅弧】成次形一边【己壬】以乙为心作夘己午半周则乙角之度【夘辰弧】成次形又一边【己癸】此所成二边相等以丙为心作亥癸壬未半周则丙角之度【癸壬象限】即为次形第三边　依法平分次形以己壬酉形求壬角得原设甲丙边【壬角之度癸子与甲丙等】乙丙边【壬癸两锐角原同度而癸角之度辰壬与乙丙等故一得兼得也】求半己角倍之成己角以减半周得原设乙甲边【己外角之度午寅或丑夘并与乙甲等】
　　论曰本形有正角次形无正角而有象限弧得次形之象限弧得本形之正角矣
　　若设丙戊丁形【丙正角两钝角同度二大边同度一边小】易为己癸壬次形与上同法惟丁戊用外角
　　若设甲丙戊形【丙正角余一锐一钝而锐角钝角合成半周边二大一小而小边与一大边合成一半周】易为己癸壬次形亦同上法惟甲用外角戊用本角而同度所得次形之边亦同度【甲外角之度子寅成次形巳壬边戊本角乏度辰夘成次形己癸边而四者皆同度】其转求本形也用次形之壬角得甲丙以减半周即得丙戊【或乙丙丁形亦同】
　　右本形有正角而次形无正角爲弧角互易之第二支
　　或三角形无相同之边角而有正角【其次形必有象限边】或无正角而有相同之边角【其次形亦有等边等角】准此论之



　　次形法补遗【角一锐一钝边二大一小】
　　附算例　三角求边　三边求角
　　甲乙丙形【甲角一百二十度乙角一百一十度丙角八十五度为一锐二钝】三角求边





　　如法易为丑寅癸次形【癸寅边六十度当甲角丑癸边七十度当乙角寅丑边当丙角并以角度减半周得之】
　　求甲乙边【即次形癸外角】法以【甲乙】两角正相乗半径除之得数【八一三八○】为一率半径【一○○○○○】为二率【甲乙】两角相较【十度】之矢与丙角减半周【九十五度】大矢相较得数【一○七一九七】为三率求得四率【一三一七二四】爲次形癸角大矢内减半径成余【三一七二四】捡表得癸外角【七十一度三十分】为甲乙边【本宜求癸角以减半周得甲乙今用省法亦同】
　　论曰三角求边而用次形实即三边求角也故其求甲乙边实求次形癸角得癸角得甲乙边矣然则两角正仍用本度者何也凡减半周之余度与其本度同一正也【甲角一百二十度之正八六六○三即次形癸寅边六十度之正乙角一百一十度之正九三九六九即次形丑癸边七十度正】独丙角用余度大矢何也正可同用而矢不可以同用也【丙以外角易为次形丑寅边九十五度其大矢一○八七一六而丙角本八十五度是锐角当用正矢故不可以通用】然则两角较矢又何以仍用本度曰两余度之较与本度同故也【甲角乙角之较十度所易次形之癸寅边丑癸边其较亦十度】所得四率为大矢而甲乙边小何也曰余度故也【甲乙边易为癸外角而四率所得者癸内角也故为甲乙减半周之余度】用余度宜减半周命度矣今何以不减曰省算也虽不减犹之减矣【四率系大矢必先得癸外角七十一度半以减半周得癸内角一百○八度半再以癸内角减半周仍得七十一度半为甲乙边今径以先得癸外角之度为甲乙边其理无二】
　　求甲丙边　如上法以边左右两角正【甲八六六○三丙九九六一九】相乘半径除之得数【八六二七三】为一率半径【一○○○○○】为二率【甲丙】两角相较【三十五度】矢【一八○八五】与乙外角【七十度】矢【六五七九八】相较得数【四七七一三】为三率求得甲丙边半周余度之矢【五五三○四】为四率【捡表得六十三度二十七分】以减半周得甲丙边【一百一十六度三十三分】
　　论曰此亦用次形三边求寅角也【以甲角所易癸寅边丙角所易寅丑边为角旁二边以乙角所易丑癸边为对角之边求得寅角之度辛子与酉丙等即甲丙减半周余度】求乙丙边　如法以边左右两角正【丙九九六一九乙九三九六九】相乘半径除之得数【九三六一二】爲一率半径【一○○○○○】为二率【丙乙】两角较【二十五度】矢【○九三六九】与甲外角【六十度】矢相较【四○六三一】爲三率求得余度矢【四三四○三】为四率【捡表得五十五度三十二分】以减半周得乙丙边【一百廿四度廿八分】
　　论曰此用次形三边求丑角也【丙角易寅丑边乙角易丑癸边为角旁二边甲角易癸寅为对边求得丑角度午壬与未丙等即乙丙边减半周余度】又论曰此所用次形之三边三角皆本形减半周之余度【甲乙同己辰即癸外角度则次形癸角为甲乙边之半周余度也寅角之度子辛与酉丙等甲丙边之余度也丑角之度午壬与未丙等乙丙边之余度也是次形三角皆本形三边减半周之余度矣其次形三边爲本形三角减半周之余己详前注】故所得四率为角之大小矢者皆必减半周然后可以命度若他形则不尽然必须详审







　　如甲未丙形【甲角六十度丙角九十五未角一百一十】易丑寅癸次形则其角易为边用本度者二【甲角弧丁辛六十度易次形癸寅边丙角弧申午九十五度易次形寅丑边】用余度者一【未角弧壬戊一百一十度其半周余度己壬七十度易次形丑癸边】而其边易为角用本度者二【未丙边五十五度三十二分与午壬等成次形丑角甲未边余度未酉七十一度三十分与丁戊等成癸外角则次形癸角一百○八度三十分为甲未边本度】用余者者一【甲丙边一百十六度三十三分其余度酉丙六十三度二十七分与辛子等成次形寅角】若一槩用余度算次岂不大谬
　　又如乙丙酉形【乙角七○丙角九五酉角一二○】用【癸寅丑】次形【前图】求丙酉边
　　如法以边左右两角正【丙九九六一九酉八六六○三】相乗去末五位得数【八六二七三】为一率半径【一○○○○○】为二率以【酉外角丙角】相差【三十五度】矢【一八○八五】与乙角矢【六五七九八】相较【四七七一三】爲三率求得正矢【五五三○四】为四率【次形寅角之矢】捡表得六十三度二十七分为丙酉边
　　论曰此所用四率与前条求甲丙边之数同而边之大小迥异一为余度一为本度也【前条为余度之矢故甲丙边大此条为本度之矢故丙酉边小】又所用矢较亦以不同而成其同【前条以两角相差此则以酉外角与丙角相差不同也而相差三十五度则同前条用乙外角之矢此条用乙本角又不同也而矢数六五七九八则同】其理皆出次形也
　　求酉乙边　如法以两角正【乙九三九六九酉八六六○三】相乗去末五位【得八一三八○】为一率半径为二率【酉外角乙角】相差【十度】之矢与丙角【九十五度】之矢相较【得一○六一九七】为三率求得大矢【次形癸角之矢】为四率【一三一七二四】捡表【得一百○八度三十分】为酉乙边【此与前条求甲乙边参防即见次形用法不同之理如前所论】
　　求乙丙边　与前条同法【因丙乙两内角之正及差度并与两外角同而酉角又同甲角故也】
　　论曰三角求边必用次形而次形之用数得数并有用求度余度之异即此数条可知其槩
　　又论曰在本形为三角求边者在次形为三边求角故此数条即三边求角之例也【余详环中黍尺】


　　垂弧捷法【作垂弧而不用其数故称捷法】　亦为次形双法【用两次形故称双法】设亥甲丁形有甲亥边亥丁边亥角【在二边之中】求甲丁边【对角之边】





　　本法作垂弧分两形先求甲已边次求亥已边分丁巳边再用甲巳丁巳二边求甲丁边
　　今捷法不求甲已边但求亥已边分丁已边即用两分形之两次形以径得甲丁
　　一　亥已余　即次形亥戊正
　　二　亥甲余　即次形亥丙正
　　三　已丁余　即次形辛丁正
　　四　甲丁余　即次形庚丁正
　　法引甲亥边至丙引甲丁边至庚引甲已垂弧至乙皆满象限又引分形边亥已至戊引丁已至辛亦满象限末作辛庚乙丙戊半周与亥已遇于戊与丁已遇于辛成亥丙戊次形与甲已亥分形相当丁亥辛次形与甲已丁分形相当而此两次形又自相当【戊角辛角同以己乙为其度则两角等丙与庚又同为正角则其正之比例皆等】
　　论曰半径与戊角之正若戊亥之正与亥丙之正又半径与辛角【即戊角】之正若辛丁之正与丁庚之正合之则戊亥正与亥丙正亦若辛丁正与丁庚正
　　又论曰辛丁已亥戊如黄道半周辛庚乙丙戊如赤道半周甲如北极辛如春分戊如秋分已乙如黄赤大距即夏至之纬乃二分同用之角度【即戊角辛角之度】亥丙及丁庚皆赤纬甲亥及甲丁皆距北极之度【即赤纬之度】
　　一　戊亥正　黄经　　戊亥为未到秋分之度辛二　亥丙正　赤纬　　丁为已过春分之度似有三　辛丁正　黄经　　不同而二分之角度既同四　丁庚正　赤纬　　故其比例等






　　一　亥已余　　即亥戊正
　　二　亥甲余　　即亥丙正
　　三　已丁余　　即戊丁正
　　四　甲丁余　　即庚丁正
　　论曰此理在前论中盖以同用戊角故比例同也又论曰乙庚丙戊如赤道已丁亥戊如黄道皆象弧戊角如秋分其弧己乙如夏至距纬【此两黄经并在夏至后秋分前其理易见】或先有者是丁钝角甲丁丁亥二边则先求丁巳线【亦用前图】一　丁已余　　即戊丁正
　　二　甲丁余　　即丁庚正
　　三　亥已余　　即亥戊正
　　四　亥甲余　　即亥丙正
　　又论曰假如星在甲求其黄赤经纬则亥丁如两极之距亥角若为黄经则丁角为赤经而亥甲黄纬丁甲赤纬也若丁角为黄经则亥角为赤经而丁甲黄纬亥甲赤纬也【弧三角之理随处可施故举此以发其例】
　　弧三角举要卷五
　　八线相当法引
　　弧三角有以相当立法者何也以四率皆八线也弧三角四率何以皆八线而不用他线【八线但论度他线则有丈尺】浑体故也【弧三角皆在浑员之面】浑体异平而御浑者必以平是故八线之数生于平员而八线之用专于浑员也曷言乎专为浑员曰平三角之角之边皆直线也同在一平面而可以相为比例故虽用八线而四率中必兼他线焉【以八线例他线则用角可以求边以他线例八线则用边可以求角皆兼用两种线】弧三角之角之边皆弧度曲线也不同在平面故非八线不能为比例而四率中无他线焉既皆以八线相比例则同宗半径【有角之八线有边之八线各角各边俱非平面而可以相求者同一半径也】相当互视之法所由以立也错举似纷实则有条不紊故爲论列使有伦次云


　　八线相当法详衍
　　总曰相当分之则有二曰相当曰互视互视又分为二曰本弧曰两弧
　　但曰相当者皆本弧也又分为二曰三率连比例者以全数为中率也其目有三曰四率断比例者中有全数也其目有六凡相当之目九
　　互视者亦相当也皆爲断比例而不用全数若以四率之一与四相乗二与三相乗则皆与全数之自乗等也本弧之互视其目有三两弧之互视其目有九凡互
　　视之目十二
　　总名之皆曰相当其目共二十一内三率连比例三更之则六四率断比例十有八更之反之错而综之则百四十有四共百有五十
　　相当共九
　　一曰正与全数若全数与余割
　　二曰余与全数若全数与正割
　　三曰正切与全数若全数与余切
　　以上三法皆本弧皆三率连比例而以全数为中率
　　四曰正与余若全数与余切
　　五曰余与正若全数与正切
　　六曰正割与正切若全数与正
　　七曰余割与余切若全数与余
　　八曰正割与余割若全数与余切
　　九曰余割与正割若全数与正切
　　以上六法亦皆本法而皆四率断比例四率之内有一率为全数
　　互视共十二
　　一曰正与正切若余切与余割
　　二曰余与余切若正切与正割
　　三曰正与余若正割与余割
　　以上三法亦皆本弧皆四率断比例而不用全数然以四率之一与四二与三相乗则其两矩内形皆各与全数自乗之方形等
　　四曰此弧之正与他弧正若他弧之余割与此弧余割五曰此弧之正与他弧余若他弧之正割与此弧余割六曰此弧之正与他弧正切若他弧之余切与此弧余割七曰此弧之余与他弧余若他弧之正割与此弧正割八曰此弧之余与他弧正若他弧之余割与此弧正割九曰此弧之余与他弧余切若他弧之正切与此弧正割十曰此弧之正切与他弧正切若他弧之余切与此弧余切十一曰此弧之正切与他弧正若他弧之余割与此弧余切十二曰此弧之正切与他弧余若他弧之正割与此弧余切以上九法皆两弧相当率也其爲四率断比例而不用全数则同若以四率之一与四二与三相乗其矩内形亦各与全数自乗之方形等


　　相当法错综之理




　　此三率连比例也首率与中率之比例若中率与末率故以首率末率相乗即与中率自乗之积等
　　假如三十度之正【○五○○○○】与全数【一○○○○○】之比例若全数【一○○○○○】与三十度之余割【二○○○○○】其比例皆为加例也更之则余割【二○○○○○】与全数【一○○○○○】若全数【一○○○○○】与正【○五○○○○】其比例为折半也
　　又如三十度之余【○八六六○三】与全数【一○○○○○】若全数【一○○○○○】与三十度之正割【一一五四七○】更之则正割【一一五四七○】与全数【一○○○○○】若全数【一○○○○○】与余【○八六六○三】也
　　又如三十度之正切【○五七七三五】与全数【一○○○○○】若全数【一○○○○○】与三十度之余切【一七三二○五】更之则余切【一七三二○五】与全数【一○○○○○】若全数【一○○○○○】与正切【○五七七三五】也
　　用法
　　凡三率连比例有当用首率与中率者改为中率与末率假如有四率其一三十度正其二全数改用全数为一率三十度余割为二率其比例同





　　凡四率之前后两率矩内形与中两率矩形等故一与四二与三可互居也




<子部,天文算法类,推步之属,历算全书,卷八>





　　右四率断比例也一率与二率之比例若三率与四率假如三十度之正【○五○○○○】与其余【○八六六○三】若全数【一○○○○○】与其余切【一七三二○五】更之则余切【一七三二○五】与全数【一○○○○○】若余【○八六六○三】与正【○五○○○○】也【第四法】又如三十度之正割【一一五四七○】与其正切【○五七七三○】若全数【一○○○○○】与其正【○五○○○○】更之则全数【一○○○○○】与正割【一一五四七○】若正【○五○○○○】与正切【○五七七三五】也【第六法】又如三十度之余割【二○○○○○】与其正割【一一五四七○】若全数【一○○○○○】与其正切【○五七七三五】更之则正切【○五七七三五】与正割【一一五四七○】若全数【一○○○○○】与余割【二○○○○○】也【第九法余仿此】用法
　　凡四率断比例当用前两率者可以后两率代之假如有四率其一正其二余改用全数为一率余切为二率其比例同互视















　　此本弧中互相视之率也其第一与第四相乗矩第二与第三相乗矩皆与全数自乗方等故其边为互相视之边而相与爲比例皆等
　　假如三十度之正【○五○○○○】与其余割【二○○○○○】相乗【一○○○○○○○○○○】其余【○八六六○三】与其正割【一一五四七○】相乗【一○○○○○○○○弱】皆与全数自乗之方等故以正为一率余为二率正割为三率余割为四率则正【○五○○○○】与余【○八六六○三】若正割【一一五四七○】与余割【二○○○○○】也【第三法】又如三十度之正切【○五七七三五】与其余切【一七三二○五】相乗【一○○○○○○○○弱】亦与全数之方等故以正为一率余切为二率正切为三率余割为四率则正【○五○○○○】与正切【○五七七三五】若余切【一七三二○五】与余割【二○○○○○】也【第一法】或以余为一率余切爲二率正切为三率正割为四率则余【○八六六○三】与余切【一七三二○五】若正切【○五七七三五】与正割【一一五四七○】也【第二法】
　　用法
　　此亦四法断比例故当用前两率者可以后两率代之假如有四率当以正与正切为一率二率者改用余切为一率余割为二率以乗除之其比例亦同余仿此本弧诸线相当约法
　　其一为与股之比例　　反之则如股与全　正割　余切　余割　全　　余　正切　正正　正切　余　全　余割　余切　正割　全其二为与句之比例　　　反之则如句与全　　余割　正切　正割　全　　正　余切　余余　余切　正　全　正割　正切　余割　全其三为句与股之比例　　　反之则如股与句全　　余　余割　余切　全　　正割　正　正切正切　正　正割　全　　余切　余割　余　全右括本弧七十八法








　　如图甲丙甲乙甲丁皆半径全数乙丙为正弧乙丁为余弧乙戊为正庚丙为正切线庚甲为正割线乙己为余辛丁为余切线辛甲为余割线













　　此皆一定比例观图自明
　　外有余切余非与股之比例则借第二比例更之
　　一　甲乙全数【即甲丁】　　辛丁余切


　　四　辛丁余切　　　　甲丁全数
　　全数与余若余割与余切更之而余切与余若余割与全数也余割与全数既为与股则余切与余亦如与股矣
　　正切正非与句之比例则借第一比例更之一　甲乙全数【即甲丙】　　庚丙正切


　　四　庚丙正切　　　　甲丙全数
　　全数与正若正割与正切更之而正切与正若正割与全数也正割与全数既为与句则正切与正亦如与句矣
　　余割正割非句与股之比例则仍借第一比例更之
　　一　余割辛甲　　　　余割辛甲
　　二　全数甲丁【即甲丙】　　正割庚甲
　　三　正割庚甲　　　　全数甲丙
　　四　正切庚丙　　　　正切庚丙
　　余割与全数若正割与正切更之而余割与正割若全数与正切也全数与正切既爲句与股则余割与正割亦如句与股矣
　　【互视自此而分以前为本弧所用共大法三更之则二十有四合相当法则七十有八而总以三率连比例三大法为根】
　　【以后为两弧所用共大法九更之七十有二而仍以本弧之三率连比例为根】


























　　九法















　　十二法




　　【以上大法三更之二十有四是以本弧之正切余切与他弧互视】
　　此皆两弧中互相视之率也本弧有两率相乗矩与全数之方等他弧亦有两率相乗矩与前数之方等则此四率为互相视之边互相视者此有一率赢于彼之一率若干倍则此之又一率必朒于彼之又一率亦若干倍而其比例皆相等故以此弧之两率为一与四则以他弧之两率为二与三
　　假如有角三十度边四十度此两弧也角之正【○五○○○○】与其余割【二○○○○○】相乗【一○○○○○○○○○】与全数自乗等边之正【○六四二七九】与其余割【一五五五七二】相乗【一○○○○○○○○弱】亦与全数自乗等则此四率为互相视之边互相视者言角之正【○五○○○○】与边之正【○六四二七九】若边之余割【一五五五七二】与角之余割【二○○○○○】也【第四法】
　　又如有二边大边五十度小边三十度大边之正【○七六六○四】余割【一三○五四一】相乗与全数自乗等小边之正切【○五七七三五】余切【一七三二○五】相乗亦与全数自乗等则此四者互相视互相视者言大边之正【○七六六○四】与小边之正切【○五七七三五】若小边之余切【一七三二○五】与大边之余割【一三○五四一】也【第六法】
　　又如有两角甲角三十度乙角五十度此亦两弧也甲角之正切【○五七七三五】余切【一七三二○五】相乗与全数自乗等乙角之正切【一一九一七五】余切【○八三九一○】相乗亦与全数自乘等则此　率为互相视之边互相视者言甲角之正切【○五七七三五】与乙角之正切【一一九一七五】若乙角之余切【○八三九一○】与甲角之余切【一七三二○五】也【第十法】
　　用法
　　假如别有四率以五十度正为第一三十度正切为第二今改用三十度余切第一五十度余割第二其比例同
<子部,天文算法类,推步之属,历算全书,卷八>如图壬丙爲本弧乙丙为他弧他弧小于本弧而并在半象限以内
　　本弧【正壬癸　余壬丑　正切庚丙余割未甲　正割庚甲　余切未丁】
　　他弧【正乙戊　余乙巳　正切辛丙余割酉申　正割辛甲　余切酉丁】
　　论曰甲丙甲丁皆半径乃本弧他弧所共也半径自乗之方幂为甲丙夘丁而本弧中以正乗余割以余乗正割以正切乗余切所作矩形既各与半径方幂等则他弧亦然故可以互相视而成相当之率








　　如上图壬丙本弧在半象限内巳丙他弧在半象限外亦同














　　如上图壬丙本弧小于乙丙他弧而并在半象限外并同













　　厯算全书卷八
<子部,天文算法类,推步之属,历算全书>
　　小引
　　环中黍尺者所以明平仪弧角正形乃天外观天之法而浑天之画影也天圜而动无晷刻停而六合以内经纬厯然亘万古而不变此即常静之体也人惟囿于其中不惟常动者不能得其端倪即常静之体所为经纬厯然者亦无能拟诸形容惟置身天外以平观大圜之立体则周天三百六十经纬之度擘划分明皆能变浑体为平面而写诸片楮按度攷之若以玻璃水晶通明之质琢成浑象而陈之几案也又若有镂空玲珑之浑仪取影于烛而惟肖也故可以算法证仪亦可以量法代算可以独喻可以众晓平仪弧角之用斯其妙矣庚辰中秋鼎偶霑寒疾诸务屏絶展转牀褥间斗室虚明心闲无寄秋光入户秋夜弥长平时测算之绪来我胸臆积思所通引伸触类乃知厯书中斜弧三角矢线加减之图特以推明算理故为斜望之形其弧线与平面相离聊足以彷佛意象啓人疑悟而不可以实度比量固不如平仪之经纬皆为实度弧角悉归正形可以算即可以量为的确而简易也病间録枕上之所得輙成小帙然思之所引无方而笔之所追未能什一庶存大致竢同志之讲求耳【此第一卷原序也余详目録】
　　康熈三十有九年重九前七日勿庵力疾书时年六十有八










　　钦定四库全书
　　厯算全书卷九
　　宣城梅文鼎撰
　　环中黍尺卷一之二
　　总论
　　有垂弧及次形而斜弧三角可算乃若三边求角则未有以处也环中黍尺之法则可以三边求角【如有黄赤两纬度可求其经】可以径求对角之边【如有黄道经纬可径求赤道之纬】立术超妙而取径遥深非专书备论难谙厥故矣书成于康熈庚辰非一时之笔故与举要各自为首尾
　　凡测算必有图而图弧角者必以正形厥理斯显于是以测浑圆则衡缩欹衺环应无穷殆不翅累黍定尺也本书命名盖取诸此
　　用八线至弧度而竒然理本平实以八线量弧度至用矢而简然义益多通要亦惟平仪正形与之相应一卷之先数后数所为直探其根以发其藏也
　　平仪以视法变浑为平而可算者亦可量即眎度皆实度矣二卷之平仪论所以博其趣而三极通几其用法也【黍尺名书于兹益着】
　　矢度之用已详首卷而余之用亦可参观故又有三卷之初数次数也　初数次数本用乗除亦可以加减代之故有加减法以疏厥义【自三卷以后非非一时所撰今以类相附而仍各为之卷】
　　四卷之甲乙数即初数次数之变也而彼以乗除此以加减则繁简殊矣
　　五卷之法亦加减也而特为省径故称防焉【用初数不用次数用矢度不用余以视甲乙数又省其半】然不可不知其变故又有补遗之术也
　　恒星厯指之法别成规式而以加减法相提而论固异名而同实是以命之又法也
　　【以上环中黍尺之法约之有六用乘除者二其一先数后数其一初数次数也用加减者四初数次数也甲乙数也捷法也又法也本书中具此六术然而加减捷法其尤为善之善者欤】
　　外有不系三边求角之正用并可通之以加减之法者是为加减通法盖术之约者其理必精数之确者为用斯博并附数则于五卷之末以发其例
　　弧三角用平仪正形之理
　　作图之法有二一为借象一为正形以平写浑不得已而为侧睨遥望之形以曲状其变然多借象而非正形兹一准平仪法度寘二极于上下而从旁平视之【如置身大员之表以观大员】则浑球上凸面之经纬弧角一一可写于平面而悉为正形于是测望之法步算之源皆不烦笺疏而解














　　平仪用实度之理
　　斜视之图无实度可纪【弧角之形聊足相拟其实度非算不知】兹者平仪既归正形则度皆实度循图可得即量法与算法通为一术【以横径查角度以距纬查弧度并详二卷】
　　平仪用矢线之理
　　八线中有矢他用甚稀乃若三边求角则矢线之用为多而又特为简易信古人以弧矢测浑员其法不易然亦惟平仪正形能着其理【下文详之】
　　矢线之用有二
　　一矢线为角度之限　钝角用大矢　鋭角用小矢【小矢即正矢也从半径言之为正矢从全径言之为小矢】法曰置角度于平仪之周则平员全径为角线所分而一为小矢一为大矢【平仪横径即浑员之腰围故大矢即钝角度小矢即鋭角度】
　　如图浑球上甲戊甲丁甲丙三小弧与甲已同度故同用甲已为正矢丁乙戊乙丙乙三过弧与已乙同度故同用已乙为大矢





　　一矢较为弧度之差　大弧用大矢【弧度过象限为大弧故大矢亦大于半径】小弧用小矢【弧度不及象限为小弧故正矢小于半径】较弧与对弧并同法曰置较弧对弧于员周【角旁两弧之较为较弧亦曰存弧对角之弧为对弧亦曰底弧】则各有矢线而同轴可得其差谓之两矢较也较弧对弧并小则为两正矢之较【两弧俱象限以下故俱用正矢】较弧小对弧大为正矢大矢之较【较弧在象限以下用正矢对弧过象限用大矢】
　　较弧对弧并大为两大矢之较【两弧俱过象限故俱用大矢】
　　凡较弧必小于对弧则较弧矢亦小于对弧矢故无以较弧大矢较对弧正矢之事法所以恒用加也【若较弧用大矢则对弧必更大】
　　如图丑乙弧之正矢辛乙【庚乙寅乙
　　二弧同用】子乙弧之正矢壬乙【癸乙夘乙
　　同用】则辛壬为两矢之较即为【癸乙
　　寅乙】两弧度之较也【或丑乙与子乙或庚乙与
　　癸乙或寅乙与卯乙并同】　又如戊乙弧之
　　大矢已乙与丑乙弧之正矢辛乙相较得较已辛或子乙弧之正矢壬乙与丙乙弧之大矢已乙相较得较巳壬皆大矢与正矢较也　又如甲丑弧之大矢辛甲与甲夘弧之大矢壬甲相较得较辛壬则两大矢较也约法
　　凡求对角之弧并以角之矢为比例【钝角用大矢鋭角用正矢】求得两矢较【半径方一率正矩一率角之矢三率两矢较四率】以加较弧之矢【较弧大用大矢较弧小用正矢】得对弧矢加满半径以上为大矢其对弧小【遇象限】加不满半径为小矢其对弧小【不过象限】此不论角之鋭钝边之同异通为一法
　　凡三边求角并以两矢较为比例求角之矢【半径方一率余割矩二率两矢较三率角之矢四率】得数大于半径为大矢其角则钝得数小于半径为正矢其角则鋭亦不论边之同异通为一法
　　问用矢用余异乎曰矢余相待而成者也可以矢算者亦可用余立算但加减尚须详审若矢线则一例用加尤为简妙
　　先数后数法
　　【此以平仪弧角正形解浑球上斜弧三角用矢度矢较为比例之根也】
　　【先得数者正上距等圈矢也与角之矢相比后得数者而矢较也与较弧矢相加】
　　设丙乙丁斜三角形　有乙鋭角　有丙乙弧小于象
　　限丁乙弧大于象限【是为角旁
　　之两弧不同类】　求丁丙为对角
　　之弧　用较弧【角旁两弧相减】及
　　对弧两正矢之较为加差
　　法以大小两边各引长之
　　满半周遇于戊作戊甲乙
　　圜径　又于圜径折半处【巳】命为浑圜心　又自己心作横半径【如巳寅辛】则寅辛即乙角之弧亦即为乙角之矢【平视之为矢度实即角度之弧跻缩而成】而寅已即乙角之余弧亦即为乙角余【因视法能令余弧跻缩成余】　又自丁作横半径【巳辛】之平行线【如壬丁甲】此平行线即乙丁大边之正【因平视故乙丁小于乙壬其实乙丁弧之度与乙壬同大今壬甲既为戊壬及乙壬之正亦即为乙丁之正矣】而此正【壬甲】又即为距等圈之半径也【想戊巳乙为半浑圜之中剖国面侧立形乃自壬丁甲横切之则壬甲为其横切之半径】则其丁壬分线亦为距等圈上丁壬弧之矢线矣【有距等圈半径即有其弧】而此大小两矢线各与其半径之比例皆等【己辛大圜之半径大故寅辛矢亦大甲壬距等圈之半径小故壬丁矢亦小然其度皆乙角故比例一也距等虽用戊角而戊角即乙角有两弧线限之故也】法为已辛与甲壬若寅辛与壬丁
　　一率　半径已辛
　　二率　【大弧正】壬甲【卯距等圈之半径】
　　三率　【乙角矢】寅辛
　　四率　【先得数】壬丁【即距等圏之正矢】
　　次从丙向已心作丙巳半径此线为加减之主线【以较弧对弧俱用为半径而生矢度】　又从壬作壬夘为壬丙较弧之正【壬乙既同丁乙则丁乙弧之大于丙乙其较为壬丙】　又从丁作癸丁午线为丁丙对弧之正【因平视故丁丙弧小于癸丙其实丁丙弧与癸丙同大癸午既为癸丙正亦即丁丙之正矣】因两正平行又同抵巳丙半径为十字正方角故比例生焉此立算之根本　又从丁作丁子线与午夘平行而等【以有对弧较弧两正为之限也】成壬丁子句股形又从丙作丙辰线为乙丙小边之正成已丙辰句股形　此大小两句股形相似【巳丙辰与卯已奎小形相似则亦与壬丁子形相似等角等势故也】法为丙已与辰丙若壬丁与丁子
　　一率　半径丙已　
　　二率　【小弧正】辰丙　股
　　三率　【先得数】壬丁　小
　　四率　【两矢较】丁子　小股
　　省算法用合理
　　【因上两宗内各冇先得数而一为三率一为四率故对去不用】




　　乃以后得数为矢较加较弧矢【以午夘加夘丙也】成对弧矢【午丙】末以对弧矢【午丙】减半径【巳丙】成对弧余【午已】检表得对弧【丁丙】之度
　　又法　以后得数减较弧余【以午夘减夘已】成对弧余【午己】检表得对弧【丁丙】度亦同【两正矢之较即两余较也故加之得矢者减之即得余】
　　若先有三边而求乙钝角则反用其率【因前四率反之以首率为次率三率为四率】




　　以乙角矢【寅辛】减半径【辛巳】得余【寅巳】检表得乙角之度右锐角以二边求对边及三边求角并以两矢较为加差【以差加较弧矢得对弧大三边求角则为三率】亦为两余较【依又法以差减较弧余为对弧余三边求角则两余弧相减为三率】　角旁弧异类对边小
　　设亥乙丁斜弧三角形　有乙钝角　有亥乙小弧丁乙大弧　求亥丁【对角弧】　用较弧正矢与对弧大矢之较为加差
　　戊乙径为取角度之
　　根亢寅角度及房甲
　　与亥虚两正皆依
　　之以立
　　大矢即钝角之弧度
　　小矢即鋭角之弧度
　　亥斗径为加减之根
　　房氐及危心两正
　　依之以立　有两正即有两余及大小矢而加减之用生焉
　　法以大小两边各引长之满半周遇于戊　又依小边半周【乙亥戊】补其余半周【戊辛乙】成全圆　又从戊至乙作圆径　又作亢辛横径两径相交于已即圆心　则寅辛为乙角之小矢而寅亢为乙角之大矢【寅已亢即乙钝角之弧度平视之成大矢】　若自寅点作直线与戊乙平行取距戊乙之度加象限即角度　又从丁作房丁壬横线与亢辛横径平行此线即丁乙大邉正之倍数【房丁壬与亢辛平行则房乙即丁乙也因平视故丁乙小于房乙耳而房甲既为房乙之正亦即丁乙正也房甲既为正房壬则倍正矣倍正即通】而此【房壬】倍正又即为距等圏之全径【想全体浑圆从壬丁房横切之成距等圈而房壬其全径】则房丁分线亦即为距等圏上丁甲房弧之大矢【有距等圈全径即有其全圏而房甲丁其切弧】而此两大矢线各与其全径之比例皆等【亢辛全径大故寅亢大矢亦大房壬距等圏之全径小故房丁大矢亦小然其度皆乙角之度在乙丁戊及乙房戊两弧线之中故各与其全圆之比例等而其大矢亦各与其全径之比例等】即各与其半径之比例亦等【若以甲为心壬为界作半圆于房壬线上则距等之弧度见矣】法为亢辛【全径】与房壬【距等全径即倍正】若寅亢【钝角大矢】与房丁【先得数亦距等大矢】而亢已【半径】与房甲【乙丁正亦距等半径】亦若寅亢与房丁
　　一率　亢巳【半径】
　　二率　房甲【大邉之正亦距等半径】
　　三率　寅亢【钝角大矢】
　　四率　房丁【先得数亦距等大矢】
　　次从亥过巳心作亥已斗全径为加减主线【较弧对弧之俱过此全径而生大小矢】　又从房作房氐线为房亥较弧之正【准前论房乙同丁乙则丁乙之大于亥乙其较房亥】　又从丁作心丁娄线与房氐正平行而交亥斗径于危如十字则此线为亥丁对弧之倍正【因视法心亥弧大于亥丁其实即亥丁也亥丁为平视跻缩之形心亥为正形而心危者心亥弧之正也是即亥丁弧之正而心丁娄其倍矣】　又从丁作丁女线与斗亥径平行亦引房氐较弧之正为通而与丁女线遇于女成丁女房句股形　又从亥作亥虚线与亢辛横径及大边之正房甲俱平行成亥虚已句股形　此大小两句股形相似【亥巳即径线与丁女平行亥虚与房甲丁平行则大形之丁角与小形之亥角等而女与虚并正角则为等角而相似】法为已亥【半径】与亥虚【小边正】若房丁【先得数而距等大矢】与丁女【后得数亦即氐危为较弧正矢氐亥及对弧大矢危亥之较】
　　一率　半径已亥　
　　二率　【小边正】亥虚　句
　　三率　【先得数】房丁　大
　　四率　【后得数】丁女　大句
　　乃以省算法平之




　　乃以后得数加较弧正矢【以氐危加氐亥成危亥】为对弧大矢内减半径得对弧余检表得度以减半周为对弧之度又法于后得数内减去较弧余成对弧余【于氐危内减氐巳其余危巳即对弧余】乃以余检表得度以减半周为对弧之度　大矢与小矢之较即两余并也内减去一余即得一余矣观图自明　前用鋭角是于较余内减得数为对弧余此用钝角是于得数内减较弧余为对弧余
　　若有三边而求角度者则反用其率
　　一半径上方　　　　一两正矩　　半径上方
　　二两正矩　　　　二半径上方　　两余割相乗矩三钝角大矢寅亢　　三两余并氐危【即较弧正矢与对弧大矢之较】四两余并丁女【即氏危】四钝角大矢寅亢
　　乃于所得大矢内减去半径成余以余检表得度用减半周为钝角之度
　　右钝角求对边及三边求钝角并用两矢之较为加差【以差加较弧正矢得对弧大矢又为三边求角之三率】亦为两余并【依又法减较弧余得对弧余三边求角即并两余为三率】　其钝角旁两弧异类对弧大
　　设丁辛乙斜弧三角形
　　有辛丁边【五十度一十分】丁乙对角
　　边【六十度】辛乙边【八十度】三边并
　　小求辛鋭角
　　法先为戊亢辛全员　作戊
　　辛员径　又作亢巳横员径
　　【两径十字相交于巳心此线上有角度】
　　次于戊辛径左右任取自辛数至丁如所设角旁小边【五十度一十分】之数截丁辛为小边　又从丁过巳作径线【此线上有加减度】为较弧对角弧两正所依　仍自辛过丁数至房如所设大边【八十度】之数截房丁为大小两边之较弧　又自丁过房数至心如所设对边【六十度】之数截心丁与乙丁等　仍自丁过辛截娄丁度如心丁乃作娄心直线聨之为心丁对弧之倍正　又从房作房甲横线与亢巳横径平行此为乙辛大边之正【因视法房辛即乙辛详后】　次视娄心倍与房甲正两线相遇于乙命为斜弧形之角　乃从乙角向辛作乙辛弧【此弧亦八十度与房辛同大】是所设角旁之大边【理在平仪视法房辛是真度乙辛是视凸为平跻缩之形想平仪原系浑体从房乙甲横切之则自房至甲为距等圈之九十度从此线上度度作弧至辛极并八十度不惟乙辛与房辛同大即甲辛亦与房心同大也他仿此】　又从乙向丁作乙丁弧【此弧亦六十度与心丁同大】是所设对角之边【切浑角以心娄距等圈而以丁为极则危丁亦六十度与心丁同大矣乙丁同大不言可知】　遂成乙辛丁斜弧三角在球上之形与所设等　又从乙引乙辛弧线至戊成心乙戊半周侧立形此线截亢巳半径于寅则亢寅为辛角矢度而寅己其余　次从丁作丁虚横线与房甲正平行是为辛丁小边之正　又从房作房夘线与心危娄平行则此线为房丁较弧之正其心危则乙丁对弧之正　又从乙作乙女线与夘危平行而等【线在两正平行线之中而赤平行不得不等】是为较弧与对弧两正矢之较【房夘为较弧正则夘已为余而夘丁其矢又心危为对弧正则危巳为余而危丁其矢此两正矢之较为危卯而乙女与之等则乙女亦两矢之较矣】
　　法曰巳丁虚句股形与房乙女句股形相似【房乙与丁虚平行乙女与巳丁平行则所作之大形丁角小形乙角必等而大形之虚小形之女并正角则两形相似】故丁虚【小边正】与丁巳【半径】若乙女【即夘危较弧余与对弧余之较】与乙房【先得数】
　　又房甲正之分为乙房犹亢巳之分为寅亢其全与分之比例皆相似【从房甲线切浑员成距等圏而房甲为其半径犹浑员之有亢巳为半径也两半径同为戊寅辛弧线所分则乙房为距等圏半径之矢度犹寅亢为大员半径之矢度也其比例俱相似】故房甲【大邉正即距等圏半径】与亢巳【大员之半径】若乙房【先得数即距等圏之矢】与寅亢【后得数即角之矢线】
　　以省算法平之即异乘同乘异除同除






　　较弧【二十九度五十分】余【八六七四八】正矢【一三二五二】其较三六七四八
　　对弧【六十度　　　　五○○　　五○○○○　　　○○】
　　一半径方一○○○○○○○○○○【首率除宜去十尾乃先于二率】二余割矩一三二二三二三四○八九【去五位故得数只去五位即如】
　　三两矢较　　　　　　　三六七四八【共去十位也】
　　四锐角矢　　　　　　　四八五九二【用减半径得辛角余五一四○八】检表得五十九度四分为辛角之度【此与厯书所算五十八度五十三分只差十一分】又法径求余　法曰房甲之分为乙房而其余乙甲犹亢已之分为亢寅而其余寅已也故其全与分余之比例亦相似法为房甲【正】与亢己【半径】若乙甲【正分线之余】与寅已【半径截矢之余即角之余】
　　准前论小边之正虚丁【句】与半径丁巳【】若较弧对弧两矢之较乙女【小句】与大边正之分线乙房【小】也先求乙房为先得数以转减大边正房甲得分余线乙甲
　　一　小边【五十度一○】正　　丁虚　七六七九一
　　二　半径　　　　　　　　　丁巳一○○○○○三　【较弧二十九度五○对弧六　十度○○】两正矢较乙女　三六七四八
　　四　先得数【大邉正之分线】　　　　乙房　四七八五四以先得数减大邉八十度正房甲　九八四八一得大边正内乙房分线之余乙甲　五○六二七未以分余线为三率
　　一　大边正　　房甲　九八四四一
　　二　半径　　　　亢已一○○○○○
　　三　分余线　　　乙甲　五○六二七
　　四　角之余　　寅已　五一四○七【检表得五十九度○四分与先算合】附厯书斜弧三角图【稍为校正】
　　丙乙丁弧三角形
　　乙丙角旁小弧　壬乙同丁
　　乙角旁大弧　壬丙为较弧
　　癸丙同丁丙为对角之弧
　　甲壬为大弧正　辰丙
　　为小弧正　壬夘为较弧
　　正　癸午为对弧正　寅辛为乙角之弧　庚辛为乙角之矢　夘丙为较弧之矢　午丙为对弧之矢午夘为两矢较　酉壬为先得数　酉子同午夘亦
　　两矢之较
　　法为全数【己辛】与大弧正【甲壬】若角之矢【庚辛】与先得数【酉壬】又全数【巳丙】与小弧正【辰丙】若先得数【酉壬】与两矢较【酉子】也一率全之方　二率两正矩　三率角之矢　四率得两矢较以两矢较加较弧之矢为对弧之矢
　　论曰此因欲显酉壬为甲壬距等半圈之矢度故特为斜望之形其实丁点原在酉寅点原在庚丁壬弧即酉壬线寅辛弧即庚辛线乙寅丁戊弧原即为乙庚酉戊弧也故以平仪图之则皆归正位矣所以者何平仪上惟经度有弧线之形其距等圈纬度皆成直线而寅庚为角度之正直立下垂从其顶视之成一点矣丁酉者大弧正甲壬上所作距等圈之正也从顶视之而成一点与寅庚一也其寅已半径势成斜倚从上眎之与已庚余同为一线甲丁与甲酉亦然此皆平面正形可以算亦可以量非同斜望比也愚故谓惟平仪为正形也
　　若乙角为钝角成亥乙丁三角形则当用房亥较弧之正矢【牛亥】与同丁亥对弧之心亥弧大矢危亥相减成两矢之较【牛危即女酉】以较加较弧正矢为对弧大矢【法详前例但前例钝角旁小弧不同乙丙故此图以相同者论之更见其理之不易】
　　乙为钝角用大矢之图
　　【此用平仪正形故丁与酉同为一点】






　　设角之一边适足九十度一边大　用锐角【余角一钝一鋭】法为半径与大边之正若角之矢与两矢较也亦若角之余与对弧之余
　　乙丁丙斜三角形　丙丁边适
　　足九十度乙丁边大于九十度
　　丁鋭角求对边丙乙　法先作
　　平员分十字从丁数丁壬及丁丑
　　并如乙丁度作距等线聫之【壬丑】又于壬丑线上取乙点【法以壬巳为度巳为心作半员】
　　【分匀度而自壬取角度得乙防】作庚乙癸直线为对弧之正　又取壬丙为较弧作壬夘正较弧之矢夘丙对弧之矢癸丙其较夘癸与壬乙等壬已正又即距等圈半径而为丁乙戊弧所分则壬乙如矢乙已如余与角之丙子矢子甲余同比例
　　一　半径丙甲　　　一　半径丙甲
　　二　【大邉正】壬已　　　二　【大邉正】壬已
　　三　【角之矢】子丙　　　三　【角之余】子甲
　　四　【两矢较】壬乙【即夘癸】　四　【对弧余】乙已【即癸甲】
　　若丁为钝角　用大矢
　　法为半径与大边之正若角之大矢与两矢较也亦若钝角之余与对弧之余
　　借前图作乙辛为对角之弧成乙丁辛三角形【三角俱钝】作丑午为较弧丑辛正【以丑丁同乙丁故】其庚癸为对弧乙辛之正【以庚辛即乙辛故】较弧之正矢午辛对弧之大矢癸辛其较癸午与丑乙等　依前论壬乙为距等圈小矢则乙丑为大矢壬丑为距等圏全径与其大矢乙丑之比例若丙辛全径与钝角之大矢子辛则已丑为距等半径与其大矢丑乙亦若甲辛半径与钝角之大矢子辛也而丑已原为乙丁大边之正【丑乙原与癸午等】故法为半径【甲辛】与钝角之大矢【子辛】若大边之正【已丑】与两矢较【丑乙或癸午】也
　　一　半径甲辛　　一　半径甲辛
　　二　【大邉正】丑巳　　二　【大邉正】丑已
　　三　【钝角大矢】子辛　　三　【钝角余】子甲
　　四　【两矢较】癸午　　四　【对邉余】乙已【用余入表得度以减半周得对邉之度】一系　距等圏上弧度所分之矢与余与大矢与其半径或全径并与大圏上诸数比例俱等
　　又按前法亦可以算一邉小于象限之三角
　　于前图取乙戊丙斜弧三角形用戊鋭角【余角一钝一鋭】有丙戊大边足九十度有乙戊边小于九十度　求对戊角之乙丙边
　　法从乙作壬已线为小邉乙戊之正【以壬戊即乙戊故】又从乙作庚癸为对弧乙丙之正【以庚丙即乙丙故】　于是较弧之矢为夘丙　对弧之矢为癸丙而得两矢之较为癸夘　则又引戊乙小邉之弧过半径于子而合大圏于丁分子丙为戊角之矢子甲为角之余法曰丙甲【半径】与壬已【小邉】若子丙【戊角之矢】与乙壬【两矢较】也得乙壬即得癸夘
　　捷法不用较弧但作壬已为小弧乙戊之正作庚癸为乙丙对弧之正其余癸中　又引小邉戊乙分半径于子得子甲为戊角之余
　　法曰丙甲【半径】与壬已【小邉正】若子甲【戊角余】与乙巳【对邉余】得乙己得癸甲矣
　　又于前图取辛戊乙三角形用戊钝角【余角并鋭】有戊辛大邉九十度有戊乙邉小于九十度　求对戊钝角之辛乙邉
　　用防法　于乙作壬丑为乙戊小邉之通　作庚癸为乙辛对弧之正　其余甲癸　又引戊乙小邉割丙辛全径于子分子辛为钝角大矢子甲为钝角余
　　法为甲辛与丑已若子甲与乙巳得乙巳即得癸甲一　半径甲辛【即丙辛全径之半】
　　二　【小邉王】丑已【即壬丑通之半】
　　三　【钝角余】子甲
　　四　【对邉余】癸甲【即乙巳】
　　若先有三邉而求角则反用其率
　　一　半径
　　二　小邉余割
　　三　对邉余
　　四　角之余
　　一系凡斜弧三角形有一邉足九十度其余一邉不拘小大通为一法皆以半径与正若角之矢与两矢较也亦若角之余与对邉之余
　　若置大小邉于员周其算亦同
　　乙丁丙斜弧三角形　乙丁
　　邉适足九十度　丁丙邉小
　　于九十度　有丁锐角　求
　　对邉丙乙　法于平员邉取
　　丙丁度作丙已为小邉之正
　　　又自丙作丙甲过心线
　　又作壬夘线为丙壬较弧
　　之正　又作庚乙癸线为对弧乙丙之正【庚丙即乙丙故】　乙壬为丁角之矢　乙甲为丁角之余　癸丙为对弧之矢　癸甲为余　夘丙为较弧之矢　夘甲为余　对弧较弧两矢之较夘癸【亦即乙辰】
　　法曰甲丙已壬乙辰乙甲癸三句股相似故甲丙【半径】与丙已【小邉正】若壬乙【角之矢】与乙辰【两矢较】亦若乙甲【角之余】与甲癸【对弧余】
　　三邉未角法
　　一　半径壬甲【即甲丙】　二　【小邉余割】甲甲
　　三　【对弧余】癸甲　　　　四　【角之余】乙壬
　　又于前图取乙戊丙三角形　用戊鋭角【余角一钝一鋭】　有乙戊邉九十度　有戊丙大邉　求对戊角之丙乙邉用防法　自丙作丙已为丙戊大邉之正　即从丙作丙甲半径　乃于乙点作庚癸为丙乙对弧之正其余癸甲而戊乙弧原分乙甲为戊角之余法曰甲丙巳句股与乙甲癸相似故甲丙【半径】与丙巳若乙甲【角之余】与甲癸【对边余】
　　若丁为钝角【余角并鋭】　用大矢
　　借前图作丑乙为对角之弧
　　成丑丁乙三角【丁为钝角】　作
　　丑甲寅径　又作辛丑较之
　　正辛午　【以辛丁同丁乙故】　作
　　丑乙对弧之正子酉引过
　　乙至亥成通　又作辛未
　　线与酉午平行而等　较弧之正矢午丑对弧之大矢酉丑相较得酉午【亦即未辛】　乙辛与丁钝角大矢　乙甲为钝角余
　　法曰甲丑已乙辛未乙甲酉三句股相似故甲丑【半径】与丑已【小邉正】若乙辛【角大矢】与未辛【两矢较】亦若乙甲【角之余】与甲酉【对弧余】
　　又于前图取乙戊丑形　用戊钝角【三角俱钝】　有乙戊邉九十度有丑戊大邉　求对钝角之丑乙邉
　　用防法　自丑作丑已为丑戊大邉之正　又自丑作丑甲寅全径　又自乙作亥酉为对邉丑乙之正【以亥丑即乙丑故】　其余酉甲而乙甲原为戊钝角之余法曰甲丑己句股形与乙甲酉相似故甲丑【半径】与丑已【大邉正】若乙甲【钝角余】与甲酉【对邉余】
　　又设丙乙丁三角形　乙为钝角【余一钝一鋭】　乙丙邉小丁乙邉大　对邉丁丙大于象限　较弧壬丙亦大
　　于象限
　　惟对邉较弧俱大于象限故
　　所得为两大矢之较
　　其正比例仍用小矢以角
　　为鋭角也






　　壬丙较弧之大矢夘丙加后得数午夘为对弧丁丙之大矢【丁丙即癸丙故】　大矢午丙内减半径已丙得午已为余以检表得庚癸之度以减半周得癸丙之度即对弧丁丙之度
　　又法以得数午夘加较弧之余夘巳得午已为对弧余【以两大矢较即两余较也余同上】
　　若于前图取丁乙庚三角形则角旁两邉俱大于象限而对邉小于象限较弧亦小于象限乙为钝角【三角俱钝】有庚乙与丁乙两大邉而较弧丑庚小故所得为两小矢之较其正比例则用大矢以乙为钝角故也　丑庚为较弧其正丑亥余亥已　对弧庚丁即庚酉其正酉午余午已【两矢较亥午即余较】
　　又设丙乙丁三角形
　　乙为鋭角【余一钝一鋭】
　　乙丙邉小　丁乙邉大　对
　　弧丁丙大于象限　较弧壬
　　丙小于象限　所得为对弧
　　大矢与较弧小矢之较
　　其正比例仍用小矢以乙
　　鋭角故






　　两余并即大矢与小矢之较也
　　法以得数午夘加较弧之正矢夘丙成午丙为对弧之大矢午丙内减去半径已丙得午巳余乃以余检表得度以减半周得对弧丁丙之度
　　若于得数内减较弧余弧夘己亦即得午己余余如上
　　又于前图取丁乙庚三角形　乙为钝角【三角俱饶】　角旁两邉俱大于象限惟对邉小故用两正矢较其正比例仍用大矢以钝角故　乙丁弧之通丑壬为乙丁弧所割成丑丁亦割其戌辛全径于寅成寅戌为钝角大矢而比例等　又丑庚为较弧其正丑亥其矢亥庚　对弧庚丁之通酉癸其矢午庚两矢之较为亥午




　　以两矢较亥午加丑庚较弧之矢庚亥成午庚为对弧丁庚之矢【以矢减半径庚已得对弧之余午巳检表得丁庚度】
　　论曰先得数何以能为句股比例也曰先得数即距等圏径之分线也其势既与全径平行又其线为弧线所分其分之一端必与对弧相防【葢对弧亦从此分也】其又一端必与较弧相防是此分线在较弧对弧两正平行线之中斜交两线作角而为则两正距线必为此线之句矣而两矢之较即从两正之距而生故不论大矢小矢其义一也
　　然则正上所作句股何以能与先得数之句股相似邪曰两全径相交于员心则成角各正又皆为各全径之十字横线则其相交亦必成角而横线所作之角必与其径线辏心之角等角等则比例等矣大邉小邉之正皆全径之十字横线也较弧对弧之正皆又一全径之十字横线也此两十字之各线相交而成种种句股其角皆等




　　仍于前图取丁戊庚三角形　戊钝角【余并鋭】　三边俱小于象限　戊丁弧之通丑壬正甲壬　又引戊丁弧过全径于寅防于乙则寅戌为戊钝角之大矢亦割丑壬通于丁则丑丁与通若寅戌大矢与全径也　又戊庚弧之正庚申为句则已庚半径为其其比例若丑未为句而丑丁为也　又丑庚为较弧其正丑亥其余亥已其矢亥庚　对弧庚丁之通酉癸正癸午余午已其矢午庚两矢之较为亥午【对弧小故用两小矢之较戊钝角故以角之大矢为比例并同上条】




　　两法并用钝角其度同所求之庚丁弧又同故其法并同即此可明三角之理
　　仍于前图取丁丙戊三角形　有丁丙及戊丙二大边有丙鋭角【余一钝一鋭】求丁戊对边　法引丁丙及戊丙二弧防于庚作庚丙径作已亢及已戊两半径作癸午为丁丙边正而丁丙弧割癸午正于丁亦割亢已半径丁心则亢已之分为心亢犹癸午之分癸丁也又作戊井为戊丙弧之正成戊已井勾股形又从丁作壬甲为对弧戊丁之正其矢甲戊又取癸戊为较弧【以癸丙同丁丙故】作癸氐为较弧正其矢氐戊两矢之较为氐甲又从丁作斗丁与氐甲平行而等成丁斗癸小句股形与戊已井形相似则已戊与井戊句若癸丁与斗丁句也【此因对弧小故所得为小矢之较而用丙鋭角故只用角之正矢为比例　又此因用丙角求戊丁邉故另为比例若用戊角求丁丙弧则与第一条之法同矣】




　　以甲氐加较弧之矢氐戊成甲戊为对弧之矢如法取其度得丁戊
　　右例以一图而成四种三角形皆可以入算而诸线错综有条不紊可见理之真者如取影于灯宛折惟肖也【又丁丙戊三角形亦可以戊角立算余三角并然　丁乙丙形可用丙角庚戊丁形庚乙丁形俱可用庚角】计开
　　一图中三角形凡四
　　一丁乙丙形　一丁戊丙形　一丁乙庚形　一丁戊庚形
　　全径凡二
　　一戊乙径　一庚丙径
　　算例凡八








　　右前四例皆以乙戊径为主线丙庚径为加减线后四例皆以丙庚径为主线乙戊径为加减线
　　一系　凡三角形以一邉就全员则此一邉之两端皆可作线过心为全员之径而一为主线一为加减线皆视其所用之角
　　凡所用角在径线之端则此径为主线余一径为加减线
　　几用锐角则主线在形外用钝角则主线在形内凡角旁两弧线引长之各成半周必复相防而作角其角必与原角等
　　凡主线皆连于所用角之锐端或在形内或在形外并同其引长之对角亦必连于主线之又一端也若主线在形内破钝角端者其引长之钝角亦然
　　一系　凡两径线必与两弧相应如角旁弧引长成半周其首尾皆至主线之端是主线即为此弧之径也如对角弧引长成半周首尾皆至加减线之端是加减线即为对弧之径也主线既为引长角旁一弧之径又原为全员之径而角旁又一弧之引长线即全员也故角旁两弧皆以主线为之径　加减线既为对弧之径而较弧在员周其端亦与加减线相连又加减线原为全员径故较弧对弧皆以加减线为径
　　一系　凡全径必有其十字过心之横径而正皆与之平行皆以十字交于全径引之即成通
　　主线既为角旁两弧之径故角旁两弧之正通皆以十字交于主线之上而其余其矢皆在主线加减线既为对弧较弧之径故对弧较弧之正皆以十字交于加减线而其余其矢皆在加减线
　　一系　凡角旁之弧引长之必过横径分为角之矢角之余若钝角则分大矢
　　角旁引长之弧过横径者亦过正通故其全与分之比例皆与角之大小矢及余之比例等平仪论　论以量代算之理
　　以横线截弧度以直线
　　取角度并与外周相应
　　如艮已弧距极三十度
　　为申未横线所截故其
　　度与外周未已相应坎
　　乙应戌乙亦同又干乙
　　弧距极六十度为丑夘横线所截故其度与外周丑乙相应巽已应午已亦同
　　又如戊已辛角有未戊辰直线为之限知其为六十度角以与外周未午辛之度相应也癸乙子三十度角应子丑度亦然又庚已子钝角有午夘庚直线为之限知其为百五十度角以与外周午未已申寅子弧度相应也壬乙辛百二十度角应戌乙辰夘辛弧亦然
　　论曰平仪有实度有视度有直线有弧线直线在平面皆实度也弧线在平面则惟外周为实度其余皆视度也实度有正形故可以量视度无正形故不可以量然而亦可量者以有外周之实度与之相应也何以言之曰平仪者浑体之昼影也置浑球于案自其顶视之则惟外周三百六十度无改观也其近内之弧度渐以侧立而其线渐缩而短离邉愈逺其侧立之势益髙其跻缩愈甚至于正中且变为直线而与员径齐观矣此跻缩之状随度之髙下而迁其数无纪故曰不可以量也然而以法量之则有不得而遁者以有距等圈之纬度为之限也试横置浑球于案任依一纬度直切之则成侧立之距等圈矣此距等圈与中腰之大圈平行其相距之纬度等故曰距等也其距既等则其圈踓小于大圈而其为三百六十度者不殊也从此距等圈上逐度作经度之弧其距极亦皆等特以侧立之故各度之视度跻缩不同而皆小于邉之真度其实与邉度并同无小大也特外周则眠体而内线立体耳故曰不可量而可量者以有外周之度与之相应也此量弧度之法也弧度者纬度也【量法详后】然则其量角度也奈何曰角度者乃经度也经度之数皆在腰围之夫圈此大圈者在平仪则变为直线不可以量然而亦可以量者亦以外周之度与之相应也试于平仪内任作一弧角
　　如乙已丙平员内作已丙戊角欲知其度则引此弧线过横径于戊而防于乙则已戊弧即丙锐角之度戊壬弧即而
　　钝角之度也然已戊壬两弧皆以视法变为平线又何以量其度法于戊防作庚辛直线与乙丙直径平行则已庚弧之度即戊巳弧之度亦即丙锐角之度矣其余庚乙壬之度即戊丁壬弧之度亦即丙钝角之度矣故曰不可量而实可量者以有外周之度与之相应也然此法惟角旁弧度适足九十度如戊丙则其数明晣若角旁之弧或不足九十度又何以量之曰凡言弧角者必有三邉如上所疏既以一邉就外周真度其余二邉必与此一邉之两端相遇于外周而成角此相遇之两防即余两弧起处法即从此起数借外周以求其度而各循其度作距等横线乃视两距等线交处而得余一角之所在遂补作余两弧而弧三角之形宛在平面再以法量之则所求之角可得其度矣此量角度之法也
　　今设乙丁丙弧三角形丁丙邉五十○度乙丙邉五十五度乙丁邉六十○度而未知其角
　　法先作戊巳庚丙平员
　　又作巳丙及戊庚纵横
　　两径任以丁丙邉之度
　　自直线之左从丙量至
　　丁得五十○度为丁丙
　　邉又自丙左右各数五
　　十五度如辛丙及子丙皆如乙丙之度乃作辛子线联之为五十五度之距等圈　又自丁作夘丁径线自丁左右各数六十○度为癸丁及丑丁皆如乙丁之数亦作丑癸线聨之为六十○度之距等圈　此两距等线相交于乙则乙防即为乙丙及乙丁两邉相遇之处而又为一角也　乃自乙角作乙丙及乙丁两弧则乙丙丁三角弧形宛然平面矣再以法量之则丁丙两角亦俱可知　欲知丙角即用辛子距等线以半线午子为度以午为心作子酉辛半员句分一百八十度此辛子径上距等圈之真形也乃自乙防作直线与午丙径平行截半员于酉乃从酉数至子得酉子若干度此即乙丙丁锐角之度以减半周得酉辛若于度亦即乙丙辛钝角之度也　欲知丁角亦即用丑癸距等线以半线辰癸为度辰为心作丑亥癸半员分一百八十度此亦丑癸径上距等圈之正形也乃自乙防作直线与辰夘径平行截半员于亥即从亥数至癸得亥癸若干度此即乙丁丙钝角之　度以减半周得亥丑若干度又即乙丁丑钝角之度也
　　计开
　　丙角七十八度稍弱【以算考之得七十七度五十五分】丁角六十七度三分度之二【以算考之得六十七度三十九分】
　　右量角度以图代算【欲得零分须再以算法考之即知无误】
　　又设乙丙丁弧三角形有六十○度丙角有乙丙邉一百○○度有丁丙邉一百二十○度求丁乙邉【对角之邉】法先为巳戊丙庚大圈作巳丙及庚戊十字径乃自丙数至辛如所设丁丙边一百二十○度自丙至子亦知
　　之作辛十子线为一百
　　二十○度之距等圈
　　又以距等之半线辛午
　　为度午为心作辛酉子
　　半圈匀分一百八十度
　　乃自辛数至酉如所设
　　丙角六十度而自酉作酉丁直线与已甲径平行至丁遂如法作丁丙邉　又自丙数至乙如所设乙丙邉一百○○度又从乙过甲心至夘作大圈径亦作寅壬横径乃补作丁乙邉【乙丙丁三角弧形宛然在目】　又自丁作丑丁癸距等线与寅壬平行未自乙数至癸得若干度即乙丁之度
　　计开
　　丁乙线五十九度强【以算考之得五十九度○七分】
　　右量弧度以图代算【若用规尺可免逐圈匀分之度有例在后条】
　　又若先有乙丁对角邉丁丙角旁邉有丙角而求乙丙角旁之邉【仍借前圏】
　　法先作己戊丙员及十字径线又以丁丙邉之度取丙辛及丙子作辛子距等线又作子酉辛半员取辛酉角度作酉丁直线遂从丁作丁丙邉皆如前　次以所设丁乙邉五十九度倍之作一百十八度少于夲员周取其通【即距等线癸丑之度】乃以通线就丁防迁就游移使合于外周而不离丁防成丑丁癸线即有所乘丑乙癸弧乃以弧度折半于乙则乙丙外周之度即所求乙丙邉于是补作乙丁线成三角之象
　　又法以丁乙倍度之通【丑癸】半之于辰乃从辰作夘甲辰过心径线即割大员周于乙而乙癸及乙丑之弧度以平分而等皆如乙丁度亦遂得乙丙度余如上又若先有乙丙两角及乙丙邉在两角之中【亦仍借前图】法先作己戊丙员及十字径线皆如前乃自丙数至乙截乙丙为所设之邉　次作丙角法于戊庚横径如前法求庚亥如所设丙角之度遂从亥防作弧【如丙亥己】则丙角成矣　次作乙角法于乙防作乙甲夘径亦作壬寅横径乃自寅至未如前法求寅未如所设乙角之度遂从未防作弧【如夘未乙】则乙钝角亦成矣　两弧线交于丁角乃补作丑癸及辛子两距等线则弧度皆得【案此两弧线必以鸡子形作之方凖若丁防离两横径不逺则所差亦不多也】
　　再论平仪
　　凡平仪上弧线皆经度而直线皆纬度
　　惟外周经度亦可当纬度又最中长径纬度亦为经度平仪上弧线皆在浑靣而直线皆在平靣
　　试以浑球从两极中半濶处直切之【如用极至交圏为度以剖浑仪】则成平靣矣以此平面覆置于案而从中腰横切之【如赤道半圏】则成横径于平面矣【如赤道之径】又以此横径为主离其上下作平行线而横切之则皆成距等圏之径线于平面矣大横径各距极九十度逐度皆可作距等圏即皆有距等径线在平面故曰皆纬度也此线既为距等圏之径则其径上所乗之距等圏距极皆等即任指一防作弧度其去极度皆等故以为纬度之限也
　　若又别指一处为极【如赤道极外又有黄道极又如天顶亦为极】则其对度亦一极也亦可如前横切作横径【如黄道之径】于平面其横径上下亦皆有九十度之距等圏与其径线矣【如黄道亦有纬度】故直线有相交之用也
　　凖此观之浑球之外圏随处可指为极即有对度之极两极相对则皆有直线为之轴轴上作横径横径上下即皆有九十度之距等径线而相交相错其象千变而句股之形成比例之用生加减之法出矣【如黄赤两极外又有天顶地心之极而天顶地心随北极之髙下而变】又此所用外周特浑球上经圏之一耳若凖上法于球上各经圏皆平切之皆为大圏则亦可随处为极以生诸距等纬线而相交相错之用乃不可以亿计矣【如天顶地心既随极出地度而异其南北亦可因各地经度而异其东西】由是推之浑球上无一处不可为极故所求之防即极也何以言之凡于球上任指一防即能于此防之上作十字直线以防于所对之防而十字所分之角皆九十度即逐度可作线以防于对防而他线之极此防上线皆能与之防故曰所求之防即极也
　　又论平仪
　　凡平仪上弧线皆经度也而弧有长短者则纬度也是故弧线为经度而即能载纬度盖载纬度者必以经度也若无经度则亦无纬度矣
　　平仪上直线皆纬度也而线有大小者则经度也是故直线为纬度而即能载经度盖载经度者必以纬度也若无纬度则亦无经度矣【所云直线指横径及其上下之距等径而言】弧线能载纬度即又能分纬度之大小直线能载经度即又能分经度之长短
　　假如平面作一弧引长之其两端皆至外周则分此外周为两半员而各得百八十度即所作之弧亦百八十度矣此百八十者皆纬度故曰能载纬度也而此平面上所乘之半浑员其经度亦百八十而皆纪于腰围之纬圏若于腰围纬圏上任指一经度作弧线必会于两极而因此弧线割纬圏以成角度故又曰能分纬度也不但此也若从此弧线之百八十度上任取一度作平行距等纬圏其距等圏上所分之纬必小于腰围之纬圏而其所载距等圏之经度皆与角度等即近极最小之纬圏亦然何以能然曰纬圏小则其度从之而小而为两弧线所限角度不变也故纬圏之大小弧度分之也
　　然弧线之长短又皆以纬圏截之而成而纬圏必有径在平面上与圏相应故曰直线能载经度即又能分经度之长短也
　　复论平仪
　　平仪上直线弧线皆正形也问前论直线有正形弧线跻缩无正形兹何以云皆正形曰跻缩者球上度也然其在平靣则亦正形矣有中剖之半浑球于此覆而观之任于其纬度直切至平面则皆直线也而其切处则皆距等圏之半员即皆载有经度一百八十也从此半员上任指一经度作直线下垂至平面直立如县针则距等圏度之正也若引此经度作弧以防于两极则此弧度上所载之纬度一百八十每度皆可作距等圏即每度皆可作距等圏之正矣由是观之此弧上一百八十纬度既各带有距等圏之正即皆能正立于平面而平面上亦有弧形矣夫以弧之在球面言之别以侧立之故而视为跻缩而平面上弧形非跻缩也故曰皆正形也惟其为正形故可以量法御之也
　　又
　　问平仪经纬之度近心濶而近邉狭何也曰浑员之形从其外而观之则成中凸之形其中心隆起处近目而见大四周逺目而见小此视法一理也又中心之经纬度平铺而其度舒故见大四周之经纬侧立而其度垜垒故见小此又视法一理也若以量法言之则近内之经纬无均平之数数皆纪之于外周外周之度皆以距等线为限而近中线之距等线以两旁所用之弧度皆直过与横直线所荖少故其间阔近两极之距等线则其两旁之弧度皆斜过与横直线县殊故其间窄此量法之理也固不能强而齐一之矣夫惟不能强而齐故正之数以生八线由斯以出尺算比例之法由斯可以量代算而测算之用遂可以坐天之内观天之外巳
　　取角度
　　又法
　　设如巳戊丙庚员有子
　　辛距等纬线有所分丁
　　辛小纬线求其所载经
　　度以命所求之角【丙角】本法取距等半径【辛午】作
　　子酉辛半员从丁作酉
　　丁线乃纪酉辛之度为丁辛之度
　　今用防法径于丁防作女丁壬线与巳甲径平行再用距等半径【午辛】为度从甲心作虚半员截女壬线于亢即从此引甲亢线至癸则数大圈庚癸之度为丁辛角度【即丙角也】
　　解曰试作氐亢房半员其亢甲牛径既与午辛等则氐亢房半员与辛酉子等而氐亢房半员又与大员同甲心则庚癸之度与氐亢等即亦与酉辛等矣
　　又如先有丙角之度及辛子距等线而求丁防所在以作丙丁弧
　　法从大圈庚数至癸令庚癸如丙角之度即从癸向甲心作癸甲线【半径】　次以距等之半径辛午为度从甲心作半员截癸甲【半径】于亢乃自亢作亢丁壬线截辛午于丁即得丁防
　　用规尺法
　　设如乙丁辛弧三角形有乙丁邉六十度有丁辛邉五十度一十分有乙辛邉八十度求辛鋭角
　　如法依三边各作图法以十字剖平员自主线端辛数
　　所设丁辛五十度竒至丁乃自
　　丁作径线过已心又依所设丁
　　乙六十度自丁左数至娄右数
　　至丙皆六十度作丙娄线为距
　　等圈之径又自辛依所设辛乙
　　八十度至房亦左至壬作房壬
　　距等径线此两距等线交于乙乃作乙丁及辛乙丙线则三角形宛然在目今以量法求辛角
　　法曰房甲距等半径与乙甲分线若亢已半径与辛角之余寅已
　　法以比例尺正线用规器取图中房甲之度于半径九十度定尺再取乙甲度于本线求正等度得角之余度乃以所得余度转减象限命为辛角之度
　　依法得余三十一度弱即得辛角为五十九度强又法以房甲为度甲为心作房癸壬距等半圈又作乙癸正与已辛平行如前以房甲度于正九十度定尺再以乙癸度取正度命为辛角度
　　又法作房癸线用分员线取房甲度于六十度定尺再取房癸线于分员线求等度得数命为辛角之度更防论曰既以房甲为半径则乙癸即正乙甲即余房癸即分员皆距等圏上比例也其取角度与分半周度而数房癸之度并同然量法较防
　　又求丁钝角
　　法以丙危为度危为心作娄丑丙半员又作丑乙线当角之正则乙危当余
　　乃取距等半径丙危度于正线九十度定尺再取乙危度求得正线等度命为钝角之余以所得加九十度为丁钝角度
　　依法得余十二度太即得丁钝角一百○二度太或取丑乙线求正线上度命为钝角之正以所得减半周度余为丁钝角度【两法互用相考更确】
　　又法作娄丑分员线取丙危半径于分员线六十度定尺而求娄丑分员之度分为丁钝角【亦可与正法叅考】
　　论曰兼用两法分员线一法以相考理明数确然比半周度之工尚为省力是故量防于算而尺更防矣若兼作丙丑分员以所得度减半周亦同如此则分员线亦有两法合之正成四法矣
　　又论曰此条三邉求角前条有二邉一角求弧可互明也故用图亦可以求角用尺亦可以求弧智者通之可也
　　三极通几
　　平员则有心浑员则有极如赤道以北辰为极而黄道亦有黄极人所居又以天顶为极故曰三极也极云者经纬度之所宗如赤道经纬悉宗北极而黄道经纬自宗黄极地平上经纬又宗天顶亦如屋之有极为楹桷宇梠楶棁之所宗也既有三极即有三种之经纬于是有相交相割而成角度角之鋭端即两线相交之防任指一防而皆有三种经纬之度与之相应焉故可以黄道之经纬求赤道之经纬亦可以赤道之经纬求地平上之经纬以地平求赤道以赤道求黄道亦然举例如后以黄道经纬求赤道经纬　已辰庚斜弧三角形
　　巳丁乙丙为极至交圈
　　巳为北极　丙甲丁为赤
　　道　庚为黄极　壬甲寅
　　为黄道　星在辰　辰庚
　　为黄极距星之纬　辰庚
　　酉角为黄道经度　今求赤道经纬　法自辰作黄道距等纬圈【酉辛】又自辰作赤道距等纬圈【戊午】即知此星【辰】在赤道之北其距纬戊丙【或午丁】　次以赤道距等半径戊夘为度夘为心作午未戊半员又作未辰直线与已甲平行则未戊弧即为赤道经度【即戊巳辰角】
　　若先有赤道经纬而求黄道经纬亦同
　　以赤道经纬求地平经纬
　　巳子戊三角形【三角皆鋭】
　　戊壬庚辛为子午规　壬
　　辛为地平　戊为天顶
　　巳为北极　丁丙为赤道
　　星在子　子巳为星距
　　北极　巳角为星距午规
　　经度【即纬圈上丑子之距】　求地平
　　上经纬　法自子作寅亥线与辛壬地平平行即知地平上星之髙度亥辛【或壬寅】　次作寅酉亥半员【以亥寅半线亥午为度午为心】又从子作酉子直线与戊甲天顶垂线平行即子寅为星距午方之度为子戊寅角数酉至寅之弧即得星在午左或午右之方位是为地平上之经度【按此图为星在夘酉线之北数酉辰若干度即知其星距夘酉线若干度也】　若先得地平上经纬【髙度为纬方位为经】而求赤道经纬【星距赤道为纬距午线时刻为经】其理亦同
　　以两纬度求经度
　　巳子戊斜弧三角形
　　假如北极髙三十度【巳辛髙】戊寅壬为午规　太阳
　　在子距赤道北十度【其距丑丁
　　或卯丙纬度】　子丑为太阳距
　　午线加时经度【即子巳丑角】寅壬为太阳髙度【即亥辛】
　　求大阳所在之方　法以太阳髙度【亥辛或寅壬】作亥寅地平髙度纬线又以太阳距赤道纬【丑丁卯丙】作丑卯赤道北纬线两线相交于子乃以亥午为度午为心作亥酉寅半员【分百八十度】又自子作酉子直线与戊甲平行截半员于酉则酉至寅之度即太阳所到方位离午正之度【即子戊寅外角】　若求加时以北极赤纬线准此求之用子巳戊角
　　求北极出地简法【可以出洋知其国土所当经纬西北广野亦然与地度弧角可以参用】不拘何日何时刻但有地平真髙度及真方位即可得之
　　法曰先以所测髙度及方
　　位如法作图取作平仪上
　　太阳所在之防【即地平经纬交处】次查本日太阳在之道南
　　北纬度用作半径于仪心
　　作一小员末自太阳所在
　　防作横线切小员而过引长之至边此即赤纬通也乃平分通作十字全径过仪心即两极之轴数其度得出地度
　　假如测得太阳在辰髙三十四度方位在正卯南三度强而不知本地极髙但知本日太阳赤纬十九度今求北极度
　　如法作图安太阳于辰【详下文】　先作丙丁线为地平髙度次用法自正东卯数正度至辰得近南三度为地平经度【或以丙卯为半径作半规取直应度分亦同】次依本日太阳赤纬十九度【以员半径取庚甲十九度正】为小员半径作子庚小员末自太阳辰作横线戊壬切小员于庚乃自庚向甲心作大员径线已午则已即北极【数己丑之度为极出地度】依法求得本地极髙四十度
　　论曰此法最简最真然必得正方案之法以测地平经度始无错误










　　厯算全书卷九
　　钦定四库全书
　　厯算全书卷十
　　宣城梅文鼎撰
　　环中黍尺卷三之四
　　初数次数法【加减代乗除之法从初数次数而生故先论之】
　　【上卷之法用角旁两正相乗今则兼用两余故别之为初数次数其法有二其一次数与对弧余相加其一相减也相加又有二一鋭角一钝角也相减有四或余内减次数或次数内减余而又各分锐角钝角也】
　　约法　三边求角






　　角求对边






　　余次数相加例【锐角法钝角法各一】
　　丁乙丙形　有三边求乙锐角　角旁大弧丁巳【正辛戊余巳戊】小弧丙乙【正丙癸余巳癸】两正相乗全数除之成初得数戊庚又以两余相乗全数除之成次得数戊丑【即卯巳】乃以次得数卯巳加对弧之余已戌成卯戌【即申戊】
　　一　初得数　　戊庚
　　二　【次得数与对弧余相并】申戊
　　三　半径　　　亥已
　　四　角之余　已干
　　【以余检表得乙锐角之度】
　　若先有角求对边则反之
　　一　半径　　　亥巳
　　二　角之余　巳干
　　三　初得数　　戊庚
　　四　【次得数与对弧余相并】申戊【以次得数戊丑减之得对弧余丑申即巳戌】
　　论曰辛戊正与亥巳半径同为乙丁弧所分则辛戊全与丁戊分若亥巳全与干巳分也而辛戊与丁戊小又若戊庚句与申戊小句也故戊庚与申戊必若亥巳与干巳
　　若用丁甲丙形其算并同何以明之甲丁者乙丁半周之余甲丙者乙丙半周之余其所用正并同又同用丁丙为对角之弧甲角又同乙角皆以干已为余故也
　　右系对边小于象限角旁弧异类故其法用加而为锐角
　　仍用前图取丁甲寅三角形　有三边求甲钝角　角两旁弧同类　对角边大为寅丁其正酉戌余戌已　旁弧丁甲其正辛戊余已戊　又旁弧寅甲其正寅壬余壬已　初得数戊庚【半径除两正矩】　次得数卯巳【半径除两余矩】
　　所用三率与前锐角形并同亦以卯已加已戌成申戊为三率所得四率干已亦为甲角之余【末以余检表得度以减半周余为甲钝角之度】
　　若先有甲钝角求对边丁寅则反用其率一半径亥已二甲角余干已三初数戊庚四申庚末以次数戊丑去减得数甲戊余丑申为对弧余
　　论曰对弧寅丁系过弧与锐角形对弧丁丙相与为半周之正余度同用酉戌为正戌已为余角旁弧丁甲即乙丁半周之余度同用辛戊为正戊已为余甲寅弧又与乙丙弧等度其正壬寅同癸丙余壬巳同癸巳故加减数并同所异者对弧大而两旁弧又同类故为钝角
　　若用寅乙丁形其算并同以同用丁寅对弧而两弧在角旁者寅乙为寅甲半周之余丁乙为丁甲半周之余所用之正余并同故也甲角同乙角皆以干已余度转减半周为其度
　　右系对边大于象限而角旁两弧同类故其法用加而为钝角
　　正余交变例
　　若角旁两边以象限相加减而用其余弧则正余之名互易而所得初数次数不变三率之用亦不变解曰弧小以减象限得余弧弧大以象限减之而用其余亦余弧也其故何也凡过弧与其减半周之余度同用一正故过弧内减象限之余即反为过弧之余弧亦曰剰弧而此剰弧之正即过弧之余也
　　若两弧内一用余度则其初数次数皆为正乘余半径除之之数然其数不变何也一弧既用余度则本弧之正变为余弧之余而其又一弧仍系本度则正不变然则先所用两正相乗为初数者今不变而为余乘正乎次数仿此
　　试仍以前图明之丁乙丙形任以乙角旁之乙丁弧【即辛乙】内减去亥乙象弧其剰弧亥辛之正戊已即乙辛过弧之余也又亥辛之余辛戊即过弧乙辛之正也然则先以辛戊正乗丙癸正者今不变为辛戊余乘丙癸正乎然但变其名为余乘正而辛戊之数不变则其所得之初数戊庚亦不变也次数仿论【按此法即测星时第二法所用】
　　若角旁两弧俱改用余弧则初数变为两余相乘次数变为两正相乗盖以正变余余变正而所得之初数次数不变
　　试仍以前图明之丁乙丙形乙角旁两弧乙丁改用辛亥【义见前】乙丙改用丙亥皆余弧也则丙癸辛戊两正皆变余【丙癸为丙亥弧余辛戊为辛亥弧余】癸已戊已两余皆变正【癸已为丙亥弧正戊巳为辛亥弧正】然则先以两正相乘者今为两余然虽变两余而其为丙癸与辛戊者不变故其所得之初数戊庚亦不变也次数仿论
　　总例
　　凡弧度与半周相减之余则所用之正同余亦同
　　凡弧度与象限相减之余则所用之正变余余变正
　　余内减次数例【钝角法锐角法各一】
　　丁乙丙弧三角形有三边
　　求乙钝角　丙乙小弧其
　　正丙辰余辰巳　丁
　　乙大弧其正癸甲余
　　甲已　是为角旁之两弧
　　不同类　癸干初得数【两正】
　　【乗半径除之数】　午已次得数【两余乗半径除之数】　丁丙对边大其正壬卯余卯已　对边大于象限而角旁弧不同类宜相减　对弧余大于次数法当于余卯巳内减去次得数午已余午卯【即艮丁】为二率
　　一　初得数　癸干
　　二　【次得数减余】　艮丁
　　三　半径　　辛已
　　四　角余　寅已
　　对边大角旁弧异类而次数小减对弧余其角为钝宜以四率寅已捡余表得度以减半周度其余即为乙钝角之度【即寅酉大矢之度】
　　若先有乙钝角求对弧则反用其率
　　一　半径　　辛巳
　　二　角余　寅已
　　三　初得数　癸干
　　四　【次得数减余】　艮丁
　　既得艮丁乃以次数加之成卯已余检表得度以减半周得丁丙对边之度
　　凡过弧与其减半周之余度同用一余故以余检表得度以减半周即得过弧
　　仍用前图取锐角
　　丁戊庚三角形【系锐角○此形有三锐角】有三边求戊角　戊庚小边其正庚丑余丑巳　丁戊次小边其正癸甲余甲巳　是为角旁弧同类　初得数癸干【半径除两正矩】　次得数午已【半径除两余矩】　丁庚对边小其正壬卯余卯巳　对边小于象限而角旁弧同类宜相减次数午已小于对弧余卯已以午已去减卯已余
　　卯午【即艮丁】
　　一　初得数　癸干
　　二　【次得数减余】　艮丁
　　三　半径　　辛已
　　四　角余　寅已
　　对边小角旁弧同类而次数小去减余其角为锐宜以四率寅已检余表得戊锐角之度
　　若先有戊锐角度求对边丁度则反用其度
　　一　半径　　辛巳
　　二　角余　寅已
　　三　初得数　癸干
　　四　【次得数减余】　艮丁
　　以所得艮丁加次数午已检余表得丁庚对边之度因锐角角旁弧同类次数小于余得数后宜加次数为对边余
　　论曰丁戊庚形与丁乙丙形为相易之形故丁戊为丁乙减半周之余戊庚等乙丙此两弧所用之正余并同则初数次数亦同矣而丁庚对弧亦丁丙对弧减半周之余则所用余边又同加减安得不同
　　次数内转减余例【锐角法钝角法各一】
　　丁乙丙形三边求乙角【系锐角】　丙乙小边正辰丙余辰已　丁乙大边正癸甲余甲已　是为角旁之两边不同类　初得数甲干【半径除两正矩】　次得数午
　　已【半径除两余矩】　丁丙对边
　　大正壬卯余卯已
　　对边大而角旁弧不同类
　　宜相减　次数午已大于
　　对弧余卯已法当于午
　　己内减卯巳余午卯【即甲艮】
　　为二率
　　一　初得数　　甲干
　　二　【余减次数之余】　甲艮
　　三　半径　　　辛巳
　　四　角余　　寅已
　　对边大角旁弧异类而次数大受对弧余之减其角为锐宜以四率寅已检余表得乙鋭角之度【即寅辛矢度】若先有乙角而求对边丁丙则反用其率
　　一　半径　　　辛巳
　　二　角余　　寅己
　　三　初得数　　甲干
　　四　【余减次数之余】　甲艮
　　末以所得甲艮转减次数午已得对弧余卯巳检表得度以减半周为对弧丁丙度
　　前图取钝角
　　丁戊庚形三边求戊角【系锐角】　戊庚小边正丑庚余丑巳　丁戊次小边正癸甲余甲巳　是为角旁两弧同类　初数甲干【半径除两正矩】　次数午已【半径除两余矩】　丁庚对边小正壬卯余卯巳　对边小而角旁两弧同类宜相减　次数午巳大于对边余卯巳当于午巳内减卯已余午卯【即甲艮】
　　一　初得数　　甲干
　　二　【余减次数之余】　甲艮
　　三　半径　　　辛巳
　　四　角余　　寅已
　　对边小角旁弧同类而次数大内减去余其角为钝宜以四率寅巳检余表得度以减半周得戊钝角之度
　　若先有戊钝角而求对边丁庚则反用其率
　　一　半径　　　辛已
　　二　角余　　寅巳
　　三　初得数　　甲干
　　四　【余减次数之余】　甲艮
　　末以所得甲艮转减次数午巳得对弧余卯已检表得对弧丁庚之度
　　一系　半浑员面所成斜三角形左右皆相对如左锐角者右必钝也对边左小者右必大也角旁之边左为同类者右必异类也【角旁两弧一居员周一居圆面此员面弧线左右所同用也而员周之弧左右有大小故同于左者不同于右】
　　加减法【以代乗除】
　　初数次数并以乘除而得今以总弧存弧之余相加减而半之即与乗除之所得脗合法简而妙而甲数乙数之用亦从此生矣
　　总法曰凡两弧相并为总弧相减为存弧【存弧一曰较弧】总弧存弧各取其余以相加减成初数次数　法曰视总弧过弧限则总存两余相加总弧不过象限则相减皆折半为初数【即原设两弧之正相乗半径除之之数】以初数转减存弧余即为次数【即原设两弧之余相乗半径除之之数】又法【总弧过象限两余相减不过象限则相加并折半为次数】又法【初数以相加成者以总弧余减初数以相减成者以总弧余加并加减初数为次数亦同】
　　又取总弧存弧之正相加减成甲数乙数　法曰以总存两正相加折半为甲数【即原设大弧正乗小弧余半径除之之数】总存两正相减折半为乙数【即原设小弧正乘大弧余半径除之之数】又法【以存弧正减甲数其余为乙数亦同】又法【以甲数减总弧正即得乙数】
　　总弧在象限内两余相减
　　大弧丙寅　小弧辰丙【即丑丙】　二弧相加为总弧辰寅相减得存弧丑寅　丑寅存弧之余丑癸【亦即丁乙】
　　辰寅总弧之余卯辰【即癸子亦即乙午】　两余相减【丑癸内减
　　子癸存丑子或乙丁内减乙午存午丁】其余
　　半之【丑子半之于壬成壬丑即亥丁】为【丙寅
　　辰丙】二弧两正相乗半径
　　除之之数即初得数也
　　以初得数转减存弧之余
　　【以壬丑减丑癸其余癸壬亦即亥乙】其余
　　为大小二弧两余相乗半径除之之数即次得数也论曰丙辛大弧之正也丑戊小之正也以句股形相似之故乙丙半径【】与丙辛正【股】若丑戊正【小】与丑壬初得数也【小股】其半而得者何也曰辰戊同丑戊则戊巳亦同丑壬而壬子即已戊则子丑者初得数【壬丑】之倍数故半之即得　辛乙大弧之余也戊乙小弧之余也乙丙半径【】与辛乙余【句】若戊乙余【小】与亥乙次得数也【小句】又以存弧余内兼有初得次得两数故减初得次也【丑癸余内有丑壬初数癸壬次数故减丑壬即得癸壬也或于乙丁内减亥丁得亥乙并同】
　　以上用总存两余加减
　　又丑寅存弧之正丑丁【即午子或癸乙】辰寅总弧之正辰午【即卯乙】两正相加半之为大弧正乗小弧余半径除之之数即甲数也　以甲数转减总弧之正【以午已减辰午其余巳辰亦即卯未】是为大弧余乗小弧正半径除之之数即乙数也
　　论曰乙辛大弧之余也辰戊小弧之正也以两句股形同比例之故丙乙半径【】与乙辛余【句】若辰戊正【小】与辰已乙数也【小句】
　　又丙辛大弧之正也戊乙小弧之余也而丙乙半径【】与丙辛正【股】若戊乙余【小】与戊亥甲数【小句】也又以总弧正内兼有甲乙两数故减乙得甲减甲亦得乙矣【辰午正内有辰巳乙数巳午甲数故减辰巳得巳午若减巳午亦必得辰巳】
　　以上用总存两正加减
　　若以酉丙为大弧丙丑为小弧则其总弧酉丑【正丑丁余丑癸】其存弧辰酉【正辰午余卯辰】但互易存总之名其他并同论曰凡过象限之弧与其减半周之余弧同用一正如丙酉过弧以减半周得丙寅所用正【丙辛】余【辛乙】皆丙酉弧与丙寅弧之所同也故但易总存之名而正余加减之用不变又法　凡过象限之弧即截去象限用其余度如法加减但以总弧为存弧存弧为总弧而总存之余为正正为余如酉丙过弧截去酉甲象限只用丙甲为大弧与丙丑小弧相加减则丑甲为总弧其正丑癸余丑丁而辰甲为存弧其正卯辰余辰午是总存正余名皆互易也法以总存两正相减而其余折半为甲数【丑癸内减卯辰余丑子半之得丑壬为甲数】仍以甲数转减总弧正【甲数丑壬转减丑癸其余癸壬即乙数】是其名虽易而其实不易也但横易为直
　　论曰去过弧之象限而用之则过弧之正为余余为正矣故加减而得之数皆两弧之正乘余余乘正之数而非复正乗正余乘余之数也何也过弧之正余互易而小弧之正余如故也
　　如丙酉过弧去象限为丙甲则其正丙庚即过弧之余也【丙庚即辛乙故】其余庚乙即过弧之正也【庚乙即丙辛故】而小弧丙丑之正丑戊余戊乙皆如旧故先得之丑壬为大弧余丙辛乘小弧正丑戊而丙乙半径除之也非两正相乘也乙数转减正而得之亥乙【即癸壬亦即戊未】为大弧正辛乙乘小弧余戊乙而半径除之也非两余相乘也
　　又论曰又法即测夜时篇中测星距午之第二法也加减代乗除只此一例而絶不与七卷八卷之乘除求初数次数者相虽有学者何从悟入乎愚故为之详説以发其覆
　　又论曰元法依图直看直者正横者余又法正余互易则图当横看变立体为眠体本以总存两余加减者变为两正加减然其数并同
　　又论曰又法是用大之余度而小弧则用元度何以言之测星条用星之赤纬即去极之余度也其用赤道髙则极去天顶之元度也然而赤纬在南者则是于星去极度截去象限之数也何以亦为余度曰过弧既与其减半周之余度同一正则此减半周之余度亦即正弧也然则此截去象限而余者非即正弧之余度乎大弧过象限若干度与不及象限若干度其正并同故加减可通为一法【此又测星条用法之意】
　　约法
　　两弧俱用本度或俱用余度相加减以取总存二弧是两正或两余也则用总存两余加减法取初得数惟视总存二弧俱在一象限则相减或分跨两象限则相加皆以初数减存弧之余为次得数
　　若两弧内有一过弧则总弧之正小于存弧而余反大当以初数减总弧之余为次数
　　若一弧用本度一弧用余度相加减以取总存之弧是一正一余也则用总存两正加减法其加减皆眎两正原法或加或减取甲数即以甲数减总弧正余为乙数
　　若过弧节去象限而用其剰度与余度同法【凡余度是以本度减象限而得名今反以象限减过弧故别之曰剰】
　　若两俱剰弧与两余弧同法
　　若只一剰弧与一正一余同法
　　论曰过弧用剰度为余弧其法甚简快凡过弧皆当用之可不用本度矣【算普天星经纬岁差宜此】
　　又按凡存弧之余内兼有两正相乗两余相乗两数即初次两得数也凡总弧之正内兼有此正乗彼余彼正乗此余之数即甲乙两数也故易其名以别之也
　　大弧寅丙正丙辛余
　　辛乙　小弧辰丙【即丑丙】正
　　辰戊【即丑戊】余戊乙
　　二弧相加为总弧辰寅正
　　辰午余午乙　相减
　　为存弧丑寅正丑丁余
　　丁乙　存总两余【午乙丁乙】相并成午丁半之于亥成亥丁即初得数大小二弧两正【丙辛辰戊】相乗半径除之之数也　以初得数亥丁转减存弧之余丁乙余亥乙即次得数大小二弧两余【辛乙戊乙】相乗半径除之之数也
　　论曰以句股形相似之故丙乙半径与丙辛正若戊丑正与初数丑壬【即亥丁】也皆比股也
　　又丙乙半径与辛乙余若戊乙余与次数亥乙也皆比句也
　　以上用总存两余加减因总弧跨过象限故相加
　　又存弧正丑丁与总弧正辰午相加成辰干【以午干等丁艮亦即丑丁也】折半得巳午【即戊亥　辰子折半为巳子子干折半为午子合之成巳午】为甲数大弧正丙辛乗小弧余戊乙半径丙乙除之也
　　以甲数已午转减总弧正辰午余辰巳为乙数大弧余辛乙乗小弧正辰戊半径丙乙除之也
　　以上用总存两正加减
　　若用酉丙过弧为大弧丙丑为小弧则其总弧酉丑存弧酉辰但互易存总之名其它并同以过弧酉丙所用之正丙辛余辛乙即丙寅弧所同用故也
　　又法
　　于酉丙过弧内截去象限酉甲只用其剰弧甲丙则甲丙反为小弧丙丑反为大弧【説见前条】
　　图式三
　　总弧在象限内两余相
　　减　乙丙小弧其正丙
　　辰余辰已　丁乙稍大
　　弧其正丁甲余甲巳
　　戊壬初得数【两正相乗半径除】
　　【也即庚甲或戊卯】　午戊次得数
　　【两余相乗半径除也即巳癸】　今改用加减以省乗除　以二弧相加成总弧丁丙其正子丁余子巳　又二弧相较成存弧壬丙其正壬辛【卽午巳】余辛巳【卽壬午】
　　于存弧之余辛巳内减去总之余巳子存子辛半之于癸得子癸及辛癸皆初得数也亦卽戊壬也【或于壬午丙减午卯半之于戊得卯戊及戊壬亦同亦即庚甲也】　又于存弧余辛已内仍减去初得数辛癸存癸已即次得数也【壬午内减戊壬存午戊亦同】
　　此因总弧在象限内故以总弧余减存弧余求初数是初数小于次数
　　解曰以句股形相似之故己丙半径【】与丙辰正【句】若丁甲正【】与甲庚初数也又壬甲等甲丁故庚甲亦等戊壬而戊卯即庚甲故可以半而得之也
　　又已丙半径【】与辰已余【股】若甲已余【】与巳癸次数【股】也
　　右系总存两余用法
　　又丁庚为甲数【丁甲大弧正乗辰巳小弧余半径除之也亦即庚卯即甲戊】　子庚为乙数【辰丙小弧正乗甲巳大弧余半径除之也即癸甲】
　　今改用加减法以存弧正子卯【即辛壬】加总弧正子丁成卯丁而半之于庚得丁庚为甲数【亦即庚卯即戊甲】　仍于总弧正丁子内减去甲数丁庚存子庚【即癸甲】为乙数
　　此亦总弧在象限内亦总存两正相加求甲数是甲数大于乙数
　　解曰以句股形相似之故已丙半径与辰巳小弧余若丁甲大弧正与甲数丁庚皆与股之比例也又丁甲等壬甲故戊甲亦等丁庚而戊甲即庚卯故可以半而得之也
　　又巳丙半径与丙辰小弧正若甲已大弧余与乙数甲癸【即子庚】皆与句之比例也
　　右系总存两正用法
　　一系　凡两弧内无过弧则存弧之余大故其中有初次两数而总弧则正大故其中有甲乙两数虽两数相加能令总弧跨过象限此理不变余仍系存弧大正仍系总弧大
　　总弧过象限两余相加
　　乙丙小弧正辰丙余
　　辰已　乙丁过弧正
　　丁甲余甲已　初得数
　　戊丁【半径除两正矩即子癸亦即癸辛亦即
　　庚甲】　次得数癸巳【半径除两余矩】
　　今用加减代乗除以二弧相加成总弧丁丙正丁子余子已　又二弧相较成存弧壬丙正壬辛余辛巳　乃以总存两余相加成子辛【子巳加辛巳】而半之于癸得子癸及癸辛【亦即丁戊即庚甲】初得数也　又以初数子癸转减总弧之余子已余癸巳次得数也【此因总弧跨过象限故两余相加求初数是初数大于次数】
　　解曰以句股形相似故半径已丙与正丙辰若正丁甲与初数丁戊皆与股之比例也　又半径丙已与余辰已若余甲巳与次数癸已皆与句之比例也　又壬甲等丁甲则庚甲亦等戊丁而辛癸亦等子癸故半而得
　　右用总存两余加减
　　又甲数丑甲小弧余辰已乗过弧正丁甲半径除之也　乙数癸甲小弧正辰丙乗过弧余甲巳半径除之也
　　今用加减搃存两正相加成丑戊【癸戊与正丁子等丑癸与正辛壬等故以相加即成丑戊】半之于甲得丑甲【亦即甲戊】为甲数　仍以甲数丑甲转减存弧正丑癸余癸甲为乙数【或以总弧正癸戊减甲数甲戊亦即得乙数癸甲】
　　此亦总弧跨象限外仍系总存两正相加求甲数【甲数仍大于乙数】
　　解曰半径丙已与小弧余辰已若大弧正丁甲与甲数丑甲皆以比句也　又半径丙已与小弧正辰丙若大弧余甲巳与乙数癸甲皆以比股也又壬甲等丁甲则甲戊亦等壬庚而壬庚即丑甲故半之而得
　　右用总存两正加减
　　一系　凡两弧内有过弧者总弧之余反大故初次两数皆在总弧余内而总弧之正反小故甲乙两数皆在存弧正内也【此必原有一过弧始用此例非谓总弧过象限也观图自明】
　　甲数乙数用法【黄赤道经纬相求】
　　黄赤二道经纬相求用斜弧三角形以星距黄极为一边星距北极为一边并两极之距为三边此本法也今不用距极度而用其余度【距极度本为纬度之余今用三角形以距极度为边故纬度皆为余度】径取黄纬为一边【此先有黄纬而求赤纬也若先有赤道而求黄道即用赤纬为边】二至之黄赤大距为一边【黄赤大距原与两极之距等】而取二边之总存两正为用以加减省乘除故在本法为初数次数者别之为甲乙数焉甲数乙数不止为求黄赤而举此为式其理特着故命之曰甲数乙数用法实黄赤相求简法矣
　　第一图　黄纬小于黄赤大距甲数大乙数小
　　甲丙亢危大圈为过
　　两极之经圈【即二至经圈】心乙亢轴即黄道
　　二分经线　丙乙室
　　为黄道　心为黄极
　　寅乙危为赤道
　　甲为北极　辰胃娄
　　为黄道北纬【即丙辰之度】　丑尾奎为黄道南纬【即丙丑之度】星在箕　箕心为星距黄极纬度　箕女为星距黄道纬【即丙辰之度】　甲心箕锐角为黄道经度其余女乙甲心为两极相距【二十三度三十一分半】　寅丙为夏至距纬【同甲心之度】
　　今求甲箕为星距北极纬度　其余弧箕翌为星距赤道纬【即氐危之度】
　　用甲心箕三角形有心角【黄道经】有心箕弧【星距黄极纬】有甲心弧【为两极之距】而求对角弧甲箕【星赤道北极纬】
　　依加减代乗除改用寅丙夏至距【即心甲】辰丙黄道纬【即心箕之余箕女又即丙丑度】　寅丙辰丙相加为总弧辰寅其正辰午　又相减为较弧丑寅其正丑丁【亦即丁井亦即午昴亦即子午】以丑丁正【即午昴】加辰午正成辰昴折半得巳午
　　甲数【巳子为辰子之半子午为子昴之半合之成巳午】甲数【巳午】转减正【辰午】余【巳辰】为乙数
　　或以丑丁正【即子午】减辰午正余辰子折半得辰巳为乙数以乙数转减总弧正辰午得已午为甲数亦同
　　法为黄道半径【丙乙】与心角之余【女乙】若甲数【巳午】与四率【斗未】也
　　一　黄道半径　丙乙
　　二　心角余　女乙
　　三　甲数　　　巳午【即戊酉】
　　四　【减过乙数之赤纬正】斗未【即虚栁】
　　论曰丙乙半径与女乙余原若辰胃与箕胃【辰胃者箕心黄纬之正即距等圏半径因箕心角线过箕至女分辰胃正于箕亦分丙乙半径于女故丙乙与女乙若辰胃与箕胃皆全与分比例】而辰胃同戊乙箕胃同斗乙皆也【戊酉乙大句股以戊乙为戊酉为句斗未乙小句股以斗乙为斗未为句】戊酉【同巳午】斗未皆句也则其比例等故丙乙与女乙能若戊乙与斗乙亦即若已午与斗未
　　以乙数【辰巳即箕虚】加四率【斗未即虚栁】成箕栁即所求赤道纬度正检表得赤纬在北【即箕翌亦即氐危】
　　若先有赤纬黄纬而求黄经则互用其率以三四为一二法为甲数【戊酉】与赤纬正内减乙数之斗未若黄道半径【丙乙】与心角黄经度之余【女乙】也
　　一　甲数　　　戊酉【即午巳】
　　二　【乙数箕虚减赤纬正】半未【即虚栁】
　　三　黄道半径　丙乙
　　四　心角余　女乙　　　检余表得心角之度假如前图星在尾为黄道南纬则所用之甲数乙数并同所得之四率亦无不同而赤纬逈异
　　何以言之曰心不在箕而在尾则心
　　甲弧【两极距度】心角【黄道经度】皆不变唯尾心
　　弧大于箕心故甲心箕三角形变为
　　甲心尾三角而所求对角之甲尾弧
　　亦大于甲箕故赤纬异也
　　然则所用之甲数乙数又同何也曰尾心为过弧则用在女尾【尾心内减去女心象限】女尾为黄道南纬与箕女北纬同度亦即同正则相加为总弧相减为较弧亦同而甲乙数不得不同矣而三率算法亦必同矣但所得四率在北纬则用加在南纬则用减纬度迥异理势自然也一　黄道半径　丙乙
　　二　心角余　女乙　以乙数【辰巳】减四率斗未减尽三　甲数　　　已午　无余为星在赤道无纬度四　【加过乙数之赤纬正】斗未
　　论曰此因乙数与四率同大故减尽也减尽则甲尾正九十度而星在赤道无纬也
　　亦有四率小于乙数者则当以四率转减乙数用其余为纬度正在赤道南
　　又论曰星在箕为黄道北在尾为黄道南然所得赤纬皆在北者以箕尾经度皆在夏至前后两象限中也故所得四率在赤道北而加乙数则北纬大减乙数则北纬小皆北纬也惟四率转减乙数则变为南纬【此亦惟黄南纬星又近二分则虽在夏至前后象限中而有南纬】
　　亦有无四率者心角必九十度其星必在黄道二分经度无角度余为次率故亦无第四率可求但以乙数为用视星在南北即以乙数命为南北纬度之正假如前图中有星在胃是在北也即以乙数胃张【即辰巳】命为赤道北纬之正若星在房是在南也即以乙数乙癸【亦即辰巳】命为赤道南纬之正
　　又有所得四率北反用减南反用加者心角必为钝角其星必在冬至前后两象限其角度余必为大矢内减仪象限之余则所得第四率在赤道之外【外即南也】而加减后所得皆赤道之南纬也故加减皆反【求北纬以加而南纬必减者星在北也求北纬以减而南纬必加者星在南也盖所得第四率原系在北在南两星纬度之中数　星在北在南皆主黄道言】假如前图中有星在兑为黄道北而甲心兑三角形心
　　为钝角其余艮乙为艮丙大矢内
　　减象限之余故所得第四率未斗在
　　赤道之外为赤道南纬【此南纬是黄道轴距赤道
　　轴】而兑星在黄道之北则其南纬正
　　小于未斗故必以乙数牛斗【即辰己亦即奎巳】减之其余牛未【同兑庚】即兑星赤道南纬之正
　　若星在巽亦同用心钝角为甲心巽三角形艮乙余四率未斗在赤道外并同但巽星又在黄道之南则其南纬大于未斗四率故必以乙数虚巽【即辰巳亦即牛斗】加之成巽栁即巽星南纬之正
　　亦有四率小于乙数者则以四率转减乙数用其余为纬度在赤道北
　　又论曰星在兑为黄道北在巽为黄道南然所得赤纬皆在南者以兑巽经度皆在冬至前后两象限中也故所得四率在赤道南而以乙数减则南纬小以乙数加则南纬大皆南纬也惟四率转减乙数者则变为北纬【此亦必黄北纬星又近二分故虽在冬至前后象限中而仍有北纬　凡以乙数及四率相加减成纬度者并主纬度之正而言后仿此】
　　总论曰凡乙数皆南北两赤纬度相减折半之数甲数则两纬度之中数也【如箕女与女尾两黄纬同度而不能以女庚为两赤纬之中数者弧度有斜正故也】而所得四率即所求星南北两纬正中数故与甲数为比例
　　凡所得四率星在夏至前后两象限四率在赤道北星在冬至前后两象限四率在赤道南
　　凡总弧正内兼有甲数乙数【不论黄南黄北并同一法】但视黄纬之大小若黄纬小于黄赤大距则以总存两正相并而半之为甲数若黄纬大于黄赤大距则以总存两正相减而半之为甲数并以甲数转减总弧正为乙数又法
　　黄纬小于黄赤大距以总存两正相减而半之则先得乙数黄纬大于黄赤大距以总存两正相并而半之亦先得乙数并以乙数转减总弧正为甲数求赤纬约法
　　凡星有黄纬之南北有黄经之南北【黄经南北即南六宫北六宫　星在夏至前后先得之黄经为鋭角是经在北也　星在冬至前后先得之黄经为钝角是经在南也】若星之黄纬南北与黄经同者其赤纬南北亦与黄纬同法用四率乙数相加为纬度正加惟一法
　　星在黄道北又系夏至前后两象限先得黄经鋭角是经纬同在北则赤纬亦在北　星在黄道南又系冬至前后两象限先得黄经钝角是经纬同在南则赤纬亦在南
　　若星之黄纬南北与黄经异者赤纬有同有异皆四率乙数相减为赤纬正减有二法
　　但视乙数大受四率转减者赤纬之南北与黄纬同如星在黄道北而在冬至前后两象限黄经角钝是纬北而经南也而乙数大受四率转减则赤纬仍在北星在黄道南而在夏至前后两象限黄经角鋭是纬南而经北也而乙数大受四率转减则赤纬仍在南若乙数小去减四率者赤纬之南北与黄纬异　如星在黄道北而在冬至前后黄经角钝为纬北经南而乙数又小去减四率则赤纬变而南　星在黄道南而在夏至前后黄经角鋭为纬南经北而乙数又小去减四率则赤纬变而北
　　若星在黄道轴线是正当二分经度也其角必九十度无余亦无四率但以乙数为用　星在北即以乙数命为赤道北纬之正　星在南即以乙数命为南纬之正
　　若遇乙数四率相减至尽者其星正当赤道无纬度第二图　黄纬大于黄赤大距甲数小乙数反大【有黄道经纬求赤纬】
　　甲北极　心黄极
　　甲心为两极之距
　　丙室黄道　寅危赤
　　道　寅丙为夏至大
　　距【同甲心】　乙为二分
　　以上并与前图无
　　二　所异者黄纬丙
　　丑【即丙辰】大于寅丙故
　　乙数亦大于甲数　寅丙之正丙辛余辛乙　丙丑之正辰戊【或戊丑】余戊乙
　　甲数戊酉乃寅丙正乗丙丑余半径除之也法为丙乙半径与正丙辛若戊乙余与甲数戊酉乙数辰巳【或巳子或戊壬】乃辛乙余乗辰戊正半径除之也法为丙乙半径与余辛乙若辰戊正与乙数辰巳
　　假如星在箕为在黄道北箕心为距黄极之度其余箕女黄道北纬也有箕心甲心【两极距】二边有心锐角【黄经】用甲心箕三锐角弧形求赤纬甲箕为对角之弧
　　依加减代乗除改用寅丙辰丙二弧相加为总弧辰寅其正辰午　又相减成较弧寅丑其正丑丁【即午子】以丑丁正加辰午正成辰子折半于巳为乙数【辰巳及巳子】　乙数辰已转减总弧正辰午得已午为甲数【即戊酉】
　　本法以丑丁减辰午折半得已午为甲数　甲数巳午转减辰午得辰巳为乙数
　　法为黄道半径丙乙与余女乙若甲数戊酉与四率斗未也【理见前式论见】
　　一　黄道半径　丙乙　　　　既得斗未以乙数箕
　　二　心角余　女乙　　　　虚加之成箕栁为赤
　　三　甲数　　　戊酉　　　　纬正查表得箕翌四　【以乙数减赤纬正】　斗未【即虚栁】　赤纬度在赤道北右系黄纬在北而心为锐角黄经亦在北故法用加而赤纬仍在北
　　若先有黄赤纬度而求黄经则互用其率亦同前式一　甲数　　　戊酉
　　二　【乙数减赤纬正】　斗未
　　三　黄道半径　丙乙
　　四　心角余　女乙　　查余表得心角之度假如前图星在尾为在黄道南则所用之甲数乙数及所得之四率并同惟赤纬异
　　论曰星不在箕而在尾则甲心箕三
　　锐角形变为甲心尾三角形而心尾
　　弧大于心箕故所求对角之甲尾弧
　　亦大于甲箕而赤纬大异
　　心尾大于心箕而甲数乙数悉同者因用余弧则女尾南纬与女箕北纬同度故也
　　一　黄道半径　丙乙　　既得斗未以转减乙数斗二　心角余　女乙　　牛得余未牛【即尾申】为赤纬三　甲数　　　戊酉　　正查表得尾卯纬度在四　【乙数内减赤纬正】　斗未　　赤道南
　　论曰此系乙数跨赤道故乙数内兼有赤纬及四率之数而减赤纬得四率以四率转减亦得赤纬
　　右系黄纬在南而心为锐角是纬南而经北法当用减而乙数大受四率反减故赤纬仍在南
　　假如前图星在巽则所用之甲数乙数亦同惟四率异【因巽艮黄纬即室奎之度与丙丑同故甲数酉戊与戊酉同大而乙数斗牛兊干并同辰巳】
　　又巽星在黄道南而心为钝角星在
　　秋分后春分前黄经亦在南则赤纬
　　亦在南法当用加

　　一　黄道半径　　　丙乙【即室乙】
　　二　【钝角余即大矢减半径之余】　艮乙【艮丙为心钝角大矢内减丙乙得艮乙】
　　三　甲数　　　　　酉戊
　　四　【赤纬正内减乙数】　　　未斗
　　既得未斗以乙数斗牛【即辰巳】加之成未牛为赤纬正【即栁巽】查表得震巽纬度在赤道南
　　假如前图星在兑为黄道北所用之
　　甲数乙数四率并同惟赤纬异【兑艮北纬
　　与巽艮南纬并同丙丑之度故甲数乙数同甲心巽与甲心兊两钝角形
　　同用心钝角故四率亦同惟心兊弧小于心巽故所求对角弧甲兊亦小】
　　【于甲巽而赤纬异】
　　一　黄道半径　丙乙　　　既得未斗以转减乙数二　钝角余　艮乙　　　兊干得余兊离为赤纬三　甲数　　　酉戊　　　正查表得兊坎纬度四　【乙数内减赤纬正】　未斗【即离干】　在赤道北
　　右系黄纬在北而心为钝角是秋分后春分前为纬北而经南法当用减而乙数大受四率转减故赤纬仍在北
　　第三图　赤纬大于二极距甲数小乙数大
　　心甲箕三鋭角形　星在箕　有黄极纬心箕有北极
　　赤纬甲箕有黄赤极
　　距心甲【即室危】求甲角
　　为赤经　辰危赤纬
　　大于危室大距【即心甲】与前图略同故乙数
　　亦大于甲数　所异
　　者此求赤经故诸数
　　皆生于赤纬谓总弧
　　较弧皆用赤纬也而加减正反在黄道矣
　　室危两极距之正室辛余辛乙
　　辰危赤纬【即箕女为甲箕距比极之余】之正辰酉余酉乙甲数戊酉法为半径室乙与辛室正若酉乙余与甲数戊酉也
　　乙数辰已法为半径室乙与辛乙余若辰酉正与乙数辰已【或娄酉正与乙数酉壬】也
　　依加减代乗除改用辰危室危相加为总弧辰室其正辰午又相减为较弧娄室其正娄丁【即午昴】
　　又以较弧正午昴减总弧正辰午余数半之得已午为甲数【即戊酉也法于辰午内截减辰坤如午昴其余坤午半之于已即得已午】
　　甲数已午转减辰午正余辰巳为乙数【或以甲数已午加较午昴成巳昴乙数亦同】箕虚及未牛并同【皆乙数也】
　　又以箕翼黄纬之正箕柳与乙数箕虚相减得虚柳【即未斗】以为次率【因箕栁黄纬大乙数箕虚小故于黄纬正内减乙数得未斗】
　　法为甲数戊酉与未斗若酉乙与未乙亦即若危乙半径与甲角之余女乙也
　　一　甲数　　　　戊酉
　　二　【黄纬正内减去乙数】　未斗
　　三　赤道半径　　危乙
　　四　甲角余　　女乙
　　论曰赤道经度春分至秋分【北六宫】为钝角秋分至春分【南六宫】为锐角其角与黄经正相反此条星在箕是赤纬在北也而黄纬亦北两纬同向宜相减成次率而乙数小于黄纬必以乙数减黄纬而得未斗乙数减黄纬而纬在北赤经必南六宫为锐角查表得度为甲角度即赤经也在秋分后以所得减三象限在冬至后以所得加三象限皆命为其星距春分赤道经度
　　若星在尾用甲心尾三角形则以黄
　　纬正反减乙数为次率【未牛乙数大于黄纬
　　斗牛故以斗牛反减未牛得未斗】余率并同

　　论曰此条星在尾是赤纬在南也而黄纬亦并在南两纬同向宜相减而成次率而乙数大于黄纬宜于乙数内转减去黄纬成未斗也乙数大受黄纬转减而纬在南赤经必亦在南六宫为锐角
　　一　甲数　　　　戊酉
　　二　【乙数内减黄纬】　　　未斗
　　三　赤道半径　　危乙
　　四　甲角余　　女乙
　　假如前图星在兊用心甲兊三角形
　　有心兑边【星距黄极】有甲兑边【星距北极】有心
　　甲边【两极距】求甲钝角为赤道经度
　　因赤纬同故甲数乙数同
　　星在兊赤纬在北黄纬亦在北纬同向北宜相减而成次率而乙数大以黄纬减之得斗未【乙数兊干内减去黄纬兊离余离干即斗未】
　　乙数大受黄纬转减而赤纬在北必赤经亦在北六宫为钝角
　　一　甲数　　　酉戊
　　二　【乙数内减去黄纬】　斗未
　　三　赤道半径　寅乙
　　四　甲角余　艮乙
　　以艮乙查余表得度用减半周为甲钝角即赤经也在春分后以象限减钝角度在夏至后以钝角度与三象限相减皆命为星距春分赤道经度
　　假如星在巽用心甲巽三角形有心巽边【距黄极】有甲巽边【距北极】有甲心边【两极距】求甲钝角为赤经
　　甲数乙数并同
　　惟心在巽是赤纬南也黄纬亦南也两纬并南宜相减
　　成次率　乙数小黄纬大故以乙数
　　减黄纬得斗未【斗牛黄纬即栁巽也内减乙数未牛余即
　　斗未矣】　乙数小去减黄纬而赤纬在
　　南赤经必在北六宫为钝角
　　一　甲数　　　酉戊
　　二　【黄纬内减乙数】　　斗未
　　三　赤道半径　寅乙
　　四　甲角余　艮乙
　　以艮乙余查度春分后用余度减象限夏至后加象限皆命为距春分赤经


　　第四图　赤纬小于二极距甲数大乙数小
　　假如星在箕用心甲
　　箕钝角形有心箕过
　　【距黄极对角边也其余箕翼即黄纬】有
　　甲箕边【距北极即辰危之余】有
　　心甲边【两极距寅丙及危室并同】求甲钝角赤道经
　　两极距危室之正
　　危辛余辛乙　赤纬危辰之正辰戊余戊乙甲数戊酉【为半径危乙与二极距之正危辛若赤纬余戊乙与甲数戊酉也】
　　乙数辰巳【或戊壬　为半径危乙与二极距之余辛乙若赤纬正辰戊与乙数辰巳也】依加减代乗除以辰危危室两弧相加为总弧辰室其正辰午
　　又相减为较弧娄室其正娄丁【或丁井即午昴】
　　以总弧正辰午加较弧正午昴成辰昴而半之为甲数巳午【巳坤为辰坤之半坤午为坤昴之半合之为巳午】即戊酉
　　又以甲数己午转减正辰午得辰巳为乙数【亦即戊壬】星在箕为赤纬北而黄纬亦在北两纬同向宜相减而成次率而乙数大当以黄纬转减之成斗未【牛未乙数内减牛斗黄纬余斗未】
　　乙数大受黄纬反减而纬在北赤经在北六宫为钝角一　甲数　　　酉戊　　以艮乙余查度春分后二　【乙数内减黄纬正】　斗未　　用减象限夏至后加象限三　赤道半径　寅乙　　命为距春分经度
　　四　甲角余　艮乙
　　若星在尾用心甲尾三角形则为南纬而黄纬亦南两
　　纬同向宜相减成次率而乙数小于
　　黄纬故以乙数减黄纬成斗未【虚尾黄纬
　　内减乙数氐尾余虚氐即斗未】　其甲数乙数等算
　　并同　乙数小去减黄纬而纬在南
　　赤经必在北六宫为钝角
　　一　甲数　　　酉戊
　　二　【黄纬正内减乙数】　斗未
　　三　赤道半径　寅乙
　　四　甲角余　艮乙
　　若星在兑用心甲兑三角形兑为北纬而黄纬亦北两
　　纬同向宜相减成次率而乙数小于
　　黄纬故以乙数减黄纬成未斗【兊干黄纬
　　内减乙数兊离余余离干即未斗】甲数乙数并同
　　乙数小去减黄纬而纬在北赤经反
　　在南六宫为锐角
　　一　甲数　　　戊酉　　以女乙余度秋分后减二　【黄纬正内减乙数】　未斗　　三象限冬至后加三象限三　赤道半径　危乙　　命为距春分赤经【下同】四　甲角余　女乙
　　若星在巽用心甲巽三角形赤纬南黄纬亦南两纬同向宜相减成次率而乙数大以黄纬转减之成未斗【未牛乙数内减黄纬斗牛即栁巽其余即未斗】
　　乙数大受黄纬转减而纬在南赤经
　　即在南六宫为锐角


　　一　甲数　　　戊酉
　　二　【乙数内减黄纬正】　未斗
　　三　赤道半径　危乙
　　四　甲角余　女乙
　　第五图　赤纬小于二极距甲数大乙数小
　　黄纬乙数相加成次
　　率【黄纬在南角鋭钝黄纬在北角】星在巽用心甲巽三
　　角形有心甲边【二极距】有巽甲边【距北极度为过弧其
　　赤纬女巽在南】有巽心边【距黄
　　极度其余巽为黄纬在北】　求对
　　巽心弧之甲角　心甲两极距即危室【或寅丙】其正危辛余辛乙　女巽赤纬即危娄【或辰危即丑寅】其正辰戊余戊乙
　　甲数戊酉【两极距正危辛乗赤纬余戊乙半径危乙除之之数也法为危乙与危辛若戊乙与戊酉】乙数辰巳【两极距余辛乙乗赤纬正辰戊半径危乙除之之数也法为危乙与辛乙若辰戊与辰巳】依加减代乗除改用辰危危室相加为总弧辰室其正辰午又相减为较弧娄室其正娄丁【即午昴及丁井】以总较两正相加成辰昴折半得巳午为甲数即戊酉【巳坤为辰坤之半坤午为坤昴之半合之成己午】
　　甲数巳午转减总弧正辰午得辰巳为乙数即戊壬黄纬巽氐在北赤纬女巽在南两纬异向宜以乙数与黄纬正相加成次率【以同黄纬正巽栁之牛斗加同乙数戊壬之未牛成未斗】乙数黄纬正相加而黄纬在北其赤经必在南六宫为锐角法为甲数戊酉与未斗若戊乙与未乙亦即若危乙与女乙
　　一　甲数　　　　戊酉　　以女乙查余表得度二　【乙数加黄纬正】　未斗　　秋分后减冬至后加皆与三　赤道半径　危乙　　三象限相加减命为其星四　甲角余　女乙　　距春分赤道经度
　　又如星在箕用心甲箕三角形有心甲边【二极距】有箕甲边【距北极度其余箕艮赤纬在北】有箕心边【距黄极度为过弧其黄纬翼箕在南】求对箕心弧之甲角
　　甲数乙数同上
　　惟黄纬翼箕在南赤纬箕艮在北两纬异向宜以乙数
　　与黄纬正相加成次率【以黄纬正箕张相
　　同之牛斗加乙数辰巳相同之牛未成斗未】
　　乙数与黄纬相加而黄纬在南其
　　赤经必在北六宫为钝角法为甲数
　　酉戊与斗未若戊乙与未乙亦即若寅乙与艮乙一　甲数　　　戊酉　　以艮乙查余表得度春二　【乙数加黄纬正】　斗未　　分后减夏至后加皆加减三　赤道半径　寅乙　　象限命为其星距春分赤四　甲角余　艮乙　　赤道经度
　　求赤道经度约法
　　用三边求角【两极距为一边距北极为一边此二边为角两旁之弧距黄极为一边此为对角之弧】以求到钝角赤道经度在北六宫锐角赤道经度在南六宫
　　法为甲数与次率若赤道半径与所求角之余其枢纽在次率也
　　凡黄纬南北与赤纬同向者并以乙数与黄纬相减而成次率减有二法




　　凡黄纬南北与赤纬异向者并以乙数与黄纬相加而成次率
　　加惟一法















　　厯算全书卷十
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书卷十一
　　宣城梅文鼎撰
　　环中黍尺卷五之六
　　加减捷法
　　用加减则乗除省矣今惟用初数则次数亦省又耑求矢度省余则角之锐钝得矢自知边之大小加较即显无诸拟议之烦故称捷法
　　如法角旁两弧度相加为总相减为存视总弧过象限以总存两余相加不过象限则相减并折半为初数
　　若总弧过两象限与过象限法同【其余仍相加】过三象限与在象限内同【其余仍相减】若存弧亦过象限则反其加减【总弧过象限或过半周宜相加今反以相减若总弧过于三象限宜相减今反以相加】并以两余同在一半径相减不然则加也
　　总存两余同在一半径当相减折半图
　　乙丁丙三角形
　　丁为钝角


　　丙卯为总弧其正卯
　　戊余戊己　庚丙为
　　存弧其正庚壬余壬巳　两余同在丙已半径宜相减【壬巳余内减戊巳成戊壬】折半为初数丑壬【即甲庚亦即未酉】总存两余分在两半径当相加折半图
　　乙丁丙形　丁为锐角


　　庚丙为总弧其正弧庚
　　壬余壬巳　卯丙为
　　存弧其正卯戊余
　　戊已径两余分在丙巳子巳两半径宜相加【以戊巳加壬巳成壬戊】折半为初数丑戊【即甲酉亦即未卯】
　　三边求角初数恒为法以两矢较乗半径为实法为初数与两矢较若半径与角之矢也
　　一　初数【即角旁两正相乗半径除之之数今以加减得之】
　　二　两矢较【或两俱正矢或两俱大矢或存弧用正矢对弧用大矢】
　　三　半径
　　四　角之矢【正矢角锐大矢角钝】
　　角求对边则以初数乗角之矢为实半径为法法为半径与角之矢若初数与两矢较也
　　一　半径
　　二　角之矢【或正矢或大矢】
　　三　初数
　　四　两矢较【并以较加存弧矢为对弧矢加满半径以上为大矢其对弧大不满半径为正矢其对弧小】
　　乙丁丙形　三边求丁角
　　小边乙丁【正卯辛】大边丙丁【正壬丙】　初数卯癸【两正相乗半径除之也】
　　今改用加减


　　两余相减【余房戊】折半得
　　丑戊即初数卯癸【与先所得同】


　　一系　总弧过半周而存弧亦过象限则余相减法为卯癸初数与两矢较牛乙若卯辛正【距等半径】与乙庚【距等大矢】亦即若寅巳半径与角之大矢酉子
　　一　初数　　卯癸【即丑戊】
　　二　两矢较　牛乙【即房甲】
　　三　半径　　寅巳
　　四　角之大矢酉子
　　若先有丁钝角而求乙丙对边则反用其率
　　一　半径　　寅巳
　　二　角之大矢酉子
　　三　初数　　卯癸
　　四　两矢较　牛乙
　　以所得两矢较加存弧大矢房丙得大矢甲丙
　　乙丁丙形
　　三边求丁角
　　小边乙丁【正乙辛】　大边丙丁【正戊壬】
　　初数戊癸
　　今用加减


　　两余相减【余辰甲】折半得辰
　　丑即初数戊癸
　　对弧【乙丙】大矢斗乙
　　存弧　大矢甲乙【两矢较斗甲】
　　法为初数戊癸与两矢较斗甲若戊壬正【距等半径】与丙庚【距等大矢】亦即若寅巳半径与角之大矢酉子
　　一　初数戊癸【即丑甲】
　　二　两矢较　斗甲
　　三　半径　　寅巳
　　四　角之大矢酉子
　　论曰此移小边于外周如法求之所得并同其故何也先有之角及角旁二边并同则诸数悉同矣然则句股之形不同何也曰前图是用乙丁小弧之正为径分大矢之比例则所用句股是丁丙大弧之正此图是用丁丙大弧正为径分大矢比例则所用句股是乙丁小弧正故句股形异也然句股形既异而所得初数何以复同曰此三率之精意也初数原为两正相乗半径除之之数前图用大弧正偕半径为句与而小弧正用为大矢分径之比例是以大弧正为二率而小弧正为三率也今改用小弧为二率大弧为三率而首率之半径不变则四率所得之初数亦不变也又何疑焉
　　一系　角旁二弧可任以一弧之正为全径上分大小矢之比例其余一弧之正即用为句股比例不拘大小同异其所得初数并同
　　又论曰以句股比例言之则戊庚通为【即距等圏全径】戊女倍初数为句【即总存两余相加减之数】一也戊壬正为则戊癸初数为句二也丙庚为【通之大分即距等大矢】则斗甲两矢较为句【即丙房】三也丙壬为【正之分线即距等余】则斗丑为句【对弧余内减次数丑巳得斗丑亦即丙牛】四也戊丙为【正之分线即距等小矢】则午戊为句五也
　　以全与分之比例言之则戊庚为距等全径与寅子全径相当一也戊壬正为距等半径当寅巳半径二也丙庚如距等大矢当酉子大矢三也丙壬如距等余当酉巳余四也戊丙如距等小矢当寅酉正矢五也一系　初数恒与角旁一弧之正为句股比例其正恒为初数恒为句而其全与分之比例俱等又即与员半径上全与分之比例俱等若倍初数即与全员径上大小矢之比例等
　　一系　角旁两弧任以一弧之正为径上全与分之比例初数皆能与之等
　　若先有丁钝角求对边乙丙则更其率
　　一　半径　　巳子
　　二　丁角大矢酉子
　　三　初数　　丑甲
　　四　两矢较　斗甲
　　以四率斗甲加存弧大矢乙甲成斗乙为对弧大矢内减巳乙半径得斗巳为对弧余捡表得未丙弧度以减半周得对弧丙乙度
　　乙丁丙形　三边求丁角
　　乙丁边【九十五度】　丁丙边【一百一十二度】　乙丙对弧【一百一十九度】总弧丙未二百○七度　余辛巳　八九一○一存弧丙戊一十七度　　余壬巳　九五六三○两余相加辛壬一八四七三一
　　初数卯亥【即半辛壬丑辛】九二三六五
　　对弧大矢癸丙一四八四八一
　　存弧正矢壬丙　　四三七○
　　两矢较癸壬　一四四一一一
　　法曰卯亥【即丑辛】与癸壬若
　　未亥与乙戊亦必若庚巳
　　与甲子
　　一　初数　卯亥　　　九二三六五
　　二　两矢较癸壬　　一四四一一一
　　三　半径　庚巳　　一○○○○○
　　四　角之矢申子　　一五六○二二
　　四率大于半径为大矢其角钝法当以半径一○○○○○减之余五六○二二为钝角余捡表得余度五十五度五十六分以减半周为丁角度
　　依法求到丁钝角一百二十四度○四分
　　论曰试作辰戊线与倍初数辛壬平行而等又引未辛【总弧正】至辰成未辰戊句股形又引牛乙癸【对弧正】至寅作亥丑线引至斗各成句股形而相似则其比例等一未辰戊大句股　以辰戊倍初数为句未戊通为一乙寅戊次句股　以寅戊两矢较为句乙戊【距等大矢】为一【未卯亥亥斗戊】两小句股并以【卯亥斗戊】初数为句【未亥亥戊】正为辰戊倍初数与寅戊两矢较若未戊通与乙戊距等大矢是以大句股比小句股也
　　卯亥初数与癸壬两矢较若未亥正与乙戊距等大矢是以小句股比大句股也　用亥斗戊形比乙寅戊其理更着
　　又未戊通上全与分之比例原与全员径上全与分之比例等故三者之比例可通为一也
　　【一大句股截数种小句股故又为全与分之比例】
　　仍用全图取乙丁女形　求丁鋭角
　　乙丁边【九十五度】　女丁边【六十八度】　女乙对弧【六十一度】
　　总弧女戊【一百六十三度】余【壬巳】九五六三○
　　存弧女未【二十七度】　余【辛巳】八九一○一
　　两余并【辛壬】一八四七三一初数卯亥九二三五六


　　一　初数　卯亥　九二三六五
　　二　两矢较癸辛　四○六二○
　　三　半径　巳庚一○○○○○
　　四　角之矢申庚　四三九七七　【以减半径得丁角余入表得丁角度】
　　依法求得丁鋭角五十五度五十六分
　　辛丁乙形
　　三边求丁角
　　辛丁边五十度一十分　乙丁边六十
　　总弧卯辛一百一十度一十分
　　余庚丙二四四七五
　　存弧戊辛九度五十分
　　余子丙九八五三一
　　余并子庚一三三○○六
　　初数子午【即戊癸】六六五○三
　　辛乙对弧八十度
　　对弧矢辛酉　八二六三五
　　存弧矢辛子　一四六九
　　两矢较子酉　八一一六六
　　一　初数　　子午　六六五○三
　　二　两矢较　子酉　八一　一六六
　　三　半径　　壬丙一○○○○○
　　四　丁角大矢壬甲一二二○五○【用余入表得丁外角减半周得丁角度】
　　依法求到丁钝角一百○二度四十四分
　　论曰此如以日髙度求其地平上所加方位也乙为太阳乙甲其髙度其余度丁乙日距天顶也亥乙赤道北纬辛乙为距纬之余即去极纬度也辛壬为极出地度其余辛丁极距天顶也所求丁钝角百○二度太距正北壬之度外角七十七度少距正南巳之度也算得太阳在正东方过正卯位一十二度太
　　乙丙辛形　有【辛丙三十三度辛乙百卅二度】　对弧乙丙【百八度】求辛角
　　总弧【丙壬】一百六十五度
　　余【己戊】九六五九三
　　存弧【丙庚】九十九度
　　余【己甲】一五六四三　两余相减余【戊甲】八○九五○
　　初数甲丑四○四七五　对弧大矢酉丙一三○九○二
　　存弧大矢甲丙一一五六四三
　　两矢较甲酉　一五二五九
　　一初数甲丑　四○四七五
　　二两矢较甲酉一五二五九
　　三半径申巳一○○○○○
　　四角之矢未申三五三五二
　　得辛鋭角四十九度二十八分
　　恒星岁差算例
　　老人星黄道鹑首宫九度三十五分二十七秒为庚角【康熈
　　甲申年距厯元戊辰七十七算毎年星行五十一秒
　　讣行一度○五分二十七秒以加戊辰年经度鹑首
　　八度三十分得今数】
　　黄道南纬七十五度　距
　　黄极一百六十五度为庚
　　辛边　用巳庚乙三角形
　　【一角二边】求对弧巳乙【赤纬】


　　余较丁甲二○六六一
　　初数甲戊一○三三○
　　庚角正矢申酉　一三九八
　　一　半径　　申丙一○○○○○　　大矢内减半径二　庚角矢　申酉　　一三九八　　取余检表得三　初数　　甲戊　一○三三○　　三十八度廿三四　两矢较　甲丑　　　一四四　分半以减半周加存弧大矢巳甲一七八二三四　得星距北极一百得对弧大矢巳丑一七八三七八　四十一度三十六
　　分半为对弧巳乙
　　求到甲申年老人星赤纬在赤道南五十一度三十六分半【以校厯元戊辰年纬五十一度三十三分及仪象志康熈壬子年纬五十一度三十五分可以畧见恒星赤纬岁差之理】
　　求巳角【赤经】
　　巳庚角旁弧二十三度三
　　十一分半
　　巳乙角旁弧一百四十一
　　度三十六分半
　　庚乙对弧一百六十五度
　　三边求角


　　余较子斗　四九五七七
　　初数午斗　二四七八八
　　对弧大矢庚亥一九六五九三
　　存弧大矢庚斗一四七○七六
　　两矢较亥斗　四九五一七
　　一　初数　午斗　二四七八八　大矢内减半径得二　两矢较亥斗　四九五一七　余检表得度以三　半径　丙氐一○○○○○　减半周得已角度四　角大矢亢氐一九九七六一　　　一百七十六度○二分置三象限以已角度减之得星距春分九十三度五十八分
　　求到甲申年老人星赤道经度在鹑首宫三度五十八分【以校戊辰年赤经九十三度三十九分及仪象志壬子年赤经九十三度五十一分可以见恒星赤经东移之理】
　　加减防法补遗
　　防法以两余相加减以两矢较偹四率其用巳简然有阙余无可加减阙矢度无可较者虽非恒用而时或遇之亦布算者所当知也
　　一加减变例
　　凡余必小于半径常法也然或捴弧适足半周则余极大即用半径为捴弧余　法以存弧余加减半径折半为初数【视存弧不过象限则相加存弧过象限则相减】又若角旁两弧同数则无存弧而余反大即用半径为存弧余　法以捴弧余加减半径折半为初数【视捴过象限或过半周则相加捴弧在象限内或过三象限则相减】
　　以上用半径为余者六
　　凡加减取初数必用两余常法也然或搃弧适足一象限或三象限或存弧适足一象限皆无余法即用一余折半为初数不湏加减【搃弧无余即单用存弧余存弧无余即单用搃弧余】
　　又或捴弧【适足象限或三象限】无余而两弧又同数【准前论即以半径为存弧余】或存弧【适足象限】无余而搃弧又适足半周【即以半径为搃弧余】
　　二者并以半径之半为初数不湏加减
　　以上无加减者六
　　一两矢较变例
　　凡两矢相较常法也然或其弧满象限则即以半径为矢【对弧满象限则以半径为对弧矢与存弧矢相较存弧满象限亦然亦即以半径与对弧矢相较】　防法视对弧存弧但有一弧满象限即命其又一弧之余为两矢较不更求矢【对弧满象限即用存弧余存弧满象限即用对弧余并即命为两矢较与上法同】
　　凡以矢较加存弧矢成对弧矢【正矢则对弧小大矢则对弧大】常法也然或有相加后适足半径者其对弧必足象限又有四率中无两矢较者以无存弧矢故也【凖前论角旁两弧同度无存弧则亦无存弧矢之可较】法即以对弧矢为用不必更求矢较　若角求对边其所得第四率即对弧矢若三边求角其所用苐三率亦对弧矢【余详后例】
　　设角旁两弧同度总弧在象限以内　求对角之边丙乙丁形
　　乙角一百一十度余三四二○二　乙丙　乙丁并三十度








　　两余相减　五○○○○　　丙庚
　　半之为初数　二五○○○　　丙癸
　　一　半径　寅已　一○○○○○
　　二　初数　丙癸　　二五○○○
　　三　【乙角大矢】　寅午　一三四二○二
　　四　【对弧矢】　丙甲　　三三五五○【四率本为两矢较因无存弧矢故即为对弧之矢
　　对弧余】　甲巳　　六六四五○
　　求到对弧丁丙四十八度二十二分
　　论曰以半径为存弧余何也弧大者余小弧小者余大今存弧既相减而至于无则小之至也故其余亦大之至而成半径也　四率即为对弧矢何也弧大矢亦大弧小矢亦小既无存弧则亦无矢矣无矢则无可较故四率即对弧矢也　然则其比例奈何曰半径寅已与大矢寅午若正子丙与距等大矢丁丙亦即若初数丙癸与对弧矢丙甲
　　若三边求角则反其率
　　一初数　　二半径　　三对弧矢　　四乙角矢
　　若捴弧过三象限其法亦同
　　前图丁丑丙形
　　丑角同乙角




　　其所用四率以得对弧丁丙并同上法
　　若三边求角则反其率
　　一初数　　二半径　　三对弧矢　　　四丑角矢
　　一系　两边同度无存弧矢则径以对弧矢当两矢较之用设总弧满半周而较弧亦过象限　求对角之边前图卯丑丁形
　　丑角　　　七十度余　三四二○二　午已丑丁　一百五十度
　　丑卯　　　　三十度


　　相减　五○○○○庚丙
　　初数　二五○○○庚癸
　　存弧大矢一五○○○○庚卯
　　丑角矢　六五七九八午酉
　　一　半径　　　酉巳　　　　一○○○○○二　初数　　　丙癸【即庚癸】　　二五○○○
　　三　丑角矢　　午酉　　　　六五七九八
　　四　两矢较　　庚甲　　　　一六四四九
　　加存弧大矢庚卯　　　一五○○○○
　　得对弧大矢甲卯　　　一六六四四九
　　求到对弧卯丁一百三十一度三十八分
　　设三小边同数
　　求角

　　丙乙丁形
　　三边并三十度
　　求乙角




　　相减　五○○○○　丙庚
　　初数　二五○○○　丙癸
　　对弧【丁丙】三十度余　八六六○三　甲巳
　　矢　一三三九七　丙甲
　　一　初数　丙癸　　二五○○○
　　二　半径　寅己　一○○○○○
　　三　对弧矢丙甲　　一三三九七
　　四　乙角矢寅午　　五三五八八
　　余午巳　　四六四一二
　　求到乙角六十二度二十分　丁丙二角同
　　论曰此亦因存弧无矢故以对弧矢为三率也其比例为初数丙癸与对弧矢丙甲若乙丙正丙辰与丙丁距等矢则亦若寅巳半径与乙角矢寅午
　　一系　凡三边等者三角亦等
　　前图丁丑丙形　二大边同度一小边为大边减半周之余三边求角




　　其对弧丁丙亦三十度所用四率并同上法所得丑角六十二度二十分亦同乙角惟余两角【丁丙】并一百一十七度四十分皆为丑角减半周之余
　　若先有角求对边则反其率
　　又于前图取丁丑戊形
　　丑丁　　一百五十度
　　丑戊　　　　三十度


　　其对弧戊丁【一百五十度】为丑戊【三十度】减半周之余故所用四率亦同但所得矢度为丑外角之矢当以其度减半周得丑角【一百一十七度四十分】戊角同丑角丁角【六十二度二十分】即丑外角一系凡二边同度其余一边又为减半周之余与三边同度者同法但知一角即知余角其一角不同者亦为相同两角之外角
　　设角旁两弧同数而捴弧
　　足一象限求对角之边
　　子乙丙形
　　乙角一百度余　一七
　　三六五




　　初数　五○○○○　　丙辛【即半径之半】
　　一　半径　　壬巳　一○○○○○
　　二　初数　　丙辛　　五○○○○
　　三　乙角大矢壬丑　一　一七三六五
　　四　对弧矢　丙癸　　五八六八二
　　余癸巳　　四一三一八
　　求到对弧子丙六十五度三十六分
　　论曰半半径为初数何也凖前论半径即存弧余而捴弧无余无可相减故即半之为初数　问捴弧何以无余曰弧大者余小捴弧满象限则大之极也故无余　其比例可得言乎曰壬巳与壬丑若丙甲与丙子则亦若丙辛与丙癸　若所设为子戊丙形戊角同乙角一百度
　　【戊子戊丙】同为一百三十五度　捴二百七十度【满三象限】亦
　　无余亦如上法以半半径为初数依上四率求到对戊角之子丙弧六十五度三十六分
　　若三边求角则反其率
　　一初数　　二半径　　三对弧矢　　四角之矢
　　设角旁两弧之捴满半周而存弧亦满象限　求对角之弧　用前图子戊卯形
　　戊角　　八十○度余　一七三六五
　　子戊一百三十五度
　　卯戊　　四十五度


　　余无减半半径为初数五○○○○　己辛即庚甲存弧满象限半径为正矢一○○○○○　即卯巳半径
　　一　半径　辰巳　一○○○○○
　　二　初数　己辛　　五○○○○
　　三　戊角矢辰丑　　八二六三五
　　四　两矢较己癸　　四一三一七　即对弧卯子余对弧大矢卯癸　一四一三一七　【以两矢较加存弧矢得对弧大矢】求到对弧卯子一百一十四度二十四分
　　论曰捴弧以半径为余何也凡过弧大者余大过弧满半周则大之至也故其余亦最大而即为半径也　然则存弧又能以半径为矢何也弧大者矢大存弧既满象限故其矢亦满半径矣
　　问两矢较巳癸即对弧之余也何以又得为两矢较曰他存弧之矢有大小而不得正为半径故其与对弧矢相较亦有大小而不得正为余今矢既为半径较必余矣
　　若三边求角则反其率
　　一　初数　巳辛　　　其比例为巳辛与巳癸若丁甲二　半径　辰巳　　　与丁子则亦若辰巳与辰丑三　两矢较己癸
　　四　戊角矢辰丑
　　设对弧满象限　三边求角
　　乙丙甲形
　　对弧乙甲九十度　无余


　　求丙角


　　相加辰癸　一三五六二一
　　初数午癸　　六七八一○
　　对弧满象限矢即半径已甲一○○○○○
　　用防法即以存弧余癸已为矢较
　　一　初数　　午癸　　六七八一○
　　二　半径　　巳戊　一○○○○○
　　三　矢较　　巳癸　　四二二六二　即存弧余四　丙角矢　庚戊　　六二九○四
　　求到丙角六十八度一十四分
　　其比例为初数午癸与余巳癸若正壬辛与距等矢乙辛也亦必若半径己戊与角之矢庚戊
　　若先有丙角求对弧则反其率
　　一半径【戊巳】　二初数【午癸】　三丙角矢【戊庚】　四两矢较【巳癸】以所得四率与存弧矢甲癸【五七七三八】相加适足半径【成巳甲】命对弧乙甲适足九十度　防法视所得四率矢较与存弧余同数即知对弧为象限不必更问存弧之矢
　　设角旁两弧同数捴弧过象限
　　求对角之弧
　　辛乙丙形
　　乙角七十三度余二九二三七




　　相加折半为初数　八二一三九　癸丙
　　一　半径　己戊一○○○○○
　　二　初数　癸丙　八二一三九
　　三　乙角矢甲戊　七○七六三
　　四　对弧矢丁丙　五八一二四
　　余丁巳　四一八七六
　　求到对弧辛丙六十五度一十五分
　　若三边求角则反其率
　　一初数【癸丙】　二半径【巳戊】　三对弧矢【丁丙】四乙角矢【甲戊】
　　设角旁弧同数捴弧过半周其算并同
　　前图辛丑丙形
　　辛丑　丙丑并一百十五度
　　捴弧丙丑壬二百三十度余　六四二七九　庚巳丑角同乙角
　　其所用四率求对弧及三边求角并如上法
　　设捴弧满半周而存弧不过象限　求对弧
　　前图辛乙卯形
　　乙角　　一百○七度余　二九二三七　甲巳乙卯　　一百十五度
　　乙辛　　　六十五度


　　相加半之为初数　八二一三九　癸庚即子辰
　　一　半径　　寅巳　一○○○○○
　　二　初数　　庚癸　　八二三一九
　　三　乙角大矢寅甲　一二九二三七
　　四　两矢较　庚丁　一○六一五三　即辛未加存弧正矢庚卯　　三五七二一
　　得对弧大矢丁卯　一四一八七四
　　求到对弧卯辛一百一十四度四十五分
　　加减又法【解恒星暦指第四题三率法与加减防法同理】
　　弧三角有一角及角旁二边求对角之弧
　　法曰以角旁大弧之余度与小弧相加求其止为先得　次以角旁两弧相加视其度若适足九十度即半先得为次得【此大弧之余弧与小弧等】
　　若角旁两弧捴大于象限【此大弧之余弧小于小弧】则以大弧之余弧减小弧而求其以加先得然后半之为次得若两弧捴不及象限【此大弧之余弧大于小弧】则以小弧减大弧之余弧而求其以减先得然后半之为次得又以角之矢为后得
　　以后得乗次得为实半径为法除之得数为他一率　全数
　　二率　次得【即初数】
　　三率　后得【即角之矢】
　　四率　他【即两矢较】
　　并以他与先得相减为所求对角弧之余若他大于先得即以先得减他【不问何但以小减大右法不载测量全义而附见厯指人自江南来得小儿以燕家信以此为问谓与环中黍尺有合也乃为摘録以疏其义】
　　论曰此亦加减代乗除之一种也加减法以捴弧存弧之余相加减以取初数此则不用存弧而用存弧之余度【以余度取正即存弧之余故也】又不正用存弧之余度而用大弧之余度【以大弧之余度加小弧即存弧之余度故也】至其加减又不用捴弧而用大弧余度与小弧相减之较弧【以此较弧之正即捴弧之余故也】取径迂回而理数脗合非两法相提并论不足以明其立法之意也举例如后
　　乙丙丁形【有乙角及角旁二边】求对弧丁丙【以加减防法求得诸数与恒星厯指法相参论之
　　乙丙小弧乙丁大弧】正【甲丙辰庚】
　　【捴存】弧【戊丙庚丙】余【壬巳癸巳】
　　【余并癸壬初数　癸甲　即辰寅】
　　【丁丙对庚丙存弧】正矢【卯丙癸丙】
　　【两矢较卯癸一　半径　　酉巳】
　　【二　角之矢　酉午三　初数　　甲癸即辰寅
　　四　两矢较　　卯癸　即丁子末以卯癸加癸丙得卯丙为对
　　弧矢乃查其度得对弧丁丙】
　　右加减法也
　　今改用恒星厯指之法　先以酉庚为角旁大弧【乙丁】之余弧【乙庚同乙丁大弧度也乙酉同乙午皆象限也乙酉象限内减乙庚犹之乙午内减乙丁也故庚酉即乙丁之余】又以牛酉当角旁小弧乙丙【乙酉与牛丙皆象限内减同用之丙酉同乙丙】二者相加成牛庚取其正戊庚是为先得次视角旁两弧【乙丙乙丁】之捴【丙戊】大于象限【丙辛】法当以大弧余度去减小弧得较【于同小弧之午酉内减同大弧余度之氐酉其较牛氐与牛房等】而取其【牛氐较与牛房等则氐井与房井等而即与危戍等是危戌即牛氐较之也】以加先得【以危戍加戌庚成危庚】然后半之【危庚半之于未成未庚】为次得
　　又以乙角之矢【午酉】为后得与次得【未庚】相乗为实半径为法除之得他【亥庚】
　　未以他【亥庚】减先得【戌庚】其余亥戌为对弧【丁丙】之余【查表得对弧】
　　论曰牛庚之正戍庚与癸巳平行而等即存弧之余也【牛庚为小弧与大弧余度之并实即存弧丙庚之余度故戌庚即同癸巳】次得未庚与甲癸平行而等即初数也【以危戍加戌庚而成危庚犹捴存两余相加成癸壬也危庚既同癸壬则其半未庚亦同甲癸】他庚亥与卯癸平行而等即两矢较也末以他与先得相减而得对弧余犹以两矢较与存弧之矢相加而得对弧之矢也【两矢较即两余较也故加之得矢者减之即得余】然则此两法者固异名而同实矣又论曰加减本法用大弧小弧之捴与较取其余以相加减今此法则用大弧余度与小弧之捴与较而取其正以相加减【如牛庚是大弧余度与小弧之捴牛氐是大弧余度与小弧之较】用若相反而得数并同者何也曰余弧与正弧互为消长其数相待是故大弧之余度大于小弧则捴弧不及象限矣大弧之余度小于小弧则捴弧过象限矣捴弧过象限宜相加此条是也捴弧不及象限宜相减后条是也宜加宜减之数无一不同得数安得而不同【得数谓初数也在此法则为次得】
　　又论曰此法之于加减法犹甲数乙数之于初数次数也初数次数用余甲数乙数用正加减法用余此法用正所以然者皆以角旁之弧半用余度也【甲数乙数法内一弧用本度一弧用余度此法小弧用本度大弧用余度】一加减法乃有四用其省乗除并同而繁简殊矣
　　乙丙丁形
　　有乙角及角旁二边
　　求对弧丁丙
　　【乙丙小弧乙丁大弧】正【申丙辰庚】
　　【捴存】弧【戊丙庚丙】余【壬巳癸巳】
　　【余较壬癸初数癸甲】
　　【丁丙对弧庚丙存弧】正矢【卯丙癸丙】
　　【两矢较卯癸一　　半径　酉巳】
　　【二　角大矢　酉午三　　初数　甲癸】
　　【四　两矢较　卯癸】
　　【末以卯癸加癸丙成卯丙为对弧矢查其余得对弧丁丙】
　　右加减法也
　　今依恒星法改用大弧之余度【庚酉即午丁】与小弧【牛酉即乙丙】相加【成牛庚即存弧丙庚之余度】求其正为先得【戍庚同巳癸即存弧之余】次视两弧之捴【戊丙】不及象限法当以小弧减大弧余度【取氐酉如酉庚以牛酉减之】得较【氐牛与牛房等】取其正【女房即女氐亦即戍危】以减先得【戍危减戌庚余危庚与癸壬等】然后半之【危庚半之于虚成庚虚与甲癸等】为次得又以【乙】钝角大矢【午酉】为后得与次得相乗为实半径为法除之得他【亢庚与卯癸等】末以他【亢庚】减先得【戍庚】其余戍亢【即卯巳】为对弧余查表得对弧丁丙
　　一率　半径　酉巳
　　二率　次得庚虚【即初数甲癸】
　　三率　后得午酉【即角大矢】
　　四率　他　亢庚【即两矢较卯癸】
　　乙丙丁形【有丙角及角旁二边】求对弧丁乙
　　法以【丁丙】大弧之余【午丁即酉甲】与小弧【乙丙即戊酉】相加【成甲戊】求
　　其正【庚甲】为先得次视两弧
　　之总【丑乙】适足象限即半先得
　　为次得【癸甲或癸庚】又以角之大矢【午酉】为
　　后得乘之【午酉乘癸甲】半径【酉巳】除之
　　得他【卯甲即壬未】以减先得【甲庚】得
　　对弧余【卯庚即壬巳】查表度得对弧【丁乙】
　　解曰此因大弧之余酉甲与小弧戊酉同数则无加减故即半先得为次得也在加减法则为总弧无余而即半存弧余为初数
　　丙戊丁形【有戊角及角旁二边】求对弧丁丙
　　如法以大边【丙戊】之余【卯丙即癸庚】与小弧【丁戊即癸辛】相加【成辛庚】取
　　其正【庚乙】为先得次眎角
　　旁两弧之捴【辰丁】大于象限法
　　当以癸庚减癸辛得较子辛
　　【即辛井】而取其正【子斗即井斗亦即乙】
　　【甲】以加先得【乙庚】而半之【甲庚之半为甲丑】为次得又以角之大矢【卯癸】为后得以乗次得为实半径为法除之得他【牛庚】末以他【牛庚】与先得【庚乙】相减得【牛乙即壬巳】为对弧之余查余度以减半周得对弧丁丙
　　解曰此为他大于先得故反减也在加减法则所得为对弧大矢与存弧小矢之较而两矢较即两余并也故减存弧余得对弧余
　　补求经度法
　　法用角旁两弧【大弧用余度小弧用本度】相加得数取正为先得又相减得较取正以与先得相加减【角旁两弧大于象限则相加若小于象限则相减】而半之为次得【若角旁两弧并之足一象限则径以先得半之为次得不须加减】用为首率　次以对角弧之余与先得相加减得他为次率【对弧大于象限相加小于象限则相减】　半径为三率　求得角之矢为四率【正矢为鋭角大矢为钝角】
　　假如丙戊丁形有三边求戊角【借用前图】
　　一　次得　甲丑【乃先得甲庚之半】即庚丑
　　二　他　　壬酉【即牛庚乃对弧余加先得因对弧大故相加】
　　三　半径　　巳癸
　　四　钝角大矢卯癸【卯癸大矢内减巳癸半径为余查表得度以减半同为戊钝角之度】论曰角求对边者求纬度也三边求角者求经度也二者之分祗在四率中互换无他缪巧厯指注云求纬用正求经用切线殊不可晓及查其后条用例亦无用切线之法殆有缺误厯书中如此者甚多故在善读耳加减通法
　　加减代乗除之法以算三边求角及二边一角求对角之边皆斜弧三角之难者也其算最难而其法益简故凡算例中两正相乗者即可以加减代之则虽正弧诸法实多所通故谓之通法
　　法曰凡四率中有以两正相乗为实半径为法者皆可以初数取之　有以两余相乗为实半径为法者皆可以次数取之　有以余与正相乗为实半径为法者皆可以甲乙数取之
　　假如正弧形有角有角旁弧而求对角之弧【此如有春分角有黄道而求距度】本法当以角之正与角旁弧之正相乗为实半径为法除之也今以初数取之即命为所求度正
　　设黄道三十度求黄赤距度
　　【春分角二十三度三十一分半黄道　三十○度】
　　【捴弧　五十三度三十一分半存弧　　　六度二十八分半】余【五九四四七九九三六二】用初数为正检表得度　【相减三九九一五折半一九九五七即初数】
　　求到黄赤距度一十一度三十○分四十二秒
　　又设黄道七十五度求黄赤距度
　　【春分角二十三度三十一分半黄道　七十五度】
　　【捴存】弧　【九十八度三十一分半五十一度二十八分半】余【一四八二四六二二八五】用初数为正检表得度　　【相加七七一○九折半三八五五四】
　　求到黄赤距度二十二度四十分三十九秒
　　又如句股方锥法有大距有黄道而求距纬本以大距正黄道余相乗半径除之也今以甲数取之设黄道六十度求距纬【句股方锥黄道以距二至起算下同】
　　【黄赤大距二十三度三十一分半黄道　　六十○度】
　　【捴弧　　八十三度三十一分半存弧　　三十六度二十八分半】正【九九三六二五五四四七】用甲数为正检表得度　　　【相减三九九一五半之一九九五七为甲数】
　　求到距纬一十一度三十○分四十二秒
　　设黄道一十五度求距纬
　　【黄赤大距二十三度三十一分半黄道　　一十五度】
　　【捴存】弧　　【三十八度三十一分半八度三十一分半】正【六二二八五一四八二四】用甲数为正查表得度　【相加七七一○九半之三八五五四为甲数】
　　求得距纬二十二度四十分三十九秒
　　又如次形法本以一正与一余相乗半径除之得所求之余今以初数取之
　　设甲丙乙形有甲正角有丙角及甲丙边而求乙角本法为半径与丙角正若甲丙余与乙角余今以初数即命为乙角余　【丙角度　甲丙余度】相【并减】为【捴存】弧各取其
　　余如法相加减而半之成初数即命为乙角余本法用正与余相乗而亦以初数取之何也曰甲丙余实次形丁丙正也故仍用初数
　　假如斜弧形作垂弧法本为半径与角之正若角旁弧之正与垂弧之正也今以初数即命为垂弧正设丁乙丙形有乙鋭角有丁乙边求作丁甲垂弧　【乙角度乙丁弧】相【并减】为【捴存】弧而取其余如法相加减而半之成初数即命为丁甲垂
　　弧正
　　设丁乙丙形乙为钝角而先有丁乙边其法亦同　【乙外角丁乙边】相【并减】为【捴存】弧而各取其余如上法取初数命为甲丁垂弧正
　　又如弧角比例法本为角之正与对角边之正若又一角之正与其对边之正今以初数进五位即为两正相乗之实可以省乗
　　设乙甲丙形有丙角甲角有乙甲边求乙丙边本以甲角正与乙甲正相乗为实丙角正为法除之得乙丙正今以甲角度与乙甲弧相并减为捴存弧如法取初数进五位为实以丙角正除之亦得乙丙正【若有乙丙边求丙角则以乙丙边正为法除之即得丙角之正】
　　又如垂弧防法本以两余相乗为实又以余为法除之而得所求之余今以次数进五位为两余相乗之实即可省乗
　　设甲丁亥钝角形有亥甲边有亥丁边有引长之丁巳边而求甲丁边本法为亥巳边之余与亥甲边之余若丁巳边之余与甲丁边之余也　今以次数代乗
　　【亥甲丁巳】二弧相并为捴弧相减为存弧
　　而各取其余如法相加减而半之
　　为次数下加五○即同亥甲与丁巳
　　两余相乗之实但以亥巳边之余
　　为法除之即得甲丁边之余
　　进五○何也曰初数者两正相乗半径除之之数故必进五位即同两正相乗之实矣　次数进位之理仿此论之
　　补加减防法
　　设壬丙甲弧三角形
　　甲壬边适足九十度　丙甲边八十三度　对弧壬丙五十九度
　　求甲角
　　法曰角旁有一边
　　适足九十度则总
　　存两余同数当
　　以余即命为初
　　数　依法求得五
　　十八度四十四分
　　为甲角


　　存矢　申丙　　　七四五


　　矢较　戊申　四七七五一
　　一　初数　九九二五五已申
　　二　矢较　四七七五一戊申
　　三　半径一○○○○○己癸　查表得五十八度四十四分四　【角之矢】　四八一○九壬癸
　　余　五一八九一壬巳
　　论曰此即算带食法也凡算带食其差角必在地平壬甲九十度即髙弧全数丙甲八十三度月距北极也癸丙七度黄赤距度也壬丙对弧极距天顶也其余己戊即极出地正所求甲角月出地平时地经赤道差也
　　防法以黄赤距度余与极出地正相减余进五位为实仍以距度余除之得差角矢
　　解防法曰极出地正即对弧余黄赤距度余即存弧余两余之较即矢较也
　　又解曰巳乙即己申亦即未丙并小弧甲丙正也【即存弧癸丙之余】未丙与戌丙若己癸与壬癸全与分之比例也又解曰初数是两正相乗半径除之之数今甲壬边之正即半径故省乗除竟以甲丙正为初数又设壬甲辛钝角形【即用前图】　壬甲邉适足九十度　辛甲邉九十七度　对邉辛壬一百二十一度　求甲角依法求得甲钝角一百二十一度一十六分


　　对弧辛壬一百卄一度余巳戊　　　　五一五○四对弧大矢　戊辛　　　一五一五○四存弧　矢　癸乙同酉辛　　　七四五【亦同丁庚】两矢　较　戊酉同辰辛一五○七五九【亦同丁壬】
　　一　　初数　【丁巳同午辛】　九九二五五
　　二　　矢较　【丁壬同辰辛】一五○七五九
　　三　　半径　己庚一○○○○○
　　四　角大矢　壬庚一五一八九○
　　余　己壬　五一八九○
　　查表得五十八度四十四分以去减半周得甲角一百二十一度一十六分
　　论曰縂弧过象限及过半周宜以余相加折半成初数今两余相同而径用为初数亦折半之理也向作加减法补遗自谓巳尽其变不知仍有此法故特记之
　　因算带食得此其用防法更竒甚矣学问之无穷也壬甲丙鋭角形壬甲邉适足九十度　丙甲邉六十七度对弧壬丙五十度　求甲角
　　依法求得甲角四十五度四十二分




　　○五【即为初数】
　　壬丙对弧五十○度余六
　　四二七九　巳戊
　　对弧矢三五七二一　戊丙
　　存弧矢　　七九五○　乙癸【即申丙】
　　矢较　二七七七一　申戊
　　一　初数　　九二○五　　申巳
　　二　矢较　　二七七一　　申戊
　　三　半径　一○○○○○　己癸
　　四　角之矢　三○一六九　壬癸
　　余　　六九八三一　壬巳
　　查表得四十五度四十二分
　　因前图丙癸度小故复作此以明之
　　算甲余角
　　又于本图取辛甲壬钝角形　壬甲九十度　辛甲一百一十三度　壬丙五十度　求甲钝角　依法求到甲钝角度一百三十四度一十八分


　　壬辛对弧一百三十○度余巳戊六四二七九
　　大矢　辛戊　一六四二七九
　　存弧矢　申丙【即乙癸】　七九五○【亦即酉辛】矢较　酉戊　一五六三二九
　　一初数　九二○五○酉巳【即丁巳】　二矢较一五【六三二九】酉戊三半径一○○○○○庚巳　　四【角大矢】一六【九八三○】庚壬
　　余六九【八三○】
　　查表得四十五度四十二分以减半周得甲钝角一百三十四度一十八分
　　论曰试作庚亥线与辛丙径平行又引对弧坎戊正至亥成庚亥壬句股形即庚干巳亦同角之小句股形而庚亥同酉戊两矢较也庚干同酉巳初数也则初数【庚干小股】与两矢较【庚亥大股】若半径【庚巳小】与角之大矢【庚壬大】凡角旁弧适足九十度则縂存两余弧同数法即以余命为初数
　　日月食带食出入地平用此算其地经赤道差甚防
　　补甲数乙数法
　　丁辛乙斜弧三角形
　　辛丁弧五十度一十分　　辛乙弧八十度　　丁乙
　　对弧六十度　　　　　　　　又若辛乙弧八十度
　　求辛角　　　　　　　　　辛丁【余弧】三十九度【五十】分
　　辛乙【余弧】一十度　　　　　　縂弧一百十九度【五十】分辛丁弧五十度一十分　　　较弧　四十度一十分


　　两正总【一五一二四九】半之为甲数【七五六二四】两正较【二二二四七】半之为乙数【一一一二三】丁乙对弧余【五○○○○】内减乙数余【三八
　　八七七】为二率
　　一　甲数　七五六二四
　　二　　　　三八八七七
　　三　半径一○○○○○
　　四　【辛角余】　五一四○八
　　查表得五十九度○四分为辛角
　　若前形有辛角而求丁乙对弧
　　一　半径一○○○○○
　　二　【辛角余】　五一四○八
　　三　甲数　七五六二四
　　四　　　　三八八七七
　　以加乙数　一一一二三
　　成对弧余五○○○○
　　查表得六十度
　　此因角旁余弧小于正弧故乙数亦小于甲数而以所得四率加乙数为对弧余
　　丙乙丁形　乙钝角一百一十度　【乙丙乙丁】二弧并三十度求丁丙对弧
　　乙丙余弧六十度
　　乙丁弧　三十度
　　縂弧　　九十度正一○○○○○
　　较弧　　三十度正　五○○○○
　　相加　　一五○○○○
　　半之为乙数七五○○○
　　相减　　　五○○○○
　　半之为甲数二五○○○
　　一　半径一○○○○○
　　二　【乙角余】　三四二○二
　　三　甲数　二五○○○
　　四　　　　　八五五○
　　以减乙数　七五○○○
　　得对弧余六六四五○
　　查表得四十八度二十一分
　　此因角旁乙丙余弧大于乙丁正弧故乙数大于甲数而以所得四率反减乙数为对弧余
　　前例转求乙钝角　【乙丙乙丁】二弧并三十度　丁丙对弧四十八度二十一分
　　求乙角
　　一　甲数　二五○○○　二【对弧余减乙数之余】八五五○三　半径一○○○○○　四钝角余三四二○二查表得七十度以减半周得一百一十度为乙角
　　縂论曰甲数乙数原以角旁两弧之正错乗而得今改用加减故角旁两弧一用正一用余然有时余弧大于正弧者角旁两弧之合数必过象限也有时余弧小于正弧者角旁两弧之合必不及象限也若角旁两弧之合适足象限则余弧必与正弧等而无较弧
　　又设子乙丙形　乙钝角一百度　【乙丙乙子】二弧并四十五度
　　求对角
　　乙丙余弧四十五度
　　乙子　弧四十五度


　　【半之为甲数】五○○○○　　　则无可加亦【亦为乙数】五○○○○　　　无可减故皆
　　用縂弧正
　　折半为甲数
　　亦为乙数
　　一　半径一○○○○○
　　二　【钝角余】　一七三六五
　　三　甲数　五○○○○
　　四　　　　　八六八二
　　加乙数共　五八六八二【命为对弧矢】
　　得对弧【余】　四一三一八
　　查表得对弧子丙六十五度三十六分
　　若前例三邉求乙角
　　乃置对弧六十五度三十六分之余四一三一八求其矢得五八六八二
　　丙减乙数五○○○○
　　仍余八六八二为二率
　　一　甲数　五○○○○
　　二　　　　　八六八二
　　三　半径一○○○○○
　　四　【钝角余】　一七三六四
　　查表得八十度以减半周得一百度为乙角之度补先数后数法
　　前式丙乙丁形　乙角一百一十度　【乙丙乙丁】并三十度求丁丙对弧
　　一　半径方　一○○○○○○○○○○
　　二　正方　　二五○○○○○○○○
　　三　乙角【大矢】　一三四二○二
　　四　两矢较　　三三五五○
　　对弧余　　六六四五○
　　查表亦得四十八度二十一分
　　此因角旁两弧同度则无较弧之矢故径以所得矢较命为对弧之矢
　　前式子乙丙形　乙角一百度　【乙丙乙子】二弧并四十五度求对弧
　　一　半径方　一○○○○○○○○○○
　　二　正方　　五○○○○○○○○○
　　三　角大矢　一一七三六五
　　四　矢较　　　五八六八二【因无较弧矢故即为对弧矢】对弧余　　四一三一八
　　查表亦得对弧子丙六十五度三十六分
　　若先有对弧子丙而求乙角
　　一　正方　　五○○○○○○○○○
　　二　半径方　一○○○○○○○○○○
　　三　对弧矢　　五八六八二【因无较弧矢故即以对弧矢为矢较】四　角大矢　一一七三六五
　　余　　一七三六五
　　查表得八十度以减半周得乙钝角一百度
　　又设乙角六十度
　　角旁【乙丙乙子】二弧并四十五度　求子丙对弧
　　一　半径方一○○○○○○○○○○二　正方　五○○○○○○○○○三　鋭角矢　五○○○○
　　四　　矢较　二五○○○　【无较弧即用为对弧矢】对弧余　七五○○○
　　查表得对弧五十三度○八分







　　厯算全书卷十一
　　钦定四库全书
　　厯算全书卷十二
　　宣城梅文鼎撰
　　歳周地度合攷
　　攷最髙行及歳余
　　古厯不知太阳有最髙之行郭太史时最髙卑正在二至难于窥测西厯自多禄某以来世有积测定最髙防每年东行四十五秒每太阳平行一度髙行七防半约八十年行天一度康熙庚申又改测每年行一分○一秒十防最髙防进移二十八分故辛酉天正冬至最髙在未宫七度○七分○七秒每太阳平行一度髙行十防一○四计五十八年十个月○六日竒行天一度此永年表之新率也但最髙之度既改而又自有行动则每年歳实小余之数必不均齐夫治厯首务太阳而太阳重在盈缩爰举歴年髙行及四正相距时日前后互核以騐歳实之消长髙行之迟速列为一卷亦可为后来攷测之资云
　　己未年
　　最髙过夏至六度三十九分
　　春分　甲戌日申正二刻六分
　　中距九十三日十二刻十二分
　　夏至　丁未日戌初三刻三分
　　中距九十三日六十一刻
　　秋分　辛巳日午初初刻三分　距本年【春分一百八十六日七十
　　三刻十二分】
　　中积八十九日四十五刻一分
　　冬至　庚戌日亥正一刻四分　距本年【夏至一百八十三日一十
　　刻一分】
　　中积八十九日○八分
　　按最髙行为盈缩立差之主其行有序今己未最髙在夏至后六度三十九分而次年庚申即行至七度七分一年之内骤行二十八分必另有新测矣
　　庚申年
　　最髙过夏至七度七分【按永年表所载者年前冬至之数七政厯所载本年夏至之数度分同】
　　春分　己卯日亥正一刻十二分　距【己未秋分百七十八日四十五刻】
　　中积九十三日十一刻　　　　【九分己未春分三　　　百六十五日卄三刻六分】
　　夏至　癸丑日丑初初刻十二分　距【己未夏至三百六十五日卄一刻九分】
　　中积九十三日六十一刻七分
　　秋分　丙戌日申正三刻四分　　距【本年春分百八十六日七十三刻七分】中积八十九日四十六刻【十三】分　【己未秋分三百六十五日二十三刻六分】
　　冬至　丙辰日寅正二刻二分　　距【巳未冬至三百六十五日卄四刻十三分
　　本年夏至一百八十三日一十三刻六分】
　　按最髙进移则夏至差而早冬至差而迟意者新测之冬至迟于先测耶
　　又按歳余二十四刻十三分于授时法得二千五百九十分必无是理其为改测无疑
　　据向后数冬至距冬至春分距春分俱合得三百六十五日二十三刻四分【或五分三分】以较庚申歳实多一刻○九分必为改测矣
　　壬戌年
　　最髙过夏至七度九分
　　春分　庚寅日巳正初刻六分
　　中距九十三日十刻一十二分
　　夏至　癸亥日午正三刻三分　距【庚申夏至七百三十日四十六刻】
　　中距九十三日六十二刻九分
　　秋分　丁酉日寅正一刻【六分】分　距【十二本年春分一百八十六日七十】
　　中距八十九日四十七刻
　　冬至　丙寅日申正初刻【三刻】分　距【六分十二庚申冬至七百三十日】中距八十八日【四十六刻十分】分　　【九十四刻十二本年夏至一百八】
　　癸亥年
　　最髙过夏至七度十分
　　春分　乙未日申初三刻九分　距【十三日十三刻九分壬戌春分三百】中距九十三日【六十五日】分　　　【二十三刻三分十刻十二壬戌秋分一】
　　夏至　戊辰日酉正二刻六分　距【壬戌夏至三百六十五日二十三刻】中距九十三日【三分六十】九分　　【二刻壬戌冬至一百八十二日九】
　　秋分　壬寅日己正一刻　　　距【刻○九分本年春分一百八十六日】中距八十九日【七十三刻】一分　　【六分四十七刻壬戌秋分三百六十】
　　冬至　辛未日亥正初刻一分　距【五日二十三刻三分壬戌冬至三百】中距八十八日【六十五日二十】分　　【三刻四分九十四刻十二本年夏至】
　　甲子年
　　最髙过夏至七度十一分
　　春分　庚午日亥初二刻【一百】分　距【八十三日一十三刻十分十三癸亥秋】中距九十三日【分一】十一分　　【百七十八日四十五刻十三分十刻】
　　夏至　甲戌日子正一刻九分　距【癸亥春分三百六十五日二十三刻四】中距九十三日【分癸亥夏】十分　　【至三百六十五日二十三刻○三】
　　秋分　丁未日申正初刻四分　距【分六十二刻癸亥冬至一百八十二】中距八十九日【日九刻○】一分　　【八分本年春分一百八十六日七十】
　　冬至　丁丑日寅初三刻五分　距【三刻六分四十七刻癸亥秋分三百】中距八十八日【六十五日二十】分　　【三刻四分癸亥冬至三百六十五日】
　　乙丑年
　　最髙过夏至七度十二分
　　春分　丙午日寅初二刻二分　距【甲子秋分一百七十八日四十五刻十】中距九十三日十刻九分　　【三分甲子春分三百六十五日二十】
　　夏至　己卯日卯正初刻【三刻】分　距【四分十一甲子夏至三百六十五日】中距九十三日【二十三刻二分】分　　【六十二刻十二冬至一百】
　　秋分　壬子日亥初三刻八分　距【八十二日九刻六分本年春分一百】
　　中距八十九日【八十六日】二分
　　冬至　壬午日巳初二刻十分　距【七十三刻六分四十七刻甲子冬至】中距八十八日【三百六十五日】分　　【二十三刻五分九十四刻十一本年】
　　丙寅年
　　最髙过夏至七度十三分
　　春分　辛亥日巳初一刻六分　距【夏至一百八十三日十三刻十四分乙】中距九十三日十刻八分　　【丑秋分一百七十八日四十五】
　　夏至　甲申日午初三刻【刻十】分　距【三分春分三百六十五日二十三刻】中距九十三日【四分十四乙丑】分　　【夏至三百六十五日二十】
　　秋分　戊午日寅初二刻【十一】分　距【本年春分一百八十六日七十三刻五分】
　　中距八十九日【四十七刻】四分
　　冬至　丁亥日申初二刻　　　距【乙丑冬至三百六十五日二十三刻六分】中积八十八日【九十四刻】十分　　【本年夏至一百八十三日十四刻一分】
　　按日行盈缩细攷之则春分距夏至夏至距秋分虽皆缩厯而其缩亦不同秋分距冬至冬至距春分虽皆盈厯而其盈亦不同又且年年不同细求之则节节不同又细求之且日日不同矣其故何也葢最髙一防不在夏至而在其后数度又且年年移此太阳盈缩之根而岁实所以有消长也
　　甲子年
　　春分　庚子日亥初二刻十三分　距癸亥年秋分【一百七十八日四十五刻十三】分　距癸亥年春分【三百六十五日二十三刻四分】
　　秋分　丁未日申正初刻四分　距春分一百八十
　　六日七十三刻六分
　　乙丑年
　　春分　丙午日寅初二刻二分　距甲子年秋分【一百七十八日四十五刻十三】分　距甲子年春分【三百六十五日二十三刻四分】
　　秋分　壬子日亥初三刻八分　距本年春分【一百八十六日七十三刻】六分　距甲子年秋分【三百六十五日二十三刻四分】
　　丙寅年
　　春分　辛亥日巳初一刻六分　距乙丑年秋分【一百七十八日四十五刻十三】分　距乙丑年春分【三百六十五日二十三刻四分】
　　秋分　戊午日寅初二刻十一分　距本年春分【一百八十六日七十三刻】五分　距乙丑年秋分【三百六十五日二十三刻三分】
　　以上二分定气之距皆相同其春分至秋分日行最髙为缩厯多八日二十七刻八分惟丙寅年秋分早到一分只多八日二十七刻七分约之为八日二十七刻半
　　按最髙半周多八日竒者非多八日也以较最卑半周故多八日竒若其本数只多四日有竒耳因最卑亦少四日竒故合之为八日竒熊防石乃谓本数多八日则所误多矣
　　假如乙丑秋分至丙寅秋分共三百六十五日卄三刻三分半之该一百八十二日五十九刻九分而丙寅春分至秋分得一百八十六日七十三刻五分则多四日一十三刻十一分　丙寅春分前距乙丑秋分得一百七十八日四十五刻十三分又少四日一十三刻十一分　合计之则为八日二十七刻七分
　　半周均各一百八十二日竒者谓之恒气半周有盈缩者谓之定气相差八日竒者乃两半周定气相较之数非一半周定气与其恒气自相较之数也
　　甲子年
　　春分　庚子日亥初二刻十三分　距癸亥春分三
　　百六十五日二十三刻四分
　　冬至　丁丑日寅初三刻五分　距癸亥冬至三百
　　六十五日二十三刻四分
　　乙丑年
　　春分　丙午日寅初二刻二分　距前春分三百六
　　十五日二十三刻四分
　　冬至　壬午日巳初二刻十分　距前冬至三百六
　　十五日二十三刻五分
　　丙寅年
　　春分　辛亥日己初一刻六分　距前春分三百六
　　十五日二十三刻四分
　　冬至　丁亥日申初二刻　距前冬至三百六十五
　　日二十三刻五分
　　右冬至之小余皆卄三刻五分【或四分】春分之小余皆卄三刻四分差一分
　　以冬至论歳余得授时万分日法之二千四百三十○半分大于消分八分
　　法以小余五分为实刻十五分为法除之得三之一以从刻共得二十三刻又三之一为实九十六刻为法除之得○二四三○五进四位得二千四百三十分强【进四位者以万乗也】若以春分论歳余得授时万分日法之二千四百二十三分六亦大于消分一分六
　　法以卄三刻化三百四十五分并入四分得三百四十九分为实日法一千四百四十分为法除之得○二四二三六进四位得二千四百二十三分半强
　　按授时消分为不易之法今复有长者何耶西法最髙之防在两至后数度歳歳东移故虽冬至亦有加减不得以恒为定也此是两法中一大节目其法自回回厯即有之然了凡先生颇采用回回法而不知此熊防石先生亲与西儒论厯而亦不言及何耶
　　丁卯年
　　高冲过冬至七度十四分
　　春分　丙辰日申初初刻十分　距【丙寅秋分一百七十八日四十五刻十】中积九十三日十刻七分　　【四分春分三百六十五日二十】
　　夏至　己丑日酉初三刻二分　距【三刻四分丙寅夏至三百六十五日】中积九十三日【二十三刻三分】分　　【六十二刻十三冬至一百】
　　秋分　癸亥日己初二刻　　　距【八十二日九刻二分本年春分一百】中积八十九日四【八十六日】分　　【七十三刻五分十七刻四丙寅秋分】
　　冬至　壬辰日亥初一刻四分　距【三百六十五日二十三刻四分丙寅】中积八十八日九【冬至三百】分　　【六十五日二十三刻四分十四刻】
　　戊辰年
　　髙冲过冬至七度十五分
　　春分　辛酉日戍正三刻【十本】分　距【年夏至一百八十三日十四刻二分十】中积九十三日十刻六分　　【四丁卯秋分一百七十八日四】
　　夏至　甲午日夜子初【十五】五分　距【刻十四分春分三百六十五日二十】中积九十三日【三刻四分二刻】分　　【丁卯夏至三百六十五日】
　　秋分　戊辰日申初一刻四分　距【二十三刻三分六十二刻十四冬至】中积八十九日四【十七刻六】分　　【丁卯秋分三百六十五日二十三刻】
　　冬至　戊戌日寅初初刻十分　距【四分丁卯冬至三百六十五日二十】中积八十八日【三刻六分】七分　　【九十四刻本年夏至一百八十三】
　　己巳年
　　髙冲过冬至七度十六分
　　春分　丁卯日丑正三刻二分　距【日十四刻五分戊辰秋分一百七十八】中距九十三日十刻六分　　【日四十五刻十三分春分三百】
　　夏至　庚子日卯初一刻八分　距【六十五日二十三刻三分戊辰夏至】中积九十三日六十三刻　　【三百六十五日二十三刻三】
　　秋分　癸酉日亥初初刻八分　距【分冬至一百八十二日八刻十三分】中积八十九日【本年春分】六分　　【一百八十六日七十三刻六分四十】
　　冬至　癸卯日辰正三刻【七刻】分　距【戊辰秋分三百六十五日二十三刻】中积八十八日【四分十四】八分　　【戊辰冬至三百六十五日二十三】
　　庚午年
　　髙冲过冬至七度十七分
　　春分　壬申日辰正【刻四】七分　距己巳【分九十四刻本年夏至一百八十三】
　　中积九十三日【十刻】四分　　　　【春分三百六十五日卄三刻】
　　夏至　乙巳日午初初刻【五分十】　距己巳【一分夏至三百六十五日二十三刻】
　　中积九十三日六十【三　　　　分三冬至一百八　　　　十二刻日八】
　　秋分　己卯日丑正三刻【刻十二】　距本年【分十一分春分一百八十六日七十】
　　中积八十九日【三刻四　　　　分四十七己巳秋分二百六　　　　十刻七分五日】
　　冬至　戊申日未正三【廿三】分　距己巳【刻三分刻三冬至三百六十】
　　中积八十八日【五日廿　　　　三刻四分九十四本年夏至　　　　一百八十刻七】
　　辛未年
　　髙冲过冬至七度十八分
　　春分　丁丑日未正一刻【分三】　距【日十四刻七分十分庚午秋分一百】中积九十三日【七十】三分　　【八　日四十五刻十四十刻分春】
　　夏至　庚戌日申正三【分　三百】分　距【六十五日廿三刻三分刻十三庚午】中积九十三日【夏至三　　百六十五日二十三刻二　　分六十三】
　　秋分　甲申日辰正三刻　　距【冬至一百八十二日刻二分八刻十】中积八十九日【分本年　　春分一百八十六日七十　　三刻五分四十】
　　冬至　癸丑日戌正二【七庚】分　距【午秋分二百六十刻七分五日廿
　　本年夏至一百八十三日十四刻九分】
　　按庚申年夏至至冬至一百八十三日十三刻六分辛未年夏至至冬至一百八十三日十四刻九分十二年中共长一刻○三分【中积只十一年】
　　壬戌年冬至至次年夏至一百八十二日九刻九分庚午年冬至至次年夏至一百八十二日八刻十分九年中共消十四分【中积共只八年】
　　又合计癸亥夏至前半周一百八十二日九刻九分冬至前半周一百八十三日十三刻十分相较一日○四刻【一分】　辛未夏至前半周一百八十二日八刻十分冬至前半周一百八十三日十四刻九分相较一日○五刻十四分八年中较数増一刻十三分然二分之相距则无甚差何也葢最髙移而东则夏至后多占最髙之度而减度加时之数益多故益长髙冲移而东则冬至后多占最卑之度而加度减时之数益多故益消其近二至处皆为加减差最大之处故消长之较已极也
　　乃若二分与中距虽亦歳移而中距皆为平度不系加减其最髙前后视行小之度固全在春分后半周最髙冲前后视行大之度亦全在春分后半周毫无动移故无甚消长也



　　西国月日攷
　　攷回国圣人辞世年月
　　回国圣人辞世年月据西域斋期【江寕至鸿堂刻单】以康熙庚午五月初三日起是彼中第九月一日谓之勒墨藏一名阿咱而月也至六月初三日开斋是彼中第十月一日谓之绍哇勒一名荅亦月是为大节再过一百日至九月十三日为彼中第一月第十日谓之穆哈兰一名法而干而丁月其日为阿叔喇济贫之期谓之小节鼎尝以回回厯法推算本年白羊一日入第六月之第八日与此正合
　　又据斋期云本年庚午圣人辞世共计一千○九十六年【此太阳年】攷本单开圣人生死二忌在本年十一月十四日在彼为第三月谓之勒必欧勒傲勿勒又名虎而达查西域阿刺必年是开皇己未距今康熙为一千○九十二算减一为一千○九十一乃开皇己未春分至今康熙庚午春分之积年
　　又查己未年春分在彼中为太阴年之第十二月初五日　以距算一千○九十一减圣人辞世千○九十六相差五年逆推之得开皇十四年甲寅为圣人辞世之年
　　约计甲寅至己未此五年中节气与月分差闰五十五日甲寅春分当在彼中第十月之初
　　圣人辞世既是第三月则在春分月前七个月为处暑月即今七月也
　　自开皇甲寅七月十四日圣人辞世至今康熈庚午七月十四日正得一千○九十六年故曰共计一千○九十六年也
　　据此则开皇甲寅是彼中圣人辞世之年薛仪甫谓为回回厯葢以此而误
　　又按圣人以第三月辞世而其年春分则在第十月今彼以第十月一日为大节葢为此也
　　攷泰西天主降生年月
　　据天地仪书耶苏降生至崇祯庚辰一千六百四十年算至康熈庚午一千六百九十年
　　查康熙戊辰年瞻礼单诞辰在冬至后四日日躔箕宿七度　逆推汉哀帝庚申约差卝四度则是当时冬至在斗宿之末　约计耶苏降生在冬至前二十余日为小雪后四五日也
　　自哀帝庚申十月算至隋开皇甲寅七月望回回教圣人马哈木徳辞世实计五百九十四年不足两个多月攷厯书所纪西国年月
　　万厯十二年甲申西九月十五日日躔夀星二度　又十三年乙酉西九月卄八日日躔夀星十五度半万厯十四年丙戌西十月【阙】　日日躔夀星二十九度又十五年丁亥西十月卝六日日躔大火十二度太
　　万厯十六年戊子西十一月初八日日躔大火二十六度太　又十七年己丑西十一月卝二日日躔析木十一度弱
　　万厯十八年庚寅西十二月初六日日躔析木卄五度又十九年辛卯西十二月卄一日日躔星纪九度
　　万厯二十三年乙未西正月三十日日躔枵卄一度万厯三十五年丁未西七月初九日日躔鹑首廿六度五三　又三十七年己酉西七月廿一日日躔鹑火八度半
　　万厯三十八年庚戍西八月初二日日躔鹑火二十度又三十九年辛亥西八月十五日日躔鹑尾二度按此所纪皆是以日躔星纪二十度为正月初一日析木二十度【或十九度】为十二月朔　大火【十九】度【或二十度】为【十一】月朔　夀星十八度为十月朔　鹑尾十八度为九月朔　鹑火十九度【或十八度】为八月朔　鹑尾十八度为七月朔【此亦约畧之算细求之尚有太阳盈缩】
　　又正德九年甲戌西五月初五日子正前日躔大梁二十二度四十分　是以大梁十九度为五月朔【所测在子正前西厯纪日月午正故曰十九度】
　　正德十五年庚辰西四月三十日日躔大梁十七度四八　是以降娄十九度为四月朔
　　又本年七月十三日日躔鹑火初度　是以鹑首十八度为七月朔
　　嘉靖二年癸未西十一月卄九日日躔析木十五度五四　是以大火十八度为十一月朔
　　嘉靖六年丁亥西十月初十日日躔夀星卄七度　是以夀星十八度为十月朔
　　嘉靖八年己丑西二月初一日日躔枵廿一度　是以廿一度为二月朔
　　万厯十年壬午西二月廿六日申初二刻日躔娵訾十七度四十九分四二　是以枵廿二度为二月朔万厯十一年癸未西九月初六日日躔鹑尾廿三度是以鹑尾十八度为九月朔
　　万厯十四年丙戌西十二月廿六日申初二刻太阳在星纪宫十四度五十一分五三　是以析木十九度为十二月朔
　　万厯十六年戊子西十二月十五日巳初刻太阳在星纪三度五十三分　是以析本十九度为十二月朔万厯十八年庚寅西二月初八日午正后三十四刻太阳视行在娵訾初四十秒　是以枵廿三度为二月朔又本年九月初七日子正日躔鹑尾二十四度　据此初一日鹑尾十八度
　　万厯廿一年癸巳西八月初十日日躔鹑火廿七度是以鹑火十八度为八月朔
　　又汉顺帝永建二年丁卯西三月廿六日酉正太阳在降娄一度十三分　是以娵訾七度为三月朔
　　顺帝阳嘉二年癸酉西六月初三日申正太阳在实沈九度四十分　是以实沈七度为六月朔
　　顺帝永和元年丙子西七月初八日午正太阳在鹑首十四度十四分　是以鹑首七度为七月朔
　　又本年西八月三十一日九月初一太阳在鹑尾七度顺帝永和二年丁丑西十月初八日太阳在夀星十四度　是以夀星七度为十月朔
　　顺帝永和三年戊寅西十二月廿二日子正前四时日躔析木九度十五分　据此初一日是大火八度当是十一月非十二月
　　顺帝阳嘉二年癸酉西五月十七十八日太阳在大梁二十三度　据此五月朔大梁七度
　　按自汉顺帝永建丁卯为总积四千八百四十年至明万厯十二年甲申为总积六千二百九十七年相距一千四百五十七年相差十二三度即歳差
　　之行也
　　汉时月朔俱在各宫七八度之间万厯间月朔俱在各宫之十八九度或卄一二度
　　据此论之则西厯太阳年用恒星有定度其恒星节气虽从歳差西行而每月之日次则以太阳到恒星某度为定千古不变也想西古厯法只是候中星每年某星到正中即是某月
　　又按此法于歳差之理甚明但欲敬授民时则不如用节气为妥天经或问欲以冬至日为第一月第一日可以免闰又可授时谓本于方无可先生然沈氏笔谈已先有其説矣
　　今查瞻礼单
　　康熙丁卯年正月十八丁酉日　应西厯三月初一日
　　【亥宫十度　　　　危十一度二十六分　　　　二三】
　　二月二十戊辰日　应西厯四月初一日
　　【戌宫十一度十三分】　　　　壁六度二三
　　二月二十戊戌日　应西厯五月初一日
　　【酉宫十度二十九分】　　　　娄十度五三
　　四月廿二己巳日　应西厯六月初一日
　　【申一十度十五分】　　　　毕六度九分
　　五月廿二己亥日　应西厯七月初一日
　　【未八度四十九分】　　　　井七度五一
　　六月廿四庚午日　应西厯八月初一日
　　【午八度二十一分】　　　　柳二度二二
　　七月廿五辛丑日　应西厯九月初一日
　　【巳八度一十分】　　　　张六度四八
　　八月廿五辛未日　应西厯十月初一日
　　【辰七度三十○分】　　　　轸一度○四
　　九月廿七壬寅日　应西厯十一月初一日
　　【卯八度二十二分】　　　　亢八度一八
　　十月卄七壬申日　应西厯十二月初一日
　　寅八度【四二】　　　　心五度一八
　　十一月【卄八】癸卯日　应西厯正月初一日
　　【丑十度二十分】　　　　斗四度二六
　　十二月【三十】甲戌日　应西厯二月初一日
　　【子十一度五十六分】　　　　女四度三○
　　据此则西国厯日是以建子之月为正月也其法不论太隂之晦朔只以太阳为主然又不论节气但以太阳到斗宿四度为正月一日耳
　　又其数与新法厯书所载不同岂彼国亦有改宪耶按西厯以午正纪日则以上宿度宜各加三十分依此推之欧罗巴之正月一日在斗宿五度
　　新法厯书万厯二十三年乙未西正月三十日太阳在枵卄一度于时日行盈厯逆推初一日是星纪卄一度以歳差攷之万厯乙未至今丁卯距九十二年计差一度半弱其时星纪卄一度是斗十四度二法相较差十度必是改宪抑彼有多国各一其法耶
　　又按今之斗四度是星纪十度逆推前此六百六十余年则正是冬至日太阳所躔之度也当此北宋之初瞻礼单必是此时所定
　　若厯书所载斗十四度则又在其前六百六十年距今丁卯共有一千三百二十余年当在汉时葢其时冬至日躔斗十四度故以为歳首意者厯书所载故是古法而瞻礼单所定乃是新率耶由是观之则耶苏新教之起必不大逺
　　又按西法以白羊宫初度为测算之端而纪月又首磨羯何耶曰测算论节气是以太阳之纬度为主纪月论恒星是以太阳之经度为主故也



　　地度弧角
　　地度求斜距法
　　有两处北极髙度又有两处相距之经度而求两地相距之里数
　　甲乙丙为赤道象弧丁为极【丁角之度为甲乙】戊
　　甲距四十五度甲乙十度半【即经度之距亦即丁角】巳乙距四十度求戊巳之距法作戊庚丙
　　象弧斜交于赤先求庚乙距以减巳乙得
　　庚巳边又求戊庚边求庚角成戊庚巳小三角弧算戊庚巳小三角先有一角【庚】两边【一戊庚边一已庚边】而求已戊边　法先作已辛垂弧截出戊辛边并求戊角因得巳戊边乃以度变成里此所得即大度若距赤同度则但以距赤道余求其比例得里数
　　一率　全　　　　　　　　二率　距赤余三率　大度里数【二百五十里】四率　纬圈里数如距赤四十五度依法算得离赤道四十五度之地每一度该一百七十六里二百八十步　如东西相距二十七度该四千七百七十二里三百五十歩弱
　　论曰地有距赤纬度又有东西经度经度如句纬度相减之余如股两地斜距如
　　既有句有股可以求而不可以句股法求者地圆故也又论曰此为一角两边而角在两边之中法当用斜弧三角法求其对角一边之度变为里即里数也或用垂线分形法并同补论曰已防或在庚上或在其下其用庚角并同　但在下则当于庚乙内减巳乙而得己庚
　　以里数求经度法
　　或先有两地相距之里数而不知经度
　　法先求两处北极髙度乃以两髙度之余为两边及相距里数变成度【用二百五十里大度】又为一边成弧三角形　乃以三边求角法求其对里数边之一角即经度也论曰凡地经度原以月食时取其时刻差以为东西相距然月食歳不数见又必多人两地同测始能得之况月天最近有气刻时三差及朦影之改变髙度非精于测者不易得凖　今以里数求之较有把握　得此法与月食法相参伍庶几无误　凡以里数论差当取径直若遇山林水泽峻岭回谷则以测量法求其折算之数而取直焉
　　不但左右不宜旋绕曲折斯谓之直即髙下若干亦须用法取平
　　若两地极髙同度则但以距赤道余【即极髙度正】求其比例得经度
　　一率　距赤度余
　　二率　全数
　　三率　里数所变之度【用二百五十里为度】
　　四率　相应之经度【纬圏经度也与赤道大圏相应但里数小耳】
　　论曰北极髙度虽有凖则然近在数十里内所争在分秒之间亦无大差今以里数凖之则当以正东西为主如自东至西之路合罗金卯酉中线斯为正度若稍偏侧亦当以斜度改平然后算之视极髙度反似的确里差攷
　　时宪厯各省太阳出入昼夜时刻
　　京师　三十【九度五十五分】夏至昼五十九刻【七分】夜三十六刻【八分】盛京　四十【二　天问度　略无】　六十刻四分　三【十五】刻十【一分】山西　三十八度　　　五十八刻【八分】　三十七刻【七分】山东　朝鲜　【三十六度】　　五十七【刻十三分】　三十八刻【二分】河南　陜西　【三十　四度竒】　五十七刻【一分】　三十八【刻十四分】江南　三十二度半　　五十六刻【六分】　三十九刻【九分】湖广　三十一度　　　五十六刻【二分】　三十九【刻十三分】四川　三　十　度　　五十【五刻】十【一分】　四十刻四分浙江　廿　九　度
　　江西　二十九度　　　五十五刻【七分】　四十刻八分福建　广西　【二十七度】　　五十四【刻十二分】　四十一刻【三分】贵州　二十五度　　　五十四刻【四分】　四十一【刻十一分】云南　二十四度　　　五十四刻　　四十二刻广东　二十三度半　　五十三【刻十一分】　四十二刻【四分】此据壬申年厯日数也其刻数与天问略同者京师江南湖广浙江江西云南广东也刻分同则极髙确矣
　　山西天问略长五十八刻六分今八分是所差不多或字画误也其极髙三十八度应亦无讹
　　山东天问略长五十八刻四分今只五十七刻十三分是极髙原测三十七度后改测三十六度也
　　时宪厯各省节气时刻
　　以京师为主　在东者加　在西者减　毎加减四分为经度一度
　　朝鲜　　　　　　　　加二刻十分
　　盛京　　　　　　　　加二刻
　　浙江　　福建　　　　加十二分
　　江南　　　　　　　　加八分
　　山东　　　　　　　　加五分
　　以上地在京师之东皆加
　　江西　　　　　　　减十分
　　河南　　湖广　　　减一刻
　　广东　　山西　　　减一刻五分
　　广西　　陜西　　　减二刻四分
　　贵州　　　　　　　减二刻八分
　　四川　　　　　　　减三刻七分
　　云南　　　　　　　减四刻八分
　　以上地皆在京师之西皆减
　　天象同时并见而在东者早见日故其刻分加在西者迟见日故其刻分减假如京师正午时太阳在午线而居东者已见其过午矣故加居西者方见其将午到而犹未正午也故减
　　陜西天问略长五十七刻十三分今只五十七刻一分是极高原测三十六度后改测三十四度奇也河南天问略长五十七刻七分今只五十七刻一分是极高原测三十五度后改测三十四奇也
　　褔建天问略长五十四刻八分今有五十四刻十二分是极高原测二十六度后改测二十七度也广西天问略长五十四刻四分今亦五十四刻十二分是极髙原测二十五度后改测二十七度也贵州天问略长五十四刻今有五十四刻四分是极髙原测二十四度半后改测二十五度也
　　天问略四川极髙二十九度半江西二十九度









<子部,天文算法类,推步之属,历算全书,卷十二>








　　南北纬度以北极髙下定　东西经度以月食时刻定地在东一度则见食早其差为十五分刻之四节朔同地在北则昼夜差多南则渐平





　　仰规覆矩　以里差赤纬为用
　　一查地平经度为日出入方位
　　一查赤道经度为日出入时刻
　　约法
　　求每日出入地平广度【春分至秋分在正卯酉北秋分至春分在正卯酉南】一率　大员半径
　　二率　极髙度割线
　　三率　赤道纬度正
　　四率　日出入卯酉正【地平经度】
　　求每日昼刻长短【春分至秋分加秋分至春分减】皆加减半昼二十四刻为半昼刻
　　一率　大员半径
　　二率　极髙度切线
　　三率　赤道纬度切线
　　四率　日出入加减度正【赤道经度】　以变时刻为加减之用
　　求二至日出地广度图【广者地平经度距正卯酉也即日出入方位举二至为例余日皆以赤纬定之】
　　已丙极髙度　即甲角之
　　弧【亦即乙甲丁之余弧】　乙丁为夏
　　至日距赤道之纬　即壬
　　辛【其正弧辰乙即卯甲】　今求乙甲
　　为夏至日出地平之广【冬至
　　同广但夏至在卯酉北冬至在正卯酉南逐日赤纬
　　皆可以此法求之得逐日出地之广】用甲乙
　　丁弧三角形　法为丙戊正与丙甲半径若乙丁之正乙辰与乙甲也【乙甲即正　丙戊正即北极髙度之余庚甲也以丙甲戊角即巳甲丙之余角】　或用乙甲卯句股形　则为庚甲余【巳甲丙角之余】与巳甲半径若壬辛之正卯甲与乙甲也末皆以乙甲查正表得弧为出地之广【壬辛之正壬未与乙辰卯甲同大即知乙丁与壬辛亦同大而卯甲之弧亦与壬辛同大而今以直视竟成正】
　　捷法　以比例尺取丙甲半径于正线之九十度定尺乃以乙甲正取对度得弧命为出地之广




　　法曰半径与北极出地之割线若赤道纬度正与地平出入经度距正卯酉之正也
　　此图已为南极　甲乙为冬至日出入之广　卯乙为冬至日轨所减于半昼之度　与前图同理
　　量法从乙作直立线【与午
　　甲平行】至戌得戌午弧即
　　乙星出入地平距正卯
　　酉经度【大圈即子午规侧望之形故午
　　甲线即正卯酉】



　　求时刻法　若欲知卯乙在距等圏之度法以卯为心癸若壬为界作半圏次从卯心出半径直线至干平分半员成象限末于乙出线与卯干半径平行至象限弧止为乙坎则其所分坎干之弧即卯乙在距等圏之度此度与甲丁赤道度相应可以知所歴时刻矣
　　或用比例尺　以癸卯【即赤纬余】为距等半径加正线九十度定尺乃以卯乙取对度得弧
　　又算法　求时刻加减度【谓逐日时刻所加减于半昼二十四刻之数春分后加秋分后减皆以度变时】　用前图巳甲乙斜弧三角形　有甲角【极出地度】有巳甲边九十度　有巳乙边赤纬之余【按用斜弧法厯书未有】　求巳角【其弧甲丁】赤道经度用查时刻
　　法为半径丙甲与甲角之切线酉丙
　　若已乙之余切亥丁【乙丁为巳乙之余故也实即
　　赤纬之正切也】与已角之正甲丁【甲丁即弧即正
　　以直视故弧线变为直线用法以甲丁查正表得角度】
　　右即夏至卯酉前后日行地平上之赤道度以距等圏上之卯乙即赤道上之甲丁以甲丁度化时即得本地卯正前酉正后所多之刻冬至日卯后酉前所减之度及其时刻并同【逐日求之可列表】
　　求乙甲边【地平经度查日出方位】此为求出地平之广与前算法并同但用斜弧形故其名顿易　法为半径丙甲与极出地甲角之割线酉甲若已乙之余乙辰与乙甲边【乙甲亦即边即正】　末以乙甲边查正表得乙甲边之度








　　厯算全书卷十二
　　自序
　　授时厯于日躔盈缩月离迟疾并云以算术垜积招差立算而今所传九章诸书无此术也岂古有而今逸耶载攷厯草并以盈缩日数离为六段各以段日除其叚之积度得数乃相减为一差一差乂相减为二差则其数齐同乃缘此以生定差及平差立差定差者盈缩初日最大之差也于是以平差立差减之则为毎日之定差矣若其布立成法则直以立差六者因之以为毎日平立合差之差此两法者若不相而其术巧防从未有能言其故者余因李世徳孝廉之疑而试为思之其中原委亦自晓然爰命孙【瑴成】衍为垜积之图得书一卷




　　钦定四库全书
　　厯算全书卷十三
　　宣城梅文鼎撰
　　授时平立定三差详説
　　太阳行天有盈有缩立成以八十八日九十一刻就整为限者【据盈厯言之】此由测验而得之也葢自定气冬至至定气春分太阳行天一象限【依古法以九十一度三一竒为象限】该歴九十一日三十一刻有竒而今则不然毎于冬至后八十八日九十一刻而太阳已到春分宿度故盈厯以此为限也
　　夫八十八日九十一刻而行天一象限则于平行之外多行二度四十分竒也是为盈厯之大积差若缩厯即其不及之数必行至九十三日竒而后满一象限也故缩厯之限多于盈厯日数其积差极数亦与盈厯同但此盈缩之差絶非平派或自多而渐少或由少而渐多何以能得其毎日参差之数郭太史立为平立定三差法以齐其不齐可得毎日细差及积差其理则出于垜积招差之法也
　　定差者何曰所测盈缩初日最大之差也凡盈缩末日即同平行其盈缩之最多必在初日今欲求逐日之差必先求初日最大之差以为之凖则故曰定差也既有此最大之差即可以求逐日之差而逐日之差皆以渐而少法当用减故又有平差立差皆减法也然何以谓之平差曰平者平方也其差之増有类平方故以名之也差何以能若平方曰初日以后其盈缩渐减以至于平以常法论之数宜平派即用差分法足矣而合之测验所得则又非平派也其近初日也所减甚少其近末日也所减骤多假如一日减平差一则二日宜减二而今则二日之平差増为四又初日平差一二日平差四则三日宜为七四日宜为十而今则三日之平差増为九四日増为十六故非平方垜积之加法不足以列其衰序也
　　然则又何以为立差曰立者立方也差何以又若立方曰以平差合之测验犹为未足故复设此以益之假如初日减平差一又带减立差一至二日则平差四而所带之立差非四也乃八也三限平差九而立差非九也乃二十七也葢必如此而后与所测之盈缩相应其分为六段何也曰此求差之法也一二日间虽各有盈缩之差然差少则难辨积至半次其差始多而可见矣故各就其盈缩之日匀分之一年二十四定气分四象限各有六气故其分亦以六也
　　既匀分六段矣又以后段连前段何也曰此所谓招差也虽匀分六段其差积仍难细分故惟于初段用本数以其盈缩多而易见也【如盈厯初段积盈七千分是最多而易见也】若末段必带前段以其盈缩少而难真也【如盈厯末段积差与第五段相减则其本段中只共盈七百四十九分数少难分故连前段论之】借彼易见之差以显难真之数此立法之意也【以太阳盈差为例他仿此】
　　然则各段平差不几混乎曰无虑也凡前多后少之积差合总数而匀分之即得最中之率如第六段之平差即第四十四日之盈加分【以八十八日九二折半得四十四日四六即最中之处其本段平差二百七十余分与之相应下仿此】第五段之平差即第三十七日之盈加分第四段之平差即二十九日之盈加分第三段之平差即第二十二日之盈加分第二段之平差即第十四日八二之盈加分第一段之平差即第七日四一之盈加分其数各有归着虽连前段原无牵混也然则又何以有一差二差曰一差者差之较也二差者较之较也曷言乎差之较曰各段平差是盈缩于平行之数也其数初段多而末段少各段一差是相邻两限盈缩之较也其数初段少而末段反多然则二者若是其相反欤曰非相反也乃相成也葢惟其盈缩于平行之数既以渐而减则其盈缩自相差之数必以渐而増其法于前限平差内减次限平差即知前限之盈缩多于后限若干矣而此一差之数原非平派故初限次限之较最少而次限三限之较渐多三限四限之较又多四限五限更多至五限六限则多之极矣其多之极者何也盈缩之数近末限则骤减也此一差之前少后多正所以为盈缩之前多后少也
　　然则二差又何以有齐数曰不齐者物之情也而不齐之中有所以不齐焉得其所以不齐斯可以齐其不齐矣今各限之一差不齐而前后两一差相减则仍有齐数为二差是其不齐者差之较而其无不齐者较之较也较之较既为齐数则较数之不齐皆有伦而有脊矣故遂可据之以求定差也
　　泛平积即用第一段平差何也曰今推定差初日之数也前所推第一段平差则第七日之数也故总第一段言之可曰平差而自初日言之但成泛积泛者对定之辞言必再有加减而后为定率也








　　二差折半何也曰以分平差立差之实也葢泛平积差既为初日盈加分多于七日之较则皆此七日中平差立差所积而成之者也而平差之数大立差之数小泛平积之大数皆平差所成而其中有六十九秒【即半二差】则立差所成故分出此数以便各求其数也
　　平差除一次立差除两次何也曰此平立之分也除一次者段日本数为法也除两次者段日自乘为法也于是再以段日乘之则本数者如平方之自乘自乘者如立方之再乘矣
　　平立合差何也曰次限少于初限之差也内有两平差六立差之共数故谓之合差【如盈厯以二分四十六秒为平差三十一微为立差今倍平差得四分九十二秒加入加分立差一秒八十六微共得四分九十三秒八十六微为平立合差是有两平差六立差之数葢加分立差原是六个立差也】
　　定差内又减一平差一立差为初日加分何也曰此初日加分之积少于定差之数也既以定差为初日加分矣而积又减此何也曰以定差为初日加分者乃初日最初之率也积满一日则平差立差各有所减而特其减甚微故各祗一数如平方立方之起数以一也是故此一平差一立差者即初日平立合差也
　　初日之平立合差何独少耶曰准于平方立方之加法正相应也葢平方幂积以自乘之积为等【其数一四九十六二十五三十六四九六四八一也】立方体积以再乘之积为等【其数一八二十七六四百二十五二一六三四三五一二也】而平立合差之数亦如之
　　是故初日之盈缩积是于定差内减一平差一立差如平方立方之根一者积亦一也
　　次日之盈缩积是于二定差内减四平差八立差　如方根二者平积必四立积必八也
　　三日之盈缩积是于三定差内减九平差二十七立差如方根三者平积必九立积二十七也
　　四日之盈缩积是于四定差内减十六平差六十四立差如方根四者平积必十六立积必六十四也
　　向后各限并同此推合而言之即皆逐日之平立合差也然则以一平差一立差较次日之四平差八立差固为小矣而以四平差八立差较三日之九平差二十七立差不更小乎何况以三较四则为九平差二十七立差与十六平差六十四立差其相差不更悬絶乎问次日之平立合差只两平差六立差而今又云四平差八立差三日以后之平立合差只递増六立差【逐日递増加分立差一秒八十六微是六个立差之数】而今所云者三日有平差九立差二十七其説之不同如此必有一误矣曰差之积类于平方立方者是总计其所减之数而毎加加分立差者是分论其逐日所减之数也欲明此理仍当求诸少广【少广者开方法也】
　　今夫平方以一四九十六二十五等为序者其幂积也若分而言之以一三五七九为序者其廉隅也【以相挨两平幂相减即得廉隅如一与四相减得三四与九相减得五九与十六相减得七十六与二十五相减得九是也】廉隅即较也而递増以二数者较之较也【一三五七九皆递増以二】今夫立方以一八二七六四一二五为序者其体积也若分而言之以七十九三七六一为序者其廉隅也【亦以相挨两体积相减得之如一减八得七八减廿七得十九廿七减六十四得三十七六十四减一百二十五得六十一是也】廉隅即较也而递増以六者较之较也【一増六得七七増二六得十九十九増三六得三十七三十七増四六得六一】是故平立差之总积是初日以来所积之差也亦如平立方之幂积体积也平立差之加法是逐日递増之较也亦如平立方之廉隅也
　　合初日以来之加分【即盈缩积度】与定差较则其差如平立方之幂积体积也【平差之序一四九十六二十五　立差之序一八二十七六四一二十五】若以本日之加分与定差较则其差如平立方之廉隅也【平差之序一三五七九　立差之序七十九三十七六十一】
　　若以本日之平立合差与初日较如平立方之廉积【平差之増二四六八立差之増六十八三十六六十】若以相近两日之平立合差自相较如平立方之廉积相较【平差之递増皆二立差之递増以六而再増十二为二六再増十八为三六再増二十四为四六也】于定差内减平差立差各一为初日加分
　　又于初日加分内减去二平差六立差是共减平差四【本日实减三合初日所减之一则四】立差八【本日实减七合初日所减之一则八】而为次日加分也
　　又于次日平立合差内加入六立差为平立合差【共二平差十二立差】以减次日加分是共减去平差九【本日实减平差五合前两日所减四共九】立差二十七【本日实减立差十九合前日所减之八则二十七】而为三日加分也
　　又于三日之平立合差内加六立差为平立合差【共二平差十八立差】以减三日加分是共减去平差十六【本日实减平差七合前三日所减之九则十六】立差六十四【本日实减立差三十七合前三日所减之二十七则六十四】而为四日加分也
　　故曰合初日以来之加分与定差较其差如平立方之幂积体积而以本日之加分【即本日实减数】与定差较则如廉隅也
　　若论布立成法则不言定差但以初日加分为根以平立合差减初日加分为次日加分是于初日加分内减二平差六立差也
　　又以六立差倂入平立合差以减次日加分为三日加分是于次日加分内又减二平差十二立差于初日加分则为减四平差十八立差也
　　又如上法再増六立差以减三日加分为四日加分是于三日加分内又减二平差十八立差于初日加分内则为减六平差三十六立差也
　　故曰以平立合差与初日较若平立方之廉积而以相近两日自相较如平立方之廉积相较也
　　平方二廉故相加以二立方六廉故相加以六此倍平差六因立差为平立合差之理也平方之相加以二者始终不变立方之相加以六者毎限递増此向后立差递増六数之理也






















　　盈缩招差图説
　　盈缩招差本为各一象限之法【如盈厯则以八十八日九十一刻为象限缩厯则以九十三日七十一刻为象限】今只作九限者举此为例也其空格九行定差本数为实也其斜线以上平差立差之数为法也斜线以下空格之定差乃余实也
　　假如定差为一万平差为一百立差为单一今求九限法以九限乘平差得九百又以九限乘立差二次得八十一并两数九百八十一为法定差一万为实法减实余实九千○一十九即九限末位所书之定差也于是再以九限为法乘余实得八万一千一百七十一为九限积数
　　本法以九限乗定差得九万为实另置平差以九限乘二次得八千一百置立差以九限乗三次得七百二十九并两数得八千八百二十九为法以减实九万得八万一千一百七十一为九限积与前所得同
　　本法是先乘后减用法是先减后乘其理一也
















　　初日减平差一庚也次日又减平差二甲也实减三并甲庚也合廉隅矣并计初日共减四合平方幂矣第三日又多减平差二乙也实减五并二甲二乙一庚也合廉隅矣并计前两日共减九合平方幂矣第四日以后仿此推之



<子部,天文算法类,推步之属,历算全书,卷十三>








　　中心甲一为初限所减立差即垜积形之顶
　　加外围六乙共七为次限所减立差平廉长廉各三隅一也并上层甲共八成根二之体积是为垜积形之第二层
　　又加外围丙十二共十九为三限所减立差三平廉共十二三长廉共六隅一也并上两层共二十七合根三之体积是为垜积形之第三层
　　又加外围丁十八共三十七为四限所减立差三平廉共二十七三长廉共九隅一也并上三层共六十四合根四体积是为垜积形之第四层
　　又加外围戊二十四共六十一为五限所减立差三平廉共四十八三长廉十二隅一也并上三层共一百二十五合根五之体积是为垜积之第五层
　　又加巳三十共九十一为六限立差其七十五为三平廉其十五为三长廉其一隅也并上层共二百一十六成体积是为垜积之第六层
　　又加庚三十六共一百二十七为七限立差其百○八为三平廉其十八为三长廉其一隅也并上层成体积三百四十三是为垜积之第七层
　　又加辛四十二共一百六十九为八限立差其百四十七为三平廉其二十一为三长廉其一隅也并上层共五百一十二如体积是为垜积之第八层
　　此姑以八层为式向后仿此推之　因从甲顶平视故类六角平面其实如六角锥也立方廉隅而图以锥形六角者以表其垜积招差之理也　甲恒为隅朱书者长廉余则平廉立方之平廉长廉各三离居三方则成六角　六觚形以六抱一毎层増六与立方加法同所异者六觚平面而立方必并其积故以堆垜象之　若算六角堆垜但取其底之一面自乘再乘见积与立方同


















　　以斜立面观之最上甲一次乙二次丙三丁四戊五己六庚七辛八其底之数各如其层之数【如堆只三层则以三丙为底四层则四丁为底毎多一层其各面之底必多一数若辛下再加一层为壬必九数也】
　　实计其毎面六觚之数则甲一乙七丙十九丁三十七戊六十一己九十一庚一百二十七辛一百六十九【前平视之图乙为甲掩故但见外围之六丙为乙掩故但见外围十二余皆若是也观者当置身于髙处从甲顶俯视即得其理】皆以外围之数为下层多于上层之数
　　合计其堆垜之积则甲一乙八丙二十七丁六十四戊一百二十五己二百一十六庚三百四十三辛五百一十二【乙七并甲一成八丙十九并乙七甲一成二十七余皆若是】其堆垜之积皆如其层数之立方【以底之一面余乗又以层数乗之也】
　　问平差之根是以段日除积差而得则毎日适得一平差今所减平差甚多殆非实数曰泛平积差是初日多于第七日之数【亦据盈厯言之】而平差之数既如段日则于日数为加倍【盈厯段日十四日竒以此分积差为毎日平差则平差共数亦十四竒于七日为加倍】今倍减平差正合积差原数岂患其多
　　曰若然又何以能合平方曰以本日实减之数与定差较但取其销尽积差已足【如第七日实减十三平差第八日实减十五平差七日有竒在其中半积差必当减尽】故其法若平方之廉隅若合计初日以来减过平差与初日以来定差相较则所减之积皆如平方自乘观图自明【如七日共数得四十九八日共数得六十四之类】
　　又如立差以段日自乘除泛立积差而得故其数亦略如段日之自乗而毎日实减亦如立方之廉隅聊足以销去积差【本日尚有余秒后一日竒减尽】若合计初日以来共数则亦如立方再乗之积矣















<子部,天文算法类,推步之属,历算全书,卷十三>
<子部,天文算法类,推步之属,历算全书,卷十三>
<子部,天文算法类,推步之属,历算全书,卷十三>
　　右图以九限为例【九限以后仿论】定差设十万平差设一千立差设单一如法以本日加法并之为平立合差【如图平差立差各有加法故当并用】以平立合差减先日加分得本日加分合计从前加分为本日盈缩积【或以本日加分加先日盈缩积得本日盈缩积亦同】
　　又简法
　　置定差内减平差立差各一为初日加分【又即为第一日盈缩积】别置平差倍之加入六立差为初日平立合差以后毎于平立合差内加入六立差为次日平立合差【余同上】
　　用定差法
　　以日数乘立差得数加入平差再以日数乘之得数乃置定差以得数减之用其余为实复以日数乘之得本日盈缩积
　　置相近两盈缩积相减得加分又置相近两加分相减得平立合差亦同
　　定差本法
　　置定差以日数乘之得数为实又以日数自乘用乘平差得数以日数再自乘用乘立差得数平立两得数并之为法法减实得盈缩积【余同上】













　　厯算全书卷十三
<子部,天文算法类,推步之属,历算全书>
　　序
　　厯元起冬至其来旧矣易复卦传曰先王以至日闭闗商旅不行后不省方孟子曰天之高也星辰之逺也茍求其故千嵗之日至可坐而致故古来治厯者其立算并起冬至夫有所受之也欲騐将来必推已往所谓求其故也秦炬以前古术难征惟春秋左氏传僖公五年春王正月辛亥朔日南至公既视朔遂登观台以望而书此冬至之有日名灼然可据者自汉以后渐讲于测景之法然测景最难真确载在史书可信者不过数十条故元时许衡王恂郭守敬等造授时厯据之以考厯法之疎密也古今厯法七十余家皆由疎以至密必取其最密者以相参考而其説始定是故唐厯莫善于大衍其次莫善于宣明宋厯莫善于纪元尤莫善于统天金厯莫善于赵知微而授时厯集其大成故以此六家互相稽考也今依其本法求之则合于当时者或戾于古合于古者又不效于今惟授时统天能上考下求而多所合由是观之厯学之古疎今密约畧可见而嵗起冬至则嵗实之古大今小较然不诬即统天授时上考下求百年消长之法亦自有据并可以深思而得其故矣【按百年消长之法统天厯术中已暗藏其数至授时乃发明之郭太史自言创法五端原未及此】元史厯议已具录六厯所得日名离合之端然未详算法兹特各依其本法详衍使学厯者攷焉宣城梅文鼎










　　钦定四库全书
　　厯算全书卷十四
　　宣城梅文鼎撰
　　冬至攷
　　唐宋金元六家算冬至本术
　　唐开元大衍厯【僧一行造】演纪上元阏逢困敦之歳距开元十二年甲子积九千六百九十六万一千七百四十算
　　通法三千○四十
　　策实百一十一万○三百四十三
　　策余万五千九百四十三
　　策实乘积算曰中积分盈通法而一为积日爻数去之余起甲子算外得天正中气
　　辰法七百六十【即半辰法】　　刻法三百○四
　　凡发敛加时各置其小余以六爻乘之辰法而一为半辰之数不尽进位六约为分分满刻法为刻命辰起子半算外
　　唐宣明厯【徐昻造】通法曰统法策实曰章歳策余曰通余爻数曰纪法通纪法为分曰旬周章歳乘年曰通积分演纪上元甲子至长庆二年壬寅积七百○七万○一百三十八算外
　　统法八千四百
　　章嵗三百○六万八千○五十五
　　通余四万四千○五十五
　　刻法八十四
　　辰法七百　　半辰法三百五十
　　宋崇宁纪元厯演纪上元上章执徐之歳距元符三年庚辰嵗积二千八百六十一万三千四百六十算至崇宁五年丙戌歳积二千八百六十一万三千四百六十六算
　　日法七千二百九十
　　辰法一千二百一十五　　半辰法六百○七半刻法七百二十九
　　期实二百六十六万二千六百二十六
　　歳周三百六十五日余一千七百七十六
　　旬周四十三万七千四百
　　纪法六十
　　置积年期实乘之为气积分满旬周去之不满日法而一为大余命己卯即所求天正冬至日辰及余其小余倍之辰法而一为辰数不满五因刻法而一为刻数
　　勿庵法小余进一位刻法收之为刻不尽为刻分刻加二退位得时
　　金赵知微重修大明厯演纪上元甲子距大定二十年庚子八千八百六十三万九千六百五十六年【大定庚子即宋孝宗淳熈七年距元至元辛巳一百一年】
　　日法五千二百三十分
　　歳实一百九十一万○二百二十四
　　通余二万七千四百二十四
　　旬周三十一万三千八百
　　纪法六十
　　歳实乘积年为通积分旬周去之不满日法约之为大余命甲子
　　辰法二千六百一十五　半辰法一千三百○七半刻法三百一十三秒八十
　　凡小余六因之辰法除之不尽刻法除之为刻
　　宋统天厯演纪上元甲子歳距绍熈五年甲寅积三千八百三十【至庆元己未歳积三千八百三十五至至元辛巳歳积三千九百一十七】策法一万二千
　　歳分四百三十八万二千九百一十　余六万二九一气差二十三万七千八百一十一【法通得一十九日八一七五】斗分差一百二十七
　　纪实七十二万
　　歳分乘积算气差减之为气泛积
　　积算距算相减为距差斗分差乘之万约【万约者万分为分万秒为秒也半以上收为秒半以下则弃之矣】为躔差【小分半以上从秒一】复以距差乘之【秒半以上从分一】以减泛积为气定积满纪实去之余如策法而一为大余【如其年无躔差及距差乘躔差不满秒以上者以泛为定】鼎按此即授时厯加减嵗余法也积算减距算为距差者距绍熈甲寅为算也斗分差乘距差为躔差者百年加减一分也授时毎百年加减一分统天则一分零六秒弱复以距差乘躔差者百年加减一分竒而又以其距年乘之也假如百年授时加减积百分统天则百有六分弱减泛积为定者授时不立元明以当时所测截算为主故有上考下求之别而加减亦明统天则虽以当时所测截算为主而又立元故只用减所求在距算以后减之则冬至差而早早则其嵗实减矣所求在距算以前减之则冬至益早早则其嵗实加矣减之而歳实减人知之减之而嵗实加人不知之此算家转换之法也若距差乘躔差不满秒半以上者是所求正在绍熈前后百年内其嵗实平故无加减而以泛为定
　　元授时厯【许衡王恂郭守敬造】不用积年据实测至元十八年辛巳嵗前天正冬至为元上考下求皆距此起算
　　日法一万分　　　　纪法六十万
　　嵗实三百六十五万二四二五【上考者毎百年长一分下求者毎百年消一分】气应五十五万六百分
　　距算乘嵗实为中积加气应为通积满纪法去之得数为天正冬至　上考者以气应减中积为通积满纪法去之余以减纪法得数为冬至【并起甲子算外命其日辰】小余以十二乘之满万为一时命起子正满五千又进一时命起子初算外得时不满者以一千二百除之为刻


　　春秋以来冬至日名六厯异同详衍
　　【按春秋以来冬至多矣而所攷只此者以其测验之可据也厯议原载四十八事今攷献公在春秋前无信史可徴故删之而以左传僖公一条为首实四十七事也】
　　鲁僖公五年丙寅歳正月辛亥朔旦冬至
　　大衍厯【积算九千六百九十六万○三百六十二】中积分【一百○七兆六千五百九十二亿五千九百二十二万四千一百六十六】冬至【大余四十七日小余二千八百八十六】辛亥日【九十四刻太强】亥正三刻
　　宣明厯【积算七百○六万八千六百六十二】通积分【二十一兆六千八百七十○亿四千三百七十九万二千四百一十】冬至【大余四十七日小余五千六百一十】
　　辛亥日【六十六刻太强】申正初刻
　　纪元厯【积算二千八百六十一万一千七百○六】气积分【七十六兆一千八百二十二亿七千二百二十九万九千九百五十六】冬至【大余三十三日小余六千一百八十六】壬子日【八十四刻太强】戌正一刻
　　统天厯【积算一千九百八十二】距差【一千八百四十分】躔差【二十三八五】减分【四万三千四百二十八】气泛积【八十六亿八千六百六十八万九千八百○九】气定积【八十六亿八千六百六十四万六千三百七十一】冬至【大余四十七日小余二千三百七十一】
　　辛亥日【一十九刻太强】寅正三刻
　　重修大明厯【积算八千八百六十三万七千八百二十二】通积分【一百六十九兆三千一百八十○亿九千四百八十九万二千一百二十八】冬至【大余四十八日小余四千六百八十八】
　　壬子日【八十九刻半强】亥初二刻
　　授时厯【距算一千九百三十五】歳余【二四四四】中积分【七十○亿六千七百四十七万九一四○】通积分【七十○亿六千六百九十二万八五四○】冬至【四十七万一四六○】
　　辛亥日【一十四刻半强】寅初二刻
　　鲁昭公二十年己夘歳正月己丑朔旦冬至
　　大衍厯【积算九千六百九十六万○四百九十四】中积分【一百○七兆六千五百九十四亿○六百八十九万九千七百八十五】冬至【大余二十五日小余一千三百八十五】己丑日【四十五刻半强】已正三刻
　　宣明厯【积算七百○六万八千七百九十四】通积分【二十一兆六千八百七十四亿五千一百八十四万三千七百二十五】冬至【大余二十五日小余一千七百二十五】己丑日【二十刻半强】寅正三刻
　　纪元厯【积算二千八百六十一万一千八百三十八】气积分【七十六兆一千八百二十六亿二千六百四十二万九千二百一十四】冬至【大余一十一日小余一千八百二十四】庚寅日【二十五刻少弱】卯正初刻
　　统天厯【积算二千一百一十五】距差【一千七百一十五】躔差【二十一分八】减分【三万七千三百八十七】气泛积【九十二亿六千九百六十一万六千八百三十九】气定积【九十二亿六千九百五十七万九千四百五十二】冬至【大余二十四日小余一万一千四百五十二】
　　戊子日【九十五刻半弱】亥正三刻
　　重修大明厯【积算八千八百六十三万七千九百五十五】通积分【一百六十九兆三千一百八十三亿四千八百九十五万一千九百二十】冬至【大余二十六日小余一千五百四十】
　　庚寅日【二十九刻半弱】辰初初刻
　　授时厯【距算一千八百○二】歳余【二四四三】中积分【六十五亿八千一百七十○万二二八六】通积分【六十五亿八千一百一十五万一六八六】冬至【二十四万八三一四】戊子日【八十三刻强】戌初三刻
　　刘宋文帝元嘉十二年乙亥歳十一月十五日戊辰景长
　　大衍厯【积算九千六百九十六万一千四百五十二】中积分【一百○七兆六千六百○四亿六千九百四十九万八千○三十六】冬至【大余四日小余一千○七十六】
　　戊辰日【三十五刻少强】辰正二刻
　　宣明厯【积算七百○六万九千七百五十二】通积分【二十一兆六千九百○二亿八千七百九十七万二千三百六十】冬至【大余四日小余二千七百六十】
　　戊辰日【三十二刻太强】辰初三刻
　　纪元厯【积算二千八百六十一万二千七百九十六】气积分【七十六兆一千八百五十一亿七千四百五十六万二千二百九十六】冬至【大余四十九日小余二千八百八十六】戊辰日【三十九刻半强】巳初二刻
　　统天厯【积算三千○七十二】距差【七百五十八】躔差【九分六】减分【七千二百七十七】气泛积【一百三十四亿六千四百○六万一千七百○九】气定积【一百三十四亿六千四百○五万四千四百三十二】冬至【大余四日小余六千四百三十二】戊辰日【五十三刻半强】午正三刻
　　重修大明厯【积算八千八百六十三万八千九百一十二】通积分【一百六十九兆三千二百○一亿七千七百○三万六千二百八十八】冬至【大余四日小余二千一百六十八】
　　戊辰日【四十一刻半弱】巳初三刻
　　授时厯【距算八百四十五】歳余【二四三三】中积分【三十○亿八千六百三十○万五八八五】通积分【三十○亿八千五百七十五万五二八五】冬至【四万四七一五】戊辰日【四十七刻强】午初一刻
　　元嘉十三年丙子歳十一月二十六日甲戌景长大衍厯【积算九千六百九十六万一千四百五十三】中积分【一百○七兆六千六百○四亿七千○六十○万八千三百七十九】冬至【大余九日小余一千八百一十九】癸酉日【五十九刻太强】未正一刻
　　宣明厯【积算七百○六万九千七百五十三】通积分【二十一兆六千九百○三亿九千一百○四万○四百一十五】冬至【大余九日小余四千八百一十五】
　　癸酉日【五十七刻少强】未初三刻
　　纪元厯【积算二千八百六十一万二千七百九十七】气积分【七十六兆一千八百五十一亿七千七百二十二万四千九百二十二】冬至【大余五十四日小余四千六百六十二】癸酉日【六十四刻弱】申初一刻
　　统天厯【积算三千○七十三】距差【七百五十七】躔差【九分六】减分【七千二百六十七】气泛积【一百三十四亿六千八百四十四万四千六百一十九】气定积【一百三十四亿六千八百四十三万七千三百五十二】冬至【大余九日小余九千三百五十二】
　　癸酉日【七十七刻太强】酉正二刻
　　重修大明厯【积算八千八百六十三万八千九百一十三】通积分【一百六十九兆三千二百○一亿七千八百九十四万六千五百一十二】冬至【大余九日小余三千四百四十二】
　　癸酉日【六十五刻太强】申初三刻
　　授时厯【距算八百四十四】歳余【二四三三】中积分【三十○亿八千二百六十五万三四五二】通积分【三十○亿八千二百一十○万二八五二】冬至【九万七一四八】癸酉日【七十一刻半弱】酉初初刻　先一日
　　元嘉十五年戊寅歳十一月十八日甲申景长
　　大衍厯【积算九千六百九十六万一千四百五十五】中积分【一百○七兆六千六百○四亿七千二百八十二万九千○六十五】冬至【大余二十日小余二百六十五】
　　甲申日【八刻太弱】丑正初刻
　　宣明厯【积算七百○六万九千七百五十五】通积分【二十一兆六千九百○三亿九千七百一十七万六千五百二十五】冬至【大余二十日小余五百二十五】
　　甲申日【六刻少】丑初二刻
　　纪元厯【积算二千八百六十一万二千七百九十九】气积分【七十六兆一千八百五十一亿八千二百五十五万○一百七十四】冬至【大余五日小余九百二十四】
　　甲申日【一十二刻半强】寅初初刻
　　统天厯【积算三千○七十五】距差【七百五十五】躔差【九分六】减分【七千二百四十八】气泛积【一百三十四亿七千七百二十一万○四百三十九】气定积【一百三十四亿七千七百二十○万三千一百九十一】冬至【大余二十日小余三千一百九十一】甲申日【二十六刻半强】卯正一刻
　　重修大明厯【积算八千八百六十三万八千九百一十五】通积分【一百六十九兆三千二百○一亿八千二百七十六万六千九百六十】冬至【大余二十日小余七百六十】甲申日【一十四刻半强】寅初二刻
　　授时厯【距算八百四十二】歳余【二四三三】中积分【三十○亿七千五百三十四万八五八六】通积分【三十○亿七千四百七十九万七九八六】冬至【二十○万二○一四】甲申日【二十刻强】寅正三刻
　　元嘉十六年己卯嵗十一月二十九日己丑景长大衍厯【积算九千六百九十六万一千四百五十六】中积分【一百○七兆六千六百○四亿七千三百九十三万九千四百○八】冬至【大余二十五日小余一千○○八】己丑日【三十三刻强】辰初三刻
　　宣明厯【积算七百○六万九千七百五十六】通积分【二十一兆六千九百○四亿○○二十四万四千五百八十】冬至【大余二十五日小余二千五百八十】
　　己丑日【三十刻太弱】辰初一刻
　　纪元厯【积算二千八百六十一万二千八百】气积分【七十六兆一千八百五十一亿八千五百二十一万二千八百】冬至【大余一十日小余二千七百】
　　己丑日【三十七刻强】辰正三刻
　　统天厯【积算三千○七十六】距差【七百五十四】躔差【九分六】减分【七千二百三十八】气泛积【一百三十四亿八千一百五十九万三千三百四十九】气定积【一百三十四亿八千一百五十八万六千一百一十一】冬至【大余二十五日小余六千一百一十一】
　　己丑日【五十刻太强】午正初刻
　　重修大明厯【积算八千八百六十三万八千九百一十六】通积分【一百六十九兆三千二百○一亿八千四百六十七万七千一百八十四】冬至【大余二十五日小余二千○三十四】
　　己丑日【三十八刻太强】巳初一刻
　　授时厯【距算八百四十一】歳余【二四三三】中积分【三十○亿七千一百六十九万六一五三】通积分【三十○亿七千一百一十四万五五五三】冬至【二十五万四四四七】己丑日【四十四刻半弱】巳正二刻
　　元嘉十七年庚辰歳十一月初十日甲午景长
　　大衍厯【积算九千六百九十六万一千四百五十七】中积分【一百○七兆六千六百○四亿七千五百○四万九千七百五十一】冬至【大余三十日小余一千七百五十一】甲午日【五十七刻半强】未初三刻
　　宣明厯【积算七百○六万九千七百五十七】通积分【二十一兆六千九百○四亿○三百三十一万二千六百三十五】冬至【大余三十日小余四千六百三十五】
　　甲午日【五十五刻少弱】未初初刻
　　纪元厯【积算二千八百六十一万二千八百○一】气积分【七十六兆一千八百五十一亿八千七百八十七万五千四百二十六】冬至【大余一十五日小余四千四百七十六】甲午日【六十一刻半弱】未正三刻
　　统天厯【积算三千○七十七】距差【七百五十三】躔差【九分六】减分【七千二百二十九】气泛积【一百三十四亿八千五百九十七万六千二百五十九】气定积【一百三十四亿八千五百九十六万九千○三十○】冬至【大余三十日小余九千○三十○】甲午日【七十五刻少】酉正初刻
　　重修大明厯【积算八千八百六十三万八千九百一十七】通积分【一百六十九兆三千二百○一亿八千六百五十八万七千四百○八】冬至【大余三十日小余三千三百○八】
　　甲午日【六十三刻少】申初初刻
　　授时厯【距算八百四十】歳余【二四三三】中积分【三十○亿六千八百○四万三七二○】通积分【三十○亿六千七百四十九万三千一百二十○】冬至【三十○万六八八○】
　　甲午日【六十八刻太强】申正二刻
　　元嘉十八年辛巳嵗十一月二十一日己亥景长大衍厯【积算九千六百九十六万一千四百五十九】中积分【一百○七兆六千六百○四亿七千六百一十六万○○九十四】冬至【大余三十五日小余二千四百九十四】己亥日【八十二刻强】戌初二刻
　　宣明厯【积算七百○六万九千七百五十八】通积分【二十一兆六千九百○四亿○六百三十八万○六百九十】冬至【大余三十五日小余六千六百九十】
　　己亥日【七十九刻少弱】酉正四刻
　　纪元厯【积算二千八百六十一万二千八百○二】气积分【七十六兆一千八百五十一亿九千○五十三万八千○五十二】冬至【大余二十日小余六千二百五十二】
　　己亥日【八十五刻太强】戌正二刻
　　统天厯【积算三千○七十八】距差【七百五十二】躔差【九分六】减分【七千二百一十九】气泛积【一百三十四亿九千○三十五万九千一百六十九】气定积【一百三十四亿九千○三十五万一千九百五十○】冬至【大余三十五日小余一万一千九百五十○】
　　己亥日【九十九刻半强】夜子初三刻
　　重修大明厯【积算八千八百六十三万八千九百一十八】通积分【一百六十九兆三千二百○一亿八千八百四十九万七千六百三十二】冬至【大余三十五日小余四千五百八十二】
　　己亥日【八十七刻半强】亥初初刻
　　授时厯【距算八百三十九】歳余【二四三三】中积分【三十○亿六千四百三十九万一千二百八七】通积分【三十○亿六千三百八十四万○六八七】冬至【三十五万九三一三】
　　己亥日【九十三刻强】亥正一刻
　　元嘉十九年壬午歳十一月初三日乙巳景长
　　大衍厯【积算九千六百九十六万一千四百五十九】中积分【一百○七兆六千六百○四亿七千七百二十七万○四百三十七】冬至【大余四十一日小余一百九十七】乙巳日【六刻半弱】丑初二刻
　　宣明厯【积算七百○六万九千七百五十九】通积分【二十一兆六千九百○四亿○九百四十四万八千七百四十五】冬至【大余四十一日小余三百四十五】
　　乙巳日【四刻强】子正四刻
　　纪元厯【积算二千八百六十一万二千八百○三】气积分【七十六兆一千八百五十一亿九千三百二十○万○六百七十八】冬至【大余二十六日小余七百三十八】
　　乙巳日【一十刻强】丑正一刻
　　统天厯【积算三千○七十九】距差【七百五十一】躔差【九分五】减分【七千一百三十四】气泛积【一百三十四亿九千四百七十四万二千○七十九】气定积【一百三十四亿九千四百七十三万四千九百四十五】冬至【大余四十一日小余二千九百四十五】
　　乙巳日【二十四刻半弱】卯初三刻
　　重修大明厯【积算八千八百六十三万八千九百一十九】通积分【一百六十九兆三千二百○一亿九千○四十○万七千八百五十六】冬至【大余四十一日小余六百二十六】
　　乙巳日【一十二刻弱】丑正三刻
　　授时厯【距算八百三十八】歳余【二四三三】中积分【三十○亿六千○七十三万八千八百五十四】通积分【三十○亿六千○一十八万八二五四】冬至【四十一万一七四六】
　　乙巳日【一十七刻半弱】寅正初刻
　　孝武帝大明五年辛丑嵗十一月乙酉冬至
　　大衍厯【积算九千六百九十六万一千四百七十八】中积分【一百○七兆六千六百○四亿九千八百三十六万六千九百五十四】冬至【大余二十日小余二千一百五十四】甲申日【七十刻太强】申正四刻
　　宣明厯【积算七百○六万九千七百七十八】通积分【二十一兆六千九百○四亿六千七百七十四万一千七百九十】冬至【大余二十日小余五千七百九十】
　　甲申日【六十九刻弱】申正二刻
　　纪元厯【积算二千八百六十一万二千八百二十二】气积分【七十六兆一千八百五十二亿四千三百七十九万○五百七十二】冬至【大余五日小余五千三百二十二】甲申日【七十三刻强】酉初二刻
　　统天厯【积算三千○九十八】距差【七百三十二】躔差【九分三】减分【七千八百○八】气泛积【一百三十五亿七千八百○一万七千三百六十九】气定积【一百三十五亿七千八百○○万九千五百六十一】冬至【大余二十日小余九千五百六十一】甲申日【七十九刻太弱】戌初初刻
　　重修大明厯【积算八千八百六十三万八千九百三十八】通积分【一百六十九兆三千二百○二亿二千六百七十○万二千一百一十二】冬至【大余二十日小余三千九百一十二】
　　甲申日【七十四刻太强】酉正一刻
　　授时厯【距算八百一十九】嵗余【二四三三】中积分【二十九亿九千一百三十四万二千六百二七】通积分【二十九亿九千○七十九万二○二七】冬至【二十○万七九七三】
　　甲申日【七十九刻太弱】戌初初刻　先一日
　　陈文帝天嘉六年乙酉嵗十一月庚寅景长
　　大衍厯【积算九千六百九十六万一千五百八十二】中积分【一百○七兆六千六百○六亿一千三百八十四万二千六百二十六】冬至【大余二十六日小余三百八十六】庚寅日【一十二刻太弱】寅初初刻
　　宣明厯【积算七百○六万九千八百八十二】通积分【二十一兆六千九百○七亿八千六百八十一万九千五百一十】冬至【大余二十六日小余一千一百一十】
　　庚寅日【一十三刻少弱】寅初初刻
　　纪元厯【积算二千八百六十一万二千九百二十六】气积分【七十六兆一千八百五十五亿二千○七十○万三千六百七十六】冬至【大余一十一日小余四百八十六】庚寅日【六刻太弱】丑初二刻
　　统天厯【积算三千二百○二】距差【六百二十八】躔差【八分】减分【五千○二十四】气泛积【一百四十○亿三千三百八十四万○○○九】气定积【一百四十○亿三千三百八十三万四千九百八十五】冬至【大余二十六日小余二千九百八十五】庚寅日【二十四刻太强】卯初四刻
　　重修大明厯【积算八千八百六十三万九千○四十二】通积分【一百六十九兆三千二百○四亿二千五百三十六万五千四百○八】冬至【大余二十六日小余四百二十八】庚寅日【八刻少弱】丑初四刻
　　授时厯【距算七百一十五】歳余【二四三二】中积分【二十六亿一千一百四十八万八千八百八十】通积分【二十六亿一千○九十三万八千二百八十】冬至【二十六万一七二○】
　　庚寅日【一十七刻强】寅正初刻
　　临海王光大二年戊子嵗十一月乙巳景长
　　大衍厯【积算九千六百九十六万一千五百八十五】中积分【一百○七兆六千六百○六亿一千七百一十七万三千六百五十五】冬至【大余四十一日小余二千六百一十五】乙巳日【八十六刻强】戍正二刻
　　宣明厯【积算七百○六万九千八百八十五】通积分【二十一兆六千九百○七亿九千六百○二万三千六百七十五】冬至【大余四十一日小余七千二百七十五】
　　乙巳日【八十六刻半强】戌正三刻
　　纪元厯【积算二千八百六十一万二千九百二十九】气积分【七十六兆一千八百五十五亿二千八百六十九万一千五百五十四】冬至【大余二十六日小余五千八百一十四】乙巳日【七十九刻太强】戍初初刻
　　统天厯【积算三千二百○五】距差【六百二十五】躔差【七分九】减分【四千九百三十八】气泛积【一百四十○亿四千六百九十八万八千七百三十九】气定积【一百四十○亿四千六百九十八万三千八百○一】冬至【大余四十一日小余一万一千八百○一】
　　乙巳日【九十八刻少强】夜子初二刻
　　重修大明厯【积算八千八百六十三万九千○四十五】通积分【一百六十九兆三千二百○四亿三千一百○九万六千○八十】冬至【大余四十一日小余四千二百五十】乙巳日【八十一刻少强】戌初二刻
　　授时厯【距算七百一十二】歳余【二四三二】中积分【二十六亿○○五十三万一千五百八四】通积分【二十五亿九千九百九十八万○九百八十有四】冬至【四十一万九○一六】
　　乙巳日【九十刻强】戌初二刻
　　宣帝太建四年壬辰嵗十一月二十九日丁卯景长大衍厯【积算九千六百九十六万一千五百八十九】中积分【一百○七兆六千六百○六亿二千一百六十一万五千○二十七】冬至【大余二日小余二千五百四十七】丙寅日【八十三刻太强】戌正初刻
　　宣明厯【积算七百○六万九千八百八十九】通积分【二十一兆六千九百○八亿○八百二十九万五千八百九十五】冬至【大余二日小余七千○九十五】
　　丙寅日【八十四刻半弱】戌正一刻
　　纪元厯【积算二千八百六十一万二千九百三十三】气积分【七十六兆一千八百五十五亿三千九百三十四万二千○五十八】冬至【大余四十七日小余五千六百二十八】丙寅日【七十七刻少弱】酉正二刻
　　统天厯【积算三千二百○九】距差【六百二十一】躔差【七分九】减分【四千九百○六】气泛积【一百四十○亿六千四百五十二万○三百七十九】气定积【一百四十○亿六千四百五十一万五千四百七十三】冬至【大余二日小余一万一千四百七十三】丙寅日【九十五刻半强】亥正三刻
　　重修大明厯【积算八千八百六十三万九千○四十九】通积分【一百六十九兆三千二百○四亿三千八百七十三万六千九百七十六】冬至【大余二日小余四千一百一十六】丙寅日【七十八刻太弱】酉正三刻
　　授时厯【距算七百○八】歳余【二四三二】中积分【二十五亿八千五百九十二万一八五六】通积分【二十五亿八千五百三十七万一二五六】冬至【二万八七四四】丙寅日【八十七刻半弱】戌正四刻　先一日
　　太建六年甲午嵗十一月二十日丁丑景长
　　大衍厯【积算九千六百九十六万一千五百九十一】中积分【一百○七兆六千六百○六亿二千三百八十三万五千七百一十三】冬至【大余一十三日小余九百九十三】丁丑日【三十二刻半强】辰初三刻
　　宣明厯【积算七百○六万九千八百九十一】通积分【二十一兆六千九百○八亿一千四百四十三万二千○○五】冬至【大余一十三日小余二千八百○五】
　　丁丑日【三十三刻少强】辰正初刻
　　纪元厯【积算二千八百六十一万二千九百三十五】气积分【七十六兆一千八百五十五亿四千四百六十六万七千三百一十】冬至【大余五十八日小余一千六百九十】丁丑日【二十三刻少弱】卯初二刻
　　统天厯【积算三千二百一十一】距差【六百一十九】躔差【七分九】减分【四千八百九十○】气泛积【一百四十○亿七千三百二十八万六千一百九十九】气定积【一百四十○亿七千三百二十八万一千三百○九】冬至【大余一十三日小余五千三百○九】
　　丁丑日【四十四刻少弱】巳正二刻
　　重修大明厯【积算八千八百六十三万九千○五十一】通积分【一百六十九兆三千二百○四亿四千二百五十五万七千四百二十四】冬至【大余一十三日小余一千四百三十四】
　　丁丑日【二十七刻半弱】卯正二刻
　　授时厯【距算七百○六】嵗余【二四三二】中积分【二十五亿七千八百六十一万六九九二】通积分【二十五亿七千八百○六万六三九二】冬至【一十三万三六○八】丁丑日【三十六刻强】辰正四刻
　　太建九年丁酉嵗十一月二十三日壬辰景长
　　大衍厯【积算九千六百九十六万一千五百九十四】中积分【一百○七兆六千六百○六亿二千七百一十六万六千七百四十二】冬至【大余二十九日小余一百八十二】癸巳日【六刻弱】丑初一刻
　　宣明厯【积算七百○六万九千八百九十四】通积分【二十一兆六千九百○八亿二千三百六十三万六千一百七十】冬至【大余二十九日小余五百七十】
　　癸巳日【六刻太强】丑初二刻
　　纪元厯【积算二千八百六十一万二千九百三十八】气积分【七十六兆一千八百五十五亿五千二百六十五万五千一百八十八】冬至【大余一十三日小余七千二百一十八】壬辰日【九十九刻强】夜子初三刻
　　统天厯【积算三千二百一十四】距差【六百一十六】躔差【七分八】减分【四千八百○五】气泛积【一百四十○亿八千六百四十三万四千九百二十九】气定积【一百四十○亿八千六百四十三万○一百二十四】冬至【大余二十九日小余二千一百二十四】
　　癸巳日【一十七刻太弱】寅正一刻
　　重修大明厯【积算八千八百六十三万九千○五十四】通积分【一百六十九兆三千二百○四亿四千八百二十八万八千○九十六】冬至【大余二十九日小余二十六】癸巳日【半刻弱】子正初刻
　　授时厯【距算七百○三】歳余【二四三二】中积分【二十五亿六千七百六十五万九六九六】通积分【二十五亿六千七百一十○万九○九六】冬至【二十九万○九○四】癸巳日【九刻强】丑正初刻　后一日
　　太建十年戊戌歳十一月五日戊戌景长
　　大衍厯【积算九千六百九十六万一千五百九十五】中积分【一百○七兆六千六百○六亿二千八百二十七万七千○八十五】冬至【大余三十四日小余九百二十五】戊戌日【三十刻半弱】辰初一刻
　　宣明厯【积算七百○六万九千八百九十五】通积分【二十一兆六千九百○八亿二千六百七十○万四千二百二十五】冬至【大余三十四日小余二千六百二十五】
　　戊戌日【三十一刻少】辰初二刻
　　纪元厯【积算二千八百六十一万二千九百三十九】气积分【七十六兆一千八百五十五亿五千五百三十一万七千八百一十四】冬至【大余一十九日小余一千七百○四】戊戌日【二十三刻少强】卯初二刻
　　统天厯【积算三千二百一十五】距差【六百一十五】躔差【七分八】减分【四千七百九十七】气泛积【一百四十○亿九千○八十一万七千八百三十九】气定积【一百四十○亿九千○八十一万三千○四十二】冬至【大余三十四日小余五千○四十二】戊戌日【四十二刻强】巳正初刻
　　重修大明厯【积算八千八百六十三万九千○五十五】通积分【一百六十九兆三千二百○四亿五千○一十九万八千三百二十】冬至【大余三十四日小余一千三百】戊戌日【二十四刻太强】卯初四刻
　　授时厯【距算七百○二】歳余【二四三二】中积分【二十五亿六千四百○○万七二六四】通积分【二十五亿六千三百四十五万六六六四】冬至【三十四万三三三六】戊戌日【三十三刻少强】辰正初刻
　　隋文帝开皇四年甲辰歳十一月十一日己巳景长大衍厯【积算九千六百九十六万一千六百○一】中积分【一百○七兆六千六百○六亿三千四百九十三万九千一百四十三】冬至【大余五日小余二千三百四十三】己巳日【七十七刻强】酉正二刻
　　宣明厯【积算七百○六万九千九百○一】通积分【二十一兆六千九百○八亿四千五百一十一万二千五百四十五】冬至【大余五日小余六千五百四十五】
　　己巳日【七十八刻弱】酉正三刻
　　纪元厯【积算二千八百六十一万二千九百四十五】气积分【七十六兆一千八百五十五亿七千一百二十九万三千五百七十】冬至【大余五十日小余七千○七十】
　　己巳日【九十七刻弱】夜子初一刻
　　统天厯【积算三千二百二十一】距差【六百○九】躔差【七分七】减分【四千六百八十九】气泛积【一百四十一亿一千七百一十一万五千二百九十九】气定积【一百四十一亿一千七百一十一万○六百一十】冬至【大余五日小余一万○六百一十】己巳日【八十八刻半弱】戌初初刻
　　重修大明厯【积算八千八百六十三万九千○六十一】通积分【一百六十九兆三千二百○四亿六千一百六十五万九千六百六十四】冬至【大余五日小余三千七百一十四】己巳日【七十一刻强】酉初初刻
　　授时厯【距算六百九十六】嵗余【二四三一】中积分【二十五亿四千二百六十九万一九七六】通积分【二十五亿四千二百一十四万一三七六】冬至【五万八六二四】己巳日【八十六刻少】戌正二刻
　　开皇五年乙巳嵗十一月二十二日乙亥景长
　　大衍厯【积算九千六百九十六万一千六百○二】中积分【一百○七兆六千六百○六亿三千六百○四万九千四百八十六】冬至【大余一十一日小余四十六】
　　乙亥日【一刻半强】子正一刻
　　宣明厯【积算七百○六万九千九百○二】通积分【二十一兆六千九百○八亿四千八百一十八万○六百一十】冬至【大余一十一日小余二百一十】
　　乙亥日【二刻半】子正二刻
　　纪元厯【积算二千八百六十一万二千九百四十六】气积分【七十六兆一千八百五十五亿七千三百九十五万六千一百九十六】冬至【大余五十五日小余六千八百四十六】甲戌日【九十四刻弱】亥正二刻
　　统天厯【积算三千二百二十二】距差【六百○八】躔差【七分七】减分【四千六百八十二】气泛积【一百四十一亿二千一百四十九万八千二百○九】气定积【一百四十一亿二千一百四十九万三千五百二十七】冬至【大余一十一日小余一千五百二十七】
　　乙亥日【一十二刻太弱】寅初初刻
　　重修大明厯【积算八千八百六十三万九千○六十二】通积分【一百六十九兆三千二百○四亿六千三百五十六万九千八百八十八】冬至【大余一十日小余四千九百八十八】甲戌日【九十五刻少强】戌正三刻
　　授时厯【距算六百九十五】歳余【二四三一】中积分【二十五亿三千九百○三万九五四五】通积分【二十五亿三千八百四十八万八九四五】冬至【一十一万一○五五】乙亥日【十刻半强】丑正二刻
　　开皇六年丙午歳十一月三日庚辰景长
　　大衍厯【积算九千六百九十六万一千六百○三】中积分【一百○七兆六千六百○六亿三千七百一十五万九千八百二十九】冬至【大余一十六日小余七百八十九】庚辰日【二十六刻弱】卯正初刻
　　宣明厯【积算七百○六万九千九百○三】通积分【二十一兆六千九百○八亿五千一百二十四万八千六百六十五】冬至【大余一十六日小余二千二百六十五】
　　庚辰日【二十七刻弱】卯正一刻
　　纪元厯【积算二千八百六十一万二千九百四十七】气积分【七十六兆一千八百五十五亿七千六百六十一万八千八百二十二】冬至【大余一日小余一千三百三十二】庚辰日【一十八刻少强】寅正一刻
　　统天厯【积算三千二百二十三】距差【六百○七】躔差【七分七】减分【四千六百七十四】气泛积【一百四十一亿二千五百八十八万一千一百一十九】气定积【一百四十一亿二千五百八十七万六千四百四十五】冬至【大余一十六日小余四千四百四十五】
　　庚辰日【三十七刻强】辰正三刻
　　重修大明厯【积算八千八百六十三万九千○六十三】通积分【一百六十九兆三千二百○四亿六千五百四十八万○一百一十二】冬至【大余一十六日小余一千○三十二】庚辰日【一十九刻太弱】寅正三刻
　　授时厯【距算六百九十四】歳余【二四三一】中积分【二十五亿三千五百三十八万七一一四】通积分【二十五亿三千四百八十三万六五一四】冬至【一十六万三四八六】庚辰日【三十四刻太强】辰正一刻
　　开皇七年丁未歳十一月十四日乙酉景长
　　大衍厯【积算九千六百九十六万一千六百○四】中积分【一百○七兆六千六百○六亿三千八百二十七万○一百七十二】冬至【大余二十一日小余一千五百三十二】乙酉日【五十刻少强】午正初刻
　　宣明厯【积算七百○六万九千九百○四】通积分【二十一兆六千九百○八亿五千四百三十一万六千七百二十】冬至【大余二十一日小余四千三百二十】
　　乙酉日【五十一刻半弱】午正一刻
　　纪元厯【积算二千八百六十一万二千九百四十八】气积分【七十六兆一千八百五十五亿七千九百二十八万一千四百四十八】冬至【大余六日小余三千一百○八】乙酉日【四十二刻半强】巳正初刻
　　统天厯【积算三千二百二十四】距差【六百○六】躔差【七分七】减分【四千六百六十六】气泛积【一百四十一亿三千○二十六万四千○二十九】气定积【一百四十一亿三千○二十五万九千二百六十三】冬至【大余二十一日小余七千三百六十三】乙酉日【六十一刻少强】未正三刻
　　重修大明厯【积算八千八百六十三万九千○六十四】通积分【一百六十九兆三千二百○四亿六千七百三十九万○三百三十六】冬至【大余二十一日小余二千三百○六】乙酉日【四十四刻强】巳正二刻
　　授时厯【距算六百九十三】嵗余【二四三一】中积分【二十五亿三千一百七十三万四六八三】通积分【二十五亿三千一百一十八万四○八三】冬至【二十一万五九一七】乙酉日【五十九刻强】未正初刻
　　开皇十一年辛亥歳十一月二十八日丙午景长大衍厯【积算九千六百九十六万一千六百○八】中积分【一百○七兆六千六百○六亿四千二百七十一万一千五百四十四】冬至【大余四十二日小余一千四百六十四】丙午日【四十八刻强】午初二刻
　　宣明厯【积算七百○六万九千九百○八】通积分【二十一兆六千九百○八亿六千六百五十八万八千九百四十】冬至【大余四十二日小余四千一百四十】
　　丙午日【四十九刻少强】午初三刻
　　纪元厯【积算二千八百六十一万二千九百五十二】气积分【七十六兆一千八百五十五亿八千九百九十三万一千九百五十二】冬至【大余二十七日小余二千九百二十二】丙午日【四十刻强】巳初二刻
　　统天厯【积算三千二百二十八】距差【六百○二】躔差【七分六】减分【四千五百七十五】气泛积【一百四十一亿四千七百七十九万五千六百六十九】气定积【一百四十一亿四千七百七十九万一千○九十四】冬至【大余四十二日小余七千○九十四】丙午日【五十九刻强】未正初刻
　　重修大明厯【积算八千八百六十三万九千○六十八】通积分【一百六十九兆三千二百○四亿七千五百○三万一千二百三十二】冬至【大余四十二日小余二千一百七十二】
　　丙午日【四十一刻半强】巳初四刻
　　授时厯【距算六百八十九】歳余【二四三一】中积分【二十五亿一千七百一十二万四九五九】通积分【二十五亿一千六百五十七万四三五九】冬至【四十二万五六四一】丙午日【五十六刻半弱】未初二刻
　　开皇十四年甲寅歳十一月辛酉朔旦冬至
　　大衍厯【积算九千六百九十六万一千六百一十一】中积分【一百○七兆六千六百○六亿四千六百○四万二千五百七十三】冬至【大余五十八日小余六百五十三】壬戌日【二十一刻半弱】卯初初刻
　　宣明厯【积算七百○六万九千九百一十一】通积分【二十一兆六千九百○八亿七千五百七十九万三千一百○五】冬至【大余五十八日小余一千九百○五】
　　壬戌日【二十三刻弱】卯初二刻
　　纪元厯【积算二千八百六十一万二千九百五十五】气积分【七十六兆一千八百五十五亿九千七百九十一万九千八百三十】冬至【大余四十三日小余九百六十】
　　壬戌日【一十三刻少弱】寅初初刻
　　统天厯【积算三千二百三十一】距差【五百九十九】躔差【七分六】减分【四千五百五十二】气泛积【一百四十一亿六千○九十四万四千三百九十九】气定积【一百四十一亿六千○九十三万九千八百四十七】冬至【大余五十八日小余三千八百四十七】
　　壬戌日【三十二刻强】辰初二刻
　　重修大明厯【积算八千八百六十三万九千○七十一】通积分【一百六十九兆三千二百○四亿八千○七十六万一千九百○四】冬至【大余五十八日小余七百六十四】壬戌日【一十四刻半强】寅初二刻
　　授时厯【距算六百八十六】嵗余【二四三一】中积分【二十五亿○六百一十六万七六六六】通积分【二十五亿○五百六十一万七○六六】冬至【五十八万二九三四】壬戌日【二十九刻少强】辰初初刻
　　唐太宗贞观十八年甲辰嵗十一月乙酉景长
　　大衍厯【积算九千六百九十六万一千六百六十一】中积分【一百○七兆六千六百○七亿○一百五十五万九千七百二十三】冬至【大余二十日小余一千三百二十三】甲申日【四十三刻半强】巳正一刻
　　宣明厯【积算七百○六万九千九百六十一】通积分【二十一兆六千九百一十○亿二千九百一十九万五千八百五十五】冬至【大余二十日小余三千八百五十五】
　　甲申日【四十五刻太强】午初初刻
　　纪元厯【积算二千八百六十一万三千○○一】气积分【七十六兆一千八百五十七亿三千一百○五万一千一百三十】冬至【大余五日小余二千二百八十】
　　甲申日【三十一刻少强】辰初二刻
　　统天厯【积算三千二百八十一】距差【五百四十九】躔差【七分】减分【三千八百四十三】气泛积【一百四十三亿八千○○八万九千八百九十九】气定积【一百四十三亿八千○○八万六千○五十六】冬至【大余二十日小余六千○五十六】甲申日【五十刻强】午正初刻
　　重修大明厯【积算八千八百六十三万九千一百二十一】通积分【一百六十九兆三千二百○五亿七千六百二十七万三千一百○四】冬至【大余二十日小余一千七百○四】
　　甲申日【三十二刻半强】辰初三刻
　　授时厯【距算六百三十六】歳余【二四三一】中积分【二十三亿二千三百五十四万六一一六】通积分【二十三亿二千二百九十九万五五一六】冬至【二十○万四四八四】甲申日【四十四刻太强】巳正三刻
　　贞观二十三年己酉歳十一月辛亥景长
　　大衍厯【积算九千六百九十六万一千六百六十六】中积分【一百○七兆六千六百○七亿○七百一十一万一千四百三十八】冬至【大余四十六日小余一千九百九十八】庚戌日【六十五刻太弱】申初二刻
　　宣明厯【积算七百○六万九千九百六十六】通积分【二十一兆六千九百一十○亿四千四百五十三万六千一百三十】冬至【大余四十六日小余五千七百三十】
　　庚戌日【六十八刻少弱】申正一刻
　　纪元厯【积算二千八百六十一万三千○一十】气积分【七十六兆一千八百五十七亿四千四百三十六万四千二百六十】冬至【大余三十一日小余三千八百七十】
　　庚戌日【五十三刻强】午正三刻
　　统天厯【积算三千二百八十六】距差【五百四十四】躔差【六分九】减分【三千七百五十四】气泛积【一百四十四亿○二百○○万四千四百四十九】气定积【一百四十四亿○二百○○万○六百九十五】冬至【大余四十六日小余八千六百九十五】庚戌日【七十二刻半弱】酉初一刻
　　重修大明厯【积算八千八百六十三万九千一百二十六】通积分【一百六十九兆三千二百○五亿八千五百八十二万四千二百二十四】冬至【大余四十六日小余二千八百四十四】
　　庚戌日【五十四刻少强】未初初刻
　　授时厯【距算六百三十一】嵗余【二四三一】中积分【二十三亿○五百二十八万三九六一】通积分【二十三亿○四百七十三万三三六一】冬至【四十六万六六三九】庚戌日【六十六刻少强】申初三刻
　　髙宗龙朔二年壬戌嵗十一月四日己未至戊午景长大衍厯【积算九千六百九十六万一千六百七十九】中积分【一百○七兆六千六百○七亿二千一百五十四万五千八百九十七】冬至【大余五十四日小余二千五百三十七】戊午日【八十三刻半弱】戌正初刻
　　宣明厯【积算七百○六万九千九百七十九】通积分【二十一兆六千九百一十○亿八千四百四十二万○八百四十五】戌正二刻
　　纪元厯【积算二千八百六十一万三千○二十三】气积分【七十六兆一千八百五十七亿七千八百九十七万八千三百九十八】冬至【大余三十九日小余五千○八十八】戊午日【六十九刻太强】申正三刻
　　统天厯【积算三千二百九十九】距差【五百三十一】躔差【六分七】减分【三千五百五十八】气泛积【一百四十四亿五千八百九十八万二千二百七十九】气定积【一百四十四亿五千八百九十七万八千七百二十一】冬至【大余五十四日小余一万○七百二十一】
　　戊午日【八十九刻少强】戌正初刻
　　重修大明厯【积算八千八百六十三万九千一百三十九】通积分【一百六十九兆三千二百○六亿一千○六十五万七千一百三十六】冬至【大余五十四日小余三千七百一十六】
　　戊午日【七十一刻强】酉初初刻
　　授时厯【距算六百一十八】歳余【二四三一】中积分【二十二亿五千七百八十○万二三五八】通积分【二十二亿五千七百二十五万一七五八】冬至【五十四万八二四二】戊午日【八十二刻半弱】戌初三刻
　　髙宗仪鳯元年丙子嵗十一月壬申景长
　　大衍厯【积算九千六百九十六万一千六百九十三】中积分【一百○七兆六千六百○七亿三千七百○九万○六百九十九】冬至【大余八日小余七百七十九】
　　壬申日【二十五刻半强】卯正初刻
　　宣明厯【积算七百○六万九千九百九十三】通积分【二十一兆六千九百一十一亿二千七百三十七万三千六百一十五】冬至【大余八日小余二千四百一十五】
　　壬申日【二十八刻太】卯正三刻
　　纪元厯【积算二千八百六十一万三千○三十七】气积分【七十六兆一千八百五十八亿一千六百二十五万五千一百六十二】冬至【大余五十三日小余七百九十二】壬申日【一十刻太强】丑正二刻
　　统天厯【积算三千三百一十三】距差【五百一十七】躔差【六分六】减分【三千四百一十二】气泛积【一百四十五亿二千○三十四万三千○一十九】气定积【一百四十五亿二千○三十三万九千六百○七】冬至【大余八日小余三千六百○七】壬申日【三十刻强】辰初初刻
　　重修大明厯【积算八千八百六十三万九千一百五十三】通积分【一百六十九兆三千二百○六亿三千七百四十○万○二百七十二】冬至【大余八日小余六百三十二】壬申日【一十二刻强】丑初三刻
　　授时厯【距算六百○四】歳余【二四三一】中积分【二十二亿○六百○十六万八三二四】通积分【二十二亿○五百五十一万七七二四】冬至【八万二二七六】壬申日【二十二刻太强】卯初一刻
　　髙宗永淳元年壬午歳十一月癸卯景长
　　大衍厯【积算九千六百九十六万一千六百九十九】中积分【一百○七兆六千六百○七亿四千三百七十五万二千七百五十七】冬至【大余三十九日小余二千一百九十七】癸卯日【七十二刻少强】酉初一刻
　　宣明厯【积算七百○六万九千九百九十九】通积分【二十一兆六千九百一十一亿四千五百七十八万一千九百四十五】冬至【大余三十九日小余六千三百四十五】癸卯日【七十五刻半强】酉正初刻
　　纪元厯【积算二千八百六十一万三千○四十三】气积分【七十六兆一千八百五十八亿三千二百二十三万○九百一十八】冬至【大余二十四日小余四千一百五十八】癸卯日【五十七刻强】未初二刻
　　统天厯【积算三千三百一十九】距差【五百一十一】躔差【六分五】减分【三千三百二十一】气泛积【一百四十五亿四千六百六十四万○四百七十九】气定积【一百四十五亿四千六百六十三万七千一百五十八】冬至【大余三十九日小余九千一百五十八】
　　癸卯日【七十六刻少强】酉正一刻
　　重修大明厯【积算八千八百六十三万九千一百九十九】通积分【一百六十九兆三千二百○六亿四千八百八十六万一千六百一十六】冬至【大余三十九日小余三千○四十六】
　　癸卯日【五十八刻少弱】未初四刻
　　授时厯【距算五百九十八】嵗余【二四三○】中积分【二十一亿八千四百一十五万三一四○】通积分【二十一亿八千三百六十○万二五四○】冬至【三十九万七四六○】癸卯日【七十四刻半强】酉初三刻
　　明皇开元十年壬戌歳十一月癸酉景长
　　大衍厯【积算九千六百九十六万一千七百三十九】中积分【一百○七兆六千六百○七亿八千八百一十六万六千四百七十七】冬至【大余九日小余一千五百一十七】癸酉日【五十刻弱】午初四刻
　　宣明厯【积算七百○七万○○三十九】通积分【二十一兆六千九百一十二亿六千八百五十○万四千一百四十五】冬至【大余九日小余四千五百四十五】
　　癸酉日【五十四刻强】午正四刻
　　纪元厯【积算二千八百六十一万三千○八十三】气积分【七十六兆一千八百五十九亿三千八百七十三万五千九百五十八】冬至【大余五十四日小余二千二百九十八】癸酉日【三十一刻半强】辰初二刻
　　统天厯【积算三千三百五十九】距差【四百七十一】躔差【六分】减分【二千八百二十六】气泛积【一百四十七亿二千一百九十五万六千八百七十九】气定积【一百四十七亿二千一百九十五万四千○五十三】冬至【大余九日小余六千○五十三】癸酉日【五十刻强】午正初刻
　　重修大明厯【积算八千八百六十三万九千一百九十九】通积分【一百六十九兆三千二百○七亿二千五百二十七万○五百七十六】冬至【大余九日小余一千七百○六】癸酉日【三十二刻半强】辰初三刻
　　授时厯【距算五百五十八】歳余【二四三○】中积分【二十○亿三千八百○五万五九四○】通积分【二十○亿三千七百五十○万五三四○】冬至【九万四六六○】癸酉日【四十六刻半强】午初初刻
　　开元十一年癸亥嵗十一月戊寅景长
　　大衍厯【积算九千六百九十六万一千七百四十】中积分【一百○七兆六千六百○七亿八千九百二十七万六千八百二十】冬至【大余一十四日小余二千二百六十】
　　戊寅日【七十四刻少强】酉初三刻
　　宣明厯【积算七百○七万○○四十】通积分【二十一兆六千九百一十二亿七千一百五十七万二千二百】冬至【大余一十四日小余六千六百】
　　戊寅日【七十八刻半强】酉正三刻
　　纪元厯【积算二千八百六十一万三千○八十四】气积分【七十六兆一千八百五十九亿四千一百三十九万八千五百八十四】冬至【大余五十九日小余四千一百七十四】戊寅日【五十七刻少强】未初三刻
　　统天厯【积算三千三百六十】距差【四百七十】躔差【六分】减分【二千八百二十○】气泛积【一百四十七亿二千六百三十三万九千七百八十九】气定积【一百四十七亿二千六百三十三万六千九百六十九】冬至【大余一十四日小余八千九百六十九】戊寅日【七十四刻太弱】酉初三刻
　　重修大明厯【积算八千八百六十三万九千二百】通积分【一百六十九兆三千二百○七亿二千七百一十八万○八百】冬至【大余一十四日小余二千九百八十】戊寅日【五十七刻弱】未初二刻
　　授时厯【距算五百五十七】嵗余【二四三○】中积分【二十○亿三千四百四十○万三五一○】通积分【二十○亿三千三百八十五万二九一○】冬至【一十四万七○九○】戊寅日【七十刻太强】酉初初刻
　　开元十二年甲子歳十一月癸未冬至
　　大衍厯【积算九千六百九十六万一千七百四十一】中积分【一百○七兆六千六百○七亿九千○三十八万七千一百六十三】冬至【大余一十九日小余三千○○三】癸未日【九十八刻太强】夜子初二刻
　　宣明厯【积算七百○七万○○四十一】通积分【二十一兆六千九百一十二亿七千四百六十四万○二百五十五】冬至【大余二十日小余二百五十五】
　　甲申日【三刻强】子正三刻
　　纪元厯【积算二千八百六十一万三千○八十五】气积分【七十六兆一千八百五十九亿四千四百○六万一千二百一十】冬至【大余四日小余五千八百五十】
　　癸未日【八十刻少弱】戌初一刻
　　统天厯【积算三千三百六十一】距差【四百六十九】躔差【六分】减分【二千八百一十四】气泛积【一百四十七亿三千○七十二万二千六百九十九】气定积【一百四十七亿三千○七十一万九千八百八十五】冬至【大余一十九日小余一万一千八百八十五】
　　癸未日【九十九刻强】夜子初三刻
　　重修大明厯【积算八千八百六十三万九千二百○一】通积分【一百六十九兆三千二百○七亿二千九百○九万一千○二十四】冬至【大余一十九日小余四千二百五十四】癸未日【八十一刻少强】戌初二刻
　　授时厯【距算五百五十六】歳余【二四三○】中积分【二十○亿三千○七十五万一○八○】通积分【二十○亿三千○二十○万○四八○】冬至【一十九万九五二○】癸未日【九十五刻少弱】亥正三刻
　　宋真宗景徳四年丁未歳十一月戊辰日南至
　　大衍厯【积算九千六百九十六万二千○二十四】中积分【一百○七兆六千六百一十一亿○四百六十一万四千三百三十二】冬至【大余四日小余四百七十二】
　　戊辰日【一十五刻半强】寅初三刻
　　宣明厯【积算七百○七万○三百二十四】通积分【二十一兆六千九百二十一亿四千二百八十九万九千八百二十】冬至【大余四日小余二千二百二十】
　　戊辰日【二十六刻半弱】卯正一刻
　　纪元厯【积算二千八百六十一万三千三百六十八】气积分【七十六兆一千八百六十六亿九千七百五十八万四千三百六十八】冬至【大余四十八日小余五千四百四十八】丁卯日【七十四刻太弱】酉初三刻
　　统天厯【积算三千六百四十四】距差【一百八十六】躔差【二分三】减分【四百二十八】气泛积【一百五十九亿七千一百○八万六千二百二十九】气定积【一百五十九亿七千一百○八万五千八百○一】冬至【大余三日小余九千八百○一】丁卯日【八十一刻太弱】戌初一刻
　　重修大明厯【积算八千八百六十三万九千四百八十四】通积分【一百六十九兆三千二百一十二亿六千九百六十八万四千四百一十六】冬至【大余三日小余三千九百二十六】
　　丁卯日【七十五刻】酉正初刻
　　授时厯【距算二百七十三】歳余【二四二七】中积分【九亿九千七百一十一万二五七一】通积分【九亿九千六百五十六万一九七一】冬至【三万八○二九】
　　丁卯日【八十刻少强】戌初一刻
　　仁宗皇祐二年庚寅歳十一月三十日癸丑景长大衍厯【积算九千六百九十六万二千○六十七】中积分【一百○七兆六千六百一十一亿五千二百三十五万八千九百八十一】冬至【大余四十九日小余二千○二十一】癸丑日【六十六刻半弱】申初二刻
　　宣明厯【积算七百○七万○三百六十七】通积分【二十一兆六千九百二十二亿七千四百八十二万六千一百八十五】冬至【大余四十九日小余六千五百八十五】癸丑日【七十八刻半弱】酉正三刻
　　纪元厯【积算二千八百六十一万三千四百一十一】气积分【七十六兆一千八百六十八亿一千二百○七万七千二百八十六】冬至【大余三十四日小余一千六百二十六】癸丑日【二十二刻少强】卯初一刻
　　统天厯【积算三千六百八十七】距差【一百四十三】躔差【一分八】减分【二百五十七】气泛积【一百六十一亿五千九百五十五万一千三百五十九】气定积【一百六十一亿五千九百五十五万一千一百○二】冬至【大余四十九日小余三千一百○二】癸丑日【二十五刻太强】卯初初刻
　　重修大明厯【积算八千八百六十三万九千五百二十七】通积分【一百六十九兆三千二百一十三亿五千一百八十二万四千○四十八】冬至【大余四十九日小余一千一百七十八】
　　癸丑日【二十二刻半强】卯初一刻
　　授时厯【距算二百三十】歳余【二四二七】中积分【八亿四千○○五万八二一○】通积分【八亿三千九百五十○万七六一○】冬至【四十九万二三九○】
　　癸丑日【二十三刻太强】卯初三刻
　　神宗元丰六年癸亥歳十一月丙午景长
　　大衍厯【积算九千六百九十六万二千一百】中积分【一百○七兆六千六百一十一亿八千九百○○万○三百】冬至【大余四十二日小余二千二百二十】
　　丙午日【七十三刻强】酉初二刻
　　宣明厯【积算七百○七万○四百】通积分【二十一兆六千九百二十三亿七千六百○七万二千】冬至【大余四十二日小余七千二百】
　　丙午日【八十五刻太弱】戌正二刻
　　纪元厯【积算二千八百六十一万三千四百四十四】气积分【七十六兆一千八百六十八亿九千九百九十四万三千九百四十四】冬至【大余二十七日小余一千九百一十四】丙午日【二十六刻少强】卯正一刻
　　统天厯【积算三千七百二十】距差【一百一十】躔差【一分四】减分【一百五十四】气泛积【一百六十三亿○四百一十八万七千三百八十九】气定积【一百六十三亿○四百一十八万七千三百三十五】冬至【大余四十二日小余三千二百三十五】丙午日【二十七刻弱】卯正一刻
　　重修大明厯【积算八千八百六十三万九千五百六十】通积分【一百六十九兆三千二百一十四亿一千四百八十六万一千四百四十】冬至【大余四十二日小余一千三百八十】丙午日【二十六刻少强】卯正一刻
　　授时厯【距算一百九十七】歳余【二四二六】中积分【七亿一千九百五十二万七九二二】通积分【七亿一千八百九十七万七三二二】冬至【四十二万二六七八】丙午日【二十六刻太强】卯正一刻
　　元丰七年甲子歳十一月辛亥景长
　　大衍厯【积算九千六百九十六万二千一百○一】中积分【一百○七兆六千六百一十一亿九千○一十一万○六百四十三】冬至【大余四十七日小余二千九百六十三】辛亥日【九十七刻半弱】夜子初一刻
　　宣明厯【积算七百○七万○四百○一】通积分【二十一兆六千九百二十三亿七千九百一十四万○○五十五】冬至【大余四十八日小余八百五十五】
　　壬子日【一十刻强】丑正一刻
　　纪元厯【积算二千八百六十一万三千四百四十五】气积分【七十六兆一千八百六十九亿○二百六十○万六千五百七十】冬至【大余三十二日小余三千六百九十】辛亥日【五十刻半强】午正初刻
　　统天厯【积算三千七百二十一】距差【一百○九】躔差【一分四】减分【一百五十三】气泛积【一百六十三亿○八百五十七万○二百九十九】气定积【一百六十三亿○八百五十七万○一百四十六】冬至【大余四十七日小余六千一百四十六】辛亥日【五十一刻少弱】午正一刻
　　重修大明厯【积算八千八百六十三万九千五百六十一】通积分【一百六十九兆三千二百一十四亿一千六百七十七万一千六百六十四】冬至【大余四十七日小余二千六百五十四】
　　辛亥日【五十刻太弱】午正初刻
　　授时厯【距算一百九十六】歳余【二四二六】中积分【七亿一千五百八十七万五四九六】通积分【七亿一千五百三十二万四八九六】冬至【四十七万五一○四】辛亥日【五十一刻强】午正一刻
　　哲宗元祐三年戊辰歳十一月壬申景长
　　大衍厯【积算九千六百九十六万二千一百○五】中积分【一百○七兆六千六百一十一亿九千四百五十五万二千○一十五】冬至【大余八日小余二千八百九十五】壬申日【九十五刻少弱】亥正三刻
　　宣明厯【积算七百○七万○四百○五】通积分【二十一兆六千九百二十三亿九千一百四十一万二千二百七十五】冬至【大余九日小余六百七十五】
　　癸酉日【八刻强】丑初二刻
　　纪元厯【积算二千八百六十一万三千四百四十九】气积分【七十六兆一千八百六十九亿一千三百二十五万七千○七十四】冬至【大余五十三日小余三千五百○四】壬申日【四十八刻强】午初二刻
　　统天厯【积算三千七百二十五】距差【一百○五】躔差【一分三】减分【一百三十七】气泛积【一百六十三亿二千六百一十○万一千九百三十九】气定积【一百六十三亿二千六百一十○万一千八百○二】冬至【大余八日小余五千八百○二】壬申日【四十八刻少强】午初二刻
　　重修大明厯【积算八千八百六十三万九千五百六十五】通积分【一百六十九兆三千二百一十四亿二千四百四十一万二千五百六十】冬至【大余八日小余二千五百二十】壬申日【四十八刻少弱】午初二刻
　　授时厯【距算一百九十二】歳余【二四二六】中积分【七亿○千一百二十六万五七九二】通积分【七亿○千○百七十一万五一九二】冬至【八万四八○八】
　　壬申日【四十八刻强】午初二刻
　　元祐四年己巳歳十一月丁丑景长
　　大衍厯【积算九千六百九十六万二千一百○六】中积分【一百○七兆六千六百一十一亿九千五百六十六万二千三百五十八】冬至【大余一十四日小余五百九十八】戊寅日【一十九刻半强】寅正二刻
　　宣明厯【积算七百○七万○四百○六】通积分【二十一兆六千九百二十三亿九千四百四十八万○三百三十】冬至【大余一十四日小余二千七百三十】
　　戊寅日【三十二刻半】辰初三刻
　　纪元厯【积算二千八百六十一万三千四百五十】气积分【七十六兆一千八百六十九亿一千五百九十一万九千七百】冬至【大余五十八日小余五千二百八十】
　　丁丑日【七十二刻半强】酉初一刻
　　统天厯【积算三千七百二十六】距差【一百○四】躔差【一分三】减分【一百三十五】气泛积【一百六十三亿三千○四十八万四千八百四十九】气定积【一百六十三亿三千○四十八万四千七百一十四】冬至【大余一十三日小余八千七百一十四】丁丑日【七十二刻半强】酉初一刻
　　重修大明厯【积算八千八百六十三万九千五百六十六】通积分【一百六十九兆三千二百一十四亿二千六百三十二万二千七百八十四】冬至【大余一十三日小余三千七百九十四】
　　丁丑日【七十二刻半强】酉初一刻
　　授时厯【积算一百九十一】歳余【二四二六】中积分【六亿九千七百六十一万三三六六】通积分【六亿九千七百○十六万二七六六】冬至【一十三万七二三四】丁丑日【七十二刻少强】酉初一刻
　　元祐五年庚午歳十一月壬午冬至
　　大衍厯【积算九千六百九十六万二千一百○七】中积分【一百○七兆六千六百一十一亿九千六百七十七万二千七百○一】冬至【大余一十九日小余一千三百四十一】癸未日【四十四刻强】巳正二刻
　　宣明厯【积算七百○七万○四百○七】通积分【二十一兆六千九百二十三亿九千七百五十四万八千三百八十五】冬至【大余一十九日小余四千七百八十五】
　　癸未日【五十七刻弱】未初二刻
　　纪元厯【积算二千八百六十一万三千四百五十一】气积分【七十六兆一千八百六十九亿一千八百五十八万二千三百二十六】冬至【大余三日小余七千○五十六】壬午日【九十六刻太强】夜子初初刻
　　统天厯【积算三千七百二十七】距差【一百○三】躔差【一分三】减分【一百三十四】气泛积【一百六十三亿三千四百八十六万七千七百五十九】气定积【一百六十三亿三千四百八十六万七千六百二十五】冬至【大余一十八日小余一万一千六百二十五】
　　壬午日【九十六刻太强】夜子初一刻
　　重修大明厯【积算八千八百六十三万九千五百六十七】通积分【一百六十九兆三千二百一十四亿二千八百二十三万三千○○八】冬至【大余一十八日小余五千○六十八】
　　壬午日【九十七刻弱】夜子初一刻
　　授时厯【距算一百九十】嵗余【二四二六】中积分【六亿九千三百九十六万○九四○】通积分【六亿九千三百四十一万○三四○】冬至【一十八万九六六○】
　　壬午日【九十六刻半强】夜子初初刻
　　元祐七年壬申歳十一月癸巳冬至
　　大衍厯【积算九千六百九十六万二千一百○九】中积分【一百○七兆六千六百一十一亿九千八百九十九万三千三百八十七】冬至【大余二十九日小余二千八百二十七】癸巳日【九十三刻弱】亥正一刻
　　宣明厯【积算七百○七万○四百○九】通积分【二十一兆六千九百二十四亿○三百六十八万四千四百九十五】冬至【大余三十日小余四百九十五】
　　甲午日【六刻弱】丑初一刻
　　纪元厯【积算二千八百六十一万三千四百五十三】气积分【七十六兆一千八百六十九亿二千三百九十万七千五百七十八】冬至【大余一十四日小余三千三百一十八】癸巳日【四十五刻半强】巳正三刻
　　统天厯【积算三千七百二十九】距差【一百○一】躔差【一分三】减分【一百三十一】气泛积【一百六十三亿四千三百六十三万三千五百七十九】气定积【一百六十三亿四千三百六十三万三千四百四十八】冬至【大余二十九日小余五千四百四十八】
　　癸巳日【四十五刻半弱】巳正三刻
　　重修大明厯【积算八千八百六十三万九千五百六十九】通积分【一百六十九兆三千二百一十四亿三千二百○五万三千四百五十六】冬至【大余二十九日小余二千三百八十六】
　　癸巳日【四十五刻半强】巳正三刻
　　授时厯【距算一百八十八】嵗余【二四二六】中积分【六亿八千六百六十五万六○八八】通积分【六亿八千六百一十○万五四八八】冬至【二十九万四五一二】癸巳日【四十五刻强】巳正三刻
　　哲宗元符元年戊寅歳十一月甲子冬至
　　大衍厯【积算九千六百九十六万二千一百一十五】中积分【一百○七兆六千六百一十二亿○五百六十五万五千四百四十五】冬至【大余一日小余一千二百○五】乙丑日【三十九刻半强】巳初二刻
　　宣明厯【积算七百○七万○四百一十五】通积分【二十一兆六千九百二十四亿二千二百○九万三千八百二十五】冬至【大余一日小余四千四百二十五】
　　乙丑日【五十二刻太弱】午正二刻
　　纪元厯【积算二千八百六十十万三千四百五十九】气积分【七十六兆一千八百六十九亿三千九百八十八万三千三百三十四】冬至【大余四十五日小余六千六百八十四】甲子日【九十一刻太弱】亥正初刻
　　统天厯【积算三千七百三十五】距差【九十五】躔差【一分二】减分【一百一十四】气泛积【一百六十三亿六千九百九十三万一千○三十九】气定积【一百六十三亿六千九百九十三万○九百二十五】冬至【大余○日小余一万○九百二十五】甲子日【九十一刻强】亥初三刻
　　重修大明厯【积算八千八百六十三万九千五百七十五】通积分【一百六十九兆三千二百一十四亿四千三百五十一万四千八百】冬至【大余日空小余四千八百】甲子日【九十一刻太强】亥正初刻
　　授时厯【距算一百八十二】歳余【二四二六】中积分【六亿六千四百七十四万一五三二】通积分【六亿六千四百一十九万○九三二】冬至【○万九○六八】
　　甲子日【九十刻强】亥初三刻
　　徽宗崇宁三年甲申歳十一月丙申冬至
　　大衍厯【积算九千六百九十六万二千一百二十一】中积分【一百○七兆六千六百一十二亿一千二百三十一万七千五百○三】冬至【大余三十二日小余二千六百二十三】丙申日【八十六刻少强】戌正二刻
　　宣明厯【积算七百○七万○四百二十一】通积分【二十一兆六千九百二十四亿四千○五十○万一千一百五十五】冬至【大余三十二日小余八千三百五十五】
　　丙申日【九十九刻半弱】夜子初三刻
　　纪元厯【积算二千八百六十一万三千四百六十五】气积分【七十六兆一千八百六十九亿五千五百八十五万九千○九十】冬至【大余一十七日小余二千七百六十】丙申日【三十七刻太强】巳初初刻
　　统天厯【积算三千七百四十一】距差【八十九】躔差【一分一】减分【九十八】气泛积【一百六十三亿九千六百二十二万八千四百九十九】气定积【一百六十三亿九千六百二十二万八千四百○一】冬至【大余三十二日小余四千四百　一】丙申日【三十六刻半强】辰正三刻
　　重修大明厯【积算八千八百六十三万九千五百八十一】通积分【一百六十九兆三千二百一十四亿五千四百九十七万六千一百三十四】冬至【大余三十二日小余一千九百七十四】
　　丙申日【三十七刻太弱】巳初初刻
　　授时厯【距算一百七十六】嵗余【二四二六】中积分【六亿四千二百八十二万六九七六】通积分【六亿四千二百二十七万六三七六】冬至【三十二万三六二四】丙申日【三十六刻少弱】辰正二刻
　　光宗绍熈二年辛亥歳十一月壬申冬至
　　大衍厯【积算九千六百九十六万二千二百○八】中积分【一百○七兆六千六百一十三亿○八百九十一万七千三百四十四】冬至【大余九日小余三百八十四】
　　癸酉日【一十二刻半强】寅初初刻
　　宣明厯【积算七百○七万○五百○八】通积分【二十一兆六千九百二十七亿○七百四十二万一千九百四十】冬至【大余九日小余二千三百四十】
　　癸酉日【二十七刻太强】卯正二刻
　　纪元厯【积算二千八百六十一万三千五百五十二】气积分【七十六兆一千八百七十一亿八千七百五十○万七千五百五十二】冬至【大余五十三日小余四千一百八十二】壬申日【五十七刻少强】未初三刻
　　统天厯【积算三千八百二十八】距差【二】躔差减分【并无】气泛积【一百六十七亿七千七百五十四万一千六百六十九】气定积【因无减分以泛为定】冬至【大余八日小余五千六百六十九】
　　壬申日【四十七刻少弱】午初一刻
　　重修大明厯【积算八千八百六十三万九千六百六十八】通积分【一百六十九兆三千二百一十六亿二千一百一十六万五千六百三十二】冬至【大余八日小余二千九百九十二】
　　壬申日【五十七刻少弱】未初三刻
　　授时厯【距算八十九】歳余【二四二五】中积分【三亿二千五百○六万五八二五】通积分【三亿二千四百五十一万五二二五】冬至【八万四七七五】
　　壬申日【四十七刻太】午初一刻
　　宁宗庆元三年丁巳嵗十一月癸卯日南至
　　大衍厯【积算九千六百九十六万二千二百一十四】中积分【一百○七兆六千六百一十三亿一千五百五十七万九千四百○二】冬至【大余四十日小余一千八百○二】甲辰日【五十九刻少强】未正初刻
　　宣明厯【积算七百○七万○五百一十四】通积分【二十一兆六千九百二十七亿二千五百八十三万○二百七十】冬至【大余四十日小余六千二百七十】
　　甲辰日【七十四刻太弱】酉初三刻
　　纪元厯【积算二千八百六十一万三千五百五十八】气积分【七十六兆一千八百七十二亿○三百四十八万三千三百○八】冬至【大余二十五日小余二百五十八】甲辰日【三刻半强】子正三刻
　　统天厯【积算三千八百三十四】距差【四】躔差【○分一】减分【无】气泛积【一百六十八亿○三百八十三万九千一百二十九】气定积【距差乘躔差不满秒半以泛为定】冬至【大余三十九日小余一万一千一百二十九】
　　癸卯日【九十二刻太弱】亥正一刻
　　重修大明厯【积算八千八百六十三万九千六百七十四】通积分【一百六十九兆三千二百一十六亿三千二百六十二万六千九百七十六】冬至【大余四十日小余一百七十六】
　　甲辰日【三刻少强】子正三刻
　　授时厯【距算八十三】歳余【二四二五】中积分【三亿○千三百一十五万一二七五】通积分【三亿○千二百六十○万○六七五】冬至【三十九万九三二五】
　　癸卯日【九十三刻少】亥正一刻
　　宁宗嘉泰三年癸亥嵗十一月甲戌日南至
　　大衍厯【积算九千六百九十六万二千二百二十】中积分【一百○士兆六千六百一十三亿二千二百二十四万一千四百六十】冬至【大余一十二日小余一百八十】
　　丙子日【六刻弱】丑正一刻
　　宣明厯【积算七百○七万○五百二十】通积分【二十一兆六千九百二十七亿四千四百二十三万八千六百】冬至【大余一十二日小余一千八百】
　　丙子日【二十一刻半弱】卯初初刻
　　纪元厯【积算二千八百六十一万三千五百六十四】气积分【七十六兆一千八百七十二亿一千九百四十五万九千○六十四】冬至【大余五十六日小余三千六百二十四】乙亥日【四十九刻太弱】午初三刻
　　统天厯【积算三千八百四十】距差【一十】躔差【○分一】减分【一】气泛积【一百六十八亿三千○一十三万六千五百八十九】气定积【一百六十八亿三千○一十三万六千五百八十八】冬至【大余一十一日小余四千五百八十八】
　　乙亥日【三十八刻少弱】巳初初刻
　　重修大明厯【积算八千八百六十三万九千六百八十】通积分【一百六十九兆三千二百一十六亿四千四百○八万八千三百二十】冬至【大余一十一日小余二千五百九十】乙亥日【四十九刻半强】午初三刻
　　授时厯【距算七十七】歳余【二四二五】中积分【二亿八千一百二十三万六七二五】通积分【二亿八千○百六十八万六一二五】冬至【一十一万三八七五】
　　乙亥日【三十八刻太】巳初一刻
　　宁宗嘉定五年壬申歳十一月壬戌日南至
　　大衍厯【积算九千六百九十六万二千二百二十九】中积分【一百○七兆六千六百一十三亿二千二百二十三万四千五百四十七】冬至【大余五十九日小余七百八十七】癸亥日【二十五刻太强】卯正初刻
　　宣明厯【积算七百○七万○五百二十九】通积分【二十一兆六千九百二十七亿七千一百八十五万一千○九十五】冬至【大余五十九日小余三千四百九十五】
　　癸亥日【四十一刻半强】巳初四刻
　　纪元厯【积算二千八百六十一万三千五百七十三】气积分【七十六兆一千八百七十二亿四千三百四十二万二千六百九十八】冬至【大余四十三日小余五千○二十八】壬戌日【六十九刻弱】申正二刻
　　统天厯【积算三千九百四十九】距差【一十九】躔差【○分二】减分【四】气泛积【一百六十八亿六千九百五十八万二千七百七十九】气定积【一百六十八亿六千九百五十八万二千七百七十五】冬至【大余五十八日小余六千七百七十五】壬戌日【五十六刻半弱】未初二刻
　　重修大明厯【积算八千八百六十三万九千六百八十九】通积分【一百六十九兆三千二百一十六亿六千一百二十八万○三百三十六】冬至【大余五十八日小余三千五百九十六】
　　壬戌日【六十八刻太强】申正初刻
　　授时厯【距算六十八】歳余【二四二五】中积分【二亿四千八百三十六万四九○○】通积分【二亿四千七百八十一万四三○○】冬至【五十八万五七○○】
　　壬戌日【五十七刻】未初二刻
　　理宗绍定三年庚寅歳十一月丙申日南至
　　大衍厯【积算九千六百九十六万二千二百四十七】中积分【一百○七兆六千六百一十三亿五千二百二十二万○七百二十一】冬至【大余三十三日小余二千○○一】丁酉日【六十五刻少弱】申初二刻
　　宣明厯【积算七百○七万○五百四十七】通积分【二十一兆六千九百二十八亿二千七百○七万六千○八十五】冬至【大余三十三日小余六千八百八十五】
　　丁酉日【八十二刻弱】戌初二刻
　　纪元厯【积算二千八百六十一万三千五百九十一】气积分【七十六兆一千八百七十二亿九千一百三十四万九千九百六十六】冬至【大余一十八日小余五百四十六】丁酉日【七刻半弱】丑初三刻
　　统天厯【积算三千八百六十七】距差【三十七】躔差【○分五】减分【一十九】气泛积【一百六十九亿四千八百四十七万五千一百五十九】气定积【一百六十九亿四千八百四十七万五千一百四十○】冬至【大余三十二日小余一万一千一百四十○】
　　丙申日【九十二刻太强】亥正一刻
　　重修大明厯【积算八千八百六十三万九千七百○七】通积分【一百六十九兆三千二百一十六亿九千五百六十六万四千三百六十八】冬至【大余三十三日小余三百七十八】丁酉日【七刻少弱】丑初三刻
　　授时厯【距算五十】歳余【二四二五】中积分【一亿八千二百六十二万一二五○】通积分【一亿八千二百○十七万○六五○】冬至【三十二万九三五○】
　　丙申日【九十三刻半】亥正一刻
　　理宗淳祐十年庚戌嵗十一月辛巳日南至
　　大衍厯【积算九千六百九十六万二千二百六十七】中积分【一百○七兆六千六百一十三亿七千四百四十二万七千五百八十一】冬至【大余一十八日小余一千六百六十一】壬午日【五十四刻半强】未初初刻
　　宣明厯【积算七百○七万○五百六十七】通积分【二十一兆六千九百二十八亿八千八百四十三万七千一百八十五】冬至【大余一十八日小余五千九百八十五】壬午日【七十一刻少】酉初初刻
　　纪元厯【积算二千八百六十一万三千六百一十一】气积分【七十六兆一千八百七十三亿四千四百六十○万二千四百八十六】冬至【大余二日小余六千九百○六】辛巳日【九十四刻太弱】亥正三刻
　　统天厯【积算三千八百八十七】距差【五十七】躔差【○分七】减分【四十】气泛积【一百七十○亿三千六百一十三万三千三百五九】气定积【一百七十○亿三千六百一十三万三千三百一九】冬至【大余一十七日小余九千三百一十九】
　　辛巳日【七十七刻太弱】酉正二刻
　　重修大明厯【积算八千八百六十三万九千七百二十七】通积分【一百六十九兆三千二百一十七亿三千三百八十六万八千七百九十八】冬至【大余一十七日小余四千八百八十八】
　　辛巳日【九十三刻半强】亥正一刻
　　授时厯【距算三十】嵗余【二四二五】中积分【一亿　千九百五十七万二七五】通积分【一亿　千九百十二万二一五】　冬至【一十七万七八五】
　　辛巳日【七十八刻半】酉正三刻
　　元世祖至元十七年庚辰歳十一月己未夜半后六刻冬至
　　大衍厯【积算九千六百九十六万二千二百九十七】中积分【一百○七兆六千六百一十四亿○七百七十三万七千八百七十一】冬至【大余五十五日小余二千六百七十一】己未日【八十七刻太强】亥初初刻
　　宣明厯【积算七百○七万○五百九十七】通积分【二十一兆六千九百二十九亿八千○四十七万八千八百三十五】冬至【大余五十六日小余四百三十五】
　　庚申日【五刻强】丑初一刻
　　纪元厯【积算二千八百六十一万三千六百四十一】气积分【七十六兆一千八百七十四亿二千四百四十八万一千二百六十六】冬至【大余四十日小余一千八百六十六】己未日【二十五刻半强】卯初初刻
　　统天厯【积算三千九百一十七】距差【八十七】躔差【一分一】减分【九十六】气泛积【一百七十一亿六千七百六十二万○六百五十九】气定积【一百七十一亿六千七百六十二万○五百六十三】冬至【大余五十五日小余○万○五百六十三】己未日【四刻半强】丑初初刻
　　重修大明厯【积算八千八百六十三万九千七百五十七】通积分【一百六十九兆三千二百一十七亿九千一百一十七万五千五百六十八】冬至【大余五十五日小余一千三百一十八】
　　己未日【二十五刻强】卯正初刻
　　授时厯【据当时日晷推定无距算无中积分上考下求用为元数】
　　【实测得冬至气应五十五日○六百分】
　　己未日【六刻】丑初一刻
　　右日名五厯合宣明后一日刻惟授时合统天先一刻余皆后天大衍至八十余刻
　　以上自鲁僖公以来冬至日名共四十七并至元辛巳有刻为四十八事授时法合者三十八不合者昭公己卯刘宋元嘉丙子大明辛丑陈太建壬辰丁酉隋开皇甲寅唐贞观甲辰己酉宋景徳丁未嘉泰癸亥共十统天厯同
　　据厯议统天不合者惟献公戊寅与授时不同今以宋史所载厯术躔差用秒法求之无不同也算式如后
　　鲁献公十五年戊寅歳正月甲寅朔旦冬至
　　统天厯【积算一千七百五十四】距差【二千○七十六】躔差【二十六分四】减分【五万四千八百○六】气泛积【七十六亿八千七百三十八万六千三百二十九】气定积【七十六亿八千七百三十三万一千五百二十三】冬至【大余五十日小余一万一千五百二十三】
　　甲寅日【九十六刻强】夜子初初刻
　　躔差三位得之
　　大余【五十一日】小余【三百五十三】乙卯日【二刻太强】子正二刻躔差二位得此
　　若躔差只用二位正得乙卯与授时厯议合然非其本法也何以知之按统天厯术歩气朔章曰躔差小分半以上从秒一距差乘躔差秒半以上从分一如躔差只用分安得有秒距差乘后又安得有分以下之数乎故三位为是
　　鲁献公距算考【附】
　　史记武王九年东伐至盟津周公辅行十一年伐纣至牧野周公佐武王作牧誓克殷二年周公作金縢其后武王崩成王少在襁褓之中成王七年作洛七年后还政成王北面就臣位
　　周公卒子伯禽固前已受封是为鲁公【皇甫谧云伯禽以成王元年封四十六年康王十六年卒】伯禽卒子考公酋立四年卒弟炀公熈立六年卒子幽公宰立十四年弟防弑之自立为魏公五十年卒子厉公擢立三十七年卒鲁人立其弟具是为献公献公三十二年卒子真公濞立真公十四年周厉王奔彘二十九年周宣行政三十年真公卒弟武公敖立武公九年朝周归而卒少子戏立是为懿公懿公九年兄括之子伯御杀懿公自立十一年周宣王伐鲁杀伯御立懿公弟称为孝公孝公二十五年犬戎弑幽王二十七年孝公卒子惠公弗皇立四十六年卒隐公摄当国【又史记三代世表鲁献公在夷王燮时十二诸侯年表起鲁真公濞十五年庚申一云十四年】按自元至元十八年辛巳上距周武王己卯通二千四百单三年据厯议春秋献公以来二千一百六十余年而首列献公十五年为戊寅是在武王后二百四十年也今世家自伯禽至献公卒通一百八十九年而已厯议不知何据存之再考














　　厯算全书卷十四
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>
<子部,天文算法类,推步之属,历算全书,卷十五>















　　厯算全书卷十五
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书卷十六
　　宣城梅文鼎撰
　　五星纪要
　　论五星嵗轮
　　五星与日皆东岀而西没宗动天之所运也土木火三星在太阳上而近宗动故其左旋速于日毎日有所差之分即嵗轮心之平行也
　　五星与太阳有定距嵗轮心旣为宗动所掣渐离太阳而西则星不得不自嵗轮之中线【即平行度】渐移而东以就日而星旣在日之上亦即不得不自嵗轮之顶渐移而下以就日也旣渐移而东又渐移而下则不能平转而成环行嵗轮之圆象成矣
　　嵗轮心正在太阳之上星又在嵗轮之顶作直线过嵗轮心以过太阳之心而指地心是为合伏合伏以后星在嵗轮上东移有类平转故其东移速【古谓之疾段】嵗轮心离日渐逺星在嵗轮离合伏之度亦渐逺而向下行则东移之度渐迟【古谓之迟段】嵗轮心离日至一象限星在嵗轮直向下行人自地观之不见其动【古为留】过此留轮心距太阳益逺将至半周星行嵗轮之底转成向西行【是为退叚】轮心与日冲星正居轮底自轮心作线过星以过地心而直射太阳之心亦为一直线是为退冲
　　未至日冲皆为晨见冲日以后则为夕见夕见者西与日近东与日逺轮心反在日后而西行追日日在西星在东星不得不自轮底西移而就日【故仍为退】轮心西距日益近则星渐西而亦渐上行以就其距日之定距星旣在轮边与轮心亦有定距则其西移过半象限不得不转而上行矣
　　至于西距日一象限上行之势又直人自地观之亦不见动【古亦谓留】
　　过此而轮心距日益近则星亦在轮上渐向东行以就合伏之度以就其距日之常度于是又见其东移之速而至于合伏【古亦谓疾】是为嵗轮之周
　　论上三星围日之行左旋
　　问古以七政右旋宋儒以七政周天左旋今以七政恒星皆为一日一周之天所掣而西发明宋説谓右旋之度因左旋而成可谓无疑义矣兹论七政新图以太阳为心而复谓上三星左旋与金水异何居曰左旋有二前所论七政左旋以地为心者也今上三星左旋以太阳为心者也五星旣为动天所转而成左旋【一日绕地一周之行】又依嵗轮而右旋【以本轮上定度为心】此五纬之所同也然嵗轮上实行之度与太阳相直有定距则仍以太阳为心又成围绕太阳之行矣金水二星即以太阳为嵗轮【或伏见轮】之心故嵗轮即围日之行嵗轮右旋故其围日之行亦右旋也上三星则嵗轮不以太阳为心但其距日有定度而又成围日之形以嵗轮上度言之仍是右旋与金水同以围日之形言之则是左旋与金水异矣
　　五星与日皆为动天所转绕地左旋但上三星之左旋速于日故合伏之后即在日西【以右旋言为星不及日以左旋言为星过于日】冲日之后乃在日东【以右旋言为日逐星以左旋言则为星逐日】是不特其平行绕地者为左旋而其距日有常以成围日之形者亦左旋也
　　金水之左旋与日等故合伏之后在日东退合之后在日西则是平行绕地者均为左旋而其围日之行则右旋也故曰上三星左旋与金水异者主乎围日以为言者也
　　然则嵗轮之度又何以同为右旋乎曰视行之法逺则见迟近则见疾上三星之左旋虽速于日而在嵗轮上半则见过日之度稍迟下半则见过日之度加速矣金水之左旋虽与日等而在嵗轮上半较日距地为逺则见左旋迟于日下半距地近则见右旋速于日夫上半左旋迟则右移反速下半左旋速则右移反迟而成留退此所以嵗轮上度五星皆为右旋也
　　然五星嵗轮所以有在上在下之分者则以与太阳有定距也因其与日有定距所以能成嵗轮上周转之行因其在嵗轮上周转而行所以与日有定距
　　杨学山曰上金水左旋右旋之论犹仍厯书之説以伏见轮同嵗轮后言伏见轮乃绕日圆象金水另有其嵗轮乃勿庵晚年新説耳
　　论五星以日为心之图
　　法曰上三星其围日之圏左旋下二星其轮右旋皆以从宗动而西运之行为主【论左旋则星之退行乃其行速】假如上三星合伏时在太阳之上及其毎日左旋一周则星行过日若干分而在日西然其旋也距地则渐近其所以低者以就太阳也自此左旋之周益多则其离日而西之度亦渐逺而益旋益低比至在日西满半周而冲日则其旋益近地所以然者因在日冲故必下行嵗轮之底以就日也冲日以后其左旋之行转在日东随日之后而向日行其旋亦自冲日卑处渐向于髙离冲日若干分则其旋渐髙亦若干分自此在日后左旋追日而益近之以复至合伏则其旋益髙而复在太阳之上矣是故上三星之能为围日之圏者以左旋言也
　　惟以左旋言之则无论冲合之在恒星何度亦无问各星之冲合各有周率经厯之时日几何而其以日为心悉同一法也
　　其下二星以嵗轮围日其理易明然亦是与太阳同为一日一周之左旋而星之左旋迟于日故合伏时在太阳上毎左旋一周则星不及日若干分度而在日东其行亦渐降至于夕留之后又复渐速而追日其度益降至退合伏而极乃复离日而西度亦渐升而复于合伏矣
　　地谷曰日之摄五星若磁石之引铁故其距日有定距也惟其然也故日在本天行一周而星之升降之迹亦成一圆相厯家因取而名之曰嵗轮也是故上三星嵗轮约畧皆与太阳天同大而今其径有大小者各以其本天半径为十万之比例也
　　地谷新图其理如此不知者遂以围日为本天则是嵗轮心而非星体失之逺矣
　　宗动天左旋星与太阳皆从之左旋而有迟速以其所居有髙下离动天有逺近也
　　上三星在日天之上近于动天故其毎日左旋比日为速虽不能与恒星同复故处而所差甚防【土星只二分竒木星只五六分火星只半度】不能若太阳之毎差一度也
　　论五星本天以地为心
　　问五星之法至西厯而详明然其旧説五星各一重天大小相函而皆以地为心其新説五星天虽亦大小相函而以日为心若是其不同何也曰无不同也西人九重天之説第一重宗动天次则恒星又次土星次木星次火星次太阳次金次水次太隂是皆以其行度之迟速而知其距地有逺近因以知其天周有大小理之可信者也星之天有大小既皆以距地之逺近而知则皆以地心为心矣是故土木火三星距地心甚逺故其天皆大于太阳之天而包于外金水二星距地心渐近故其天皆小于太阳之天而在其内为太阳天所包是其本天皆以地为心无可疑者惟是五星之行各有嵗轮嵗轮亦圆象五星各以其本天载嵗轮嵗轮心行于本天之周星之体则行于嵗轮之周以成迟疾留逆【嵗轮心行于本天周皆平行也星行于嵗轮之周亦平行也人自地测之则有合有冲有疾有迟有留有逆自然之理也】若以嵗轮上星行之度聨之亦成圆象而以太阳为心西洋新説谓五星皆以日为心盖以此耳然此围日圆象原是嵗轮周行度所成而嵗轮之心又行于本天之周本天原以地为心三者相待而成原非两法故曰无不同也【上三星在嵗轮上右旋金水在嵗轮上左旋皆挨度平行】
　　夫围日圆象既为嵗轮周星行之迹则迟留逆伏之度两轮皆有之故以嵗轮立算可以得其迟留逆伏之度以围日圆轮立算所得不殊立法者溯本穷源用法者从简便算如厯书上三星用嵗轮金水二星用伏见轮皆可以求次均立算虽殊其归一也或者不察遂谓五星之天真以日为心失其指矣
　　夫太阳去地亦甚逺矣五星本天旣以地为心而又能以日为心将日与地竟合为一乎必不然矣
　　厯指又尝言火星天独以日为心不与四星同予尝断其非是作图以推明地谷立法之根原以地为本天之心其説甚明其金水二星厯指之説多淆亦乆疑其非今得门人刘允恭悟得金水二星之有嵗轮其理的确而不可易可谓发前人之未发矣
　　论伏见轮非嵗轮
　　问金水二星之求次均也【即迟疾留逆】用伏见轮厯指谓其即嵗轮其説非欤曰非也伏见轮之法起于回厯而欧逻因之若果即嵗轮何为别立此名乎由今以观盖即嵗轮上星行绕日之圆象耳【王寅旭书亦云伏见轮非嵗轮】
　　然则伏见轮旣为围日之迹上三星宜皆有之何以不用而独用之金水曰以其便用也盖五星行于嵗轮起合伏终合伏皆从距日而生故五星之嵗轮并与日天同大而嵗轮之心原在本天周故其围日象又并与本天同大上三星之本天包太阳外其大无伦又其行皆左旋【所以左旋之故详其后论】颇费觧説故只用嵗轮也至于金水本天在太阳天内伏见轮既与之同大又其度顺行故用伏见轮【亦即绕日圎象】若用嵗轮则金水之嵗轮反大于本天【以嵗轮与日天同大故皆大于本天】故不用嵗轮非无嵗轮也承用者未能深考立法之根輙谓伏见轮即嵗轮其説似是而非不可不知也伏见亦起合伏终合伏有似嵗轮然嵗轮之心行于本天之周而伏见轮以太阳为心故遂以太阳之平行为平行皆相因而误者也
　　论五星平行
　　然则金水既非以太阳之平行为平行又何以求其平行曰嵗轮之心行于本天是为平行乃实度也实度者周度也【以本天分三百六十度而以各星周率平分之则得其毎日平行如土星二十九年竒而行本天一周则二十九日而行一度毎日平行二十九分度之一是为最迟木星十二年周天毎日平行约为十二分度之一火星二年周天约为毎日平行半度金星二百二十余日周天约毎日平行一度半强水星八十八日竒而周天约毎日平行四度皆平行实度】若嵗轮及伏见轮虽亦各分三百六十度亦各有其平行然而非实度也【既非本天上平行之度又非从地心实测之平行度】乃各星之离度耳因此离度【下文详之】用三角法从地心测之则得其迟留伏逆之状亦为实度矣【此实度不平行与本天之平行实度不同】
　　本天之度平行实度也嵗轮及伏见乃离度也离度为虚数故皆以半径之大小为大小
　　伏见轮上行度与嵗轮同所不同者半径也伏见之半径皆同本天嵗轮之半径皆同日天
　　论离度有顺有逆
　　问何以谓之离度曰于星平行内减去太阳之平行故曰离度乃离日之行也以太隂譬之其毎日平行十三度竒者太隂平行实度毎日十二度竒者太隂之离度也【于太隂平行内减太阳平行】是故金星毎日行大半度竒水星毎日约行三度皆于星平行内减太阳之平行　因金水行速其离度在太阳之前乃星离于日之度故其度右旋顺行与太隂同法也
　　若上三星则当于太阳平行内减去星行是为离度盖以上三星行迟在太阳之后乃星不及于日之度其度左旋而成逆行与太隂相反然其为离日之行度一而已矣【王寅旭五星行度觧谓上三星左旋盖谓此也然竟以此为本天则终非了义】
　　论平行有二用而必以本天之度为宗
　　平行者对实行而言也然实行有二一是本天最髙卑之行亦曰实行一是黄道上迟留逆伏实测亦曰视行是二者皆必以本天之平行为宗
　　若金水独以太阳之平行为平行是废本天之平行矣又何以求最髙卑乎
　　围日之轮【即伏见轮】起合伏终合伏是即古法之合率也本天之行则古法之周率也最髙卑则古法之厯率也又有正交中交以定纬度即如古法之太隂交率也【此一法是西法胜中法之一大端】是数者皆必以本天取之故不得以围日之轮为本天
　　厯指言金星正交定于最髙前十六度水星正交与最髙同度其所指皆本天之度非伏见行之度则伏见轮不得为本天明矣
　　今以七政厯征之不惟最髙卑之盈缩有定度即其交南北亦有定度故金星恒以二百二十余日而南北之交一终水星则八十八日竒而交终此皆论本天实度原不论伏见行是尤其较著者矣
　　论金水交行非徧交黄道
　　问周云渊言金水遍交黄道不论何宫今日交有定度何也曰云渊之説盖因回回厯纬表而误者也何以言之回回厯以自行度小轮心度立表而定其交黄道之度非以黄道度为主而求其交处也故其所谓宫度者皆小轮之宫度也非黄道之宫度也若谓黄道之宫度而可以徧交将正交之度亦无定在矣又安得谓金星正交在最髙前十六度及水星正交定于最髙同度乎必不然矣【正交定度虽出厯书然与回厯原是大同小异】
　　今以七政厯攷之金星水星之交周皆有定期【金星以二百二十余日水星以八十八日竒】但嵗轮心行至正交即无纬度不论其为合伏为冲退为疾为迟或留也以此而断其必有本天有嵗轮可以勿疑
　　论金水伏见轮
　　伏见轮即绕日圆象也其半径与本天等本天上嵗轮心所行之周半在黄道北半在黄道南其势斜立如太隂之出入黄道为隂阳厯也而星体行伏见轮周其势
　　亦斜立与之相应故其交角
　　等
　　嵗轮心在正交或中交则星无纬度
　　故伏见轮上亦有正交中交　嵗轮
　　心行过正交渐生北纬至离正交九十
　　度则北纬极大如太隂之隂厯半交
　　也【古法正交后阳厯中交后隂厯西法则反用其号然其用不殊】
　　嵗轮心行过北大距【离正交九十度至一百七十九度】北纬渐小至中交而复无纬此如太隂之隂厯半周也　嵗轮心行本天隂厯半周即星在伏见轮上亦行北半周而其纬在北纬有大小无不与之相似
　　嵗轮心行过中交渐生南纬至离中交九十度南纬极大如太隂之阳厯半交也嵗轮心行过南大距南纬渐小复至正交而无纬如太隂之阳厯半周也即星在伏见轮亦行南半周而南纬之大小一一与本天相似聨正交中交成一线此线在本天必过地心以本天圆面与黄道面斜交相割而成也而在伏见轮亦必过日心以伏见轮之绕日圆象亦与黄道面斜交而半在黄南半在黄北圆面相割成线也以此线为横线而均剖之作十字横线则上下两端所指并半交大距度矣此伏见轮上十字线之理也
　　伏见轮心即太阳太阳行黄道三百六十度伏见轮亦随之行一百六十度而十字之形不变此正视之形也又正视图不能见交角故必以旁视明之伏见轮事事与本天等故以本天明之
　　如图　甲丙乙壬为本
　　天浑员之体【因旁视即为本天浑
　　体】甲心乙即本天之星
　　道【因旁视故前平视之外周跻缩成一直线
　　也】心即地心【在伏见轮即为太阳】又
　　即为正交中交【因旁视正交中
　　交过心横线竟防成一点】丁心癸即本
　　天上黄道圈【本天小于黄道然其度一一与黄道相应而成一圈亦因旁视防成】
　　【一直线】两直线相交于心即成纬度角【两直线相交即两圈】
　　【相交也亦即为两圆靣相切两圆面者一为星道一为黄道在浑体皆成面】甲心丁角在黄道北其弧甲丁其正甲庚北大距之纬度也【甲丁弧虽在本天然即外应黄道纬】乙心癸角在黄道南其弧乙癸其正乙辛南大距之纬度也【乙癸弧在本天外应黄道与甲丁同】
　　问何以分南北也曰甲丁与乙癸两大距弧各引长之成一全圈在本天浑体即外与黄道上过极经圈相应而北心南直线为之轴北即北极南即南极亦与黄道之南北极相应矣甲心线在黄道北即生北纬乙心线在黄道南即生南纬又何疑哉【甲心半径也以旁视故正交后北半周一百八十弧度并跻缩成直线与半径等乙心之在南亦然】
　　然何以谓之大距曰甲丁纬弧与甲心丁角相应为北大纬乙癸弧与乙心癸角相应为南大纬甲乙并居半交故其纬最大其未及半交及已过半交其纬并小南北并同也
　　问纬度即角度也角同而纬有大小何也曰角虽同而边不同也大距度以半径为全数其余各度并皆以正当全数
　　假如任举一度如过正交三十度为戊【未至中交三十度亦同】其正戊心法为甲心全数与甲丁大距之正甲庚若戊心正与戊子弧之正戊巳也【戊心巳句股形与甲心庚形相似同用心角而戊心边正得甲心之半则戊巳亦甲庚之半而戊子弧亦必为甲丁之半矣他皆仿此】以上所论皆本天之事然伏见轮之理并无有二故此一图即可作伏见轮观其旁视之交角甚明也
　　论伏见轮十字线
　　伏见轮既为绕日员象而生于本天之嵗轮故其面与本天等径而其斜交黄道之势亦与本天等夫本天之斜交黄道也半在北半在南惟正交中交二与黄道合聨此二过心是为交线即两员面相切所成也从交线上中分之作过心十字直线至本天周即大距线也何则黄道面上原有十字线正视之两线合为一直旁视之则本天直线斜穿而成交角故此直线在本天即为大距线也此直线所指本天之度正在二交折半之中其距最大故即为大距线然则此十字线者固本天所原有而伏见轮之斜交黄道既与本天等则其十字线亦无不等矣
　　伏见轮即为绕日之员象则太阳即轮心太阳行于黄道故伏见心钉于黄道也然其心虽钉于黄道而其面则半在北半在南一定不易任轮心在黄道之何度而其斜交之面总与本天为平行故其交线皆不变其十字大距线亦不变也
　　由是观之伏见轮亦有二面何则伏见轮之面既斜交黄道与本天之面为平行则其相当之黄道亦即有与伏见轮相应之一圏与黄道面平行而与伏见轮斜交亦如本天之与黄道斜交矣
　　如是则伏见轮之交线常与本天之交线平行不论在黄道上何度分也而伏见轮上之从心所出之十字大距线及所相当黄道上从太阳心即轮心所出之十字线亦与本天心黄道之十字线平行而两十字线正视之成一直线旁视之一直一斜而成大距之交角亦一一与本天交黄道之角分寸不爽故用伏见即如本天也
　　论伏见轮之所以然
　　伏见轮半在日天外半在日天内其半径与本天等即星体所行也【黄道半径与金星本天之比例约为十与七二有竒】伏见轮以日为心绕日环行与本天周上嵗轮心行度相应故其大相等本天半在黄道北半在其南伏见轮亦然【门人刘着云譬如人放纸鸢人在下环行而纸鸢亦在空际环行盖以纸鸢为风所举不能下而又为线所引不能不环行可谓善于形容】故惟本天之度为实度不惟伏见轮为星绕日行之虚迹即嵗轮周上星行之度亦虚设之员周非硬圏有形质也譬如浮屠髙尖有珠如日人持长竿竿上端有微小之珠【如金星】浮屠之中腰有圆圏梯道斜绕之【如金星本天之斜立】人行其上【如嵗轮心之行于本天周】其珠竿直立指天其长也如浮屠尖至其腰围之心【如星在嵗轮周至嵗轮心之径与日天半径等】两珠相望有绳系之其绳常引直而有定距与腰围斜绕之磴道等【如金星绕日有定距与本天半径相等】持竿者循斜梯绕浮屠旋转平行之则竿上珠自然亦绕尖上大珠旋转成员象矣【此如伏见轮为绕日之员象】
　　由是言之可以免嵗轮大小之疑何则嵗轮之心行于本天之周而本天既有髙卑嵗轮心行于髙度则金星在伏见轮者离地逺矣嵗轮心行低度则星在伏见轮者离地近矣近则觉嵗轮之半径小矣逺则觉嵗轮之半径大矣若嵗轮为坚靭之物何以能伸屈如此乎更以视法徴之何以在最髙反大在最卑反小乎必不然矣
　　嵗轮之大小又因于太阳髙卑伏见轮既以日为心则太阳行最髙时伏见轮从之亦髙而星去地逺太阳行最卑则伏见轮从之卑而去地近亦遂疑嵗轮之有大小而与视法反若知嵗轮亦非真有轮则羣疑尽释矣
　　求伏见轮交角
　　伏见轮斜交黄道旣一一与本天等则伏见轮交角与本天交角亦必相等
　　假如本天大距纬度之正欲变为伏见轮上大距之正法为黄道半径与本天大距之正【即本天交角】若伏见轮半径【亦即本天半径】与伏见轮之大距正也
　　金星本天交角定为三度二十九分　水星六度　分一　黄道半径【全数】　　一○○○○○
　　二　本天交角【正】　　　○六○七六
　　二　伏见轮半径　　　七二二五一
　　四　伏见轮大距纬【正】　○四三八九
　　王寅旭中纬准分是○四三九○葢以得数九九七收作一数故也
　　其余各度并先以全数为一率交角正为二率各度正为三率得四率为各度纬
　　再以全数为一率各度纬为二率伏见半径为三率求得四率为各度变率之本纬
　　简法置交角正以各度正乘之去末五位又以伏见轮半径乘之去末五位即径得各度变率本纬又防法　黄道半径为一率　大距正变率为二率各度正为三率　得各度本纬为四率
　　假如伏见轮上距交三十度求其本纬
　　一　黄半径全数一○○○○○
　　二　【大距正】变率　　○四三九○乘得二一九五○○三　三十度正　五○○○○○○○
　　四　三十度本纬　○二一九五
　　解曰此以变率求变率故径得本纬不须再变寅旭用中纬准分即此理也
　　求各度正余变率法
　　置各度正余以伏见轮半径乘之得数去末五位即得变率之正余
　　求金星视纬法【水星仿此】
　　一求合伏距交
　　法以本日太阳实行在正交后宫度【即伏见轮心距交宫度】命为合伏距交度
　　解曰凡星合伏必与太阳同度太阳行一度小轮上合伏亦随之移一度故太阳实行度即轮心而轮心距交必与轮周之合伏距交等角
　　二求星距交
　　法以用日距合伏后日数在位用星离日度三十七分弱为法乘之得离日平行以加合伏距交度为星距交平行度再简本度盈缩差加减之【即加减差从最髙卑起算】为星实行距交度分
　　解曰金星之行速于太阳太阳行一度金星行一度三十七分弱有竒故虽与太阳同行而常在前谓之离日度厯书以太阳之行为星平行非真平行故必并此离日度始为真平行
　　星平行在伏见轮周而根本在本天嵗轮心行于本天有髙卑加减古厯谓之盈缩差伏见轮上行旣与本天上嵗轮心行相应则亦必有盈缩加减矣
　　三求两距交度入隂阳厯及初末限
　　法以两距交度【一伏见轮心距交是黄道上度一星体距交是伏见轮周度】并视其在半周以下为入隂厯【○一二三四五宫】满半周以上内减去半周为入阳厯【六七八九十十一宫】各视其度在象限以下为初限【○一二宫为隂厯初限六七八宫为阳厯初限】满象限以上用以减半周余为末限【三四五宫为隂厯末限九十十一为为阳厯末限】
　　四求视纬正
　　法以星距交正【用变率】及各度本纬【变率】各自乘实相减得数开方得根以加减黄道正【即轮心距交度正用本数】为黄道正又自乘之得数以与本纬自乘实相并【本纬实即上所求】为视纬股实开方得视纬正【防法不必开方只用股实】
　　加减例　视【黄道上轮心伏见轮上星】两距交度【同在隂厯或同在阳厯则相加或一在隂厯一在阳厯则相减】
　　解曰星距地心线如句股之即全数也故亦有其正为股余为句
　　五求视纬余
　　法以星距交度余【变率】加减黄道余【用本数与正同】为视纬余
　　加减例　视两距交度【仝在正交边或仝在中交边则相加若一在正交边一在中交边则相减】
　　解曰在正交边者隂厯初限阳厯末限也隂厯初限为已过正交在正交前一象限也阳厯末限为未到正交在正交后一象限也此两象限共一百八十度在十字直线之右并于正交为近也
　　在中交边者隂厯末限为未到中交之度在中交后一象限阳厯初限为已过中交之度在中交前此一百八十度在十字直线之左并于中交为近也
　　又总解曰正之加减论隂阳厯以十字横线为断也余之加减论正中交以十字直线为断也横线者交线也直线者大距线也正线并与大距线平行是各度距交线之数余线并与交线平行是各度距大距线之数于此而知十字线之为用大也
　　六求星距地心线
　　法以视纬正余各自之并而开方得星距地心线七求视纬
　　法以各度本纬【变率】加五位为实星距地心为法除之得视纬论曰必如此下算则事事有着落视纬得数始真若前纬后纬之表以中分取数加减法虽巧便得数亦恐不真耳
　　假如金星伏见轮心距正交三十度星距合伏三十五度求视纬
　　如图大圈为黄
　　道小圈为伏见轮
　　轮心在日距正交
　　为井日弧三十度
　　合伏距正交为
　　合正亦三十度星在戊过合伏三十五度距正交为戊正弧六十五度
　　法先用日乙丙丁戊巳两三角形依变率法日乙与乙丙大纬正若丁戊星距交正与戊巳纬次用丁戊巳直角形巳为直角戊丁为戊巳为勾求得巳丁股次用戊巳癸直角形巳为直角以巳丁股加丁癸【丁癸即日壬为轮心距交井日弧正】共己癸为股戊巳为勾求得戊癸为视纬正次以星距交正戊弧余丁日即壬癸也与壬心相加【壬心为轮心距交井日弧之余】共癸心为视纬余次用戊癸心形癸为直角戊癸为股癸心为勾求得戊心星距地心线末用心戊巳直角形巳为直角心戊与戊巳纬若全数与戊心巳角之正求弧得心角视纬度【图内诸三角形俱是立三角须以浑体观之便明】
　　按右法未加髙卑之算盖前纬后纬表原亦未用髙卑也若求宻率仍当以髙卑入算为穏説具后条
　　又按依右法用三角形推算可不必立前后纬表亦不用中分厯书盖以作表故用约法以该之也
　　论大距纬之变率又以髙卑而变
　　大距纬者即黄道交角之正金水本天半径皆小于黄道半径【黄道常为十万而金星本天半径得其十之七有竒水星得其十之三有竒】故其大距纬亦小于黄道之大距纬而各度从之皆有变率矣然星本天既有髙卑则其半径亦时有大小而其距纬亦从之有大小变率之法又当以此为准的也准前论在本天最髙则半径大而伏见轮半径亦大即距纬亦大矣在最卑则半径小【本天与伏见轮并仝】距纬亦小矣【皆变率之距纬】説者遂谓其与视法之理相反殊不然也何则本纬之变率与视纬之变率不同也
　　本纬在最髙则半径大本纬亦大在最卑则半径小本纬亦小乃本天自有之数非闗视法【伏见轮上纬仍是本天】视纬星距地逺则大纬变小星距地近则小纬变大全系视法【从地上看伏见轮上星】
　　论黄道亦有半径之大小
　　黄道半径常为十万分全数然黄道旣有髙卑则其半径必有大小最髙时半径必十万有竒最卑时半径必十万不足日躔章原有太阳距地髙卑表所当取用者也
　　太阳距地为黄道半径亦即伏见轮心距地也在上三星用嵗轮即为嵗轮半径王寅旭曰因黄道之髙卑而嵗轮有大小盖谓此也今按嵗轮与黄道同大厯家筭髙卑或用不同心圏则其距地之数有大小乃是半径有大小非以此半径另作一圏也以嵗轮立算乃是数中之象因天运有常故可以轮法测之此可为达者告也论伏见轮半径亦有大小而本纬因之有大小
　　本天旣有髙卑则半径有大小而伏见轮并与之等伏见轮半径旣有大小则其正余之变率及大距度之变率与各度之本纬并因之而有大小
　　法以本天髙卑求得各度半径为伏见轮各度半径【最髙距正交十六度起算】
　　就以半径为法乘各度正余去末五位为正余变率又以半径为法乘大距正【金星大距三度二十九分】去末五位为大距变率
　　就以大距变率为法乘各度正去末五位为各度本纬
　　以上数端并以最髙变大最卑变小
　　论视纬当兼用两种髙卑立算
　　准上论黄道半径有大小伏见轮半径及正余及本纬并有大小必兼论之则视纬始为宻率
　　法以伏见轮各度正变率自乘本纬亦自乘两得数相减开方求根以加减黄道正【髙卑所求】为正又自乘之以并本纬自乘为视纬自乘实【即视纬股实】又法不用加减但以伏见轮正【变率】为一边黄道正【髙卑所算】为一边大距度外角【以大距角减半周】为一角用切线分外角法求得视纬正自乘为股实亦同又以伏见轮余黄道余相加减【俱用变率】为视纬余又自乘之为句实并视纬股实句实开方得即星距地心逺近线也
　　末以星距地心为法本纬【变率】加五位为实实如法而一得视纬宻率
　　黄道髙卑于太阳实行度取轮心距最髙宫度【在正交后若干度起算】
　　本天髙卑于伏见轮上星实行度取距最髙宫度【距正交十六度起算】
　　又按用此宻率当设两表
　　一伏见轮上各度半径表　以金星髙卑算得其大小一伏见轮上各度大距表　即以各度半径乘大距变率正全数除之即得
　　其黄道中各度半径即用日躔髙卑表不必另作有各度半径即可求逐度正余变率【黄道仝】
　　有各度大距变率即可求各度正纬　以上俱用乘法按金星之最髙不与正交同度相差十六度当于伏见轮上安两种十字线水星之最髙则与正交同度
　　论金星前后纬表南北之向
　　金星前纬自小轮初宫向北其纬极大为一度二十八分自此渐减至二宫三十度而减尽无纬度【即三宫初度】自三宫初向南渐有南纬至五宫三十度南纬极大为九度○二分【即六宫初度】
　　自六宫初以后南纬渐减至八宫三十度南纬减尽无纬【即九宫初度】
　　自九宫初度复向北渐有北纬至十一宫三十度复为一度二十八分【即初宫初度】
　　据此则金星前纬南纬大北纬小南大纬至九度○二北大纬只一度二八而分为四限
　　自合伏至留际【乃嵗轮上距合伏九十度亦可名为留际】北纬减尽为初限自留际向南至退合南纬至九度○二分【为南纬极大】为次限
　　自退合以后南纬渐减至留际【距退合亦九十度】南纬减尽为三限
　　自留际复向北至合伏北纬至一度二十八分【北纬极大】为末限
　　此盖以嵗轮上合伏之时星距地逺故纬度见小退合之时星距地近故纬度见大
　　此前纬是置轮心在正交后大距处而算伏见轮上一周之纬故其南北之向如此
　　金星后纬自小轮初宫初度无纬度自此向北而生北纬北纬之大为二度三十三分在四宫十五度自此渐减至五宫三十度北纬减尽【即六宫初度】
　　自六宫初度以后向南而生南纬南纬之大亦二度二十三分在七宫十五度又自此渐减至十一宫三十度南纬减尽【复至初宫初度】
　　据此则金星后纬向南向北分为两限【其增减之分南北相同但有顺逆而无大小】
　　自合伏始向北而生北纬至距合伏一百三十五度北纬甚大【至二度三十三分】至距合伏一百八十度北纬减尽而无纬度【即退合时其距大纬度相距四十五度】是为北纬限
　　自退合后始向南而生南纬至距退合四十五度南纬甚大【亦二度三十三分】从此渐减至退合一百八十度南纬减尽而无纬度【即复至合伏其距南大纬度一百三十五度】是为南纬限此后纬是置轮心在正交而算伏见轮上一周之纬故其南北之向若此　若水星南北之向俱与金星相反然伏见轮之理则同
　　合前后二纬表观之距合伏后一象限前后纬宜相加以其同为向北也距退合前一象限前后纬宜相减以前纬已改向南而后纬仍向北也
　　过退合后一象限前后纬又宜相加以前纬仍向南而后纬亦向南也过退合后第二象限【即距合伏前一象限】前后纬又宜相减以前纬已改向北而后纬仍向南也
　　论金星前后纬加减之法
　　前纬起大距【凡言起者即合伏所在】自初宫至二宫共九十度为隂厯末限后纬起正交自初宫至二宫共九十度【○一二宫】为隂厯初限虽分初末皆隂厯也故相加
　　前纬过九十度【三宫四宫五宫】为阳厯初限后纬过九十度【三宫四宫五宫】为隂厯末限一隂厯一阳厯南北相反故相减前纬过一百八十度复行九十度【六宫七宫八宫】为阳厯末限后纬过半周复行九十度【六宫七宫八宫】为阳厯初限并阳厯俱在南故亦相加
　　前纬过二百七十度行一象限复至合伏【九宫十宫十一宫】为隂厯初限后纬过二百七十度行一象限【九宫十宫十一宫】复至正交为阳厯末限一隂厯一阳厯故又相减
　　此置轮心【即太阳】于正交【后纬】及正交后大距【前纬】立表若置轮心于中交【为后纬】及中交后大距【为前纬】则隂阳之名相易然加减之法并同
　　并以合伏后一象限相加【○一二宫】第二象限相减【三四五宫】退合后一象限【六七八宫】又相加第二象限又相减【九十十一宫】又按厯书枢线之説盖是谓交防移则南北变恐非有翕张之形也假如交在合伏则合伏线与交线合而无纬度若合伏过正交若干度则正交上之合伏后若干度【即合伏防距枢线之度】此处无纬度而合伏反有纬度矣是纬度之变动全系乎枢线之移也【即轮心所到】
　　论五星以髙卑变纬度
　　本天髙卑能变纬度理宜有之然按图详审其法有三其一于本天之斜交径上作嵗轮三径线与黄道面平行逺近不同纬度自异其二于本天斜径上只作一嵗轮径线而最髙卑之嵗轮心有时而移即其周之长短随之逺近其三亦只作一径线而行最髙时嵗轮圏大行最卑时嵗轮圏小三者虽同用最髙卑立算而加减各异此必徴之实测乃可定之
　　第一法用三线则交角虽不变而嵗轮面与黄道面之逺近顿殊【角既同矣纬何得异曰所用之本天径线不同也假如中距时交角为三度其所得正乃中距时径线为全数也若最髙时则其全数大矣虽亦三度角之正而其实数则大矣故纬亦大最卑时全数小而正亦小彷此论之其留际上下角不同者又在其外也】
　　又有异者若用三线则交防亦当有变何也中距面线至正交时与黄道面径合为一线其余两嵗轮面线必一在北一在南【按至交防则三线合一此一节可以勿论】
　　第二法嵗轮只用一线其面之距纬本无不同而最髙卑时轮心有动移最髙时轮心在上则正线如故而角变小矣【谓小于中距之角】最卑时轮心近下则正如故而角变大矣【大于中距角】何则正虽同【谓嵗轮面与黄道面平行之纬】而轮心在上则逺于地心而见小矣轮心在下则近于地心而见大矣【又法用不同心于黄道则不但正不变角亦不变但人在地心视之则有大小与上法二而一者也】
　　第三法只作一嵗轮径线【凡言径线皆因旁视而面变为线】而其两端并作三层线折半为嵗轮心而两端无参差尽其轮边【即径线两锐尖尽处】为最大圏之径乃最髙时所用两端各缩进为界则中距时径也两端又缩进为界则最卑时圏径也西厯论火星嵗轮有大小之故解之以髙卑而王寅旭亦取之用此法也
　　以上三法不知谁为定法故曰必徴诸实测
　　又按三法在上三星其用皆同至金水则又大异何则金水嵗轮大于本天【以其径同太阳天故】则包过地心退合时轮心在人之背而星在轮周跨过地心在人之上星之下星在轮周与其轮心如月之望而人居其间故最髙时轮心逺于地而星在轮周反近于地纬反变大矣若最卑时轮心近地而星在轮周反逺于地纬反变小矣此自然之势不得不然者也【此在第一法第二法并同】
　　若用第三法则虽有髙卑而两端之逺近不变与前二法相反故必徴之实测乃取其合者用之
　　杨学山曰西法歩五星土木火有嵗轮金水有伏见轮虽两轮行度求角之法皆同然嵗轮上为星离日之虚度轮心在本天伏见轮则自有行度轮心即太阳细按厯书之説盖谓上三星本天包太阳天外星离日而又与日有定距是生嵗轮其半径恒与太阳天等若金水之本天即太阳天其平行与太阳同距地亦与太阳等【俱一千一百四十二地半径】而此伏见一轮以日为心绕日环转而为伏见使非此轮则星无所为伏见【以平行同太阳故也】故名伏见轮之半径皆有定度【金星七千二百竒水星三千八百竒】是其意原非以伏见轮当嵗轮若果即为嵗轮则半径宜有大小何则火星因与太阳天近尚有日躔本天二差以变次均角岂金水在太阳天下而反无之今测不然是伏见轮另为一种行动为金水之所独故昔人别立伏见轮之名也其所云即嵗轮者盖因行法相同而混言之耳今勿庵之説又异是谓五星皆同一法皆有嵗轮上三星因本天大故用嵗轮金水因嵗轮大难用故用绕日圆象【即伏见轮如上三星围日之圏】如此可明金水自有本天因得自有髙卑亦自有平行度因在日天下速于太阳本天斜倚黄道因有正交中交之名诸根底俱有着落且五星一贯但依此立算凡星平行自行之根数初均次均之度分南纬北纬之大小皆与厯书数迥异騐之于天末识合否余尝疑厯指论五星纬説多混淆金水尤略因作五星纬行解一巻明之勿庵之説不敢遽定其是非存之以待参攷焉





　　厯算全书卷十六
　　钦定四库全书
　　厯算全书巻十七
　　宣城梅文鼎撰
　　火纬本法图説
　　荧惑一星最为难算至地谷而其法始宻图表具在可攷而知也何尝云火星天独以太阳为心不与余四星同法乎作厯书者突发此语遂令学者沿譌是执图以观图而不以算理观图也不知厯算家有实指之图有借象之图地谷氏之图火星所谓借象也非实指也钱唐友人袁惠子士龙受黄三和先生宪厯学以厯指为金科余故为作此以极论之而徴之切线分角之法以着其理袁子虚懐见从已复质诸睢州友人孔林宗兴秦亦以为然而手抄以去又旁证诸穆氏天歩真原王氏晓庵厯法大防亦多与余合


　　火星本法【发厯书之覆】
　　据厯指万厯癸丑年太阳在降娄宫一十四度有半
　　地谷测火星体防合于井宿第五星
　　经度为鹑首四度半
　　纬度在黄道北二度十一分
　　火星平行在壬
　　距冬至二百一十七度半强
　　火星最髙在丙
　　引数自丙厯丁至壬三百三十八度半弱














　　图説　乙为地心　即为各天平行之心【亦黄道心】大圈为火星平行之天　内圈为太阳平行天皆以地为心【其度皆应黄道】　太阳在本天自春分壁向娄顺行　火星嵗轮心在本天自丙过丁至壬顺行太阳行速而火星行迟今太阳在后火星在前是
　　太阳与星已过相冲之度而从后逐星也　火星在嵗轮上亦自戌顺行过亢至申　合伏时星在戊冲日时星在亢今在申是星己过冲日之限而复向合伏也　太阳距星实行为娄张【亦即心氐】以减半周为张角为黄道上星距日冲之度【亦即氐未】太阳在黄道上自娄仍顺行其冲亦自角顺行星亦自氐顺行而日速星迟故其距渐近而星距日冲渐逺则星在嵗轮上距合伏之度亦渐近距冲日之度亦渐逺其嵗轮上渐逺渐近之度皆与黄道上距度相应然黄道上娄张是日在后追星嵗轮上是星向合伏【申戌】黄道上日冲度渐离星【角张】嵗轮上是星离冲日【申亢】
　　本法以平行壬为心作子癸小轮自最髙子过癸左行为引数之数至丑　又以丑为心作夘辰小均轮自辰最近右行过夘歴寅复过辰歴夘至寅为引数之倍减去全周得嵗轮之心到寅
　　先以丑寅壬三角形求得丑壬寅角及壬寅线次以寅壬乙形求得寅乙线为嵗轮心距本天心之数　又求得壬乙寅角为平行实行之差即前均也因在后六宫其号为加得寅乙申角为实行视行之差
　　此以上厯书之法并同以下则异
　　次以寅为心作嵗轮戊申亢圏也戊为最逺合伏之度也亢为最近冲日之度也今太阳在降娄火星在鹑首是已过冲日之度而日反在后以逐星也其日星之距为降娄至鹑首之度在嵗轮上则为申戊弧乃星行嵗轮末至合伏之度也【厯家谓之距余盖顺数自戊合伏过亢冲日至申为距合伏行度以全周得申戊为距余】以申戊减半周得申亢为巳过冲日之度即申寅亢角【或申寅乙角】
　　末以申寅乙三角形求申寅半径　此形有先求得寅乙距心线又有申乙寅角为先测火星视行与所算实行之差度有申寅乙角为嵗轮上己过冲日之度有两角自有寅申乙角法为申角之正与乙角之正若寅乙线与申寅线也【此以测得视差而求半径】若先有申寅半径而无视差度求乙角者则以切线法求之以申寅邉乙寅邉并之得戊乙为总数【一率】又以申寅减乙寅得亢乙为较数【二率】以申戊度半之为距余半求其切线【为三率】法为总数与较数若半距余角【即半总角】之切线与半较角之切线也求得四率查切线得其度以减距余半之度余为申乙寅视差角乃以视差角减实径为视径【已过日冲其差为减】此本法也厯书所载求法得数并同而其图迥异盖巧算耳下文详之
　　厯书之法亦是用两角一邉以求余邉【星过日冲弧度是一角测得视行与实行之差是一角算得寅乙距心线是一边今以法取嵗轮半径为所求一边】然不正作申乙寅视差角而反作乙寅甲为视差角故亦不正作申寅乙星过冲日角而作寅乙甲为星距冲日角然则用本法者惟寅乙距心一线耳
　　然既有寅乙线为主又有寅乙甲为星距日冲度有乙寅甲角为视差度则乙寅甲三角形与申乙寅三角等而甲乙邉必与申寅半径同矣此倒算防法与加减差法不作角于心而作角于邉同一枢轴也
　　其法以先得寅乙线为三角之底其两端各作角【即先得两角】
　　各引其邉遇于甲则甲乙为半径【寅甲亦即为星体距心与申乙之距同矣又大阳心在降娄其冲未在寿星星实行在氐氐末为氐乙未角即星实行己过日冲之真距也正与嵗轮上申亢度等故用氐乙未角为黄道上星距日冲之度与用嵗轮上申寅亢同此为借象之一根】
　　然又以甲为地心而作圏周分十二宫何也曰此则借象也其法妙在作甲己线与寅乙平行何也先依寅乙线作三角形其寅甲原与申乙平行今己甲又与寅乙平行则寅甲己角与申乙寅角等度而且等势矣【寅甲线斜交于寅乙及甲己两平行线中则所作寅甲己及甲寅乙两角等寅乙线斜交于申乙及寅甲两平行线中则甲寅乙与申乙寅角亦等而寅甲己角与申乙寅不得不等矣○角之度既相等而寅乙线即原用之线也今巳甲与寅乙平行故不惟等度而且等势也】由是而自甲心作春秋分横线井箕直线即与乙心所作大圏上降娄夀星横线及冬夏至直线悉为平行而等势【横与横平行直与直平行则其势等】于是而匀分十二宫即无一不与乙心所作大圏等
　　十二宫既与大圏等势而寅甲己角又与大圏之申乙寅角等度等势则己甲线即指星实行度寅甲线即指星视行度而可以命其宫度不爽矣推此而辛甲为星最髙指线及作平行线于己甲实行之内一一皆真度矣
　　又以乙为太阳体何也曰太阳实行降娄宫度原在大圏其离降娄之度为乙角今太阳指线过乙至甲则甲角与乙角等度而乙防在次圏上【甲心所作之甪】距春分之度与大圏等【圏有大小而角度等】即太阳真度可以命之为日矣乙既命为日则次圏可命为太阳所行之天而乙心所作大圏以太阳之冲处割小圏有火星行嵗圏最近侵入太阳天内之象故遂以大圏命为星行之圏也【又寅乙甲角原为星距日冲之度与申寅乙角同而甲己既与寅乙平行甲未即甲乙之截线则己甲未角又与寅乙甲角同而己亥与嵗轮上申亢同为星距日冲之】
　　此一图也有嵗轮半径之数【甲乙】有火星实行视行差度【寅甲己角】有周天宫度有太阳度及火星最髙卑度又有火星行最近入太阳天内之象可谓简而该巧而妙矣非地谷精于测算神明于法不能为也
　　然则何以谓之借象曰以其一图而备数端故知之也何以言之甲乙者嵗轮之半径也不得与日距地心同数一也寅乙距心之线从两小轮求出而两小轮在火星本天是从乙心起算不从甲心起算二也因寅乙距心之线以得视差之角亦为乙心之角非甲心之角三也若甲真为地心则与乙太阳有距数太阳乙心所见之差角至地心必不同观四也视行实行之差角为地面实测非乙心之数不得两处悉同五也又大圏既为本天而侵入太阳天内则将为嵗轮之心若冲日之时嵗轮心既在太阳天内星又在嵗轮最近将越过地心如金水之退伏合而不得冲日矣六也由是观之此图但为借象巧算之用而非以是为真象也或者不察遂真以乙为日体则死于古人句下矣
　　或问五星新图亦以火星天用太阳为心而冲日之处割入太阳天内又何以説焉曰火星之行围日而能割太阳天者乃嵗轮上周行之迹耳非本天也盖火星本天在太阳之外能包太阳之天因嵗轮之行合伏时在嵗轮之顶去太阳益髙合伏以后离太阳渐逺则行于嵗轮中半与本天齐及其冲日则行嵗轮之底而在本天之内去地益近其去地益近者为日所摄也此理五星所同故土木火三星皆可为围日之象今新图五星不以地为心者是也火星则嵗轮最大冲日时稍侵入太阳之天其实嵗轮之心仍系本天在太阳天外耳七政小轮周行于天遂成不同心之圏嵗轮周行于天成围日之形一而已矣今以实数攷之火星嵗轮半径约为本天半径十之六其合伏时则两半径相加成十六冲日时两径相减只余十之四其侵入太阳天内约为一二分则太阳天半径只得火星天半径十之六有竒而火星合伏时在太阳上约为十分冲日时在太阳下亦约十分而成围日之形矣是故以日为心者嵗轮上星行之轨迹也非本天也【图见下】
　　火星嵗轮上轨迹围日之图　【土木二星因嵗轮之度而成围日之形与此同理但其天更大而嵗轮小故不致侵入余里之天】








　　丁庚寅辛为太阳天　戊癸己壬为火星本天甲丑嵗轮以戊为心　丙子嵗轮以己为心
　　丁为日体　甲丙皆星体
　　甲癸丙壬为嵗轮上星行轨迹成一大圈而以丁日为心
　　星天日天各有小轮髙卑其本天则皆以地为心星在嵗轮甲为合伏而去地极逺　星在丙为冲日冲日之时庚丙辛割入太阳天庚寅辛之内而去地极近
　　星在嵗轮丙时已割入日天然嵗轮心则在本天已若如众説以割入日天内者为本天则冲日时当以丙为嵗轮心矣而星在嵗轮之上又当向日岂不越地心乙而过之乎必不然矣
　　切线法解在后


















　　火星次均解　【火星次均用切线求嵗轮上视差角乃三角法也】
　　欲明火星次均用切线之法当先明三角形用切线之法
　　甲夘乙三角形有甲钝角一百五十度有甲乙邉六十有甲夘邉一百整求夘角
　　法曰以甲角减半周得余三十度为癸甲乙外角　半之得十五度为丙甲辛角　其切线辛癸【二六七九五】并甲乙【六十】甲夘【一百】共得丙夘一百六十为首率【总数】　以甲乙减甲夘余得辰夘四十为二率【较数】　半外角之切线辛癸为三率　二率乗三率为实首率为法除之得辛夘【六六九八】为四率即辛甲壬减之切线也　以四率查切线表得三度五十分弱为辛甲壬减角　以所得辛甲壬减角三度五十分减半外角十五度余壬甲丙角十一度一十分即夘角也
　　今以火星言之丙乙辰圏则嵗轮也甲为嵗轮之心丙甲辰夘过心线即星实行度分也
　　夘为本天之心　甲夘者距心线也【即表中距日数】　甲丙甲乙甲辰皆嵗轮半径也【即表中半径合日差而成星数也】
　　先以前均求到星之实行在甲矣然此嵗轮之心而非星也星则自丙合伏顺行过辰冲日而渐近合伏其体在乙则丙辰乙为星在嵗轮上行之度【与星距太阳实行之度相等】即相距度也
　　乙丙则距余度半之为辛丙则距余半也　乙辰为星巳过冲日之度则甲角度也
　　今已知嵗轮心实行之度又已知星在嵗轮上行之度所不知者视差角耳盖自本天心夘作实行线过甲心至黄道又从夘作视行线过乙星体至黄道其差为夘角是故求次均者求此夘角也
　　用上法以距日【即距心】为一邉【甲夘】以星数为一邉【甲乙】以星行过冲日之度【即乙辰】为一角【甲角】成甲夘乙三角形依上法得夘角即次均也
　　一率　距日与星数之总【即甲夘并甲乙亦即甲丙】二率　星数减距日之较【即辰夘】
　　三率　距余半之切线【即半夘角之切线辛癸盖乙甲丙角为距余即乙甲夘角之余度半之为辛甲丙角即距余半】
　　四率　减之正切线【即辛壬其角为辛甲壬】
　　末于辛甲丙【距余半角】内减去辛甲壬【减角】余成壬甲癸角与夘角等得视差之度如所求
　　既知三角形用切线之法尤当进而明其所以用切线之理
　　如后图乙甲夘三角形　甲角一百五十度　甲乙邉六十甲夘邉一百　两邉之总一百六十为首率两邉之较四十为次率　甲角之余角半之求切
　　线为三率【即率癸】　求得四率为半较角之切线辛壬求其度以减半余角得夘角
　　何以用切线也曰此分角法也凡外角【乙甲丙为乙甲夘之余角亦为外角】内兼有形内余两角之度【乙甲丙外角兼有夘角及甲乙夘角之度】试作壬甲线与乙夘平行分外角为两则壬甲丙角如








　　夘角矣【以壬申及乙夘皆平行线而丙甲夘未一直线故其作角必等】
　　外总角内减去同夘角之壬甲丙角则其余壬甲乙角必为甲乙夘角矣
　　今但有外角为总角而不知其分角故以比例分之而切线则其比例也
　　又试作乙丙线为外角之通又从乙作正线至丁为乙甲壬大角之正从丙作正线至戊为壬甲丙小角之正而通遇壬甲分角线于子成乙子及子丙两线此大小两线之比例与大小两角之正比例等何也乙子丁勾股形与丙子戊勾股形以子为交角则相似而乙子【大】与子丙【小】若乙丁【大股】与丙戊【小股】矣
　　又甲夘大邉与甲乙小邉原若所对之大角正【乙角】及小角【夘角】正【凡三角形邉之比例与对角正之比例皆等】即乙丁与丙戊也【角同则正同】则甲夘与甲乙亦若乙子与子丙矣
　　又试作辛甲线分外角为两平分而各作切线为辛癸为辛己【即半外角之切线】则两切线聨为一【己癸】而与乙丙平行又引壬子线割之则分为二线而己壬与壬癸之比例若乙子与子丙亦若甲夘与甲乙矣
　　又作庚甲线使庚己如壬癸则庚壬为两线之较己癸为两线之总
　　而甲乙甲夘两邉之较为辰夘其总为丙夘
　　甲夘大邉与甲乙小邉之比例既若大线【己壬】与小线【壬癸】则两邉之总与较亦必若两线之总与较矣
　　一率　丙夘【即甲乙甲夘两边之总】
　　二率　辰夘【即两邉之较】
　　三率　己癸【即己壬壬癸两线之总】
　　四率　庚壬【即两线之较】　　　　今各半之
　　辛癸半总【即半外角辛甲癸之切线】
　　辛壬半较【即半较角辛甲壬之切线】
　　既得辛壬切线查表得其角度即半较角也以半较角减【辛甲癸】半外角即半角也
　　若以半较角加【乙甲辛】半外角亦即甲乙夘角矣
　　火星测算本法图説【明厯书之倒算】
　　嵗圏半径【六四七三八】甲乙
　　查加减表八宫十九度【四十分】　半径数【六四○八七三】太阳引数星纪二十三度加六宫为六宫二十三度日差【一○一六】相并得【六四一八八】为星数与所测防差
　　若用实引得半径【六四四二五】其数益相近
　　距心数【九九六九七】寅乙
　　平引八宫一十九度【四十二分二十秒】
　　加均数　一十度【三十三分三十秒】
　　实引九宫初度【一十五分五十秒】
　　查加减表八宫一十九度【四十分】距日【九九七○一】所差不多若用实引则距心【一○一六七四】差稍大然按图用乙寅线宜用实引










　　图説本宜用寅防为嵗轮之心以寅乙申角为嵗轮上视差角即寅未也
　　寅申线则嵗轮之半径也此为本法
　　今厯书所载地谷图不于寅心作嵗轮圏而以甲为心盖因戌寅亥角与寅乙申视角同度【切线法用此角以代乙角】而甲寅乙角者戌寅亥之交角也凡交角皆同大则甲寅乙角亦即寅乙申视角矣既以甲寅乙角为所测视角则乙防即可为嵗圈之心而甲乙寅角可代乙寅申角矣故以嵗圏上星过冲日之度【冲日即近防亢星过日冲即乙寅申角亦即亢申】移作寅乙甲角自乙嵗圏心依角度作乙甲线与寅甲线遇于甲【先有乙寅甲角自有寅甲线】则甲防即嵗轮上星所到度可代申防而甲乙即嵗轮半径可代寅申矣故以甲乙线为半径者巧法也
　　然则当以乙为嵗轮之心用代寅防矣何又以甲为心乎曰甲乙既为半径则以乙为心甲为界或以甲为心乙为界其半径等为甲乙也故倒以甲为心其法与诸加减表説作差角于圏界者同也【先倒作均角于寅界法同两术中惯用此倒算之法】
　　然则以甲为地心何也曰此则其移人耳目之法也何以言之彼固言甲乙为嵗轮半径矣又以甲心乙界之轮为嵗轮矣甲既为嵗轮之心又安得为地心乎然则地心安在曰以理论之仍当以乙防为地心耳何也星之实经在寅其视经在未寅未之成寅乙未角此固实测之度也实测差角从地上得之安得不以乙为地心乎若谓乙为日体则日之去地逺矣日体所见之差角与测所见之差角必有分也而今不然故不得以乙心径为日体也
　　非地心而地心之何也盖所以使人疑也其使人疑奈何嵗轮心之非地心易见也乙防之非日体难知也以其所易见例其所难知疑则思思则得矣　地心既非地心则日体亦非日体然则其中机彀固以示之矣又论曰借甲为地心妙在作戊己线与乙寅平行葢甲己既与乙寅平行则己甲寅角即甲寅乙角亦即寅乙申均角而甲地心所作之十二宫度一切皆与乙心所作之度相应矣此用法之巧也
　　先以乙寅甲角代寅乙申视角而取甲乙线以代寅申半径是倒算也复以甲为心乙为界作嵗圏以甲心代乙心亦倒算也两番倒算而倒变为顺故甲可代乙为地心即本天心也而甲己线与寅乙平行即地心所指实行之度也己甲寅角即视差角也寅甲线即视行指线与申乙同也故天度皆应可作十二宫分细度也若于乙作嵗圏则但能得半径而十二宫之向皆反矣故借甲为心法之巧也
　　乂取甲为心影出火星能入太阳天之象其实火星入太阳天者乃其嵗轮上度非嵗轮心也若真以此为嵗轮心则火星体将过地心而与日同度如金水矣又用甲为心作十二宫则细度可不碍书若用本法则有两小轮各线相襍而不能详书细数故移乙心于甲移寅乙申角为己甲寅角也呜呼可谓巧之至矣但未説破故后学遂妄为作解耳
　　论曰既火星初均在寅即当以寅为嵗轮心而今不然何耶曰此巧算也甲寅乙角即寅甲己角也何也甲己与乙寅平行也即均角也又乙寅者嵗轮心距日数也乙甲者半径也寅乙甲角者先有之角即星日相距之余数也即己过日冲之度本法以距日数及半径为两邉与先有之角求均数角今先测得均角而无半径故反用其法以求半径法之巧也盖先有两角一邉而求余邉之法也
　　一率　甲角之正　【有乙寅两角自有甲角】二率　乙寅邉　　　【即距日数实为嵗轮心距本天心】三率　寅角之正　【即均角乃所测视行与实行之差度】四率　甲乙邉　　　【即嵗轮半径包有日差在内】
　　由是言之甲乃嵗轮心耳非地心也若甲真为地心则甲乙非嵗轮半径矣
　　火星次均解　查火星嵗轮半径与本天半径略如六与十宜即用为比例作图则所得均角亦近【后数系初稿存例非火星正用】













　　图説　乙甲夘三角形有甲角一百二十度有甲夘邉一百　乙甲邉四十一　求夘角　乙角　乙夘邉
　　法曰以乙甲甲夘二邉并得一百四十一为总【即丙夘】为一率又相减得五十九为较【即辰夘】为二率　丙甲乙外角六十度半之得三十度【即辛甲丙角】其切线五七七三五【即辛癸】为三率求得【壬辛】为四率得二三九八八查表得十三度二十九分四十秒収作三十分【即辛甲壬角】以辛甲壬角减半外角【辛甲丙角】得壬甲丙角十六度三十分即夘角也　又以辛甲壬角加辛甲丙【即辛甲己】得壬甲己角四十三度三十分【亦即甲乙夘角】末以甲乙夘角四十三度三十分之正六八八三五为二率乙甲四十一为三率全数为一率法为全数与乙角之正若乙甲与甲午也得甲午　又甲乙夘角之余七二五三七为二率乙甲四十一为三率全数为一率法为全数与乙角之余若乙甲与乙午也得乙午　用勾股以甲午幂减甲夘幂余数　开方得数
　　为午夘乃并乙午午夘共为乙夘邉
　　一系甲夘如火星距心线【即表中距日数】
　　甲乙即如火星嵗轮半径【即表中半径加日差为星数之数】丙甲乙外角即如火星行嵗轮上离合伏之度【即日星相距度】
　　丙甲辛角即如火星半距度【辛癸其切线】
　　壬甲辛角即火星减【壬辛其切线】卯角即均角
　　一系丙防如嵗轮合伏度　甲为嵗轮心　夘为本天
　　心　丙甲夘线即嵗轮心平行线
　　一系丙夘乙均角在前六宫是平行线东为加
　　一系嵗轮上加减以夘亥切线所到为限自丙防以至亥防距合伏度渐从小至大其均度渐増过亥防至辰冲日距度渐从大至小均度渐减盖距合伏度大则半距亦大反之则小也
　　一系星行嵗轮过亥防则距度大而减更大故均数
　　渐减
　　如图星行至未成甲未夘三角丙甲未外角半之于酉而壬甲酉为减其得均角夘与星行在乙等
　　若欲知未甲辰角法用三率求之
　　一率　甲未邉　　二率　夘角正
　　三率　甲夘邉　　四率　未角正
　　既得未角以并夘角而减半周其余即甲角也
　　星行到乙与星行到未同以夘角为均度

<子部,天文算法类,推步之属,历算全书,卷十七>
<子部,天文算法类,推步之属,历算全书,卷十七>
　　一系星之离日有定距
　　一系星之嵗轮与日天略等
　　一系日距星为日离星而东日速故也
　　星距日为星离日而西星迟故也
　　一系日距星为日天之度星距合伏为嵗轮之度一系论右旋则日速星迟若左旋则星反速于日故嵗轮心渐逺于日可称左旋而嵗轮上围日之象亦左旋也
　　一系星有迟速皆嵗轮心之行而星行嵗轮邉成围日之行则
　　五星一理
　　一系星本天右旋星在嵗轮上亦右旋而星围日之行左旋此外仍有自行之髙卑故土星能至甲木能至乙至丙火能至丁各天故不甚相逺
　　自人所见五星所当宿度则距日有逺近之殊而五星在天以径线距太阳终古如一以此图观之见矣
　　所异者五星各有髙卑本轮则有微差而火星则兼论太阳髙卑要不能改其径线相距之大致
　　算火星前均及距地心线用简法　依表説用两小轮图设平引三十度依表説算得均角四度五十分加减表四度五十分七秒　表説差七秒
　　今用简法得四度五十分十秒　只差三秒
　　表説又算距心一十○万九千九百○三加减表是一十一万○○一十三差十万分之一百一十【数见表首巻第四章称为火星年嵗圈心距地心数】今用简法得一十一万○○一十九只差十万分之单六又原法用勾股作垂线以求角求邉








　　今用简法以半外角切线乗两邉之较为实两邉之总为法除之即得半较角以减半外角即为均角工力较前省半其小轮上加减之角用小轮半径四与一之比例乗除工力尤省数倍
　　求邉之法只用对角之正比例工亦省半
　　窃意立表时当是用此法
　　凡诸表数或是西人成法翻译成书或是厯局依法算演俱不可攷然是入用之数当以为主
　　火星平引三十度算得均角四度【五十分十秒】距心线【一十一万○○一九】查表均角四度【五十分七秒只差三秒】距心【十一万○○一三只差十万分之单六】可谓宻近丙戊甲三角形　求甲角　及戊甲邉　丙甲为一四八四○丙戊三七一○　其比例为四与一
　　简法其总为五其较为三　丙角六十度【引数之倍】　先求甲角法以丙角减半周得余外角一百二十度半之六十度查其切线一七三二○五以较【三】因之总【五】除之得一○三九二三查切线表得其度为四十六度六分○八秒为半较角以半较角减半外角六十度余一十三度五十三分五十二秒为丙甲戊角
　　表説甲角十三度五十四分是不用秒数也
　　次求戊甲邉
　　法以甲角之正【二四○二○】为一率　丙戊邉【三七一○】为二率　丙角之正【八六六○三】为三率　求得戊甲邉【一三三七六】为四率次戊甲丁三角形　有甲丁邉【一○○○○○】　有先求到戊甲邉【一三三七六】　有甲角【以求到戊甲丙角加引数丙乙三十度共得四十三度五十四分弱为戊甲乙外角余一百三十六度六分强为甲丙角】
　　先求丁角【即三十度视差角】
　　法并【甲丁戊甲】两邉得总【一一三三七六】为一率　又两邉相减得较【八六六二四】为二率　半外角得【二十一度五十七分弱】之切线【四○三○○】为三率求得半较角切线【三○七九○】为四率
　　查表得角【十七度六分五十秒】以减半外角余四度【五十分一十秒】即丁角次求戊丁线【即表距日数实即嵗轮心距地心之数】
　　法以丁角之正【八四二六】为一率　戊甲邉【一三三七六】为二率　甲角【用余角四十三度五十四分弱】正【六九三三八】为三率　求得戊丁邉【二○○一九○】为四率
　　一系凡两小轮有比例者俱可用简法求角七政并同一系凡三角形有一角在两邉中者遇其邉有比例可用简法土星　自行轮半径八七二一小均圏半径二九○七　其比例为三与一　其总为四　其较为二　总与较之比例为折半简法【但以半外角之切线折半即得半较角】
　　木星　自行轮半径七一五五　小均圏半径二八三五　其比例亦为三与一【法同土星】
　　金星　自行轮半径二四○六　小均半径八○二　其比例为三与一【法同土木】
　　水星　地谷宻测自行轮半径六八二二　小均轮一一三七其比例为六与一　总为七较为五　法用五因七除多禄某旧法自行轮九四七九　小均轮一五八○　其比例为六与一而强
　　太隂　本轮半径【八千七百】三平分之二为新本轮半径【五千八百】一为均轮半径【二千九百】其比例为二与一其縂为三其较为一法用三为法以除半外角切线得半较角
　　朔望次轮半径二千一百七十旧为二千三百一十此朔望轮地谷转用于地心之上
　　太隂朔望次轮全径四千三百四十以全加于本轮半径则一万三千○四十故两之加减至七度四十分　然以比五星嵗轮则太隂最少
　　太阳　两心差三五八四　折半一七九二
　　王寅旭法两心差三八八三八八收作三五八四　小均轮半径为两心差四之一　第一均轮半径为两心差四之三两均轮之比例为三与一　其总四其较二亦折半比例也与土木金三星并同
　　加减差图説以两心差折半作角盖谓此也
　　两均轮比例
　　求七政各小轮半径法具厯书今只定其大小之比例
　　两心差火星最大为一万八千五百竒　次土星一万一千六








　　百竒　又次木星○万九千九百九十　又次太隂八千七百又次水星七千八百五十　太阳数少三千五百八十四　金星更少只三千二百○六
　　上三星轨迹成绕日圆象
　　五星本天并以地为心与日月同至若嵗轮【即古法迟留逆伏之叚日】则惟金水二星绕太阳左右而行其嵗轮直以日为心土木火三星则不然并以本天上平行度为嵗轮心【金水以太阳为嵗轮心亦以二星之平行与太阳同度也】然其轨迹所到并于太阳有一定之距故又成绕日左行之圆象西人所立新图不用九重天而五星并以太阳为心盖以此也然金水嵗轮绕日其度右移上三星【土木火】轨迹其度左转若嵗轮则仍右移耳
　　七政前均简法【订火纬表説因及七政】
　　西法用表如古法之用立成不得其列表之根表或笔误无从订改矣故有表説以发明之然或表説所用之数有与表中互异者则是作表者一人作表説者又一人也余因查火星之表而为之推演然后知立表之法甚简洵乎此心此理不以东海西海而殊





　　厯算全书巻十七
　　钦定四库全书
　　厯算全书卷十八
　　宣城梅文鼎撰
　　七政细草补注
　　推日躔法
　　先查年根【冬至后一日子正距冬至】随录本年髙冲【年根子正髙冲】后查日数【本日子正距冬至后一日子正之平行】随录髙行【亦本日子正距冬至后一日子正之髙行】高行加入高冲书于高冲格内【即本日高冲所在】年根日数相加得平行【即本日距冬至之平行】平行内减去髙冲为引数【即得本日子正距高冲】以引数查加减表相较【用中比例】得均数随记加减号均数依号加减于平行即得细行【人目所见视度】细行内按宫度减宿次即得本日宿也
　　鼎按年根者冬至后一日子正之平行也日数者毎日之平行也故相加即为本日之平行
　　邵本云凡算宿钤以戊辰年为主毎年加五十一秒所积之秒以六○归之加于宿钤之内再与细行相减
　　髙冲者太阳最卑防距冬至之度毎年东行一分推月离法
　　先查四年根独正交行加六宫后查四日数俱年日相加得三平行而正交年日相减为正交平行书本日太阳细行即按细行宫度查日差表得数记书加减号按数至时刻平行表内查得日差两书之依号加减于平行总平行引以平行引查加减表相较【中比例】得均数记加减号均数依号加减于平行总平行引即为实行实行引实行内减去太阳度为月距日次引以月距日次引同实行引宫度查表【二三均数表】相较得次均次均依号加减于实行即白道经度【邵本云即白经恒减】以月距日次引查交均记加减号随查大距数交均依号加减于正交平行即正交经度正交经度加六宫即中交置白道经度内减去正交经度即月距正交以月距正交查白道同升差表得同升差记加减号白道经度与同升差依号相加减为黄道视行以月距正交与大距数查纬表【即黄白距度表】得视纬减宿照日躔减法同
　　邵本云录本日太阳细行而太阳恒减以太阳恒减查日差表记得数于旁加减号记于月离日差之旁次将所得之数查时刻平行表如查出之数只分秒耳即日差以两平行与日差照号加减得平行总平引
　　又云以月距日次引查二三均表直行以实行查横行所遇之处即得
　　如月距日次引过六宫减去然后查表
　　内行宫度顺查外行宫度逆查而粗格所在即加减所分
　　按杨学山云月之二三均数以距日而生与五星嵗轮同理但其行法却异于五星兼有又次轮附于次轮之上与次均相消相长表乃二均三均之总数故与五星次均表絶殊其加减之句亦不以六宫而分○月之交均距限亦以距日而生地谷以前无之也推土木星法
　　先查两年根【冬至后一日子正星距冬至及引数】后查正交行再查日数【年根距冬至及引数之下各书日数】两书之年日相加得平行平引【年根距冬至引数各加日数为平行与平引即所求本日子正】以平引查加减表相较【中比例】得均数随录中分【加减表中分】记书加减号均数依号加减于平行得实经【嵗轮心所到】即书本日太阳细行【日躔条求得数】于格太阳内减去实经即次引【本日星在嵗轮距合伏】以次引查次均随得较分亦相较【中比例】记书加减号中较相乗六十归之得三均三均与次均恒加即定均将定均依次均号加减于实经即视经【迟留逆伏之度】减宿照日躔减法同置实经于交行下内减交行即得距交【所求日星距正交】以距交查中分【纬表内之中分】以次引【即前所得嵗轮上星距合伏】查纬限中纬相乗六十归之得视纬定南北以距交宫度定之前六宫【○一二三四五】号北后六宫【六七八九十十一】号南
　　按学山云五星三均恒用加者以嵗轮心自最髙至最卑次均皆渐大而表所列次均数乃置轮心在最高时算也
　　五星加减表中分是从高卑立算纬度中分是从交防至半交立算乃厯家简括之法若依三角形算则不用中分矣
　　推火星法
　　先查两年根【距冬至引数】随录正交行后查日数【两年根之下各书日数】两书之年日相加为平行平引以平引查加减表相较【中比例】得均数即书加减号均数依号加减于平行得实行实引随录本日太阳细行太阳内减去实行得相距若相距过六宫则于实行内减去太阳得距余减距余之半即得距余半此系后六宫者若前六宫即将相距减去一半为半距无距余半太阳内减去髙冲改作对冲宫为日引【加六宫即是从最髙起】以实引查距日及半径以日引查日差半径日差相加得星数【星数即歳轮半径】星数与距日【距日即嵗轮心距地】相加为总相减为较以距余半查八线表即得半距切线数与较相乗又以总数除之得数再查八线表取相近切线用之即得减弧半距或距余半内恒减去减弧得次均即看相距在前六宫者加【嵗轮上从合至冲】后六宫者减【从冲至合】依号加减于实行即视行宿次照日躔减法同实行内减去正交即距交以距交查中分以相距【日星相距】查纬限【先定南北】纬有加减分距交在北者依号加减为定纬限中分纬限相乗六十归之得纬以距交定南北前六宫是北后六宫是南
　　按距日半径俱以实引取之查各式并同天学防通亦同
　　按前六宫是自合伏至冲日后六宫是自冲日复至合伏皆以嵗轮言
　　邵本于半距切线下注云从距日至再查切线俱逢十进之
　　按杨学山云火星半距总较切线等用是斜三角形有一角二边求余角之法也五星皆可用惟日差星数火星所独耳
　　推金水星法
　　先查三年根【引数伏见距冬至】后查太阳日数两书之【即用为星平行日数两书于引数及距冬至下　金水距冬至平行即日躔表数也金水以太阳为平行之心】再查本星表内日数【此则伏见平行之日数】书于伏见行下年日相加得各平行以引数平行查加减表相较【中比例】得前均即书加减号随得中分【加减表中分】前均依号加减于各平行得实经实引独伏见行下前均加减号反用得伏见实行【反用均数加减伏见平行为伏见实行】以伏见实行查二均亦相较【中比例】书加减号随得较分中较相乘六十归之得三均二均三均恒加即定均并均依号加减于实经即视经减宿与日躔法同实引内恒加十六度【金星正交在最髙前十六度】即得次实引【即星距正交】以次实引查前中分【前纬表中分】以伏见实行查前纬限中纬相乗六十归之记书南北号其后中分【后纬表中分】后纬限【亦以距交查后中分】亦照前纬查法同【以伏见实行查后纬限】亦书南北号如前后纬号同者两纬相加【俱南纬俱北纬则相加】如号异者两纬相减【一南一北则相减】即得视纬其南北以数大者定之【若异号相减则以南纬大者命其减余为南北大者则命为北】　水星照此推法同独无次实引【水星正交与最高同度即以实引为距交】
　　金水伏见行即土木之次引也
　　土木以星行嵗轮心与太阳相减得次引者是星距日度即嵗轮上距合伏之度
　　金水则伏见轮心即太阳无可相减故另有伏见之行
　　金水次实引即土木之距交也
　　因水星即用实引数为距交故金星别之为次实引然殊乱人目不若直名之距交
　　邵本查后中分后纬下有云必中纬同在一篇者方可用以便定南北
　　学山云金水纬行独有前后二表者以二星之纬皆由伏见轮而生而伏见轮小于黄道斜交侧立旋居于本天之周作表须前后两表以该之非星纬实有前后之分也
　　学山云金水伏见实行与初均加减号相反者以伏见轮心之角斜线错列适与初均成相反之势故反加减之得星合伏真度非伏见之行与本轮相反勿误认袁説
　　推火星诸行假如【甲申年距根一百三十五日】
　　距冬至平行　查【本星】二百恒年表【本年下】距冬至横行【一十一宫○六度五十三分五十九秒】随查日数【二宫十度四十五分】日数与年根并之得【一宫十七度三十九分】
　　引数平行　　查恒年表【本年下】引数横行【三宫七度○五分二十七秒】日数与距冬至同　年根日数并之得【五宫十七度五十分】
　　初均数　　　以引数平行查【本星】加减表得【二度三十分四十二
　　秒　其号顺减书减号于均数之旁】随录距日数
　　距冬至实行　以【本星】平行内减去初均数得【一宫一十五度○八
　　分　以均数之号为加减】
　　引数实行　　以本平行内减去均数之全数得【五宫十五
　　度十　以均数之九分　号为加减】
　　太阳　　　　即录本日日躔细行
　　相距　　　　以太阳内恒减去距冬至实行得【二宫二十
　　九度三十五分】
　　半距　　　　即以相距半之　若相距过半周则借全周内减去相距全分即为距余再将其较半之即距余半也
　　日引　　　　以本日太阳加六宫减去日躔表内本
　　年下最髙冲得【十宫八度三十一分】
　　距日　　　　以引数实行查加减表得【八九三七四○】　勿
　　庵按距日半径俱宜用实行
　　半径　　　　以引数实行查加减表得【六三○七一七】
　　日差　　　　以日引查之得【○一九一四四】
　　星数　　　　以半径恒加日差得【六四九八六一】
　　总数　　　　以距日内加星数得【一五四三六○一】
　　较　　　　　距日内减去星数得【二四三八七九】
　　半距切线　　以半距全分查八线表正切线得【九九二四
　　七】
　　减弧　　　　以较数与半距切线相乗得【二四二○四二五九一一三】　又以总数除之得【一五六八○】以此查正切线得【八度五十五分】
　　次均　　　　半距内恒减去减弧得【一宫五度五十二分】
　　视行　　　　以实行内加次均全分得【二宫二十一度】
　　正交　　　　查【本星】恒年表【本年下】正交横行得【四宫十七度十
　　三分】
　　距交　　　　以实行内恒减去正交得【八宫二十七度五十】
　　中分　　　　以距交查首卷本星纬度得【五分六】
　　纬限　　　　以相距查纬表得【十分一度二十】
　　视纬　　　　以纬限数化作【九分八十】与中分【九分六】相乘得【十分五千三百四】为实以六十为法除之得【十分八十】以六十分成度得【九分一度二十
<子部,天文算法类,推步之属,历算全书,卷十八>】
　　推凌犯法
　　月犯恒星以本年七政厯与恒星钤表恒星经度及南北纬度月在上相距二度内取月在下相距一度内取之又以本日与次日之月视行相较化分为一率日法一千四百四十分为二率恒星经度内减月经度之较化分为三率二三相乘一率除之得凌犯时刻
　　月犯五星以本年七政查月与五星经度及南北纬度月在上相距二度内取月在下一度内取之次以本日之月视行内减次日之月视行取其较又以五星本日经度内减次日经度取其较视星顺行者两较相减逆行者两较相加化分为一率日法一千四百四十分为二率以本日五星经度内减月经度为月未及星之距化分为三率求得四率为凌犯时刻
　　五星犯五星以本年七政五星经度及南北纬度相距一度内取用五星各以本日经度与次日经度相减得较如俱顺俱逆者两较相减一顺一逆者两较相加化分为一率日法一千四百四十为二率又以本日五星经度两相减之较化分为三率如法求得四率为凌犯时刻
　　五星犯恒星以本年七政与恒星钤表经度及南北纬度相距一度内取用次以五星本日经度内减次日经度得较度化分为一率日法一千四百四十为二率又置恒星经度内减本日五星经度得较度化分为三率如法求得凌犯时刻为四率若五星退行者以五星经度内减恒星经度为三率
　　月与星一度为犯十七分以内为凌同纬为掩　五星与星一度为犯三分以内为凌同纬为掩
　　视凌犯时刻在地平上者取之若在地平下可勿推算定上下以北为上南为下月纬星纬同在北以月纬多者在上少者在下月纬星纬同在南则以月纬多为在下少为在上其两纬相减　若星月一南一北则以月南为在下月北为在上两纬相加
　　推月星凌犯密法
　　依本年七政厯并恒星钤视恒星经度及南北纬度月在上二度内取之月在下一度内取之又以恒星经度内减本日之月视行得度化分为二率以一千四百四十分为三率本日之月视行相减其较数度分为一率二三率相乘以一率除之即得时刻
　　一求太阳细行　以一千四百四十分为一率次日细
　　行与本日细行相减得较为二率凌
　　犯时化分为三率二三率相乘一率
　　除之得四率以四率加于本日细行
　　得太阳细行
　　二求时分　　　以太阳细行查交食四卷内【九十度表】得
　　时分太阳度过三十分进一度查表
　　得数即是
　　三求总时　　　以时分及凌犯时刻午后减十二小
　　时午前加十二小时满二十四时去
　　之余为总时【即应时】
　　四求九十度限　以总时查交食四卷表与时分相对
　　者录之得九十度限
　　五求恒星经度　置恒星经度
　　六求限髙度　　以九十度减距天顶之度分得限髙
　　度
　　七求月实引　　置月离内月实引
　　八求月距地【半径】　以月实引查交食二卷表内得月距
　　地半径【邵本作查交食表二卷内视半径】
　　九求月实行　　以月实引查交食二卷表内得月实
　　行
　　十求星距限　　九十度限之宫度分内减星之经度
　　宫度分为限大则星在西若不及减
　　置星经度内减九十度限之宫度分
　　为限小则星在东
　　【十一】求置正交【经度】　置月离内正交经度
　　十二求较数　　以正交经度内减九十度限宫度若
　　九十度限不足减则加十二宫减之
　　即得较数
　　十三求真髙度　以较数查交食二卷太隂距度表得
　　月实纬分北加南减于限髙度得真
　　髙度六宫以上定北加以下定南减
　　十四求地平差　以真髙度并月距地半径求地平差
　　【见交食九卷表】
　　十五求时差　　以地平差变为髙下差【查交食表九卷】及星
　　距限度求时差
　　十六求较数　　以真高度置九十度减之余为较数十七求气差　　以较数及月距地半径求气差【交食九卷
　　表内】月距地半径查上横行以较数查
　　右直行
　　十八求月实纬　以凌犯时刻化分为三率本日之月
　　纬度与次日纬度相较得数化分为
　　二率与凌犯化分相乘以二十四小
　　时化分为一率除之得数加减于本
　　日纬度视南北号顺加逆减即月实
　　纬若南北异号以两数相加为二率
　　后除得之数用减本日纬度以次日
　　之号定南北
　　十九求视纬　　以月实纬度南加北减于气差得视
　　纬
　　二十求恒星纬　置恒星纬度分
　　廿一求月距星　月视纬北多定上月视纬南多定下
　　以大减小一度以外不用得月距星
　　如一南一北两数相加
　　【廿二】求凌犯时刻　置凌犯时刻
　　廿三求定时差　以月实行分为一率时差分为二率
　　六十分为三率二三率相乘一率除
　　之得四率有六十分进一时十五分
　　进一刻得定时差
　　廿四求视时　　以定时差加减于凌犯时刻即得凌
　　犯视时视星距限度西加东减
　　南北异号【月南在下月北在上两数相加】
　　南北同号　　同【北南】月纬大在【上下】月纬小在【下上】两数相减
　　按凡推月与五星及恒星凌犯用此式较密
　　攷节气法【用变时表依法查之更密】
　　凡半月一节气遇细行一十四度与二十九度即是交节气之日次日细行与本日细行相减减余化秒为一率置六十分以本日细行分秒减之减余化秒为二率化二十四小时为一千四百四十为三率二三率相乘以一率除之得数即四率其分秒用六归之收作时刻分　查节气日差加减表【在日躔二卷内凡六十分为一小时若过半分作一分用】一百二十分为一大时十五分为一刻如不满一刻作分算时自子正起算
　　二十九度与次宫○度相较为气
　　十四度与十五度相较为节
　　查二至限法
　　以二至度为主加以本日太阳经度未满宫度之余分即是二至限　如冬至日经度为二十九度二十五分【即此廿五分为未满之余分也】　而本至宿为箕三度三十五分加二十五分则为冬至限在箕四度
　　假如五月初十日太阳在申宫二十九度二十三分宿在觜十度十二分
　　问曰夏至限系何宿度分　答曰觜宿十度四十九分
　　假如十一月二十日太阳在寅宫二十九度十五分宿在箕二度五十六分
　　问曰冬至限系何宿度分　答曰箕宿三度四十一分
　　假如正月十四日太阳在子宫十四度二十一分八秒十五日太阳在子宫十五度二十二分三秒
　　问曰立春系何时刻　答曰申初初刻十分
　　假如二十九日太阳在子宫二十九度三十一分二十五秒
　　三十日太阳在亥宫初度三十一分十四秒
　　问曰雨水系何时刻　答曰午初一刻六分
　　定合朔望法
　　合朔　以月距日次引满十一宫二十余度此日即合朔也满十二宫即○宫是合朔之次日也
　　求合朔时刻【凡星同度法同】
　　以本日太阳与次日太阳相减得较数另记又以本日之月视行与次日之月视行相减得较仍以两较数相减得数化分为一率以一千四百四十为二率又置本日太阳减去本日之月视行得数即月不及日之度为三率二三相乘一率除之得数再以六十分收之为时余以十五分收为刻即得时刻及分
　　假如正月初一日太【阳隂】在子宫【十四度十五分二十秒十度二十三分十二秒】初二日太【阳隂】在子宫【十五度十四分六秒二十三度三十分三十一秒】问曰合朔系何时刻　答曰辰初二刻八分
　　相望　亦以次引满五宫二十度之上将近六宫即是望也到六宫即望之次日也
　　求望时刻
　　以本日与次日太阳之较及月视行之较相减化分为一率以一千四百四十为二率又置本日之月视行内减去本日太阳其余宫度分上辏满三宫望辏满六宫下辏满九宫将辏满之数化分为三率二三相乘一率除之得数再以六十收之为时刻分
　　假如十六日太【阳隂】在【戌辰】宫【十五度十六分九秒六度三十分二十一秒】十七日太【阳隂】在【戌辰】宫【十六度十五分十六秒十八度二十九分三十五秒】问曰望系何时刻　答曰戌初初刻七分
　　上　以次引二宫二十余度将近三宫即上也若满三宫即为上之次日也
　　假如初八日太【阳隂】在【亥申】宫【八度三十四分八秒七度五十八分四十秒】初九日太【阳隂】在【亥申】宫【七度三十四分二十秒二十度五十五分十六秒】问曰上系何时刻　答曰丑初初刻十分
　　下　以次引八宫二十余度将近九宫即是下也若九宫一二度即下之次日也
　　假如二十三日太【阳隂】在【酉子】宫【二十一度十一分二十秒十一度三十三分六秒】二十四日太【阳隂】在【酉子】宫【二十二度八分十六秒二十五度二十八分三十秒】问曰下系何时刻　答曰酉初三刻四分
　　求月入宫法
　　以次日宫度分内减去本日宫度分余度分化分为一率本日未满整宫之余度分亦化分为二率一千四百四十为三率二三率相乗一率除之即得时刻
　　假如正月初七日太阴在戌宫十八度三十一分初八日太阴在酉宫一度二十四分
　　问曰月入宫系何时刻　答曰亥初一刻八分入酉宫
　　求月升法
　　以朔日之月离宫度定之
　　子宫十五度至酉宫十五度为正升
　　酉宫十五度至未宫初度为斜升
　　未宫初度至寅宫十五度为横升
　　寅宫十五度至子宫十五度为斜升
　　假如正月初一日月在丑宫十八度四十六分
　　问曰月系何升　　答曰系斜升
　　求月孛罗计法
　　以本年所推月离稿内毎月初一十一二十一三日月孛实行正交经度中交经度内减本年宿余减宿即得三宿分
　　假如正月初一日月孛实行在己宫八度四十四分本年宿钤在己宫一度八分为张宿
　　问曰月孛系何宿度分　答曰张宿七度三十六分求五星伏见
　　土木火三星与太阳合伏后为晨见　合伏前俱称夕与太阳冲后为夕见　冲前为晨【葢星行迟太阳行速故也】
　　金水二星顺行与太阳合伏曰夕　逆行合伏曰晨假如土星四月十九日合伏
　　问曰土星合伏前后应晨应夕见与不见
　　答曰合伏前系夕不见合伏后系晨见
　　假如水星五月十二日与太阳冲
　　问曰太阳冲前冲后应晨夕见与不见
　　答曰冲前系夕不见冲后即晨见【按水星不冲日今云尔者葢退合亦冲之属也　当云退合伏前系夕不见退合伏后即晨见】
　　求五星冲伏同度时刻法
　　两星各以次日行与本日行相减得较　两较相加减为一率同顺同逆两较相减一顺一逆两较相加一千四百四十为三率二三率相乘以一率除之得时刻
　　假如正月十八日【土水】星在子宫【二十六度四十九分二十六度三十三分】十九日【土水】星在子宫【二十六度五十六分二十八度一十七分】
　　问曰【土水】二星系何时同度　答曰寅初三刻十二分
　　假如正月二十五日【太阳水星】在亥宫【二十八度三十分二十八度四十二分】二十六日【太阳水星】在亥宫【二十九度三十分二十七度四十二分】
　　问曰水星系何时与太阳合退伏　答曰丑正一刻九分
　　假如二十日【太阳土星】在【丑未】宫【三度二十六分四度十分】
　　二十一日【太阳土星】在【丑未】宫【四度二十四分四度六分】
　　问曰土星系何时与太阳冲　答曰酉初初刻一分
　　假如二十八日【太阳木星】在子宫【二十七度三十分二十七度五十五分】二十九日【太阳木星】在子宫【二十八度三十分二十八度二分】
　　问曰木星系何时与太阳合伏　答曰午初一刻四分
　　求五星退入宫法
　　本日度分内减去次日度分其较为一率本日余分为二率【度以上不算止用余分】一千四百四十为三率二三率相乘以一率除之得时刻
　　假如二十六日金星在戌宫初度三十二分
　　二十七日金星在亥宫二十九度三十八分
　　问曰金星系何时退入某宫　答曰未正初刻十三分退入亥宫
　　求五星顺入宫法
　　以次日宫度分内减去本日宫度分余度分化分为一率诸法俱与月入宫法同【如退入宫者则于本日宫度分内减去次日宫度分得数化分为一率以日法为二率即以本日初度分为三率依法求之】
　　假如正月初三日水星在丑宫二十九度四十六分初四日水星在子宫一度三十五分
　　问曰水星系何时刻入某宫　答曰寅初初刻四分入子宫
　　求五星最髙卑中距法
　　凡三宫九宫为中距　○宫为最卑　六宫为最高火金水三星以实引次实引查　土木星以平引查假如土星平引在四宫八度二十分
　　问曰从何限之上下行　答曰中距下行
　　求五星留逆法
　　凡五星经度自一度二度而行者为顺如从十五度十四度而行者为逆　本日系十度五分次日仍十度五分者为留第三日系十度六分为留顺初如系十度四分三分为留退初
　　求五星伏见法
　　以天球安定北极出地如四十度求晨在东地平上用本日太阳距星之数求夕在西地平上用次日太阳距星之数以太阳所在之宫挨地平又看此日之星宫度相距太阳之逺近又用缺规矩较星距太阳之定限如土星定限距太阳十一度木星定限距太阳十度火星定限距太阳十一度半金星定限距太阳五度水星定限距太阳十一度半以缺规矩较定之限挨地平视星所在之宫度及纬南纬北之度视
<子部,天文算法类,推步之属,历算全书,卷十八>















　　厯算全书卷十八
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书卷十九
　　宣城梅文鼎撰
　　揆日候星纪要
　　求日影法
　　谨按测日之法要先知太阳纬度　其次要知里差其次要知句股算法其次又要知割圆八线
　　太阳纬度有半年在赤道南有半年在赤道北此以节气定之假如冬至日太阳在赤道南二十三度半为纬度之极南其影极长自此以后太阳渐渐自南而北其南边纬度渐减则影之长者亦渐减至春分日太阳行到赤道上即无纬度
　　既过春分太阳行过赤道之北于是渐生北纬纬既渐北其影渐短至夏至之日而影短极矣
　　夏至日太阳在赤道北二十三度半为纬度之极北其影极短自此以后太阳渐渐自北而南则北边纬度渐减而影之短者复渐长至秋分日太阳行到赤道上亦无纬度
　　既过秋分太阳行过赤道之南于是渐生南纬纬既渐南影亦渐増至于冬至之度而复为影长之极矣长极则短短极则长总由太阳南北纬度之所生其纬日日不同故影之长短亦日日不同也
























　　凡防表上层节气顺数而下自初日至十五日止下层节气逆数而上亦自初日至十五日止或论日或论度防有不同然所差不逺

<子部,天文算法类,推步之属,历算全书,卷十九 >
　　查表法
　　第一表是太阳在赤道南所纪度分是南纬日日不同之数管冬至小寒大寒立春雨水惊蛰【其日期自上而下顺推】又管秋分寒露霜降立冬小雪大雪【其日期自下而上逆推】凡顺推日期者看右行顺下之数逆推日期者看左行逆上之数
　　第二表是太阳在赤道北所纪度分是北纬日日不同之数管春分清明谷雨立夏小满芒种【日期顺推看右行】又管夏至小暑大暑立秋处暑白露【日期逆推看左行】
　　凡查纬度看本日是何节气则知太阳在赤道南或在其北
　　又看是节气之第几日依表顺逆查之即知太阳在赤道南北相离几何度分
　　假如辛未年四月初一日是在谷雨节内检表便知在赤道北又查交过谷雨已有八日便于谷雨节之下从上顺数而下对右行八字之格内【系第九格】寻其纬度是【十四度十三分】便是此日太阳距赤道北纬之数也
　　又法不用算日期只于本年七政厯寻本日太阳所到宫度加三十分即是　假如四月初一日七政厯内太阳是酉宫七度三十六分此是夜半子时度数加三十分得八度○六分便是本日午正太阳躔度也以午正太阳入酉宫八度○六分从本表中谷雨节一行内从上顺数而下到横对右行顺下第八号之格是十四度一十三分便是此日此时太阳离赤道北之纬度也以上论太阳纬度
　　既知纬度则日影长短之縁已得之矣然又要知里差何也纬度不同是天上事乃万国九州所同然而人所居有南北故所见太阳之髙下各异则其影亦异前所论纬度髙下是毎日不同今论里差则虽同此一日而北方日影与南方不同若不知此则误矣
　　里差南北论本地北极出地
　　即如四月初一日午正推得太阳在地平上髙六十四度此据京师地势言之若在别省则其度不同何也北极之出地不同也　后图明之






















　　右图举浙江为例其他处各各不同可以类推
　　北极出地度开后
　　京师　四十度　　山东　三十七度　陜西　三十六度盛京　四十二度　山西　三十八度　河南　三十五度江南　三十二度　浙江　三十度　　福建　二十六度湖广　三十一度　【江西四川】　俱廿九度　广西　二十五度贵州　二十四度　广东　二十三度　云南　二十二度求赤道髙法
　　各以其地北极出地度减九十度余为赤道髙度观前图自明
　　以上论里差
　　既知太阳纬度又知本地里差则任举一日可知太阳午正之髙度而测影不难矣
　　然又要知句股算法及割圆八线
　　凡测影有二法一是用直表而取平地之影【又名直影】　一是用横表而取壁上之影【又名倒影】
　　此两者皆是句股形







　　直表取影是一个正句股形





　　古人用八尺表取影只用直表直影故前所论者亦直影也
　　凡此句股之法生于割圎八线
　　何以谓之割圆周天三百六十度今取其若干度而算之是将浑沦圆形剖开算之故曰割圆也
　　割圆有八种线俱是算句股之法今取日影则所用者切线也切线有正有余此因直表取影故所用者又是余切线也
　　凡测影者先以纬度及里差得太阳髙度即用所得髙度入八线中查本度之余切即得所求直影
　　假如前推四月初一日太阳髙六十四度一十四分即于八线表中寻六十四度十四分之余切线便是所得直影
　　八线表在厯书中其查法毎度六十分自四十五度以前自上而下四十五度以后至九十度自下而上【其顺下逆上俱自一分起至六十分止俱要看表旁之分号对而取之】


　　甲乙为半径
　　【为股】以当表丙
　　乙为余切线
　　【为句】以当影甲
　　丙为日光斜
　　
　　太阳在已光
　　射于表端之
　　甲直至于丙成甲乙丙句股形
　　其己庚髙度与戊丁相对之度等用戊丁即如用己庚也
　　以戊丁为主则丁乙为余度而丙乙者即戊丁髙度之余切线也
　　查八线表法
　　先查某度　再查某线　再查某分　以横直相遇处取之
　　其度数有写在髙处者【自○度起至四十四度止】有写在下面者【自四十五度起至九十度止】
　　其八线之号有写在上一层者有写在下一层者其分数有自上而下者有自下而上者此无他故也只看度数写在髙处者其八线之号【如正切等】亦即写在上一层而其分数亦自上而下也若度数写在下面者其八线之号亦即写在下一层而其分数亦自下而上也【凡一度俱有两张一张自○分至三十分一张自三十分至六十分】
　　假如前推太阳髙六十四度便知此度数写在下靣即于表中寻下面左角上写有六四字样者此则六十四度之表也　度既写在下便从下一层横看八线之号至余切字样处认定此即六十四度余切之行也　又因度下有一十四分便向表中原写六四字样处接了便是○分自此逆上一分二分以至十四分止是所用之横格也依此十四分之号横看至余切之行其中所书便是六十四度十四分之余切线数矣他仿此【若依前加太阳十五分便寻三十分之号如法求之】
　　又式
　　康熈辛未七月初四日丁亥测正午时日影　京师立表
　　前月二十八日壬午夘时交大暑节
　　本日子正太阳度鬼宿三度七分为六宫四度三十三分
　　午正太阳度鬼宿三度三十六分为六宫五度○二分黄纬十九度○五分在北
　　京师赤道髙五十度　午正太阳髙度六十九度○五分
　　余切线○三八三八六
　　立八尺表　正午日影该三尺○七分
　　凡立表须正取影之地须平又须正对子午
　　又按此直表也故当以太阳半径加髙度而取直影【用余切】
　　若横表即当以太阳半径减髙度而取倒影【用正切】此测影中最精之理不可不知






　　皖城北极髙
　　三十一度
　　赤道髙五十
　　九度　立表
　　八尺　冬至
　　日在赤道外
　　二十三度三
　　十一分半
　　午正太阳髙三十五度二十八分半　余切线一四○○六五　直影宜加太阳半径十五分竒共髙三十五度四十四分其余切线一三八九九四以表数八尺乘余切线得影长一丈一尺一寸二分　若求倒影宜减太阳半径十五分竒得髙三十五度一十三分



　　四省表影立成
　　四省表影立成者为友人马德称氏作也徳称系本西域逺祖玛沙伊克玛哈齐两编修公以善治厯见知洪武朝受敕译西书其文御制称为不朽之智人钦天监特寘专科肄习子孙世其官皆精其业西域之言厯者宗焉西域之厯有二一曰动的月以望晦朔为序乃太阴厯也故斋期以见月为满一曰不动的月以二十四定气为端乃太阳厯也故礼拜以晷景为凭然此二者皆有里差而今回回家所传二十四节气表景尺度共祗一术故徳称氏疑焉谓其不足以尽诸省直之用而欲有以是正之以属余余既稔知西域之以天为教以厯为学经数百年能守其旧俗不变可谓有恒而徳称氏又能不牵于习见踵事加详以致其恪恭郑重之意深为可敬遂力疾为之布算以归之夫厯学至今日明且确矣而泰西氏之法大纲多出于回回窃意如各省直里差之説必西域所自有或当时存而未译或译之而未传或传之久而残缺皆未可知吾愿德称氏与其西域之耆旧尚为之详征焉而出以告世庶有以证吾之説而释夫传者之疑以正其疎也













　　四省直节气定日表影考定
　　立表十尺【若表短则用折算假如用表一尺则以尺为寸寸为分分为厘皆折取十分之一若表八尺则尺取八寸为十之八】














　　右表影皆以直省城内为准附近二百里内外可用其余州县各各不同须以彼处北极髙度定之
　　一凡立表须直不得稍偏于东西南北则影为之变须以线垂而准之古所谓八线附臬者是也
　　一植表取影之地须极平如砥若防有髙下陂陀坑坎垤则影不应矣当以水准之
　　一量表量影之尺度须极匀极细
　　一取正午之影须在正南然天上正南非罗针所指之正南也须于罗针正午之西稍偏取之或曰丙午之间缝针与臬影合亦非也盖针所指在在不同如金陵则偏三度此非正方案则不能定或以厯书法用北极附近星取之
　　以上四事皆求表影者所当知
　　此外又有节气加时在午前午后之不同则影亦为之加减
　　假如冬至影极长而冬至不在正午或午前或午后则其午影必防差而短
　　又如夏至影极短而夏至不在正午或午前或午后则其午影必微长
　　又如小寒至芒种十一气影自长而短若其加时在午前则午影必防短加时在午后则午影必微长
　　又如小暑至大雪十一气影自短而长若其加时在午前则午影必防长加时在午后则午影必防短按以上加减只在分厘若所用径尺之表初无损益可无深论也惟春秋分及前后两节晷差颇速若其加时又在亥子之间则距午甚逺为差益大不可不知
　　午正太阳髙九十度已至天顶则日中无影其过此者皆在天顶之北而生南影法当以所带零度转减九十度而用其余命为太阳在天顶北之髙度
　　北极出地二十度则赤道在天顶南二十度而夏至日躔在赤道北二十三度半故其日午时已过天顶北三度而影在表南
　　芒种日午正亦过天顶北二度竒影亦在南
　　凡午影芒种必髙于小满夏至又髙于芒种今皆反之亦此故也
　　自北极髙二十三度以前仿此论之
　　宜邑谢野臣至中州寻古测景之台所立石表尚存其形似墖上小下大夏至日中无影盖其根盘半径即日景所到如句髙尖距地之数为表如股亦表八尺土圭尺有五寸之比例也以此推之则向南州邑并可作夏至无影之石表





　　论恒星
　　中星定时
　　中星之法肇于尧典羲和分职测日之后继以中星盖中星所以觇四时騐寒暑定昏旦考节气察日度辨里差其用甚钜故与测日均为治厯之大端也第星之丽天左旋之势则依赤道自行之度则向黄道因此星之经纬度自二道望之叅差不齐法以黄赤二道之极为宗出弧线过星体用弧三角法可推各星之经纬度在古厯未觉有恒星之行【中法谓之歳差不言星行】西用大仪累年密测知恒星亦依黄道毎嵗东行五十一秒其距黄道有定度若赤道因黄道斜络之势度分多变动不居因普测周天有名位之星算其二道之经纬度列表今推中星祗用赤道度以时刻凭赤道为主故也法以星赤道度与本日太阳赤道度相离之数变时得星昏旦中之时刻取用星座除二十八舎外止用三等以上之星余光体茫昧者可勿论也
　　推中星求时法
　　先查本年七政厯太阳宫度分至仪象志八卷内变为赤道度分次查所出之星在十二三卷内系若干度分将星之度分减去太阳所变之度分如不足减数加三百六十度减之所余之度分移至仪象志第五卷之变时表内变为时刻分从未初起算至所得时刻即所求之时也
　　推时求中星法
　　先查本年七政厯太阳宫度分至第八卷仪象志内变为赤道度分次查所出之时刻从未初起算得几时刻移至第五卷变时表内变为赤道经度分时之度分加于太阳之度分若满过三百六十度则去之所余之度分至十二三卷内比例相近度分之大星宿即所求之星宿也【星宿之度分不及则偏西有余则偏东】


　　诸名星赤道经纬度加减表















<子部,天文算法类,推步之属,历算全书,卷十九 >
<子部,天文算法类,推步之属,历算全书,卷十九 >
<子部,天文算法类,推步之属,历算全书,卷十九 >
<子部,天文算法类,推步之属,历算全书,卷十九 >
<子部,天文算法类,推步之属,历算全书,卷十九 >
　　二十八宿距星黄赤二道经纬度
　　二十八宿距星赤道经纬度【自春分起算】壬子年度














<子部,天文算法类,推步之属,历算全书,卷十九 >
　　二十八宿距星黄道经纬度　壬子年度















<子部,天文算法类,推步之属,历算全书,卷十九 >
<子部,天文算法类,推步之属,历算全书,卷十九 >
　　二十八宿黄道积度















　　康熈戊辰年各宿距星所入各宫度分【黄道经度】














　　以上戊辰年经度视仪象志又各加一十四分惟斗牛二宿加十五分















　　纪星数
　　大西儒测算凡可见可状之星一千二十二若防小者或不常见者或朦黒者不与焉其大小分为六等又因其难以识认尽假取人物之像以别其名【星非真有象也但人借名之耳】毎合数星以成一像凡四十八像其多寡大小不等在黄道北者二十一像第一曰小熊内有七星外有一星二曰大熊内二十七外八三曰龙凡三十一星四曰黄帝内十一外二五曰守熊人内二十二外一六曰北冕旒凡八星七曰熊人内二十九外一八曰琵琶凡十星九曰鴈鵞内二十二外一其十曰岳母凡十三星十一曰大将内二十六外三十二曰御车凡十四星十三曰医生又曰逐蛇【一医常取蛇合药以救世其星如人逐蛇状】内二十四外五十四曰毒蛇凡十八星十五曰箭凡五星十六曰日鸟【性喜视日】内九外六十七曰鱼将军【性好人闻人歌乐即来听呼其名渐来就人溺水则载之岸边人取鱼彼即领众鱼至呼之彼先跃过众鱼则罹网矣】凡十星十八曰驹凡四星十九曰飞马凡二十星二十曰公主凡二十四星二十一曰三角形凡四星共在北者三百六十星一等三二等十八三等八十四四等一百七十四五等五十八六等十三昏者十在黄道中者【按节气】十二象【即十二宫】一曰白羊即春分清明内十三外五二曰金牛即谷雨立夏内三十三外十一三曰双兄即小满芒种内十八外七四曰巨蟹即夏至小暑内九外四五曰狮子即大暑立秋内二十七外八六曰室女即处暑白露内二十六外六七曰天秤即秋分寒露内八外九八曰天蝎即霜降立冬内十一外三九曰人马即小雪大雪凡三十一星十曰磨羯【羊头鱼尾】即冬至小寒凡二十八星十一曰寳瓶即大寒立春内四十二外三十二曰双鱼即雨水惊蛰内三十四外四共在中者三百四十六星一等五二等九三等六十四四等一百三十四五等一百○六六等二十九昏者三在黄道南者十五像一曰海兽凡二十二星二曰猎户凡三十八星三曰天河凡三十四星四曰天兔凡十二星五曰大犬内十八外十一六曰小犬凡二星七曰船凡四十五星八曰水蛇内二十五外二九曰酒缾凡七星十曰乌雅凡七星十一曰半人牛凡三十七星十二曰豺狼凡十九星十三曰大台凡七星十四曰南冕凡十三星十五曰南鱼内十二外六共在南者三百十六星一等七二等十八三等六十四等一百六十八五等五十三六等九昏者一三方共一千二十二星分其大小一等共十五二等共四十五三等共二百○八四等共四百七十四五等共二百十七六等共四十九昏者共十四
　　新増一十二像【系近南极之星】
　　火鸟十　水委三　蛇首蛇腹蛇尾十五　小斗七飞鱼七　南船五　海山六　十字架四　马尾三马腹三　蜜蜂四　三角形三　海石五　金鱼四夹白二　附白一　异雀十　孔雀十　波斯十一鸟喙六　鹤十二　共一百三十四星
　　据西书言彼地天文家原载可见之星分为四十八像后自治十年丁巳有精于天文呉黙哥者行至极南见有无名多星复有西士安徳肋者亦见诸星之旁尚有白气二块如天汉者嗣于万厯十八年庚寅有西士胡本笃始测定南极各星经纬度数新増一十二像至万厯四十八年庚申汤罗两公航海过赤道南三月有竒见南极已髙三十余度将前星一一对测经纬皆符但据云一十二像今又有二十一名何耶
　　地谷测定经纬之星数
　　厯法西传曰地谷著书第四卷取六星之距度以经度相并适合周天之全度求角宿经纬度以起周天之度再求近赤道十二星经纬度证星之黄道纬度今古不同求星之经度并解其时八百余星之真经纬度【五十三年前】复加百余星赤道经纬度説
　　按地谷实测过者只有八百星则其余非地谷测也新法厯书星数
　　厯引曰恒星为数甚多莫能穷尽其间有光渺体防非目可及非仪可推者则略而不録其在等第之内已经新法所测定者南北两极共得一千七百二十五星又曰星以大小分为六等第一等大星如五帝座织女类者一十七次二等如帝星开阳类者五十七次三等如太子少衞类者一百八十五次四等如上将柱史类者三百八十九次五等如上相虎贲类者三百二十三次六等如天皇大帝后宫类者二百九十五是皆有名之星共为一千二百六十六余则皆为无名之星矣西又分为六十二像各命之以名以期便于识别又曰西古厯亦有二十八舎义与中古相侔其所定二十八距星亦皆脗合第觜宿距星西用天闗耳
　　此二十八宿者各以一字命名分注毎日之下内以房虚星昴为属太阳之日心尾毕张为属太阴之日是外五纬各属四宿毎以七日为期毎日各属一宿西厯亦然义理皆符西经相传上古有大师名诺厄者所通于天下万国云
　　按天经或问恒星多寡条与此同但总数作一千一百六十六则总撒符矣　汤道未删定厯引数同但总数百字上缺画不明今查经纬表三等星有二百○七除海石等七星仍有二百则云八十五者非矣
　　恒星厯指曰自古掌天星者大都以可见可测之星求其形似聨合而为象命之名以为识别是有三垣二十八宿三百座一千四百六十一有名之星世所传巫咸石申甘德之书是也西厯依黄道分十二宫其南北又三十七像亦以能见能测之星聨合成之共得一千七百二十五其第一等大星一十七次二等五十七次三等一百八十五次四等三百八十九次五等三百二十三次六等二百九十五盖有名者一千二百六十六按此星数与厯引同惟三等星多一百然以总数合之此为是
　　星屏赤道南北两总星图説曰旧传三垣二十八宿共三百座一千四百六十一有名之星如世传巫咸丹元子之书之类然细测有在疑似者今则非实测不图旧图未载而测有经纬亦増入焉南极旁星向来无象无名因以原名翻译共得星一千八百一十二第一等一十六第二等六十七第三等二百一十六第四等五百二十二第五等四百一十九第六等七十二
　　按此星数细数少五百总数多五百
　　恒星经纬表旧本一等星十七二等六十八三等二百○九四等五百一十二五等三百四十六等二百一十六共一千三百六十二外有傅説积尸气等不入等之星共七然今刻表又有不同
　　天学防通星数
　　论各星大小一等十五星二等四十五星三等二百八十星四等四百七十四星五等二百一十六星六等五十星共一千二十九星
　　按此数合总该一千○八十总撒不符必有误也薛书若此类颇多
　　查表一等大星毕参二五车狼老人星轩辕五帝座角大角心南门织女北落师门共十五与此合其水委不在此内
　　又查表三等并新増海石等共二百○七则十字衍可知
　　又查表二等星五十又新増海石等十七共六十七与此及厯引厯指俱不同
　　天文实用星数
　　恒星总像例条曰中厯分垣分宿计二百八十座见界诸星尽矣西国于此见界诸星约以四十八像别如近南极诸星都爲六十像騐时依像推效各异古厯家详察星之形星之性与某物合因以毎物像之
　　白羊宫　起降娄二十八度　止大梁一十八度金牛宫　起大梁一十九度　止实沈二十五度双兄宫　起实沈二十六度　止鹑首二十四度巨蟹宫　起鹑首二十四度　止鹑火一十二度狮子宫　起鹑火一十三度　止鹑尾一十六度室女宫　起鹑尾一十六度　止大火　六　度天秤宫　起大火　六　度　止大火二十六度天蝎宫　起大火二十七度　止析木二十五度人马宫　起析木二十六度　止星纪二十八度磨羯宫　起星纪二十八度　止枵二十二度寳瓶宫　起枵二十三度　止娵訾一十五度双鱼宫　起娵訾一十五度　止降娄二十七度
　　汉志星数
　　汉书天文志曰凡天文在图籍昭昭可知者经星常宿中外官凡百一十八名积数七百八十三
　　晋志星数
　　晋书天文志曰马绩云天文在图籍昭昭可知者经星常宿中外官凡一百一十八名积数七百八十三皆有州国官宫物类之象张衡云文曜丽乎天其动者有七日月五星是也日者阳精之宗月者隂精之宗五星五行之精众星列布体生于地精成于天列居错峙各有攸属在野象物在朝象官在人象神其以神差有五列焉是为三十五名一居中央谓之北斗四布于方各七为二十八舍日月运行厯示吉凶五纬躔次用告祸福中外之官常明者百有二十四可名者三百二十为星二千五百微星之数盖万有一千五百二十庶物蠢蠢咸得系命不然何得总而理诸后武帝时太史令陈卓总甘石巫咸三家所着星图大凡二百八十三官一千四百六十四星以为定纪
　　隋志星数
　　隋天文志又列目曰经星中官乃另起叙星自北极五星起北斗辅星三公止又另起自文昌六星起至少微长垣止太防天市二垣俱杂叙其中是为天文上卷次卷天文中列目曰二十八舍乃另起叙星自东方角二星起又北方南斗六星西方奎十六星南方东井八星各另起而于后低三字总结之曰右四方二十八宿并辅官一百八十二星又列目曰星官在列宿之外者乃另起叙星自库楼十星起青丘土司空军门止仍低三字总结之曰自摄提至此大凡二百五十四官一千二百八十三星并二十八宿辅官名曰经星常宿逺近有度大小有差茍或失常实表灾异
　　隋天文志曰后汉张衡为太史令铸浑天仪总序经星谓之灵宪其大畧曰中外之官常明者百有二十可名者三百二十为星二千五百微星之数万有一千五百二十庶物蠢动咸得系命而衡所铸之图遭乱湮灭星官名数今亦不存三国时呉太史令陈卓始列甘氏石氏巫咸三家星官着于图録并注占赞总有二百五十四官一千二百八十三星并二十八宿及辅官附坐一百八十二星总二百八十三官一千五百六十五星宋元嘉中太史令钱乐之所铸浑天铜仪以朱黒白三色用殊三家而合陈卓之数髙祖平陈得善天官者周坟并宋氏浑仪之器乃命庾季才等叅挍周齐梁陈及祖暅孙僧化官私旧图刋其大小正彼踈密依准三家星位以为盖图以坟为太史令自此太史观生始能识天官
　　客星説【附】
　　厯法西传曰地谷书第五卷解其时新见大客星计十二章一详初起及渐大至与金星等并渐减二取某宫星以定其经纬度三解测新星所用诸器四取新星与他星距度五解其更度几何六用各法以求新星经纬度七求新星赤道经纬度八证新星不丽空际而丽列宿天九攷新星之大小十取新星之似径得三分三十秒十一证新星大倍于日大于地三百六十倍十二攷众星参差
　　彗星解【附】
　　厯法西传又载地谷彗星十卷测彗星之髙度尾之长短光之隐显及其方向攷十二星在黄道上度以求彗星之眞所在设彗星离两星之度求黄赤道经纬度求彗星毎日赤道经纬度求彗星所行之道及其道交黄赤之角处依毎日彗星行黄赤二道作立成表证彗星在月上较月更逺于地为三百地半径故知彗星在日月二天之中证其尾恒向日与金星作彗星行度图徴彗星之大爲月二之一尾长为九十六地半径因攷前人彗星之论当否
　　极星攷
　　隋书纽星去不动处一度余
　　隋天文志曰北极五星皆在紫宫中北极辰也其纽星天之枢也天运无穷三光迭耀而极星不移故曰居其所而众星共之贾逵张衡蔡邕王蕃陆绩皆以北极纽星为枢是不动处也祖暅以仪准候不动处在纽星之末犹一度有余
　　宋时极星去不动处三度余
　　宋时天文志载沈括于熙宁七年七月上浑仪浮漏景表三议其浑仪议内一则云前世皆以极星为天中自祖衡以玑衡窥攷天极不动处乃相极星之末犹一度有余今铜仪天枢内径一度有半乃谬以衡端之度为率若玑衡端平则极星常游天枢之外玑衡小偏则极星乍出乍入令瓒旧法天枢乃径二度有半葢欲使极星游于枢中也臣攷騐极星更三月而后知天中不动处逺极星乃三度有余则祖恒窥攷犹未为审今当为天枢径七度使人目切南枢望之星正循北极枢里周常见不隐天体方正【按祖衡祖恒并误当作祖暅乃冲之子】
　　按古法自浑仪之南窥浑仪之北皆用衡管则必过心所得之度数亦真惟此候极之枢似有未确何以言之南枢既亦径七度则人目可中可边致有游移若南枢窄小令目常在枢心则目光射星不过仪心而悉成斜望矣且以圆理征之人目窥处即圆心为起度之根而北极之度变七度为三度有半矣故不如元极仪之确元候极仪亦径七度然设于简仪是从心窥周其度真确
　　又尝疑西术言极星亦东行而祖暅时离不动处一度沈括时遽离三度竒可谓速矣而至郭太史时仍三度竒何以又迟今以其仪器攷之则宋时离不动处正在二度左右耳
　　祖氏所用仪器恐亦是自南周用目以窥北周则虽云离一度有余若其真度恐未及一度
　　宋史志极度条又言北极为天之正中而自唐以来厯家以仪象攷测则中国南北极之正实去极星之北一度有半此盖中原地势之度数也中兴更造浑仪而太史令丁师仁乃言临安府地势向南于北极髙下当量行移易局官吕璨言浑天无量行移易之制若用于临安与天参合移之他往必有差忒遂罢议后十余年邵谔铸仪果用临安北极髙下为之以清台仪挍之实去极星四度有竒也
　　又叙中外官星言北极五星在紫防宫中北辰最尊者也其纽星为天枢天枢在天心四方去极各九十一度贾逵张衡蔡邕王蕃陆绩皆以北极纽星之枢是不动处在纽星末犹一度有余今清台则去极四度半按此两条误以北极出地之髙下差为极星去不动处之距度作史者之疎乃如此　愚前一条言用目自心窥周为测圆正法足证郭太史简仪之妙然自昔无人见及其理甚微无恠其然也若后两条之辨茍稍知厯法者宜知之奈何史家瞆瞆也
　　王良阁道攷
　　隋天文志曰天良五星在奎北居河中天子奉车御官也其四星曰天驷旁一星曰王良亦曰天马其星动为策马车骑满野亦曰王梁梁为天桥主御风雨水道故或占津梁其星移有兵亦曰马病客星守之桥不通前一星曰策王良之御策也主天子仆在王良旁若移在马后是为策马则车骑满野　阁道六星在王良前飞道也从紫宫至河神所乗也一曰阁道主道里天子游别宫之道也亦曰阁道所以扞难灭咎也一曰王良旗一曰紫宫旗亦所以为旌表而不欲其动揺旗星者兵所用也傅路一星在阁道南旁别道也备阁道之败复而乘之也一曰太仆主御风雨亦游从之义也
　　晋志并同隋但亦曰王良作亦曰梁若移在马后作若移在王良前居马后
　　前汉天文志曰紫宫左右星曰天枪右四星曰天棓后十七星絶汉抵营室曰阁道　又曰营室为清庙曰离宫阁道汉中四星曰天驷旁一星曰王梁王梁策马车骑满野旁有八星絶汉曰天横天横旁江星江星动则人涉水史记天官书曰紫宫左三星曰天枪右五星曰天棓后六星絶汉抵营室曰阁道　又曰营室为清庙曰离宫阁道汉中四星曰天驷旁一星曰王良王良策马车骑满野旁有八星絶汉曰天潢天潢旁江星江星动人涉水又宋均云天潢天津也津凑也主计度也○正义曰天江四星在尾北主太阴也不欲明明而动水暴出其星明大水不禁也宋史天文志并同
　　鼎按史记本云阁道六星而汉书更其文曰十七星不知何据今厯书图阁道为十余星其本诸此欤














　　三十杂星攷
　　回回厯书有三十杂星钱塘袁惠子攷其经纬系以中法星名但所攷尚缺第三第四第五第十三第十四第廿四第廿五第廿九壬申秋晤于京师则皆补完余问其何本则皆自揣摩而得非三和授也又以余言改定巨蟹为积尸气缺碗为贯索
　　薛仪甫厯学防通亦有三十杂星之攷亦有缺星名者今余所攷则以囘厯星名同者为证似比两公为有根本也又查恒星出没表四十五大星内星名同者二十一
　　人坐椅子诸像非西洋六十像之像如贯索在回回厯为缺椀在西洋则为冕旒即此见西占之本出回囘也第五作觜宿南星性情既合又与参宿同象而厯书言逺镜测之有三十六星则为气类宜为杂星所收今从袁説
　　查囘回凌犯表有天关及昴宿性情虽同星名不合若如袁説则两星性情皆系金土亦未可为确据不如缺之














　　攷定三十杂星
　　【戊午年距厯元戊辰五十一年加星行四十三分二十秒】














<子部,天文算法类,推步之属,历算全书,卷十九 >

　　今将原书所载列后
　　西星名　　　【译书时所　距　述宫度　　黄道】　等性













<子部,天文算法类,推步之属,历算全书,卷十九 >

　　原书云以上数星是三百九十二年之前度数如此其星皆往东行一年行五十四秒十年行九分六十六年行一度观者依此推之











　　厯算全书卷十九
　　钦定四库全书
　　厯算全书卷二十
　　宣城梅文鼎撰
　　仰仪简仪二铭补注
　　仰仪
　　按元史天文志简仪之后继以仰仪然简仪纪载明析而弗録铭辞仰仪则仅存铭辞而弗详制度葢以铭中弗啻详之也庚寅暮春眞州友人以二铭见寄属防其义余受而读之简仪铭既足以补史志之阙仰仪铭与史亦多异同而异者较胜岂牧庵作铭后复有定夲耶爰据其夲以为之释仍附録史志原文以资攷订焉
　　不可形体莫天大也无竞维人仰载也
　　言天体之大夲不可以为之形似而今以虚坳似之器仰而肖之则以下半浑圆对覆帱之上半浑圆而周天度数悉载其中此人巧之足以代天工故曰无竞维人也
　　六尺为深□自倍也兼深□倍絜兊也
　　形是半浑圆而其深六尺是浑圆之半径也倍之为广则浑圆之全径也兼深与□之度而又倍之浑圆之周也盖仰仪之口圆径一丈二尺周三丈六尺也兑为口故曰兑絜犹度也【此虽亦径一围三古率然其器果圆则畸零在其中矣】
　　振溉不泄缭以浍也正位辨方曰子卦也
　　口周围为水渠环绕注水取平故曰振溉不泄缭以浍也口之面均列二十四方位而从子半起子午正则诸方皆正故曰正位辨方曰子卦也
　　横缩度中平斜载也斜起南极平镦也【度入声】
　　缩直也仰仪象地平下半周之浑天其度必皆与地平上之天度相对待故先平度之从仪面之卯酉作弧线相聫必过仪心以横剖形为二地平下卯酉半规也又直度之从仪面之子午作弧线相聨亦过仪心而直剖形为二地平下子午半规也两半规交于仪心正中天在地平下正对天顶处也故曰衡缩度中然此所谓中乃平度之中【其衡缩度之者并自地平之子午卯酉出弧线而防于地平下之中心】若在天之度固自斜转即非以此为中故既平度之复斜度之有两种取中之法故曰平斜载也【载犹再也】斜度柰何曰宗南极也法于地平下子午半规匀分半周天度乃用此度自地平午数至南极入地度命为斜度之中心故曰斜起南极【言纬度从此起】镦者之镦即仪心也【镦徒对切矛防底平者曰镦曲礼进矛防者前其镦类篇矛防柲下铜也仪类而形仰最坳深处为其底心故谓之镦】为地平下两半规十字交处而下半浑圆之心平度以此为宗亦如斜度之宗南极故曰平镦也盖以此二句释上二句也【不言起省文】
　　小大必周入地画也始周浸断浸极外也
　　此言斜度之法也斜画之度既宗南极则其纬度之常隠不见者毎度皆绕极环行而成圆象【毎度相去约一寸弱】虽有大小皆全圆也【近南极旁则小渐逺渐大毎度相离一寸其圆径之大小毎度必加二寸】故曰小大必周而明其为入地之画也在南极常隠界内故也若过此以徃则离极益逺纬度之圆益大其圆之在地平下者渐不能成全圆而其阙如玦以其渐出南极常隠界外也故曰始周浸断浸极外也【亦是以下句释上句】
　　极入地深四十太也北九十一赤道齘也列刻五十六时配也
　　仪设于元大都大都北极出地四十度太【四分之三为太】则南极入地亦然仰仪凖之近南极四十度内皆常隠界也若四十一度以上则所谓始周浸断者也至于离南极一象限【四分天周各九十一度竒为象限铭盖举成数也】则为赤道之齘而居浑天腰围矣【齘齿相切之界缝也考工记圅人衣之欲其无齘也仰观经纬之度入筭处并只一线故曰齘】凡昼夜时刻并宗赤道赤道全周匀分百刻以配十二时仰仪赤道乃地平下半周故列刻五十配六时也六时者起卯正初刻毕酉初四刻皆昼时仰仪赤道半周居地平下而纪昼时者日光所射必在其冲也【日在卯光必射酉日在午光必射子余时亦皆若是】
　　衡竿加卦防坤内也以负缩竿子午对也【子元史作夲】末旋机杖【机杖元史作机板】窽纳芥也上下悬直与镦防也视日漏光何度在也
　　此仰仪上事件也防东南坤西南所定口之卦位也横竿之两端加此二卦者以负直竿也直竿正与口为平面承之者必稍下故曰内也直竿加横竿上如十字其夲在午而末指子故曰对也直竿必圆取其可以旋转而竿末则方其形类板板之心为圆窍甚小仅可容芥子故曰窽纳芥窽即窍也然必上下悬直以为之凖盖直竿之长适如半径其末端虽自午指子实不至子而纳芥之窍正在口平圆之心于此悬绳取正则直线下垂亦正直底镦心故曰与镦防也既上下相应无豪髪之差殊则窍纳芥处亦即为浑圆心矣凡所以为此者以取日光求真度也何则仰仪为形以象地平下之半天而所测者地平上之天也故必取其冲度以命之而浑圆上经纬之相冲必过其心兹也机板之窍既在浑圆之最中中央从此透日光以至底视其光之在何度分即可以知天上日躔之度分矣漏即透也
　　旸谷朝賔夕饯昧也寒暑发敛騐进退也
　　此详言测日度之用也虞书分命羲仲宅嵎夷曰谷寅賔出日分命和仲宅西曰昧谷寅饯内日此古人测日用里差之法也今有此器则随地随时可测日度即里差已在其中不必谷昧谷而寅饯之用已全矣周礼以土圭致日日至之影尺有五寸为土中又取最长之影以定冬至此古人冬夏致日之法也今有此器以测日道之发南敛北【日躔在赤道以南谓之发在赤道以北谓之敛皆以其逺近于北极而立之名】则毎日可知其进退之数【二分前后黄赤斜交故纬度之进退速二至前后黄赤平行故纬度之进退缓细攷之亦逐日各有差数】不必待南至北至而可得真度视表影所测尤为亲切矣
　　薄蚀终起鉴生杀也以避赫曦夺目害也
　　言仰仪又可以测交食也【日月交食一曰薄蚀】厯家之测騐莫大于交食而测筭之难亦莫如交食是故测食者有食之分秒有食之时刻有食之方位必测其何时何刻于何方位初亏为食之起何时何刻于何方位复圆为食之终何时何刻于何方位食分最深为食之甚自亏至甚为食之进自甚至复为食之退凡此数者一一得其真数始可以騐厯之踈宻以为治厯之资然太阳之光最盛难以目窥今得此器透芥子之光于仪底必成小小圆象而食分之浅深进退毕肖其中【但蚀于左者光必阙于右蚀于右者光必阙于左上下亦然皆取其对冲方位】而时刻亦真不烦他器矣古者日食修徳月食修刑然春生秋杀之理固在寒暑发敛中而起亏进退尤测之精理此盖与上文互见相明也
　　南北之偏亦可槩也极浅十七林邑界也深五十二【元史作五十竒】铁勒塞也浅赤道髙人所载也夏永冬短犹少差也深故赤平冬昼晦也夏则不没永短最也【载当作戴】此言仰仪之法不特可施之大都而推之各方并可施用因举二处以槩其余也盖时刻宗赤道赤道宗两极而各方之人所居有南北北极之出地遂有髙卑而南极之入地因之有深浅则有地偏于南如林邑者其地在交趾之南是为最南故其见北极之髙只十七度即南极之入地亦只十七度而为最浅又有地偏于北如铁勒者其地在朔漠之北是为最北故其见北极之髙至五十余度即南极之入地亦五十余度而为最深南极入地浅则赤道入地深而成立势其赤道之半在地上者渐近天顶为人所戴故夏日亦不甚长冬日亦不甚短而永短之差少也南极入地深则赤道入地浅而成眠势其赤道之半在地上者渐近地平绕地平转故冬日甚短而至昼晦夏昼甚长而日不没永短之最斯为极致也【按元史铁勒北极髙五十五度夏至昼七十刻夜三十刻北海北极髙六十五度夏至昼八十二刻夜十八刻未至于夏日不没则冬亦不至昼晦然北海之北尚有其北北极有渐直人上之时逺征之周髀所言近騐之西海所测夏不没冬昼晦容当有之铭盖因二方差度而遂以推极其变也】
　　二天之书曰浑盖也一仪即揆何不悖也以指为告无烦喙也闇资以明疑者沛也智者是之胶者怪也此言仰仪之有禆于推歩也浑天盖天并古者测天之法盖同出于一源传乆而分遂成岐指近代盖天之说浸防惟周髀筭经犹存十一于千百而习之者稀今得此器以肖地平下之天虽常隐不见之南极其度数皆如掌纹而浑天之理頼以益明即盖天家所言七衡之説并可相通初无龃龉然后知浑盖两家实有先后一揆并行而不悖者矣所以者何也多言乱听喙愈烦而心惑一仪惟肖指相授而目喻也由是而理之闇者资之以明从来疑义涣然氷释虽其器创作为胶固者之所怪而其理不易终为明智者之所服矣【周髀筭经云北极之左右物有朝生暮获赵爽注曰北极之下从春分至秋分为昼从秋分至春分为夜是北极直人上而南极益深为人所履赤道平偃与地面平日遂有时而不没地为永短之最观于仰仪可信其理】
　　过者巧厯不亿軰也非让不为思不逮也将窥天眹造物爱也其有俟然昭圣代也泰山厉兮河如带也黄金不磨悠乆頼也鬼神禁诃庻勿壊也
　　此承上文而深赞之也言古来巧厯不可数计然不知为此者岂其谦譲不遑乎无亦精思有所未及耳抑天道幽逺将造物者不欲以朕兆令人窥测而有爱惜耶其待人而行非时不显故若有所俟必至圣代而始昭耶然则兹器也实振古所未有而兹器之在宇宙间亦当与天地而常存虽泰山如砺长河如而兹器也悠乆頼之如黄金之不磨而鬼神且为之呵防以庻防勿壊矣
　　按史载斯铭引古六天之说而谓仰仪可衷其得失是等盖天于宣夜诸家而归重浑天也然郭太史有异方浑盖图固已观其防通兹则并举浑盖且以仰仪信其揆之一盖牧庵之厯学深矣愚故以断其为重定之夲也学无止法理愈析益精古之人皆如是上海徐公之治西厯也开局后数年推宗郭法乃重于前惟公则明惟虚受益好学深思者其知所取法哉
　　简仪【仪制详元史兹约举为铭而文章尔雅能略所详详所略与史相备因并释之】
　　旧仪昆仑六合包外经纬纵横天常衺带三辰内循黄赤道交其中四游頫仰钧箫
　　此将言简仪而先述浑仪也昆仑即混沦古者浑天仪浑圆如球故曰旧仪昆仑也浑天仪有三重外第一重为六合仪有地平环平分廿四方向有子午规卯酉规与地平相结于四正又自相结于天顶以象宇宙间四方上下之定位故曰六合包外经纬纵横也又依北极出地于子午规上数其度分命为南北二极之枢两枢间中分其度斜设一规南髙北下以象赤道之位而分时刻谓之天常规故又曰天常衺带也内第二重为三辰仪亦有子午规卯酉规而相结于两极各为枢轴以缀于六合仪之枢中分两极间度设赤道规与天常相直又于赤道内外数南北二至日度斜设一规为黄道两道斜交以纪宿度以分节气而象天体故曰三辰内循黄赤道交也内第三重为四游仪亦有圆规内设直距以带横箫横箫有二并缀于直距而能运动故可以上下转而周窥规枢在两极又可以左右旋而徧测故曰其中四逰頫仰钧箫也
　　凡今改为皆析而异繇能防明无窒于视
　　此承上文而言作简仪之大意也浑天仪经纬相结而重重相包今则析为单环以各尽其用故曰皆析而异各环无经纬相结作之既简而各仪各测无重环掩映之患故曰防明无窒于视也
　　四游两轴二极是当南轴攸沓下乃天常维北欹倾取轴榘应镂以百刻及时初正赤道上载周列经星三百六十五度竒赢
　　此以下正言简仪之制也简仪之四游环用法与浑仪之四游同而厥制防异原亦有经纬相结今只一环【虽用防环而左右平列无经纬相结即如一环】又原在浑仪之内为第三重今取出在外而中分其环命为两极北极枢轴连于上规之心南极枢轴在赤道环心故曰四游两轴二极是当南轴攸沓下乃天常也天常即百刻环与赤道相叠言天常不言赤道省文也上规贯北云架柱之端赤道百刻叠置承以南云架柱两云架柱斜倚之势并凖赤道但言维北欹倾者省文互见也两并欹倾则二轴相应如绳正指两极而四游环可以运动其势恒与上下两规作正方折其方中矩故曰取轴矩应此以上言四逰环也百刻环匀分百刻又匀分十二时时又分初正此二句言百刻环也赤道环叠于百刻环上故曰上载其环匀分十二次周天全度于中又细分二十八舍距度故曰周列经星三百六十五度竒赢也【百刻环即六合仪上斜带之天常赤道环即三辰仪之赤道然皆不用子午规而单环叠置此其异也】
　　地平安加立运所履错列干隅若十二子
　　地平环分二十四方位与浑仪同【干八干甲乙丙丁庚辛壬癸隅四维乾坤艮巽十二子支辰子丑寅卯辰巳午未申酉戌亥也】然彼为六合仪之一规此则独用平环卧置以承立运故曰立运所履也立运环浑仪所无兹特设之以佐四逰之用其制亦平环分度而中分之为上下二枢上枢在北云架柱之横輄下枢在地平环中心二枢上下相应如垂绳之立而环以之运故谓之立运
　　五环三旋四衡絜焉
　　一四游二百刻三赤道四地平五立运凡为环者五也旋运转也五环之内百刻地平不动四游赤道立运并能运转是能旋者三也衡即横箫古称玉衡絜犹絜矩之絜用衡测天如筭家之□术絜而度之以得其度也简仪之衡凡四而并施于旋环之上故曰五环三旋四衡絜焉也【下文详之】
　　两缀闚距随捩留迁欲知出地究兹立运去极防何即游是问
　　两者两衡承上文四衡而分别言之先举其两也两者维何一在立运环一在四游环也闚闚管距直距捩闗捩即枢轴也留迁者言留迁惟人所用也闚管缀于直距有枢轴以转动随其所测可以頫仰周闚此两衡之所同也然各有其用欲知日月星辰何方出地及其距地平之髙下则惟立运可以测之若欲知其去北极逺近防何度分惟四游可以测之此又两衡之所异也
　　赤道重衡四末张上结北轴移景相望测日用一推星兼二定距入宿两候齐视
　　前云四衡而上文已详其两尚有二衡复于何施曰并在赤道环也赤道一环何以能施二衡曰凡衡之枢在腰而此二衡者并以赤道中心之南极轴为轴重叠交加可开可合故曰重衡也衡既相重故不曰闚衡而谓之界衡界衡之用在线不设闚管也用线柰何其法以线自衡枢间循衡底之渠贯衡端小孔上出至北极轴穿轴端所结线折而下行至衡之又一端入贯衡端小孔顺衡底渠至衡中腰结之如此则一线折而成两并自衡端上属北极其势斜直张而不弛半衡如句而线为之一衡首尾二线重衡则四线矣故曰四末张末指衡端张者状其线之直也北轴即北极之轴穿线处也四线并起衡端而宗北极故又曰上结北轴也景谓日影移衡对日取前线之景正加后线则衡之首尾二线与太阳参直故曰移景相望也衡上二线既与太阳参直则界衡正对太阳衡端所指即太阳所到加时早晚时初时正何刻何分并可得之【百刻环中具列其数】则一衡已足故曰测日用一也测星之法移衡就星用目睨视取衡上二线与其星相参值则为正对与用日景同理但须二衡并测故曰推星兼二也二衡并测奈何曰二十八舍皆有距星以命初度若欲知各宿距度广狭者法当以一衡正对距星又以一衡正对次宿距星则两衡间赤道度分即夲宿赤道度分矣若欲知中外官星入宿深浅者法当以一衡对定所入宿距星复以一衡正对此星稽两衡间赤道即得此星入宿度分矣既用二衡即亦可两人并测故曰定距入宿两候齐视也
　　巍巍其髙莫莫其遥荡荡其大赫赫其昭歩仞之间肆所赜考明乎制器运掌有道法简而中用宻不穷厯考古陈未有侔功猗与皇元发帝之蕴畀厥羲和万世其训
　　简仪之制及其用法上文已明此则赞其制作之善归羙夲朝也言天道如斯髙逺乃今测诸歩仞之间如示诸掌则制器有道耳其为法也简而适中其为用也宻而不穷歴攷古制未有如我皇元斯器之善
<子部,天文算法类,推步之属,历算全书>
　　厯学骈枝自叙
　　厯犹易也易传象以数犹律也律制噐以数数者法所从出而理在其中矣世乃有未习其数而嘐嘐然自谓能知厯理虽有髙言雄辨广引博稽其不足以折畴人之喙眀矣而株守成法者复不能因数求理以眀其立法之根于是有沿误传讹而莫之是正厯所以成絶学也然理可以深思而得数不可凿空而撰然则茍非有前人之遗绪又安所乎【鼎】自童年受易于先大父又侧闻先君子余论谓象数之学儒者当知谨识之不敢忘壬寅之夏获从竹冠倪先生受台官通轨大统厯算交食法归与两弟依法推步疑信相参乃相与晨夕讨论为之句栉字比不惮往复求详遇所难通则废瞑食以助其愤悱夫然后气朔发敛之由躔离朓朒之序黄赤道差变之率交食起复满之算稍稍闚见藩篱乃知每一法必有一根而数因理立悉本实测为端固不必强援钟律牵附蓍卦要其损益进退消息往来于易于律亦靡弗通也爰取商确之语録系本文之下义从浅近俾可共晓辞取眀畅不厌申重庶存一时之臆见以为异时就正之借虽于厯学未必有禆亦如骈拇枝指不欲以无用折之云尔
　　康熙元年岁在元黓摄提格相月既望又三日宣城山口梅文鼎书于陵阳之东楼










　　厯学源流
　　夫治厯以明时乃古今之大典而气朔为之首章以总七政之要当时有载太史令郭公守敬因气朔之不齐遂攷景以验气更立四十尺之表测至元十八年辛巳岁前天正冬至恒气日则己未丑初一而为元曰授时谓授人时而已距来岁之冬至则三百六十五万二千四百二十五分为一岁之实以二十四气约之是知每气一十五万余二千一百八十四分三十七秒半为之气盈一月凡二气计盈四千三百六十八分七十五秒也其月有迟疾而三十日之间与日防之同度曰合朔然此非交食无以攷也今朔距来朔则二十九万五千三百○五分九十三秒为朔实是知一朔之实而少四千六百九十四分○七秒不及三十日为之朔虚并一月之气盈得九千○百六十二分八十二秒曰月闰积一年凡一十○万八千七百五十三分八十四秒曰岁闰积三年而过朔实有三万余是三年一闰而名曰正闰积五年复成再闰稍未及二朔之实积十九年成七闰为一章之终亦不及七朔实之八百余分也所以五年之十九年之闰皆曰余闰稽之于韵闰即余也余即闰也故曰闰余成岁厯之既成在元凡八十七年迨至我
　　朝尤重之勅太史令王公恂撰之立成元公统注诸通轨契厯经不言之奥开来学未遇之疑既而更太史院为钦天监实敬天勤民之盛心授推步官为保章正乃设职从政之美意又何以加于是乎故为序
　　右厯学源流一篇不知谁作味其语意首言气朔为首章葢即首章之序也案元史授时厯经本有七章曰气朔曰发敛曰日躔曰月离曰中星曰交防曰五星而本书合气朔发敛为一章又取日躔章之盈缩差月离章之迟疾差使相附丽则经朔之后即求定朔颇便于用大致亦本厯草也然不用授时消分则元统氏之为也元统所传厯法于日躔月离交防五星皆有通轨而此章独无葢乆为畴人所习简明易知无烦改作也作此序者又在元统之后其言气盈朔虚置闰甚有原委字句朴简犹存古意故仍冠其首












　　释凡四则
　　一印心
　　厯生于数数生于理理与气偕其中有神焉而不乱也变焉而有常也于是圣人以数纪之尧命羲和舜在玑衡皆是物也中遭秦炬先宪略亡自太初以后作者数十家人各效才王郭肇兴大成斯集夫天不变理亦不变故厯代贤者往往验天以立法要皆积有其毕生之精力始得其一法之合于理有圣人虽起不能易者而后垂之不刋以至今鼎何人也敢与于斯夫创起者难为功观成者易为力昔人縁理以立数今兹因数以知理期以信吾心焉耳矣所不能信者不敢知也其或章句繁复往复谆然夫必如是而后自信以信于古人僭越获罪既无所逃拘滞固陋诒诮通方幸有以敎
　　一存疑
　　大统厯法所以仍元法不变者谓其法之善可以永久也夫既仍辛巳之元合用授时之数乃以今所传较之厯经参伍多违岂别有説愚故不能无疑也按厯经上考往古则岁实百年长一周天百年消一下验将来则岁实百年消一周天百年长一此其据往以知来自尧典征降而诸史所载可以数求者当时则既一一验之矣而今所传岁实一无消长此其可疑一也又按厯经诸应等数随时推测不用为元固也今则气应仍是五十五日○六百分周应仍是箕十度至于闰原是二十○万一千八百五十分今改为二十○万二千○五十分较授时后二百分转应原是一十三万一千九百○四分今改为一十三万○千二百○五分较授时先一千六百九十九分交应原是二十六万○千一百八十七分八十六秒今改为二十六万○千三百八十八分较授时后二百○○分一十四秒或差而先或差而后以之上考辛巳必与元算不谐若据厯经以步今兹亦与今算不合然则定朔置闰月离交防之期又安所取也岂当时定大统厯有所测验而改之与夫改宪则必另立元今气应周应俱同而独于数者有更此其可疑二也又按厯经盈缩迟疾皆有二术其一术不用立成其一术用立成然只有用之之法而无其图其迟疾图则又仍如古式只二十八日母数而无逐限细率意者当时修史者之遗忽与抑有所禁秘也今据此所载立成以求盈缩二术俱谐以求迟疾则自八十三限以至八十六限与前术有所不合意其所谓立成者有异欤据元史王恂先卒其立成之藁俱未成书郭公守敬为之整齐意者厯经前术为王公未定之藁与此其可疑三也又如日月食开方数乃所求食分横过半径之数据厯经皆五千七百四十乘之今改月食者为四千九百二十乘是所测闇虚小于原所测者二十分也则其所测月轮圆径亦小于原测一十分也茍非实有测验于天又何敢据此以非彼与茍非于交食之际立浑比量周径纵横之数何从而定与茍非于亏复之际下漏刻以验之定用分之多少何自而知与此其可疑四也又有自相背驰如立成所载日出入半昼分是自冬至夏至后顺数只问盈缩不言初末而通轨求日出入法又似有初末二图此言不可意断者至于昼夜永短与元史所载大都刻数不同则以北极高下黄道因之所在而殊理固然也然篇首既不言郡省撰名复载王恂岂当时九服晷漏之永短皆推有图而元史止载其一欤然毕竟此所列者据何地为则也此其可疑五也凡此数端同异出入未敢偏据姑即所传畧附笺疏去取是非俟之君子
　　一刋误
　　大抵一书传经数手多非其旧或誊冩鲁鱼或简编蠧蚀故君子慎阙疑也乃若专守残文习焉不察有所未解强入以己意参之遂使斲轮不传糟粕并失金根辄改燕郢何凭今于其尤谬乱者是正数条或据厯经或据本书非敢逞私凭臆以重获戾于古今也一者日月食限乃算家所凭以定食不食者也而今所载或失而出或失而入失而入不过虚费筹筞而已失而出则将据此以断不食其有不合将以疑立法之不详今皆据隂阳食限极之诸差所变以为常准即准本书以定似为稍密脱有不合其必非本算所能御矣其日食夜刻月食昼刻亦据本书及厯经所载时差并定用分得之其月带食若据厯经定用分尚有微差亦不多也一者月食时差分据厯经为定葢厯考古厯皆与此所载不合故断从经一者黄道定积度原以岁差推变自大衍以后为法畧同今若定钤何异胶柱今断从厯经仍以天启辛酉一年步定为式一者月食既内分据厯经原以既内分与一十分相减相乘平方开之也今则讹为一十五分夫月食十分而既其既内五分倍之为十分而止矣安得有所谓既内十五分乎今以较求句股法求得既内小平圆积数皆与所求相应一如厯经原法故断从之别有图説以证其理一者日月带食凡日出入分在初亏已上复圆已下是为带食而出入也今则讹为初亏已上食甚已下是得其半而失其半求之厯经亦复仍讹故愚亦不敢全据歴经者谓有此等处也今据后已复光未复光条改为复圆分已下厥数实谐于理亦畅又月食通轨前所録数定望并晨分下注误又月食分秒定子法误又月食定用分并既内分定子俱误又月食更防归除法并定数法俱误又迳求次年天正交泛分条误多有闰无闰每月加数今皆刋正
　　一补遗
　　算有所必不可畧句与字有所必不可无而或无之或畧之则非作法者之故为秘惜也如日食交前后条正交交定度在七度已下数虽在正交度下而实则阳厯交后度也法宜加交终度减之此算之所必不可畧者也乃此书既不之载至元歴经亦复阙焉何也夫此亦数之易知当必非所甚秘岂非梨枣铅椠者之责乎将谓精于算者自能知之而无所用书欤今辄断之以理重为补定古人而得见我何以幸教之也【续读学厯小辨所载大统交食法有在七度以下食在正交语足与愚説相证】又如定子法为乘除后进退而设甚便于初学其立法立意不可谓不至也乃多有遗去言十定一不满法去一二语者夫定子所以御乘除之变而此二语又所以通定子之穷若无此二语则何如不定子之为愈乎又如求天正赤道黄道度二条皆不用定子夫赤道不定子知其所减者为度位乎为分位乎黄道乘除不用定子固也然何以处夫除不满法与夫减过积度只剩秒防者乎又如食甚入盈缩条遗食甚甚字夘酉前后条遗定望望字凡此皆字与句之所必不可无者也今皆补定













　　钦定四库全书
　　厯算全书卷二十一
　　宣城梅文鼎撰
　　厯学騈枝卷一
　　大统厯歩气朔用数目录
　　元世祖至元十七年辛巳嵗前天正冬至为厯元按古厯并溯太古为元各立积年未免牵合故乆而多差惟授时厯不用积年截用至元辛巳为元一慿实测而无假借故自元迄明承用三四百年法无大差以视汉晋唐宋之屡改屡差不啻霄壤故曰授时厯集诸家大成盖自西厯以前未有精于授时者徐文定公厯书亦截崇祯戊辰为元而废积年用此法也【又按大统厯以洪武甲子为元然易其名不易其实故台官布算仍用至元辛巳也】
　　周天三百六十五万二千五百七十五分
　　半周一百八十二万六千二百八十七分半
　　天体浑员自角初度顺数至轸末度得周天度分均剖之即半周天
　　按天本无度因日躔而有度古厯代更天度异测授时厯用简仪实测当时度分视古为密
　　度法一万分
　　按古厯以日法命度并有畸零【如太初厯以八十一分为日法大衍厯以三千四百分为日法而度法因之亦有畸零】惟授时厯不用日法故一度即为一万分而周天三百六十五度二五七五分即命为三百六十五万二千五百七十五分此王郭诸公之卓见超越千古也又按授时厯周天百年长一今大统不用此其与授时防异者也
　　嵗周三百六十五万二千四百二十五分
　　嵗周一名嵗实自今嵗冬至数至来嵗冬至得此日数实不及周天一百五十分而嵗差生焉
　　半嵗周一百八十二万六千二百一十二分半
　　均剖嵗周也自天正冬至算至本年夏至又自本年夏至数至本年冬至其日数并同
　　气防一十五万二千一百八十四分三十七秒半置嵗周日数以二十四气平分之得此日数谓之恒气
　　日周一万分【自今日子正至来日子正共得此数】　刻法一百分【毎日百刻故也】旬周六十分【自甲子至癸亥六十日之积分】　　纪法六十日【即旬周也】按日周一万分乃整齐之数故旬周亦整六十日也太阳行天每日一度前云度法万分者亦以此也并以整万分立算而无畸零故曰不用日法也又按授时厯嵗周上考已往百年长一分下推将来百年消一分大统省不用故不言也
　　通余五万二千四百二十五分
　　置嵗周减六旬周得余此数即五日二十四刻二十五分乃一年三百六十日常数外之余日余分
　　气应五十五万○千六百分
　　此授时厯所用至元辛巳天正冬至为元之日时也是为己未日丑初一刻乃实测当时恒气之应上考已往下求将来并距此立算以此为根也其数自甲子日子正初刻算至戊午日夜子初四刻得五十五日又自己未日子正初刻算至丑初一刻得六刻合之为五十五万零六百分
　　嵗防三百五十四万三千六百七十一分一十六秒此十二朔策之积也自今年正月经朔至来年正月经朔得此积分或置嵗实内减嵗闰亦同
　　朔防二十九万五千三百○五分九十三秒
　　此太隂与太阳合朔常数乃晦朔朢一周也自本月经朔至次月经朔得此积分又谓之朔实乃十二分嵗防之一
　　朢防一十四万七千六百五十二分九十六秒半此朔防之半乃二十四分嵗防之一自经朔至经朢又自经朢至次月经朔并得此数又谓之交朢
　　防七日三千八百二十六分四十八秒二五
　　此朢策之半乃四分朔策之一自经朔至上又自上至经朢又自经朢至下至次月经朔其数并同
　　月闰九千○百六十二分八十二秒
　　此一月两恒气与一经朔相差之数置气防倍之得三十○万四千六十八分七十五秒内减朔防得之
　　嵗闰一十○万八千七百五十三分八十四秒
　　此十二个月闰之积也亦名通闰
　　闰应二十○万二千○百五十○分
　　此至元辛巳为元之天正闰余也盖即己未冬至去经朔之数当时实测得辛巳嵗前天正经朔是三十四万八千五百五十分即至元庚辰年十一月经朔为戊戌日八十五刻半为戌正二刻也
　　闰凖一十八万六千五百五十二分○九秒
　　置朔防内减嵗闰得之
　　盈初缩末限八十八日九千○百九十二分二十五秒此冬至前后日行天一象限之日数盖冬至前后一象限太阳每日之行过于一度故也【四分嵗周所行度得九十一度三一○六二五为一象限】
　　缩初盈末限九十三日七千一百二十○分二十五秒此夏至前后日行天一象限之日数也盖夏至前后一象限太阳毎日之行不及一度故也
　　按盈初者定气冬至距定气春分之日数缩末者定气秋分距定气冬至之日数也此两限者并以八十八日九十一刻稍弱而行天一象限缩初者定气夏至距定气秋分日数盈末者定气春分距定气夏至日数也此两限者并以九十三日七十一刻有奇而行天一象限今现行时宪厯节气有长短即此法也又按古厯每日行一度原无盈缩言盈缩者自北齐张子信始也厥后隋刘焯唐李淳风僧一行言之綦详厯宋至元为法益密然不以之注厯者为闰月也大衍厯议曰以恒气注厯定气算日月食由今以观无处不用但每月中节仍用恒气不似西洋之用定气耳西洋原无闰月只有闰日故以定气注厯为便若中土之法以无中气为闰月故以恒气注厯为宜治西法者不谙比气辄诃古法为不知盈缩固其所矣
　　转终二十七万五千五百四十六分
　　此月行迟疾一周之日数也内分四限入转初日太隂行最疾积至六日八十余刻而复于平行谓之疾初限厥后行渐迟积至十三日七十七刻奇而其迟乃极谓之疾未限于是太隂又自最迟以复于平行亦六日八十余刻谓之迟初限厥后行又渐疾亦积至十三日七十七刻奇其疾乃极如初日矣谓之迟末限合而言之共二十七日五十五刻四十六分而迟疾一周谓之转终也
　　转中一十三万七千七百七十三分
　　即转终之半【解见上文　其数一名小转中】
　　转差一万九千七百五十九分九十三秒
　　置朔策内减转终得之乃相近两经朔入转之相差日数也
　　转应一十三万○千二百○五分
　　此至元辛巳天正冬至日入转日数也盖实测得冬至己未日丑初一刻太隂之行在疾末限之末日也
　　交终二十七日二千一百二十二分二十四秒
　　此太隂出入黄道阳厯隂厯一周之日数也
　　交差二日三千一百八十三分六十九秒
　　置朔防内减交终得之乃相近两经朔入交之相差日数也
　　交应二十六万○千三百八十八分
　　此至元辛巳天正冬至入交泛日也【乃实测冬至己未日丑初一刻月过正交日数】
　　气盈○日二千一百八十四分三十七秒半
　　此气策内减十五整日外余此数【一月两恒气共盈四千三百六十八分七十五秒】
　　朔虚○日四千六百九十四分○七秒
　　置三十日内减朔策得之乃一朔防少于常数三十日之数
　　没限○日七千八百一十五分六十二秒半
　　置日周一万内减气盈得之
　　土王防一十二日一千七百四十七分五十○秒又土王防三日○千四百三十六分八十七秒半按土王防一名贞防置嵗实以五除之得七十三日○四八五为一嵗中五行分王之日数又为实以四除之得一十八日二六二一二五为每季中土王日数内减气防得余三日【○四三六八七五】为土王防乃自辰戌丑未四季月中气日逆推之数土王防四因之得十二日【一七四七五】亦为土王防乃自四季月节气日顺数之数二者只须用一今并存者所以相考也
　　宿会二十四万
　　宿余分一万五千三百○五分九十三秒
　　日直宿二十八日一周是为宿会以宿会减朔实得宿余
　　限防九十○限○六八三○八六五
　　置防以十二限二十分乘之得此数故以全加得次限
　　限总一百六十八限○八三○六○【一名中限】
　　置小转中以十二限二十分乘之得此数故限防加满则用以全减
　　朔转限防二十四限一○七一一四六
　　置转差以十二限二十分乘之得此数故以全加得次朔限
　　按以上三者为求迟疾限之捷法然可不用盖既有日率相减之法则十二限二十分乘之法已为筌蹄何况限防
　　盈防六十九万六千六百九十五分二十八秒
　　置气盈分为实以气防除之得毎日盈一百四十三分五三四七七五转用为法以除日周得每六十九日六六九五二八而盈一日是为盈防故以加盈日即得次盈
　　虚防六十二万九千一百○四分二十二秒
　　置朔虚分以朔防除之得毎日虚一百五十八分九五六一七一转用为法以除日周得六十二日九一○四二二而虚一日是为虚防故以加虚日即得次虚
　　大统厯歩气朔法
　　求中积分
　　置嵗实三百六十五万二千四百二十五分为实以距至元辛巳为元之积年减一为法乘之即得其年中积分【定数以嵗实定六子以积年视有十年定一子百年定二子乘法言十加定一子得数后共以八子约之为亿也】如径求次年中积分者加一嵗实即可得之中积分者自所求年天正冬至逆推至辛巳为元之天正冬至中间所有之积日积分也积年减一者以嵗前天正冬至为立算之根故也假如康熈元年壬寅距至元十七年辛巳该三百八十二算法祗以三百八十一年入算是为减一用之也盖欲算本年之气朔必以年前天正冬至为根是所求康熈壬寅年之中积分乃顺治辛丑年十一月冬至之数故也定子法者为珠算定位设也其法十定一子百定二子千定三子万定四子十万定五子百万定六子千万定七子亿万定八子嵗实首位是三百万故定六子积年有十定一有百定二皆一法也言十加定一子者以乘法首位言之凡法首位与实首位相呼九九数有言十之句则得数进一位故加定一子此条原文缺此句余所补也得数以八子约之为亿者谓视原定之子若有八子则乘得数首位是亿也未乘之先视法实之数以定子故既乘之后即据所定之子以定得数此法最便初学也
　　附嵗实钤
　　千百十万
　　一　　三六五二四二五　　凡用钤自单年起有二　　七三○四八五○　　十年则进一位用之三　一○九五七二七五　　有百年又进一位即四　一四六○九七○○　　得所求中积分并以五　一八二六二一二五　　单年无定之位推而六　二一九一四五五○　　上之即算位俱定七　二五五六六九七五
　　八　二九二一九四○○
　　九　三二八七一八二五
　　求通积分
　　置所得其年中积全分加气应五十五万○千六百分即得所求通积分如径求次年亦加嵗实
　　前推中积分是从辛巳厯元天正冬至起算今加气应是又从辛巳厯元冬至前五十五日○六刻起即甲子日子正初刻也
　　求天正冬至
　　置通积全分满纪法六十万去之余为所求天正冬至分也万以上命起甲子算外为冬至日辰【欲求时刻依发敛加时条求之见后】如迳求次年者不拘有无闰月并加通余五万二四二五满纪法去之即得
　　通积分既从甲子起算故满纪法去之即知日辰也算外命日辰者以有小余也凡满万分成一日者为大余九千分以下皆为小余大余为日乃先一日之数小余为时刻乃为本日故取算外也
　　求天正闰余分
　　置其年中积全分如闰应二十○万二千○百五十分为闰积以满朔实二十九万五千三百○五分九十三秒除之为积月其不满者即为所求年天正闰余分也闰余分满闰凖一十八万六五五二○九者其年有闰月【补法闰余满十六万八四二六四五以上者其年冇闰如用闰凖须加两月闰】如迳求次年天正闰余者不拘有无闰月并加通闰一十○万八七五三八四满朔策去之即得【如却求前嵗闰者置本年闰余内减通闰得之闰余小于通闰不及减加朔实减之即是】
　　闰余分者乃嵗前天正冬至距天正经朔数也法当自辛巳厯元天正经朔起算故以闰应通之也闰凖是朔实内去十二个月闰之数若闰其年十一二月者此法不能御故有补法也若于所得闰余分加一万八千一百二十五分六四【两月闰之数】再用闰凖取之亦同
　　附经朔钤
　　百十万
　　一　　二九五三○五九三　闰积内与经朔钤数二　　五九○六一一八六　同者减去之减至不三　　八八五九一七七九　满一朔实二十九万四　一一八一二二三七二　五三○五九三而止五　一四七六五二九六五　其余数即闰余分六　一七七一八三五五八
　　七　二○六七一四一五一
　　八　二三六二四四七四四
　　九　二六五七七五三三七
　　求天正经朔
　　置其年通积全分内减去其年闰余全分满纪法六十万去之余为所求天正经朔分
　　又法置冬至内减闰余即得经朔如冬至小于闰余不及减加纪法六十万减之如迳求次年天正经朔者无闰加五十四万三六七一一六【十二朔实去纪法之数】有闰加二十三万八九七七○九【十三朔实去纪法之数】并满纪法去之即得
　　朔者日月同度之日经者常也经朔者朔之常数所以别于定朔也古人只用平朔故日蚀或在晦二唐以后始用定朔则蚀必于朔然不知经朔则定朔无根故必先求定朔
　　先推通积分自厯元甲子日算至冬至减去闰余是从甲子日算至经朔故去纪法即得经朔之大小余也
　　先推冬至分是以纪法减过通积而得乃冬至前甲子日距冬至数内减闰余即为甲子日距经朔数也如冬至小于闰余是此甲子日虽在冬至前却在经朔后故加纪法减之是又从经朔前甲子算起也求天正盈缩厯
　　置半嵗周一百八十二日六二一二五内减去其年闰余全分余为所求天正缩厯也【补法若其年冬至与经朔同日而冬至加时在经朔前则天正经朔入盈厯】如迳求次年天正缩厯者内减去通闰一十○万八七五三八四得之减后视在一百五十三日○九以下者再加一朔防即是
　　按冬至交盈厯夏至交缩厯各得嵗周之半今置半嵗周是减去盈厯半周只用缩厯半周从夏至日算至冬至日之数也内减闰余即为从夏至算至十一月经朔日数故恒为缩厯
　　亦有入盈厯者其前必有闰月而至朔同日冬至小余又小于经朔小余先交冬至后交经朔其经朔已入盈厯法当于经朔小余内减去冬至小余命其余为天正盈厯也若冬至小余大于经朔小余不用此法盖虽至朔同日而朔在至前仍为缩厯此处原本所缺故备着之
　　凡闰余加通闰即为次年闰余今所得天正缩厯是半周内减闰余之数于中又减通闰即如减次年闰余矣故迳得次年天正缩厯也一百五十三日○九以下者半周内减一朔防也减后得此必有闰月在次年天正经朔前故必复加朔防而得次年天正朔厯也
　　求天正迟疾厯
　　置其年中积全分内加转应一十三万○二○五减去其年闰余全分为实以转终二十七万五五四六为法除之其不满转终之数若在小转中一十三日七七七三以下者就为所求天正疾厯也若在小转中以上者内减去小转中则为天正迟厯也
　　如迳求次年天正迟疾厯者加二十三日七一一九一六【十二转差积数】经闰再加转差一日九七五九九三并满转终去之迟疾各仍其旧若满小转中去之者迟变疾疾变迟也
　　中积分原从厯元冬至起算至所求天正冬至止今加转应减闰余是从厯元冬至前十三日初交疾厯时起算至所求年天正经朔止故不满转终即为天正疾厯也转中者转终之半故疾厯满此即变迟厯也
　　附转终钤
　　百十万
　　一　　二七五五四六
　　二　　五五一○九二
　　三　　八二六六三八
　　四　一一○二一八四
　　五　一三七七七三○
　　六　一六五三二七六
　　七　一九二八八二二
　　八　二二○四三六八
　　九　二四七九九一四
　　求天正入交泛日【原本作交泛分今依厯经改定】
　　置中积减闰余加交应二十六万○三八八为实以交终二十七万二一二二二四为法除之其不满交终之数即为所求天正入交泛日及分也
　　如迳求次年天正入交日者无闰加六千○百八二○四【十二交差内减去交终之数】有闰加二万九千二百六五七三【十三交差内减去交终之数】即得
　　中积减闰余与求迟疾法同加交应是从辛巳厯元前二十六日初入正交时算起也故不满交终即为天正入交日也泛者对定而言也有经朔有定朔则入交之深浅亦从之而移此所得者经朔下数故别之曰泛
　　附交终钤
　　百十万
　　一　　二七二一二二二四
　　二　　五四四二四四四八
　　三　　八一六三六六七二
　　四　一○八八四八八九六
　　五　一三六○六一一二○
　　六　一六三二七三三四四
　　七　一九○四八五五六八
　　八　二一七六九七七九二
　　九　二四四九一○○一六
　　推经朔次气及望法
　　置天正经朔全分加五十九万○六一一八六【即二朔防】满纪法六十万去之为所求年正月经朔累加朔防二十九万五千三百○五九三为逐月经朔累至次年天正经朔必相同也【次年天正经朔在本年为十一月】复以朢防一十四万七六五二九六五累加各月经朔得经朢又加之即得次月经朔　复以防七万三八二六四八二五累加经朔得上加上即复得经朢又加之得下又加之复得次月经朔　凡累加时并满纪法去之其复得数必与原推分秒不异【或先加防次加朢防亦同】
　　前有迳求次年天正经朔法与此挨次累加之数互相参考即知无误算法还原之理也以后并同
　　推恒气次气法
　　置天正冬至日及分加四十五万六五五三一二五【即三气防】满纪法去之为所求年立春恒气累加气策一十五万二一八四三七五满纪法去之得各恒气加至本年冬至即与前迳推次年天正冬至相同也
　　附二十四恒气钤

<子部,天文算法类,推步之属,历算全书,卷二十一>








　　立春【次年】正月节　五十○万八九七八一二五右钤以加天正冬至满纪法去之即迳得各月恒气大小余
　　凡恒气大余命起甲子算外得日辰小余命时刻【依发敛加时条取之】并同冬至法
　　推盈缩厯次气法
　　置天正盈缩厯日及分加五十九万○六一一八六满半嵗周一百八十二日六二一二五去之为所求年正月经朔下盈厯也累加朔防二十九万五三○五九三为逐月经朔盈厯也盈厯加满半嵗周去之交缩厯又累加之满半嵗周去之复交盈厯也【累加至十一月即与次年天正盈缩厯相同】　复以防七万三八二六四八二五累加之各得朢乃次朔之盈缩厯也【至次朔亦必相同】
　　盈厯满初限八十八日九○九二二五为有末之盈缩厯满初限九十三日七一二○二五为有末之缩
　　推初末限法
　　置半嵗周一百八十二日六二一二五内减有末之盈缩厯全分余为所求各末限日分也　复于各盈缩末限日分累减防七万三八二六四八二五得各朢及次朔下盈缩末限必相同也　若不及减防者末限已尽盈交缩缩交盈也【补法置防以不及减之余末转减之即各得所交盈缩初限日分相同也】
　　凡盈厯算起冬至缩厯算起夏至并从盈缩初日顺推至所求日时若盈末则算起夏至缩末则算起冬至并从盈缩尽日逆推至所求日时故置半嵗周减之而得末限日分也
　　所得末限日分是所求日时距盈缩末尽日逺近之数朔而朢入厯益深则其距末尽日益近故在初限累加防者在末限即用累减而得也
　　推盈缩差法
　　置盈缩厯全分【若系末限则置所得末限全分】减去大余不用只用小余【有千分定三有百定二有十定一】并以立成相同日数下取其盈缩加分为法乘之【加分有百定二有十定一言十加定一子】得数以所定八子约之为度位乃于立成本日下所有盈缩积与得数相倂即得所求盈缩差
　　凡言八子或九子约之为度者乃是于得数上定此虚位以便与盈缩积度相加非言得数有八子九子也假如八子为度位而原所定只有五子即得数为度下三位若盈缩积有度即度得数上第三位加之法于得数首位呼五字逆上数之曰五六七八至八字住于此加积度即无误也迟疾厯同
　　盈缩加分是本日太阳行度或过或不及于一度之分也【或日行过于一度而有余分是为盈加分或日行不过一度而有欠分是为缩加分】盈缩积度则是本日以前加分累积之数也【总计逐日盈加分为盈积度总计逐日缩加分为缩积度】法当以小余乘本日加分为实日周一万分为法除之即得小余时刻内所有之加分乃以得数倂入本日以前原有之积度则为本日本时之盈缩差矣【厯经云万约为分即是以日周一万除乃本法也】兹以定子法约之故以八子为度所得亦同【假如以千乘百共定五子则所得乘数为十万分就用为实以日周一万为法除之当去四子剰一子则所得除数成十分是于度下为第三位也何以言之盖度下有千有百故十分为第三位今于所定五子虚进三位至八子位命为度以加积度即得数十分适居度下第三之位而相加无误矣　前条八子命亿而此以八子约为度何也曰无二理也八子于乘得数原是亿位盖亿即一万万用万万为实以一万为法除之当去四子剩四子则除后得数为万而成度位今不去子故以八子为度其实即厯经万约为分之法非有二也】
　　问初限是从盈缩初日顺推【盈初从冬至起算缩初从夏至起算并数其已过之日】其小余亦顺推【并自本日子正刻起顺下丑寅数至所求时刻】若末限则是从盈缩末尽日逆数【盈末距夏至立算缩末距冬至立算皆数其未到之日】其小余亦逆数【并自本日夜子初刻逆转亥戌数至所求时刻】而加分乘小余加积度之法并无有异且盈缩互用【盈末所用之加分积度即缩初之数缩末所用之加分积度即盈初之数】何也曰凡初限所积之盈缩度分并为末限之所消【假如盈初限共有积盈度二度四十分一交盈末即每日有所缩以消其积盈直至盈末尽日其盈消尽而交夏至为缩厯矣又如缩初限共有积缩度二度四十分一交缩末即每日有所盈以消其积缩直至缩未尽日其缩消尽而交冬至复为盈厯矣】故同一加分也在初限为日增之分在末限则为日消之分【假如盈末限未到夏至若干日与缩初限已过夏至之日数等则其日行度之所缩亦等故盈末日即用缩加分又如缩末日与盈初限之日数等则其距冬至等而日行之所盈亦等故缩末日即用盈加分】同一积度也在初限为己积之度分若末限则为未消之度分【假如盈末毎日内各有缩加分以消其盈而今盈末尚有若干日则其缩加分末用而积盈亦未消累而计之其数必与缩初限相同日数下之积度等故即用缩积度为盈积度也缩末即用盈积度为未消之缩积度其理亦同】今末限既有小余则此时刻内亦必有未消之零分在积度外故以小余乘加分而万约之【即八子为度之法解已见前】倂入积度即知此日此时尚有未经消尽之积度共若干度分而命之为盈缩差矣【盈末日虽用缩加分缩积度数而仍为盈差缩末日虽用盈加分盈积度数而仍为缩差盖其加分积度为逐日之盈缩而盈缩差分是总计初日以来之盈缩故也】
　　推迟疾厯次气法
　　置天正迟疾厯日及分加三日九五一九八六【两转差数】为所求年正月经朔下迟疾厯也以后累加转差即得各月经朔下迟疾厯也凡加后如满小转中一十三万七七七三者去之疾变为迟迟变为疾不满者迟疾不变累加至十一月即与次年天正迟疾厯相同也　复以防七日三八二六四八二五累加之各得朢及次朔之迟疾厯亦满小转中去之变迟疾也
　　本宜累加朔防而去转终今用转差是防法其得数同也
　　附转差钤
　　一　　一日九七五九九三　用钤加正月经朔下二　　三日九五一九八六　迟疾厯可迳求各月三　　五日九二七九七九　迟疾厯若加满小转四　　七日九○三九七二　中去之疾变迟迟变五　　九日八七九九六五　疾也
　　六　十一日八五五九五八
　　七　　○日○五四六五一　自七个月以后为减八　　二日○三○六四四　过小转中之后加后九　　四日○○六六三七　即变迟疾若加满小十　　五日九八二六三○　转中去之反不变也十一　七日九五八六二三
　　十二　九日九三四六一六
　　推迟疾厯限数法
　　置迟疾厯日及分【十日定五单日定四○日有千定三○日○千有百定二有十定一】以十二限二十分【定一】为法乘之【言十定一】得数以所定有四子为单限五子为十限六子为百限即得各迟疾厯限数如迳求次朢之限数者【如自朔求上自上求朢之类】每加限
　　防九十限即得加满中限一百六十八限去之则变迟疾　如超次月【如以朔求次朔以上求次月上之类】累转加朔转限防二十四限一○即得【亦满中限去之而变迟疾】如累加之至十个月间有多一限乃二十分尾数积成故有退一限减之之法不必致疑皆以日率为定也
　　迟疾分限数何也太隂行天有迟疾其迟疾又有初末与太阳之盈缩同所不同者太阳之盈缩以半嵗周分初末而其盈缩之度止于二度奇太隂之迟疾以十三日七十七刻奇分初末而其迟疾之度至于五度奇【疾初只六日八十八刻奇而疾五度迟初只六日八十八刻奇而迟五度】厯家以八百二十分为一限【即八刻竒】一日分十二限二十分而自朝至暮逐限之迟疾细分可得而求矣
　　捷法以所得迟疾厯与立成中迟疾日率相较择其相近者用之【或所得迟疾厯日及分即立成内日率相同或稍强于日率即可取用】即可迳得限数【此法可免十二限乘亦即无退退一限减之之事余所补也】
　　推迟疾差法
　　置迟疾厯日及分以立成内相同限下日率减之【如立成日率大不及减即退一限减之】用其余分为实【有百分定四子十分定三子单分定二子十秒定一子】以其下损益分【十分定五子单分定四子十秒定三子单秒定二子】为法乘之【言十定一】得数又为实以八百二十分【去二子】为法除之【不满法又去一子】得数取所定八子为度位视立成是益分即于得数上依位加本限下迟疾积度【如盈缩差加积度法】若是损分即置迟疾积度内减去得数【如八子为度位而所定只五子则于度下第三位减之余仿此】即各得所求迟疾差
　　迟疾日率者毎限八百二十分之积数也【如满八百二十分则为一限满两个八百二十分则为二限乃至满十个八百二十分即为十限百个八百二十分即为百限故曰日率】而所得迟疾厯未必能与各限之日率巧合而无零分故以此日率减之即知此日太隂之行度己足过若干限而尚余若干时刻也【毎限八百二十分即八刻奇未满此数皆为零分】
　　损益分者各限内迟疾进退之差也自初限至八十三限为益分其迟疾为进也【在疾厯则益其疾在迟厯亦益其迟故并为益分】自八十四限至一百六十八限为损分其迟疾为退也【在疾厯则损其疾在迟厯亦损其迟故并为损分】此损益分皆整限八百二十分之数零分所有之损益必小于八百二十分之损益故以零分乘八百二十分除也
　　迟疾积度者是本限以前所积之迟疾度分也【如在八十三限以前则为日益之积数八十四限以后则为日损之余数】于是以所得零分内之损益分损之益之便知此时此刻内太隂之迟疾所不同于平行者共有若干度分而命之为迟疾差也
　　定子之法千三百二则万四常为度位而此与盈缩差并用八子者盈缩差原是万约为分宜去四子今省不去故八子即是四子也此求迟疾之损益是以八百二十除原非万约为分而亦用八子为度者因乘时加定四子【余分百定四子是加定二子也损益分之十分是度下一位宜定千三今定五子是又加二子也合之共加定四子】则八子亦是四子其故何也迟疾厯遇八十一限至八十六其损益分多为单秒则定子之法穷故加四数以豫为之地也
　　不满法又去一子者亦以相除时算位言之【假如法是八实亦是八或八以上可以除得一数即为满法若实在八以下即不能除得一数当退位除之即为不满法也此不论十百千万之等惟论自一至九之数假如以八十除六百亦为不满法若以八百除九十亦为满法皆以得数有进位不进位而分算中精理也】盖除法本是降位【如用十为除法是以十为一当降一位故去一子百为除法是以百为一当降两位故去二子】今不能除得一数而退位除之是又降一位故再去一子也按古厯太阳朓朒之行但有各恒气十五日奇之总率而无毎日细数太隂朓朒之行但有毎一日之总率而无一日内分十二限奇之细数有之皆自授时始皆以平立定三差得之授时之密于古法此一大端也
　　推加减差法
　　视各经朔朢下盈缩差与迟疾差如是盈迟缩疾为同名则相倂用之如是盈疾缩迟为异名则两数相较用其余分【有万定四子千定三子百定二十定一】以八百二十分【定二子】乘之【言十定一】得数为实以立成本限下迟疾行度为法【迟用迟行度疾用疾行度并以万去四子千去三子】除之【不满法又去一子】得数以所定有三子为千分二子为百分即得所求加减差
　　同名者　盈迟为加差　　　缩疾为减差
　　异名者　盈多疾少为加差　疾多盈少为减差迟多缩少为加差　缩多迟少为减差
　　加减差者时刻之进退也前论盈缩迟疾二差则行度之进退也因日月之行度各有纾亟而时刻因之进退故前既分求之兹乃论之也
　　以右旋之度言之日每日平行一度月每日平行十三度有竒合朔时日月同度厯防七日【三八二六四八二五】而月度超前离日一象限是为上又厯防而月度离日半周天与日对度是为朢自此以后月向日行又厯策而距日一象限是为下更厯防而月追日及之又复同度而为合朔矣凡此者皆有常度有常期故谓之经朔经朢经也乃若定朔定朢定则有时而后于常期故有加差焉有时而先于常期故有减差焉
　　凡加差之因有二一因于日度之盈夫日行既越于常度则月不能及一因于月度之迟夫月行既迟于常度则不能及日二者皆必于常期之外更增时刻而后能及于朔朢之度故时刻加也
　　减差之因亦有二一因于日度之缩夫日行既缓于常度则月易及之一因于月度之速夫月行既速于常度则易及于日二者皆不待常期之至而已及于朔朢之度故时刻减也
　　乃若以日之盈遇月之迟二者皆宜有加差以日之缩遇月之疾二者皆宜有减差故【盈与迟缩与疾】并为同名而其度宜倂　若以日之盈遇月之疾在日宜加在月则宜减以日之缩遇月之迟在日宜减在月宜加故【盈与疾缩与迟】并为异名而其度宜相减用其多者为主也
　　如上所论既以【盈缩迟疾】二差同名相从异名相消则加减差之大致已定然而又有乘除者上所言者度也非时刻也故必以此所得之度分【即同名相从异名相消之度分】用每限之时刻【八百二十分】乘之为实每限之月行度为法【即迟疾行度】除之即变为时刻而命之为加减差矣以异乘同除之理言之月行迟疾行度则所厯时刻为八百二十分今加减之度有防个迟疾行度则月行时刻亦当有防个八百二十分故以此乘除而知加减差之时刻
　　推定朔法
　　各置经朔朢大小余各以其加减差加者加之减者减之即各得所推定朔朢大小余大余命起甲子算外得定日支干小余命时刻【依发敛加时条求之】其定朔朢日小余若在本日日出分以下者退一日命之惟朔不退定朔日干名与次月同者其月大不同者其月小　内无中气者为闰月
　　朢退一日者以月当用更防也假如定朢在乙丑日日未出前则仍是甲子日之更防故也
　　按节气为两月相交之界故谓之节中气为一月三十日之正中故谓之中月有中气然后可正其名曰某月【如有冬至则为十一月有大寒则为十二月有雨水则为正月他皆若是】若月内无中气而但有节气则在两月交界之间不能名其为何月而谓之闰月矣
　　凡闰月前一月中气必在晦后一月中气必在朔则前后两月各在定名而此月居其间不得复以前后月之名名之不得不为闰月【如月内但有立春节而无中气则大寒中气在前月之晦定其为十二月雨水中气则后月之朔定其为正月前后两月各有本名不可移动而本月无中气即无月名必为闰月也】厯家以无中气为闰月则各月之中气必在本月而不可稍移所谓举正于中民则不惑也然惟以恒气注厯始能若是唐一行之説所以确不可易而厯代遵守以为常法非不知有定气而但知恒气也【定气即日行盈缩若于各恒气求其盈缩差而以盈差为减差缩差为加差即得各定气日及分然而不用者为闰月也】
　　推入交次气法
　　置天正入交泛日及分加四日六三六七三八【即两交差】即为所求年正月经朔下入交泛日及分也以后累加交差二日三一八三六九满交终二十七日二一二二二四去之即各月经朔下入交泛日也累加至其年十一月即与次年天正入交泛日相同也　复以交朢一十四日七六五二九六五累加之亦满交终去之即得各月经朢下入交泛日加朔得朢加朢得次朔亦必相同也附交差钤
　　一　　二日三一八三六九　用钤加正月经朔下二　　四日六三六七三八　入交泛日可迳得所三　　六日九五五一○七　求某月经朔下入交四　　九日二七三四七六　泛日若加正月经朢五　十一日五九一八四五　下入交泛日亦可迳六　十三日九一○二一四　得所求某月经朢下七　十六日二二八五八三　入交泛日加满交终八　十八日五四六九五二　　二十七日二一二二九　二十○日八六五三二一　二四并去之用其余十　二十二日一八三六九○　数
　　十一二十五日五○二○五九
　　十二　○日六○八二○四
　　推盈日法
　　视各恒气之小余在没限七千八百一五六二五以上者为有盈之气也置防余分一万○一四五【以十五日除气防得一万○一四五六二五止用四位取大数也】内减有盈之气小余四位用其余分为实【以千三百二定之】以六十八分六十秒【以气盈除十五日得六十八分六十六秒九五今亦止用三位】定一为法乘之【言十定一】得数取定四子为日位用加恒气大余日满纪法去之命起甲子算外为所推盈日也
　　又法亦以有盈之恒气小余去减防余分余以一气十五日乘之为实气盈二千一百八四三七五为法除之得数以加恒气大余满纪法去之命为盈日亦同若迳求次盈日者置所得盈日毎加盈防六十九万六六九五二八即得第二盈日亦满纪法去之命干支也盈日即古厯之没日也凡气内有盈日者多一日假如甲子日立春则己夘日水今盈一日为庚辰日雨水故谓之盈日
　　防余分者十五日除气防之数也盖谓毎大余一日即带有盈分○千一百四十五分故必足得防余分【一万○一四五】之数则为十五分气防之一也
　　六十八分六十秒者气盈除十五日之数也盖谓毎盈一分在恒气为六十八分六十秒即六十八分六十秒盈一分也今有盈之恒气小余尚不及防余分有若干分则必更厯若干六十八分六十秒而其盈分始足命之盈日也
　　又法以十五日乘气盈除即六十八分六十秒乘也故其得数同
　　捷次盈以盈防加者率六十九日奇而有盈日则毎一嵗周只有五盈日或四日也余详用数
　　推虚日法
　　视各经朔之小余在朔虚四千六百九四○七以下者为有虚之朔也置有虚之朔小余四位【千定三百定二】为实以六十三分九十秒【朔虚除三十日得六十三分九十一秒竒此用大数故只三位】定一为法乘之【言十定一】得数取定四子为日位用与经朔大余相加满纪法去之命起甲子算外为所推虚日也又法以三十日乘有虚之小余为实朔虚四千六百九四○七为法除之得数以加经朔大余满纪法去之为虚日亦同
　　若迳求次虚日者置所得虚日每加虚防六十二日九一○四二二即得第二虚日其命干支亦满纪去之也虚日即古厯之灭日也凡月内有虚日者其月小【以经朔言之】故谓之虚日
　　六十三分九十秒者朔虚除三十日之数也盖谓毎虚一分在月内为六十三分九十秒即毎六十三分九十秒当虚一分也今经朔小余尚有若干分则必更厯若干六十三分九○而其虚分始尽命之虚日也
　　其又法以三十日乘朔虚除即六十三分九○乘也故得数亦同
　　捷次虚日以虚防加者率六十三日弱而有虚日则每一嵗防亦只五虚日也余亦详用数
　　推土王用事法
　　置四季月节气大小余【三月用清明六月小暑九月寒露十二月小寒】各加土王防一十二万一七四七五满纪法去之大余命起甲子算外各得所推土王用事日辰也
　　又法置四季月中气大小余【三月用谷而六月大暑九月霜降十二月大寒】内各减第二土王防三日○四三六八七五如不及减加纪法减之所得亦同
　　天有五行而土无专位以体之立者言之则居中以用之行者言之则在隅土者木火金水之所以成终而成始也参同契曰土旺四季罗络始终青赤白黒各居一方皆禀中宫戊己之功盖谓此也厯家以春木夏火秋金冬水分旺者各得气策四又十二日【一七四七五】而土寄旺于四季之末者各得气防一又三日【○四三六八七五】与四行之数适以相等而嵗功成焉前法用加节气者是于四时之末而要其终后法用减中气者是据土王用事之初而原其始余详用数推发敛加时法
　　各置定朔朢及恒气之小余为实以十二时为法乘之【法实并以千三百二定之言十定一以所定四子为万】取万为时命起子正有五千起作一时命起子初并以算外命时其不满五千者取一千二百为刻命起【初正】初刻算外为某刻
　　又法各置小余加二为时减二为刻不须定数就以千位为时百位为刻有五百起作一时命起子初初刻不起者命起子正初刻也
　　按古法以日行赤道外去北极逺谓之发日行赤道内去北极近谓之敛发敛字义并主北极为言日道之自近而逺逺而复近皆以渐致故不曰逺近而曰发敛也古诸家厯法并有歩发敛一章其所列者月卦律吕气之类而加时之法附焉授时亦然故曰歩发敛加时也【授时虽不用律吕月卦惟存七十二而统以廿四中节盖即其所谓发敛而所谓歩发敛加时者以推各气候初交之时刻发敛字义防上文而为説犹云歩气候加时云尔】大统则省去歩发敛一章故加时之法在气朔章后而犹云推发敛加时因仍旧名无他义也
　　以十二乘者何也盖以日周一万分十二时则各得八百三十三分三三不尽故以十二乘之通日周一万为十二万则可以匀分乃算术通分法也日周既通为十二万故以一万为一时以一千二刻为一刻也有五千起作一时者因时有初正则各得五千其子初四刻为前半个子时乃先一日之数谓之夜子时子正四刻为后半个子时乃本日之数本日十二时并从兹起故满一万者命起子正也命起子正则算外为丑正矣【因所满一万数中有子正四刻丑初四刻在内则前半个丑时已满而算外为丑正】若但满五千则算外为丑初【但满五千则所满者是后半个子时而交前半个丑时是为丑初非丑正也】故起作一时而命起子初此是从先日夜子初刻算起借前半个子时辏合成整以便入算也
　　其又法加二为时减二为刻者加是就身加二即十二乘但不变千位不定子故即以一千为一时而起子正有五百起作一时而起子初也减二即十二除而挨身减二不动算位所谓定身除法也故即以一百为一刻
　　附十二时钤
　　千百十分十秒　　　　千百十分十秒
　　子正　○○○○○○　午正　五○○○○○丑初　○四一六六六　未初　五四一六六六丑正　○八三三三三　未正　五八三三三三寅初　一二五○○○　申初　六二五○○○寅正　一六六六六六　申正　六六六六六六夘初　二○八三三三　酉初　七○八三三三夘正　二五○○○○　酉正　七五○○○○辰初　二九一六六六　戌初　七九一六六六辰正　三三三三三三　戌正　八三三三三三巳初　三七五○○○　亥初　八七五○○○巳正　四一六六六六　亥正　九一六六六六午初　四五八三三三　【夜子】初　九五八三三三凡日下小余分并以十二时钤相减命时【如满四一六六者即命其时为丑初满八三三三者即命其时为丑正】减不尽者以一百分为一刻如不满百分即命初刻满一百分即命一刻满二百分命二刻满三百分命三刻满四百分命四刻【如小余可减二千五百分命其时为夘正减过余数有一百分即为夘正一刻有二百分为夘正二刻有三百分为夘正三刻有四百分为夘正四刻若减余不满百分只为夘正初刻他皆若是】初正并同推朔值宿法
　　置辛巳为元求到其年通积全分内减去其年闰余全分加三万○六一一八六【即两宿余】满宿防二十八万去之命起虚宿算外即得所求年正月经朔直宿以后累加宿余一万五三○五九三满宿会去之即得各月经朔直宿再以各朔下加减差加者加之减者减之亦满宿会去之命起虚宿算外即得各月定朔直宿【其加减过小余亦必与定朔小余相同为凖】
　　此盖以辛巳为元之天正冬至前甲子日正直虚宿故迳以通积取之即得直宿
　　按日直宿法乃演禽之用占家之一种也故诸家厯法无之授时厯经亦所未载而大统厯有之盖元统之所増其实无闗厯法
　　推闰月所在
　　置朔实【二十九万五三○五九三】内减去有闰之天正闰余全分【即所推天正闰余在闰凖以上者其年有闰是也】余为实以月闰九千○百六二八二为法除之满法为月视所得有防月命起嵗前十一月算外得闰在何月此法仍多未的然只在其月之前后皆以定朔为凖也
　　满法为月者满得一个月闰之数即为一月若满两个月闰即为两月此只求整月不除分秒故不必定子
　　附六十甲子钤
　　初日【甲子】　一日【乙丑】　二日【丙寅】　三日【丁夘】　四日【戊辰】　五日【己巳】六日【庚午】　七日【辛未】　八日【壬申】　九日【癸酉】　十日【甲戌】　十一【乙亥】十二【丙子】　十三【丁丑】　十四【戊寅】　十五【己夘】　十六【庚辰】　十七【辛巳】十八【壬午】　十九【癸未】　二十【甲申】　廿一【乙酉】　廿二【丙戌】　廿三【丁亥】廿四【戊子】　廿五【己丑】　廿六【庚寅】　廿七【辛夘】　廿八【壬辰】　廿九【癸巳】三十【甲午】　三十一【乙未】　三十二【丙申】　三十三【丁酉】　三十四【戊戌】　三十五【己亥】三十六【庚子】　三十七【辛丑】　三十八【壬寅】　三十九【癸夘】　四十【甲辰】　四十一【乙巳】四十二【丙午】　四十三【丁未】　四十四【戊申】　四十五【己酉】　四十六【庚戌】　四十七【辛亥】四十八【壬子】　四十九【癸丑】　五十【甲寅】　五十一【乙夘】　五十二【丙辰】　五十三【丁巳】五十四【戊午】　五十五【己未】　五十六【庚申】　五十七【辛酉】　五十八【壬戌】　五十九【癸亥】二十八宿钤
　　初日【虚】　一日【危】　二日【室】　三日【壁】　四日【奎】　五日【娄】六日【胃】　七日【昴】　八日【毕】　九日【觜】　十日【参】　十一【井】十二【鬼】　十三【栁】　十四【星】　十五【张】　十六【翼】　十七【轸】十八【角】　十九【亢】　二十【氐】　廿一【房】　廿二【心】　廿三【尾】廿四【箕】　廿五【斗】　廿六【牛】　廿七【女】










　　厯算全书卷二十一
　　钦定四库全书
　　厯算全书巻二十二
　　宣城梅文鼎撰
　　厯学骈枝卷二
　　大统厯交食通轨用数目録
　　周天三百六十五度二十五分七十五秒
　　按此即歩气朔章用数但彼以万分为度法此以百分为度法故百分为分而分为秒名异而实同也
　　半周天一百八十二度六十二分八十七秒半
　　周天象限九十一度三十一分四十三秒七十五防平分周天度为半周天又平分之则为象限乃四分周天之一如两仪之分四象也
　　半嵗周一百八十二度六十二分一十二秒半
　　此太阳行天半嵗之度也亦以度为百分与气朔章异而以日命度则同以较半周天不及七十五秒乃嵗差所自生
　　嵗差一分五十秒
　　若以万分命度则为一百五十分
　　交终度三百六十三度七十九分三十四秒一十九防【六】
　　此以月平行度乘交终之数月入交一转凡行天度有此数也
　　交中度一百八十一度八十九分六十七秒【○九八】此以月平行乘半交之数月入交一半凡行天度有此数也
　　正交度三百五十七度六十四分
　　此于交终度内减去六度一五有竒也
　　中交度一百八十八度○五分
　　此于交中度内加入六度一五有竒也　日食入交度有加减者日既髙于月黄道在天亦髙于月道故当其初入隂厯六度时月之行天虽在日北而人之见月尚在日南中交度所以有加也及其将入阳厯尚差六度时月之行天虽在日内而人之见月已出日外正交度所以有减也此皆由测验而得也其所以然则亦中国地势为之
　　前凖一百六十六度三十九分六十八秒
　　前者交前也入隂厯满此是在正交前也入阳厯满此是在中交前也以后凖减交中即得
　　后凖一十五度五十分
　　后者交后也入阳厯在此数以下是正交后也入隂厯在此数以下是中交后也凖者定也凡月食在交前后以此为定盖无论交前交后皆以十五度五十分为定过此则不食也前凖数虽多以减交中度则以十五度五十分也
　　月平行分一十三度三十六分八十七秒半
　　置月行极迟极疾度数一转之积以月行一转之日平分之得此数
　　日行分八分二十秒
　　此乃一限之日行分也月行一限在日周一万内八百二十分也盖万分日之百即百分度之一分也
　　日食分二十分
　　此置日食十分倍之【倂日体月影各十分即二十分】
　　月食分三十分
　　此置月食一十五分倍之【倂月体十分闇虚二十分共三十分】
　　隂食限八度　定法八十分
　　隂者月入隂厯是在黄道北在日内也在日内则易为揜故八度食也　隂食八度故隂定法亦八十分以八十分除八度即得隂食十分也
　　阳食限六度　　　定法六十分
　　阳者月入阳厯是在黄道南在日外也在日外则难为揜故六度食较隂食近也　阳食六度故阳定法亦六十分以六十分除六度即得阳食十分也
　　月食限一十三度○五分　　定法八十七分
　　以定法八十七除一十三度○五分即得月食一十五分也　月既小于闇虚闇虚所至即月所至无髙下故不论隂阳厯皆十三度即食也闇虚者日之影倍大于月故月食十有五分所谓既内既外也
　　日月食限数【凡数满万为日千为十刻百为单刻】
　　阳食入交
　　在○日五十刻已下日月不食
　　在二十六日○二刻已上日月皆食
　　在一十三日○○刻已上日月皆食
　　在一十四日七十五刻已【下上】日月皆食
　　在○日五千四百五五已【下上】日月皆食
　　在二十五日六一五一已上日月不食
　　在一十二日○○八九已上日月不食
　　在一十四日一五一六已下日月皆食
　　隂食入交
　　在一日二十五刻已下不食
　　在一十二日四十二刻已【上下】月食
　　在一日一八七二已下日食
　　在二十六日○二四九已上日月皆食
　　在一十二日四一八九已上
　　在一十四日七九三三已下
　　又在交朢一十四日七六五二九六五已下日月皆食又在交终二十七日二一二二二四已下日月皆食又在交中一十三日六○六一一二已下日月皆食右各日月食限如日食视其定朔小余在夜刻者如月食视其定朢小余在昼刻者即同不食亦不必推算也又与各交泛者数同则食也不同者不食其已上已下皆指小余而言凡数自万已上为大余自千已下为小余　凡日食视其定朔小余在一千二四九以下八千八百以上皆在夜刻也起亥初初刻止丑正四刻　凡月食视其定朢小余在三千○一六已上七千○八三已下皆在昼刻也起辰初初刻止申正四刻【昼夜刻仍宜以日出八分与定朔朢小余相较而定之】
　　按自定朔之法行而日食必在朔厯家以是騐其疎密者千有余年矣厯至授时法益密数益简虽然月有交也逐逐歩算虽简亦繁许学士之讥世医谓猎不知兎广络原埜术已疎矣今通轨所载食限颠倒缪乱殆不可以数求其误后学将何已乎今为订定如左
　　今考定日月入交食限
　　朔泛交入阳厯
　　在○日五○一六已下为入食限已上者日不食在一十三日一○四五已上为入食限已下者日不食
　　朔泛交入隂厯
　　在一十四日不问小余皆入食限
　　其小余在一五一六已下一三○七已上者的食
　　在一十五日一七七九已下为入食限已上者日不食在二十五日六四○四已上为入食限已下者日不食在二十六日不问小余皆入食限
　　其小余在六六六七已上六八七六已下者的食
　　又在交终二十七日二一二二二四已下为入食限又在交中一十三日六○六一一二已上为入食限
　　朢泛交不问隂阳厯
　　在○日不问小余皆入食限
　　其小余在七九六六已下者月的食
　　在一日一五五六已下为入食限已上者不食
　　在一十二日四五○五已上为入食限已下者不食其小余在八○九五已上者月的食
　　在一十四日七六一七已下为入食限已上者不食其小余在四○二七已下者月的食
　　在二十六日○五六六已上为入食限已下者不食其小余在四一五六已上者月的食
　　又在交终二十七日二一二二二四已下月的食又在交中一十三日不问小余皆的食
　　右日月食限皆视其朔朢入交泛日其不入食限者即不必布算也其入的食限者必食也其入食限不言的者或食或不食也是皆以算御之也凡言已上已下者皆指小余有不问小余者则只以大余命之也又视其定朔小余如在日入分后及日出分前十分以上者夜刻也定朢小余如在日入分前及日出分后七百三十分以上者昼刻也日食在夜刻月食在昼刻即不得见初亏复圆同不食限不必布算也按日食隂厯距交前后二十一度而止以月平行除之得一日五七一八日食阳厯距交前后六度七十一分而止以月平行除之得○日五○一六即各食限也其隂厯距交前后七度○一三四至七度二九三四为日的食限月平行除之得○日五千二百四六至○日五千四百五五也其阳厯则无的食何也盖日食虽有阳食限六度隂食限八度其实总在隂厯阳厯本无蚀法也今所定阳厯食限以诸差得之皆或限也诸差者何一曰盈缩差加减之极至二度四十分一曰南北东西差加减之极至四度四十六分幷二数六度八十六分内除未交阳厯前原空有一十五分余六度七十一分是为阳厯食限也其隂厯的食起七度○一至七度二九止者正交中交限距交皆六度一十五分而阳食限只六度是原空一十五分也如入盈缩差幷南北东西差六度八十六分共七度○一而差变极矣故的限以比起置正交中交距交数加隂食限八度共一十四度一十五分内减去盈缩差幷减去南北东西差余七度二九而差变极矣故的限以此终不入此限度皆或限也置正交中交距交数加隂食限共一十四度一十五分又加入盈缩差又加入南北东西差共二十一度是为隂厯食限也盖极其变可以得其常执其常可以追其变今所订定食限皆要其变之极者言之而其常可知也
　　又按月食不问隂阳厯只距交前后一十五度四十五分而止在月平行得一日一五五六为食限也其距交前后一十○度六十五分在月平行得○日七九六六为的食限也夫月食何以不问隂阳厯也月之掩日以形形则有所不周日之掩月以气气则无所不及故日必以隂厯食月不问隂阳厯皆食阳全隂半之理也又月虽掩日尚不能直至于日之所也故有东西南北差日以闇虚掩月则直至于日之所也故亦无东西南北差惟其不用东西南北差也故只以盈缩差二度四十分加其食限一十三度○五分而得食限一十五度四十五分或食之数止此而差变极也只以盈缩差二度四十分减其食限一十三度○五分而得的食限一十○度六十五度或不食之数亦至此而差变极也
　　又按夜刻不见日食以时差分与定用分相较知之大约日出入夘正酉正合朔当之时差之多至六百五十分若当二至日出入其差乃极亦不下六百三十分故定朔分若与日出入同者其食甚皆在日出前日入后六百三十分以上也假如日食十分当月行极迟之限定用分极多至六百三十五分止矣故知定朔在日出分前一十分以下者即不得见未复光定朔在日入分后一十分以上者即不得见初亏断为夜刻无疑也其昼刻不见月食亦以时差分与定用分相较知之依授时时差法朢在卯酉正时差之多至一百三十分若当二至日出入其差为极亦不下八十九分故定朢若与日出入分同者其食甚皆在日入前日出后八十九分已上也假如月食十五分当月行极迟之限定用分多至八百十六分止矣故知定朢在日出分后七百三十分已上者即不得见初亏定朢在日入分前七百三十分已上者即不得见未复光断为昼刻无疑也【授时算月食时差法见后时差条】又按大衍厯有九服交食法庚午元厯有里差自宋以前厯法皆有晷漏所在差数今所定只据授时厯经所载大都食法其日出入据立成所载盖是应天漏刻也元统作通轨是洪武中故用南都漏刻【授时立法时宜有诸方漏刻及里差推歩之术今皆失传故只据通轨】
　　日食通轨
　　録各有食之朔下数
　　经朔全分　　盈缩厯全分　　盈缩差全分迟疾厯全分　迟疾限数　　　迟疾差全分加减差全分　定朔全分　　　入交泛日全分按有食之朔即所推其朔入交泛日入食限者也故其下所有数皆全录之盖数以倚数叅伍相求此所录皆母数原定朔时俱已推定故也月食仿此推定入迟疾厯法
　　置所推或迟厯或疾厯全分以本日下加减差加者加之减者减之得为定入迟疾厯分也
　　按原推迟疾是经朔今以差加减之则是定朔下迟疾也
　　推定入迟疾厯限数法
　　置所推定入迟疾厯全分依朔下限数法推之即得按定朔迟疾既不同经朔则其入转限数亦异故复定之
　　推定限行度法
　　视所推定入迟疾限与太隂立成相同限下迟疾行度【迟用迟行度疾用疾行度】内减日行分八分二十秒【于度下二位减】即为定限行度也
　　定限行度内减去八分二十秒者月行一限日行八百二十分于百分度法为八分二十秒也盖右旋之度月速于日立成中迟疾行度月行于天之数此所推定限行度乃月行距日之数即日月两行之较也假如一限内月行一度日亦行八分二十秒则月行之多于日行为九十一分八十秒
　　推日出入半昼分法
　　视有食之朔下是盈厯者大余若干用立成内冬至后相同积日下日出入半昼分全录之是缩厯者大余若干用立成内夏至后相同积日下日出入半昼分全录之
　　按日出入者所以定带食也以全昼之分半之为半昼分所以定午也只用经朔盈缩厯不加减者所差半日而极无甚差数也
　　推嵗前冬至天正赤道宿次度分法
　　置嵗差一分五十秒【定二子】为实以所距积年减一算【十定一百定二】为法乘之【言十定一】得数【定有四子为度】置箕宿十度相减余为赤道箕宿度分也
　　按嵗差者日行黄道之度所毎嵗迁徙不常者也尧时冬至在虚一度至元冬至在箕十度渐差而西也嵗差一分五十秒者凡六十六年有八月而差一度也原至元冬至在箕十度至今所求年又差几度故以距算乘嵗差而得所差之数以减箕宿十度便知退在箕宿几度也嵗差之度自东而西其数为退故用减也
　　推嵗前冬至天正黄道宿次度分法
　　置所推赤道度分内减去黄道立成相同积度下第三格积度全分余【有十定三子有分定二子十秒定一子】为实以同度下第四格度率为法除之【不去子只不满法去一子】得数【定有三子为十分二子为单分一子为十秒于十分前一位加积度】加入同度第一格积度得为天正黄道箕宿度分也
　　按此以箕宿赤道度变黄道也欲明其交变之理当先知浑天之形盖天体浑员而赤道纮带天腰其南北极皆等赤道度匀分如瓣离赤道逺则其度渐敛渐狭以会于两极若黄道之度虽亦匀分然半出赤道之外半在赤道之内与赤道有平斜之别若自两极作经度纵剖赤道必过黄道则有时赤道一度当黄道一度有竒以黄道度斜也【二分黄道斜穿赤道而过故赤道平而黄道斜】有时赤道一度当黄道则不及一度以赤道度小也【二至黄道所经离赤道二十四度弱在赤道度则已为瓣渐敛之时其度瘦小故不能当黄道之一度】古诸家厯法各有黄赤变率惟授时依割员句股之法剖浑度为之于古为密也
　　黄赤立成起二至毕二分起二分毕二至并于一象限内互相乘除各有定率【详第三卷】箕宿近冬至故用至后立成
　　立成第四格赤道度率也第二格所变黄道度率也凡至后赤道一度零若干分始可当黄道一度也【以赤道小度当黄道之平度则一度不能当一度必加零分始可相当】第三格赤道积度也第一格所变黄道积度也凡至后赤道几度几十几分始可当黄道几度也
　　嵗差之法毎年冬至西移则冬至所在宿毎年之距度不同【如至元辛巳冬至在箕十度则箕初距冬至亦十度今康熙壬寅冬至退至四度竒则箕初距冬至亦只四度竒】故必毎年变之始为凖的【如康熙壬寅箕宿赤道距冬至四度竒以变黄道则不足四度冬至愈退则距度愈近而毎度之加率愈多】
　　今以所推箕宿赤道度分【是从本年天正冬至逆数至箕宿初度】与第二格积度相减其满积度数即变成黄道积度【第三格赤道积度俱带零分第一格黄道积度并为整度以此相变是以带零分之赤道几度变为无零分之黄道几度也】其减不尽者以第四格赤道度率为法除之则此赤道零分亦变为黄道零分【所变零分必少于赤道零分】乃以所变零分倂入所变积度为箕宿初度距冬至之黄道度即知天正黄道实躔箕宿若干度分也
　　以异乘同除之理言之赤道一度零几分于黄道为一度今有赤道零分若干于黄道亦当为零分若干法当置赤道零分以黄道度率乘之为实赤道度率为法除之得数为所变黄道零分今因黄道率是一度乘讫数不动故省不乘而只用除是防法也【惟其省乘故除亦不去子惟不满法去一子盖不去子则实位暗陞与乘过之得数无两】
　　黄道立成
　　黄积度【加此】　度率【此乘黄道】　赤积度【减此】　　　度率【此除黄道】初度　　一度　　初度○○○○　一度○八六五一度　　一度　　一度○八六五　一度○八六五二度　　一度　　二度一七二八　一度○八六○三度　　一度　　三度二五八八　一度○八七五四度　　一度　　四度二四四五　一度○八四九五度　　一度　　五度四二九四　一度○八四三六度　　一度　　六度五一三七　一度○八三三七度　　一度　　七度五九七○　一度○八二三八度　　一度　　八度六七九三　一度○八一二九度　　一度　　九度七六○五　一度○八○一十度　　一度　　十度八四○六　一度○七八六按黄赤道交变立成原有九十一度今只用十度者以箕宿只十度也【若再过二三百年嵗差于箕度退完交入防度则立成数宜用二十度】箕宿度在冬至前而今用至后立成者赤道变黄道之率至前与至后本同一法故可通用也【至后是从冬至顺数至前是从冬至逆溯其距冬至度同则赤黄之变卛不异】大致与缩末盈初二限共一加分积度者同理近乃有名家撰述辄讥此条为错用立成是未尝深思而得其意也
　　推交常度法
　　置有交食之入交泛日全分【十日定五子单日定四子空日定三子空千定二子空百定一子空十不定子】以月平行一十三度三六八七五【定一】为法乘之【言十定一乘过定有四子为单度五子为十度六子为百度】即得所推交常度分也
　　按交常度者经朔太阳躔度距黄道白道相交之度也
　　推交定度法
　　置所推交常度全分内盈加缩减其朔下盈缩差度分为交定度分如遇交常度数少不及减缩差者加交终度三百六十三度七九三四一九减之余为交定度分也遇满交终度去之
　　按交定度者定朔太阳所在距黄道白道相交之度也闇虚为日对度故只用太阳盈缩差加减之也如遇交常度数少不及减缩差者是以常数言之虽已在交后计日行盈缩则仍在交前故加入交终度减之即仍作交前算也
　　推日食在正交中交度
　　视交定度分如在七度已下三百四十二度已上者为食在正交如在一百七十五度已上二百○二度已下者为食在中交
　　按正交者月自隂厯入阳厯交之始也中交者月自阳厯复入隂厯交之中也交终之度于此始即于此终故为正交也交中之度于此适半故为中交也七度已下三百四十二度已上者正交食限阳厯距交初七度隂厯距交终二十一度而止也一百七十五度者阳厯距交中亦七度而止为食限二百○二度者隂厯距交中亦二十一度而止为食限也
　　推中前中后分法
　　视定朔小余如在半日周五千分已下者就置五千分内减去定朔小余而余为中前分也如在半日周已上者就于定朔小余内减去半日周余为中后分也按中前是从午逆推前所距分也故以小余减半日周中后是从午顺求后所距分也故以半日周减小余顺数逆推皆自午正起算也
　　推时差分法
　　置半日周内减去所推或中前或中后分余【千定三百定二】为实复以中前或中后【千三百二定之】为法乘之【言十定一】得数又以九十六分【去三子　按九十六分宜去一子今去三子者经所谓退二位也】为法除之【不满法去一子除过定有二子为百分一子为十分】得为时差分也中前为减差中后为加差
　　按时差分者食甚之时刻有进退于定朔者也盖经朔本有一定之期既以月迟疾日盈缩加减之为定朔矣而犹有差者则以合朔加时有中前中后之不同也其所以不同者何也大约日在外月在内故能掩之人又在月内故见其掩而有食当其正相当一度谓之食甚如其合朔午正则以人当月以月当日相当绳直故无所差若在午前以至于夘则渐差而早假如定朔夘正一刻日月合在一度是日月合朔本等时刻也人自地上观之则不待其月之至于此度也当其夘初初刻月未及日一度时已见其合于日是差而早六刻有竒也若在午后以至于酉则渐差而迟假如定朔酉正一刻日月合在一度是日月合朔本等时刻也人自地上观之则月虽已至此度尚未见其合也直至戌初一刻月行过于日将一度时始见其合于日是差而迟六刻有竒也其自夘而辰而已所差渐少至午正则复于无差也其自午而未而申积差以渐而多至酉则差而极于六刻有竒也盖天体至圆其行至徤运乎四虚地在其中为气所团结而不散若卵之有黄夫卵既圆矣黄安得独方故地之方者其徳其体则必不正方如碁局也夫日月并附天行而月在日下当其合时去日尚不知有几许人自地上左右窥之与天心所见不同故日月平合在夘酉皆不能见所见食甚日稍在下月稍在上斜所当差近一度在月平行为六百余分惟午则自下仰观所见正当绳直与在左右旁视者异故无差也昔人常云人能凌倒景以瞰日月则晦月之表光应如望吾亦云使人能逐景而行与日相偕则举头所见常如在午又使地如琉璃光人居其最中央旋而观日八面皆平时差之法可以不设矣是其所差不问盈缩迟疾而只在本日之加时故曰时差
　　推食甚定分法
　　视时差分如是中前分推得者置定朔小余内减去时差分余为食甚定分也如是中后分推得者置定朔小余内加入时差分共得为食甚定分也满日周去之至入盈缩度再加之
　　按食甚食而甚也食甚分是自亏至复之中日月正相当于一度之时刻也中前减小余者差而早也中后加小余者差而迟也若夜刻不算者恐无满日周去之之理末二句疑有误
　　推距午定分法
　　置所推中前或中后分内加入时差分共得为距午定分也
　　按距午定分是食甚时刻距午正之数也食甚以时差加减距午则不减只加者盖食甚原是顺故有加减距午分则一自午顺推一自午逆溯总是差而渐逺于午正故也
　　推食甚入盈缩定度法
　　置前推或盈厯或缩厯初末全分加入定朔大余及食甚定分内减去经朔全分余为食甚入盈缩厯定度分也按原推盈缩厯是经朔下者故以定朔大余及食甚分加之减去经朔全分如以经朔大小余加减作食甚大小余故即得食甚所入盈缩厯数也
　　推食甚入盈缩差度法
　　置所推食甚盈厯或缩厯全分减去大余依朔下盈缩差法推入得食甚入盈缩差度分也如遇末限亦用反减半嵗周之数【数止秒】
　　按食甚盈缩厯既异经朔则其所积盈缩之差亦不同故复求也
　　推食甚入盈缩厯行定度法
　　置食甚入盈缩厯全分以万为度内盈加缩减其所推食甚入盈缩差得为食甚入盈缩厯行定度分也【末限不用数止秒】
　　按凡盈厯若干日即是常数日行距冬至宿之度数也凡缩厯若干日即是常数日行距夏至宿之度数也以其差加减之即得所推食甚日躔距二至宿之度数也凡用末限者所以纪其差是逆从二至推至二分其差整齐易知也今不用末限者所以积其度是顺从冬至数至夏至从夏至数至冬至也
　　推南北泛差度法
　　视所推食甚入盈缩厯行定度如在周天象限九十一度三一四三七五已下者为初限也如在已上者置半嵗周内减去行定度余为末限也或得初限或得末限俱自相乘之【初末限者十度上下各定三子单度各定二子言十各定一子】得数以一千八百七十度【去三子】为法除之【不满法去一子除过定有四子为度三子为十分　按上下各定二子则四子矣故四子为度】复置四度四十六分【按四度四十六分者即周天象限自乘复以一千八百七十度除之者】内减去得数余为南北泛差度分也
　　推南北定差度法
　　置所推南北泛差全分【度定四子十分定三】以所推距午定分【千定三子百定二子】为法乘之【言十定一】得数复以其所录半昼分【去二子】为法除之【不满法去一子除过定有四子为度三子为十分】仍置泛差减其得数余为南北定差也若遇泛差数少不及减者反减之而得也　又视其盈缩厯及所推正交中交限度如是盈初缩末者食在正交为减差中交为加差也如是缩初盈末者食在正交为加差中交为减差也若遇反减泛差者应加作减应减作加不可忽畧也
　　按南北差者古人所谓气差也易之曰南北所以着其差之理也盖日行盈初缩末限则在赤道南其逺于赤道也至二十三度九十分日行缩初盈末限则在赤道北其逺于赤道也亦二十三度九十分日之行天在月之上而髙故月道与黄道相交之度有此差数以南北而殊也假如盈初缩末限一日空日间日行赤道外极南去人极逺去地益近日道所髙于月道之中间人皆从南观之易得而见故月道之出黄道而南也较常期【所谓常期皆南北东西差折中之数即所定大都正交度中交度也】早四度有竒其入黄道而北也较常期迟四度有竒由是以渐而至于盈初缩末八十八日行天渐满一象限之时黄道之在赤道南者去赤道以渐而近去地之数以渐而逺其日髙月下相去之数人所从旁见者以渐而少故其所差四度有竒以渐而杀也又如缩初盈末限一日空日间日行赤道内极北去人益近去地极逺日道所髙于月道之中间人仰面视之难得而见故月道之出黄道南而为正交也较常期迟四度有竒其入黄道北而为中交也较常期早四度有竒由是以渐而至于缩初盈末九十三日行天渐满一象限之时黄道之在赤道北者去赤道以渐而近去地之数亦以渐而近其日髙月下相悬之数人所从旁见者又以渐而多故其所差四度有竒亦以渐而杀也四度四十六分者据其极差者言也以得数减之便是今所有差也然此皆据午地而言故以距午分乘之以半昼分除之便知今距午之地应分得差数凡几许而今已距午几许则此所有之差已不可用故以减原得泛差数而知其尚余几许之差为定差也盖于天则冬至夏至之黄道为南北于地则加时在正子午为南北今泛差之数近二至则多近二分则少是以天之南北而差也定差之数近午正则多近日出没时刻则少是以加时之南北而差也故曰南北差　月自黄道北出黄道南谓之正交即经所谓交前隂厯交后阳厯也月自黄道南入黄道北谓之中交即经所谓交后隂厯交前阳厯也　其南北泛差不及减反减者此带食出入方有之何也此必是食甚定分在日入分已上或日出分已下则其距午定分多于半昼分故乘除后得数亦多于泛差也不则以多除以少乘其数且不能泛差相等况能多于泛差乎愚故断其为带食也泛差数少不及减是距午定分已过于半昼是在夜刻故反算其距子之数夫距子与距午其盈缩南北逺近幷旁视仰视之理正相反故加者减之减者加之以为定差也
　　推东西泛差度法
　　置所推食甚入盈缩厯行定度就为初限也去减半嵗周余为末限也以初末二限互相乘之【百度定四子十度定三子言十定一是也】得数复以一千八百七十度【去三子】为法除之【不满法去一子除过定有四子为度三子为十分】即得所推东西泛差也
　　推东西定差度法
　　置所推东西泛差全分【度定四子千定三子】以所推距午定分【千定三子百定二子】为法乘之【言十定一】得数以二千五百度【去三子】为法除之【不满法去一子除过定有四子为度三子为十分】视所推如在东西泛差已下者就为东西定差度分也如在已上者倍其泛差内减去得数余为东西定差度分也　又视其盈缩厯及中前中后分与正交中交限度若是盈厯中前缩厯中后者正交为减差中交为加差也若是盈厯中后缩厯中前者正交为加差中交为减差也
　　按东西差即古所谓刻差也易其名曰东西者其差只在东西也于天则近二分之黄道为东西于地则近卯酉之时刻为东西盖日行在二至前后其势平直日行在二分前后则其黄道与赤道纵横相交其势斜径当其斜径加时又在卯酉则有差也假如春分日在盈厯九十余度其黄道之交于赤道自南而北势甚斜径若加时中前则是赤道倚而黄道横也加时中后则是赤道倚而黄道纵也又如秋分日在缩厯九十余度其黄道之交于赤道自北而南势甚斜径若加时中前则是赤道倚而黄道纵与盈厯中后仝也加时中后则是赤道倚而黄道横与盈厯中前仝也黄道纵立于夘酉月道之出入亦从而纵正面视之绳直相当其日内月外相去之中间人所见者少意与南北差缩初盈末正在人顶者同也故月道之出黄道南而为正交也较常期迟四度有竒其入黄道北而为中交也较常期早四度有竒此盈厯中后缩厯中前皆于正交以差加中交以差减也黄道横偃于夘酉月道之出入亦从而横人在赤道之北斜而望之其日内月外相去之中间皆得而见意与南北差盈初缩末横偃南上渐近于地者同也故月道之出黄道南而为正交也较常期早四度有竒其入黄道北而为中交也较常期迟四度有竒此盈厯中前缩厯中后皆于正交以差减中交以差加也若盈缩厯当二分加时又在卯酉则其差之极四度有竒迨至二分前后黄道之斜径以渐而平故其差亦以渐而少由是而至于二至黄道之斜径依平而差亦复于平故曰二至无刻差也若加时不在夘酉则虽二分之黄道其差却与他气不殊盖其斜径之势亦以渐而平故也假如二分加时辰巳之间其定差则正与四立泛差等渐而至于午中则其差亦渐而复于平是其所差只在东西故曰东西差　凡东西泛差近二分多是以天之东西而差也其定差以加时夘酉而多是以地之东西而差也以距午分乘之者距夘酉之数也以二千五百除之者日周四分之一乃夘酉距午之数也盖此所为泛差乃距午二千五百分时所有之差也乘除后得数若多于泛差是食甚距午分其数亦多于日周四分之一其加时乃在夘前酉后也夘前酉后之差于正夘酉者其数正与夘后酉前等故倍泛差减得数即为定差也凡差于南北者复于东西差于东西者复于南北幷二差加减数总无过四度四十六分以是为交度进退之极也盖原所谓正交中交限各损隂厯六度余为阳厯者乃是据中国地势所差于南戴赤道之下者言人在北道之北故所见黄道交处皆差而近北六度余此常数也若黄道在冬至横于南上去人益逺故其交处差而北者又四度余而极是共差十度余矣若黄道在夏至去人反近正在中国人顶故其交处原差而北者乃复而南亦四度余而极是只差一度余矣此南北差之理据午上言也若移而至日出入时则其横于南上者已斜纵于夘酉其正当人顶者已横斜于夘酉所见差度以渐而平如常数故南北差近午多近日出没则少也若黄道在春分而加时夘黄道在秋分而加时酉其势皆横偃于东西而与地相依故其交处益差而北又四度余而极是亦共差十度余矣若黄道在春分而加时酉黄道在秋分而加时夘其势皆纵立于东西而与人相当故其交处原差而北者亦皆复而南四度余而极是亦只差一度余矣此东西泛差之理据夘酉而言也若移而至午则其横偃于夘酉者反斜纵于午上其纵立于夘酉者反横斜于午上所见差度自以渐而平如常数故东西差近夘酉多近午则少也假使人能正当赤道之下则两极平见相望子正赤道平分界乎夘酉则凡正交只在交终中交则在交中其气刻之差减正交加中交者则差而北其加正交减中交者则差而南当亦各四度有竒也今中国地势则正在赤道之北故所见赤道皆斜倚于人之南其所见正交中交度常数亦皆因其赤道之斜倚者而断惟其黄道交在四立之宿加时在巽坤之维则黄道之势正自斜倚适如赤道之理而南北东西之差皆少与常数相依若黄道横则其势赤道加偃故正交中交之度益差而北若黄道纵则其势视赤道反直几有类于南戴日下之赤道故正交中交之度虽曰复差而南其实乃复于无差也凡缩初盈末而加时午盈厯而加时中后缩厯而加时中前皆黄道纵之类也其缩初盈末当午虽横在天心然东西视之则亦纵也凡盈初缩末而加时午盈厯而加时中前缩厯而加时中后皆黄道横之类也其冬夏至黄道当日出入其二分黄道当午皆黄道斜倚之类也
　　推日食在正交中交定限度
　　视所推日食在正交中交限度如食在正交者置正交度三百五十七度六十四分在中交者置中交度一百八十八度○五分俱以所推南北东西定差是加者加之减者减之即为所推正交中交定限度分也
　　按正交本在交终三百六十三度七十九分今曰三百五十七度六十四分者于隂厯本数内损六度余为阳厯也中交本在交中一百八十一度八十九分今曰一百八十八度五分者于阳厯本数外増六度余侵入隂厯也盖黄道于月道如大环包小环月在日内中间相去空隙犹多人在月内稍北日月交其南人自北斜望得见其间空隙故其交处皆差而北也惟其交处差而北故其交而南也早六度其交而北也迟六度此据地势为言在授时立法原在大都若迤而渐南至于戴日之下所差渐平迤而向北差当益大当亦必有各方差数而不可攷矣　又按此正交中交度増损六度者只是地势使然已为常数其因时而差者又有南北东西二差于是复以加之减之而后乃今所推正交中交之度可得而定而后乃今交前交后隂阳厯可得而定矣
　　推日食入隂阳厯去交前交后度法
　　视所推交定度若在正交定限度已下者就于定限度内减去交定度余为隂厯交前度也若在正交定限度已上者于交定度内减去正交定限度余为阳厯交后度也又视其交定度若在中交定限度已下者就于定限度内减去交定度余爲阳厯交前度也若在中交定限度已上者于交定度内减去中交定限度余爲阴厯交后度也　按若交定度在七度以下者数虽在正交定限度下而实则爲阳厯交后度也法当置交定度加入交终度复减去正交定限度余爲阳厯交后度也【勿庵补】按凡交定度在正交后中交前者阳厯也其在正交前中交后者阴厯也若以东西南北差定之而正交度有加中交度有减者是阳厯变爲阴厯也其正交度有减中交度有加者是阴厯变爲阳历也正交阳变阴中交阴变阳是交后变爲交前也正交阴变阳中交阳变阴是交前变爲交后也故必以所推正交中交定限度爲则与交定度相较而得合朔日躔距交前后的数也凡以交定度去减正交中交定限度者爲交前是逆从交处数来也其于交定度内减去正交中交定限度者爲交后是顺从交处数去也　又按交定度在七度以下食在正交也若以减正交定限度其所余当在三百五十度内外爲阴厯交前度也勿庵曰非也若然则凡正交七度已下者永不入食限不必布算矣况所谓隂阳厯者自正交中交而断【正交后为阳中交后为隂】所谓交前后者皆附近正交中交前后而断【正交后为阳厯交后正交前为隂厯交前中交后为隂厯交后中交前为阳厯交前】交终度分为隂阳厯隂阳厯又各分前后安得有隂厯交前度乃多至三百五十余度者乎此必无之理亦必不可通之数也然则何以通之曰有法焉凡交定度在七度已下是其数不特在正交度下幷在中交度下也然而又与中交数逺幷亦不得减中交为交前也夫在中交数下是阳厯非隂厯也不在交前是交后也夫阳厯交后度法当置交定度内减去正交定限度而此交定度数少不及减故必加入交终度而后可以减之也如入交终度减之则阳厯交后之度复其本位也则凡距交七度已下者皆得入阳食之限也然则厯经何以不云通轨何以阙载也曰是偶尔之遗也或姑略之以俟人之变通也或传之乆而失其真原有阙文也夫夏五疑三豕徴信各行其是而已为其恐误后学也故订之
　　推日食分秒法
　　视日食入隂阳厯交前交后度是隂者置隂食限八度是阳者置阳食限六度皆减去隂厯或阳厯交前交后度余【度定四十定三】为实各以其定法是隂者置八十分阳者置六十分【去一】为法约之【不满法去一子所定有二子为单分一子为十秒】即得所推日食分秒也如隂阳食限不及减交前交后度者皆为不食也
　　按隂食限八度者隂厯距交八度内有食也阳食限六度者阳厯距交六度内有食也凡合朔若正当交度其食十分渐离其处食分渐少假如阳厯距交一度二十分则于食十分内减二分只食八分也又如隂厯初交二度四十分则于食十分内减三分只食七分也故各置隂阳食限以距交前后度减之即是于食十分内减去若干分秒也其减不尽者则正是今所推合食之数故各以定法除之而得也凡隂阳定法皆十分食限之一也如食限不及减为不食者是距交前后之度多于隂阳食限其去交甚逺不能相掩断为不食也
　　推日食定用分法
　　置日食分二十分内减去推得日食分秒余【十分定三单分定二】为实即以日食分秒【单分定二】为法乘之【言十定一所定有六子为百分五子为十分】即为所推开方积也立天元一于单微之下依平方法开之得为开方数【有十定一】复以五千七百四十分【定五】为法乘开方数【言十定一】得数又以所推定限行度【去四子空度去三子】为法除之【不满法去一子所定有二子为百分一子为十分】即为所推定用分也
　　按定用分者日食亏初复末中距食甚所定用之时刻也凡日食若干分则其所经厯凡有若干刻食分深者厯时乆以月所行之白道长也食分浅者厯时暂以月所行之白道短也今所求开方之数即自亏至甚或自甚至复月行白道之率也
　　日食只十分今用二十分者何也日月各径十分其半径五分凡两员相切则两半径聮为一直线正得十分为两心之距以此两心之距为半径从太阳心为心运规作大圆其外周各距日之边五分为日月相切时太隂心所到之界其大圆全径正得二十分也
　　以日食分秒相减相乘何也此句股术中较求股法也依前所论初亏时两圆相切其两心之距十分此大圆之半径常为句股之食甚时两心之距如句而太隂心侵入大圆边之数如句较自亏至甚太隂心所行白道如股而太隂心侵入大圆边之数与食分正同盖月边掩日一分则月心亦移进一分也故即以日食分秒为句较与大圆全径二十分相减其余即为句和和较相乘为开方积即股实也其开方数即股亦即自亏至甚月心所行之白道矣其自食甚至复光理同
　　五千七百四十分乘者何也先求日食分秒及句股开方等率皆就日体分为十分其实日体不满一度大约为十之七耳五千七百四十者七因八百二十也月行一限得八百二十分其十之七则五百七十四分矣故以五百七十四分乘开方为实以定限行度除之为定用分之时刻也
　　以异乘同除之理言之月行定限行度厯时八百二十分则月行亏至甚之白道【即开方数】该厯时有若干分然此所得开方数于度分为十之七法当置开方数七因退位【如有十分只作七分】然后乘除今开方数不动而七因八百二十为五千七百四十得数亦同【即算术中异乘同乘之用】开方数之分是度下一位宜定三子七因八百二十而退位实为五百七十四宜定二子今开方数不定子故于五千七百四十加交三子为五子其乘除后定数同也








　　初亏时两心之距为【即大员二十分半径】　食甚时两心之距为句食甚时月心侵入限内三分为句较
　　自亏至甚月心所行白道为股【甚至复亦同】　此以月在阳厯日食三分为例余可仿推
　　推初亏复圆分法
　　置所推食甚定分内减去定用分为初亏分不及减加日周【一万】减之复置食甚定分如入定用分为复圆分满日周去之时刻依合朔法推之
　　按食甚者食之甚食之中也日月正相当于一度也初亏者亏之初食之始也月始进而掩日也复圆者复于圆食之终也月已掩日而退毕也凡言分者皆时刻也盖初亏在食甚前几刻故减小余复圆在食甚后几刻故加小余初亏距食甚时刻正与食甚距复圆数等故皆以定用分加减之也月食仿此　又按据加日周减满日周去二语定用分当不止此数也
　　推日食起复方位法
　　视所推日食入隂阳厯如是阳厯者初起西南甚于正南复圆于东南也如是隂厯者初起西北甚于正北复圆于东北也若食在八分以上者无论隂阳厯皆初起正西复圆于正东也
　　按日食起复方位主日体言之即人所见日之左右上下也以午位言则左为东右为西上为北下为南也日食入隂阳厯者主月道言之月在日道南为阳厯月在日道北为隂厯也如是阳厯食是月在日南掩而过故食起西南甚于正南复于东南也如是隂厯食是月在日北掩而过故食起西北甚于正北复于东北也其食在八分已上者是月与日相当一度正相掩而过故食起正西复于正东其食甚时正相掩覆而无南北不言可知也凡日月行天并自西而东日速月迟其有食也皆日先在东月自西追而及之既相及矣则又行而过于日出于日东故日食亏初皆在西复末皆在东也　又按厯经云此所定起复方位皆自午地言之其余处则更当临时消息也推带食分法
　　视朔下盈缩厯与太阳立成同日之日出入分如在初亏分已上食甚分【按食甚当作复圆】已下为带食之分也若是食在晨刻者置日出分昏刻者置日入分皆与食甚分相减余为带食差也置带食差【百定六十定五】以所推日食分秒【十定五单定四】为法乘之【言十定一】得数复以所推定用分【百去六子】为法除之【不满法去一子所定有五子为十分四子为单分三子为十秒】得数去减所推日食分秒余上下两处皆为带食已见未见之分也按带食分者日出入时所见食分进退之数也假如日出分在初亏分已上是初亏在日未出前但见食甚不见亏初也日入分在初亏已上是食甚在日入后但见亏初不见食甚也又如日出分在复圆分已下是食甚在日未出前不见食甚但见复末也日入分在复圆分已下是复圆在日入后不见复末但见食甚也见食甚不见亏初是食在未出已有若干尚有见食若干带之而出其食为进也见初亏不见食甚是食在未入见有若干尚有不见食若干带之而入其食亦为进也不见食甚但见复末是食在未出前已复若干尚有见复光若干带之而出甚食为退也不见复末但见食甚是食在未入前见复若干尚有未复光若干带之而入其食亦为退也凡此日出入所带进退分秒何以知之则视其带食而出为晨刻者置日出分其带食而入为昏刻者置日入分皆以食甚分与之相减而得带食之差也假如日出分在初亏分已上其食甚分又在日出分已上则以日岀分减其食甚分其减不尽者则是日出已后距食甚之时刻也若日入分在初亏分已上其食甚分又在日入分已上则以日入分减其食甚分其减不尽者则是日入已后距食甚之时刻也又如日出分在复圆分已下其食甚分又在日出分已下则于日出分内减去食甚分其减不尽者则是日出已前距食甚之时刻也若日入分在复圆分已下其食甚分又在日入分已下则于日入分内减去食甚分其减不尽者则是日入已前距食甚之时刻也凡此带食差分用乘日食分秒又以定用分除之便知日出入时所距食甚时刻在定用分全数内占得几许即知日出入时所带食分于日食分秒全数内占得几许也以其数减食分所余分秒即是日出入前距亏初已过食分或日出入后距复末未见食分也上下两处者得数与减余两处之数已见未见之分即已复未复已食未食如后二条所列也
　　日有带食例
　　置日出入分内减去食甚分谓之已复光未复光将所推带食分录于前
　　晨【日未出已复光若干日已出见复光若干】　　昏【日未入见复光若干日已入未复光若干】
　　置食甚分内减去日出入分谓之见食不见食将所推带食分录于后
　　晨【日未出已食若干日已出见食若干】　　昏【日未入见食若干日已入不见食若干】按置日出入分内减去食甚分者其日出入分皆在复圆分已下也故谓之已复光未复光假如日食甚五分在日出入前其带食三分以之相减尚余二分若在晨刻是日未出前已复光三分日已出后见复光二分也若在昏刻是日未入前见复光三分日已入后未复光二分也此二端带食分皆是已复光数故录于前也其以带食分减之而余者则是未复光数故录于带食之后也置食甚分内减去日出入分者其日出入分皆在初亏分已上也故谓之见食不见食假如日食甚五分在日出入后其带食三分以之相减尚余二分若在晨刻是日未出前已食二分日已出后见食三分也若在昏刻是日未入前见食二分日已入后不见食三分也此二端带食分皆是未食数故录于后也其以带食分减之而余者则是已食数故录于带食之前也月食仿此但以日之昏为月之晨以日之晨为月之昏盖日出于晨入于昏月出于昏入于晨也其余并同
　　推黄道定积度法
　　置所推食甚入盈缩厯行定度如是盈厯者内加入天正黄道箕宿度共得为黄道定积度也如是缩厯者内加入半嵗周及天正箕宿黄道度共得为黄道定积度也按黄道定积度者逆计食甚日躔度距天正冬至日躔宿度积数也盈厯加入天正黄道箕度者是逆从天正冬至所躔宿初度积算起也缩厯复加半嵗周者缩厯本数是从夏至度起算今加入半嵗周又加入天正箕宿度是变而如盈厯亦从天正冬至箕宿初度起算也所得定积度即是今所躔宿度与箕宿初度相距逺近之数也
　　推食甚日距黄道宿次度法
　　置所推黄道定积度无论盈缩厯皆以黄道各宿次积度钤挨及减之余为食甚日躔黄道某宿次度分也按所推黄道定积度无问盈缩皆是今食甚躔度前距箕宿初度之积数也然尚未知其为黄道何宿度也故以黄道各宿积度钤取其相挨及者减之其减去者是今积度内已满其宿之度日躔已过此宿断为前宿也其不及减而余者则是前宿算外所余度分也是日躔正在此宿中未过故其积度亦未满当即以所减算外之度分断为食甚日躔某宿几度几分也假如食甚定积十度则以箕宿积度九度五九减之余○度四十一分为箕宿算外余数断为食甚日躔黄道斗宿初度四十一分也余仿此
　　黄道各宿次积度钤
　　箕九度【五九】　　　斗三十三度【○六】　牛三十九度【九六】女五十一度【○八】　虚六十○度【○八太】　危七十六度【○三太】室九十四度【三五太】　壁一百○三度【六九太】奎一百廿一度【五六太】娄一百三十三度【九二太】胃一百四九度【七三太】昴一百六十度【八一太】毕一百七七度【三一太】觜一百七七度【三六太】参一百八七度【六四太】井二百十八度【六七太】鬼二百廿○度【七八太】栁二百三十三度【七八太】星二百四十度【○九太】张二百五七度【八八太】翼二百七七度【九七太】轸二百九六度【七二太】角三百○九度【五九太】亢三百十九度【一五太】氐三百三十五度【五五太】房三百四一度【○三太】心三百四七度【三○太】尾三百六五度【二五太】
　　按黄道积度钤皆自箕初度积至其宿垜积之数也假如日躔斗二十三度四七加入箕宿九度五九则已共积得三十三度○六也又如日躔牛六度九十分如入斗二十三度四七又如入箕九度五九共积得三十九度九六也余仿此　又按凡言钤者皆豫将所算之数幷其已前之数垜积而成以便临算取用意同立成也虽然黄道不可以立钤算者当知黄道度之所由生则可以断其是非矣盖黄道积度生于其宿黄道度各宿黄道度皆生于赤道赤道三百六十五度二五七五黄道亦三百六十五度二五七五而其各宿度数不同者则以二至二分所躔不同也赤道近二至则其变黄道度也损而少赤道近二分则其变黄道度也益而多盖赤道平分天腹适当二极之中所纪之度终古不易黄道不然其冬至则近南极在赤道外二十三度九十分其夏至则近北极在赤道内亦二十三度九十分其自南而北自赤道外而入于其内也则交于春分之宿其自北而南自赤道内而出于其外也则交于秋分之宿交则斜以斜较平视赤道之度必多此处既多则二至黄道视赤道之数必少理势然也【二至赤道以敛小之度当黄道大度已详天正箕宿注】黄道之损益既系于分至分至既以嵗而差黄道积度是必毎嵗不同古人则既言之矣此所载者犹据授时厯经所测黄道之度乃至元辛巳一年之数也上考下求数十年间则皆有所不合况距今三百八十余算积差尤多安得海制此钤以尽古今之无穷乎今仍以授时厯经黄赤道差法求得天启辛酉年黄道积度如左
　　依授时厯经求得天启辛酉年黄道积度
　　天正冬至赤道箕宿四度九○
　　赤道四象积度
　　箕五度【五】　　　斗三十○度【七】　　牛三十七度【九】女四十九度【二五】　虚五十八度【二○太】　危七十三度【六○太】室九十○度【七○太】　壁九十一度【三一四三太】
　　右冬至后一象之度
　　壁七度【九九三一少】　　奎二十四度【五九三一少】娄三十六度【三九三一少】胃五十一度【九九三一少】昴六十三度【二九三一少】毕八十○度【六九三一少】觜八十○度【七四三一少】参九十一度【三一四三太】
　　右春分后一象之度
　　参初度【五二八太】　　　井三十三度【八二八太】　鬼三十六度【○二八太】栁四十九度【三二八太】　星五十五度【六二八太】　张七十二度【八七八太】翼九十一度【三一四三太】
　　右夏至后一象之度
　　翼初度【三一四三太】　　轸一十七度【六一四三太】角二十九度【七一四三太】亢三十八度【九一四三太】氐五十五度【二一四三太】房六十○度【八一四三太】心六十七度【三一四三太】尾八十六度【四一四三太】箕九十一度【三一四三太】
　　右秋分后一象之度
　　黄道积度
　　箕五度【○七】　　　斗二十八度【七一】　牛三十五度【六九】女四十六度【九五】　虚五十六度【○六太】　危七十二度【二○太】室九十○度【六五太】　壁九十九度【九八太】　奎一百十七度【七一太】娄一百二十九度【九三太】胃一百四五度【五四太】昴一百五六度【四八太】毕一百七二度【八二太】觜一百七二度【八七太】参一百八三度【一一太】井二百十四度【三五太】鬼二百十六度【四八太】栁二百二十九度【六五太】星二百三十六度【○四太】张二百五四度【○五太】翼二百七四度【二八大】轸二百九二度【九五太】角三百○五度【六八太】亢三百十五度【一二太】氐三百三十一度【三二太】房三百三十六度【七三太】心三百四二度【九三太】尾三百六十度【七四太】箕三百六五度【二五太】
　　天正冬至黄道箕宿四度五一二○
　　黄道各宿度
　　角十二度【七三】亢○九度【四四】氐十六度【二】　房○五度【四一】心○六度【二】　尾十七度【八一】箕○九度【五八】
　　右东方七宿七十七度三十七分
　　斗二十三度【六四】牛○六度【九八】女十一度【二六】虚○九度【一太】危十六度【一四】室十八度【四五】壁○九度【三三】
　　右北方七宿九十四度九十一分太
　　奎十七度【七三】娄十二度【二二】胃十五度【六一】昴一十度【九四】毕十六度【三四】觜　初度【○五】参一十度【二四】
　　右西方七宿八十三度一十三分
　　井三十一度【二四】鬼○二度【一三】栁十三度【一七】星○六度【三九】张十八度【○一】翼二十度【二三】轸十八度【六七】
　　右南方七宿一百○九度八十四度
　　黄道各宿次积度钤
　　箕九度【五八】　　　斗三十三度【二二】　牛四十○度【二】女五十一度【四六】　虚六十○度【五七太】　危七十六度【七一太】室九十五度【一六太】　壁一百○四度【四九太】奎一百二十二度【二二太】娄一百三十四度【四四太】胃一百五十度【○五太】昴一百六十度【九九太】毕一百七七度【三三太】觜一百七七度【三八太】参一百八七度【六二太】井二百十八度【八六太】鬼二百二十度【九九太】栁二百三十四度【一六太】星二百四十度【五五太】张二百五八度【五六太】翼二百七八度【七九太】轸二百九七度【四六太】角三百一十度【一九太】亢三百十九度【六三大】氐三百三十五度【八二太】房三百四一度【二四太】心三百四七度【四四太】尾三百六五度【二五太】
　　已上度钤据天启辛酉嵗差所在歩定俟嵗差移一度时再改歩之又按厯经有増周天加嵗差法因前所推俱依通轨故仍之












　　厯算全书巻二十二
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书卷二十三
　　宣城梅文鼎撰
　　厯学騈枝卷三
　　月食通轨
　　録各有食之望下数
　　经望全分　　　　盈缩厯全分　　盈缩差全分迟疾厯全分　　　迟疾限数　　　迟疾差全分加减差全分　　定望全分【将本日日出分推在卯时何刻望在何刻已下者退一日也　説见定朔望条夘时举例言也按其定望退一日只据小余在日出分已下断之并不必求时刻】入交泛日全分　定入迟疾厯　　定入迟疾限【此限与前仝者便不必书出损益分并行度○按此处损益分不言何用似总不必书出】
　　定限行度　　　　晨分【月入之时刻也先于复圆有带食】日出分
　　日入分　　　　　昏分【月出之时刻也后于初有带食】
　　【按晨昏分所以定更防也其带食分只用日出入分不用晨分葢晨昏日未出月则犹见昏前日已入月则已见也注误】
　　天正赤道度　天正黄道度　　交常度　交定度已上诸法皆与日食同
　　推夘酉前后分法
　　视定望小余如在二千五百分已下者就为夘前分若已上者去减半日周五千分为夘后分又如在七千五百分已下者内减去五千分为酉前分已上者去减日周一万分为酉后分
　　按凡夘酉前后分皆距子午言之夘前分是距子正后之分故即以小余定之夘后分是逆数午正前之距分故以小余减半日周酉前分是顺数午正后之距分故以半日周减小余酉后分是逆数子正前之距分故以小余减日周
　　推时差分法
　　置日周一万内减去夘前夘后分或酉前酉后分【满千分者命为十分满百分者命为单分】为时差分
　　推食甚定分法
　　置所推时差分如入定望小余共得为食甚定分按日食气刻时三差皆起于唐宣明厯非月食所用后来诸厯或有用月食时差者皆于近夘酉则差多近子午则差少又皆子前减子后加今依通轨所推则近夘酉者差反少近子午者差反多又不问子前子后皆以加定望小余而无减法种种与厯经相反窃依元史月食时差法定之如左
　　依厯经求月食甚定分法
　　置卯酉前后分【有千法实皆定三有百法实皆定二】自相乘【言十加定一子】退二位去二子如四百七十八而一【去二子不满法去一子以所定二子为百分一子为十分】为时差子前以减子后以加皆加减定望分为食甚定分依发敛加时求之即食甚时刻
　　按卯酉前后分即前所推卯前卯后分或酉前酉后分自相乘者如求南北差法即以所得卯酉前后分为法与实也凡卯酉前后分皆自子午起算以自相乘则近卯酉差多近子午差少矣退二位法同日食时差以得数后有百万退作万有十万退作千而后除之也如四百七十八而一者是以四百七十八除之如四百七十八分为一分也子前减子后加者凡望时之月在日所冲故日在子前月乃在午前日食午前减故月食亦子前减也日在子后月乃在午后日食午后加故月食亦子后加也其差多者不过一百三十分有竒而止故以四百七十八为法除之也推食甚入盈缩厯及食甚入盈缩差并食甚入盈缩厯行定度三法俱与日食同只换望日
　　推月食入隂阳厯法
　　视所推交定度如在交中度一百八十一度八九六七已下者便为入阳厯也如在已上者内减去交中度余为入隂厯也
　　按交中度数原生于隂阳厯月入阳厯则在黄道南行一百八十一度有竒毕复入黄道北而行隂厯一百八十一度有竒毕则又复入阳厯矣行阳厯隂厯各一次谓之交终半之为交中今交定度在交中度已下是月在黄道南就为入阳厯度数也其在已上者是月在黄道北故于交定度内减去交中度命其余为入隂厯度数也阳厯数自交初起算隂厯数自交中起算也
　　推交前交后度法
　　视所推月食入隂阳厯如在后凖一十五度五十分已下者便为交后度也如在前凖一百六十六度三九六八已上者置交中度内减去隂阳厯余为交前度也按凡言交者皆月出入黄道斜十字相交之际也凡隂厯在后凖已上者是月入隂厯去交未逺尚在十五度内故为隂厯交后度也凡隂厯在前凖已上者是将交阳厯距交已近只在十五度内故为隂厯交前度也阳厯同月食限只一十三度○五分而此言十五度五十分者葢以盈缩差加减之则亦十三度有竒故以十五度五十分为食凖也
　　推月食分秒法
　　置月食限【一十三度五分】内减去交前或交后度【十度定三单度定二按定子法疑有误若如所云则月食必无十分者安得有既内外之分乎愚意当是十度定五单度定四也】
　　以定法八十七分【去一】为法除之【不满法去一子所定有三子为十分二子为单分】为月食分秒不及减者不食十分已下者用三限辰刻法已上者用五限辰刻法
　　按月食限度多于日食者闇虚大而月小也故不问隂阳厯但距交前后一十三度○五分内即能相掩而有食也定法八十七即食限十五分之一故定望正当交度其食十五分渐离其处食分渐杀假如距交前后一度七十四分则于食十五分内减二分只十三分又如距交前后九度五十七分则于食十五分内减十一分只食四分也故置食限以距交度减之即于食十五分内减去若干分秒减不尽者如定法而一为所食之分秒也如食限不及减则是距交前后度多于月食限【已在十三度○五分之外】闇虚虽大至此不能相掩断不食也
　　推月食定用分法
　　置月食分三十分内减去所推月食分秒余【十分定三单分定二】为实却以月食分秒【十分定三单分定二按十分宜定一今加定三子者以分下有十有秒也故亦以定六子为百分法实共加定四子也】为法乘之【言十定一定有六子为百分五子为十分】得为开方积立天元一于单微之下依平方法开之得为开方数【言十定一】复以四千九百二十分【定五　按以六分乘八百二十分得四千九百二十分又按元史数同日食】为法乘开方数【有十定一】得数又以其前推得定限行度【去四子空度去三子】为法除之【不满法去一子定有二子为百分一子为十分】得数为所推定用分也
　　定用分者月食自初复满距食甚之时刻也然日食只十分而月食则有十五分者闇虚大也闇虚之大防何曰大一倍何以知之以算月食用三十分知之也依日食条论两员相切法闇虚半径十分月半径五分两边相切则两半径聫为一直线共十五分为两心之距以此距线用闇虚心为心运作大圆正得全径三十分也此大圆边距闇虚边四周各五分为两圆相切时月心所到之界其两心之距十五分即大圆半径常用为而以食甚时两心之距为句食甚时月心侵入大圆边之数为句较其数与月食分秒同以此与大圆全径相减余即句和和较相乘为股实开方积也其开方数为股即自复至食甚月心所行之白道也
　　四千九百二十乘者何也依日食条论又是十分八百二十而用其六也葢所得月体又小于日一分也然厯经所用与日食同此不同者葢改率也或亦改三应数时所定
　　推三限辰刻等法
　　置所推食甚定分内减去定用分余为初分也不及减者加日周减之复置食甚定分内加入定用分共得为复圆分也满日周去之时刻依合朔推之
　　按三限辰刻同日食理不复赘








　　初时两心之距为【即大员三十分半径】
　　食甚时两心之距为句
　　食甚时月心侵入大员界八分为句较
　　自至甚月心所行之度分为股【甚亦复亦同】
　　此以月食八分为例余可仿推
　　又此系阳厯故月在闇虚南若隂厯反此论之
　　推既内分法
　　置月食限一十五分【按厯经作月食既一十分今从之】内减去所推月食分秒自单以下全分余【十分定三单分定二　句误按此处无十分当是有分定二十秒定一也】为实却以月食分秒自单分以下分秒【单分定二十秒定一】为法乗之【言十定一所定有五子为十分四子为单分】得为开方积立天元一于单微之下依平方法开之得为开方数就置开方数【十分定五单分定四　按十分定五句误此处开方数必无十分当作十秒定三有分定四也分加定四子者以有秒防也】复以四千九百二十分【定五】为法乘之【言十定一】得数又以所推定限行度【去四子空度去三子】为法除之【不满法去一子所定有六子为百分五子为十分】得为所推既内分也
　　按厯经原是以既内分与一十分相减相乘此则改为一十五分今以大圆掩小圆率求得既内小平圆径一十分与厯经合故断从厯经
　　月食十分则既矣此时月体十分全入闇虚而月之边正切闇虚之心两心之距正得五分以得五分为半径自闇虚心作小平圆其全径十分其边各距闇虚心五分为食既时月心所到之界过此界则为既内矣假如月食十二分食既时月心正掩小圆之边食甚时月体则入闇虚内二分而月心亦侵入小平圆二分故即用此二分为句较以与小平圆全径相减余为句和和较相乘得积开方得股即月心从食既至食甚在闇虚内所行小平圆内之白道也于是亦如前法变为度分而计其行率则知月入闇虚以后行至食甚所厯时刻之数而命为既内之分也食甚至复圆同论









　　乙为闇虚心　初亏时月心在甲以其边切闇虚于庚两心之距为乙甲与壬乙等大员半径十五分也为大　食甚时月心行至丁丁甲度分为自亏至甚之行与甚至复丁戊之行等为大股丁乙三分食甚时两心之距为句　壬丁十二分食甚时月心侵入大圆内之数也为句较
　　食既时月心在丙两心之距乙丙与生光时己乙之距等小圆半径五分也为小　丙丁为月心自既至甚之行与甚至生光己丁之行等为小股　丁乙仍为句　午丁二分为食甚时月心侵入小员之数为句较　丙至丁所厯时刻与己至丁时刻等是为既内分　甲至丙所厯时刻与己至戊等是为既外分　此以隂厯月食十二分为式余皆仿论开方数
　　壬丁十二丁癸十八相乘二一六平方开之得丁甲十四【六九】午丁二分丁辰八分相乘十六平方开之得丁丙四分
　　推既外分法
　　置所推定用分内减去既内分余为既外分也
　　按既外分者是月食初亏至食既生光至复圆所厯时刻也原所推定用是自亏初复末中距食甚之数乃既内既外总数也故于其中减去既内时刻其余即既外时刻
　　推五限辰刻等法
　　置食甚定分内减去定用分为初亏分初亏分加既外分为食既分食既分加既内分为食甚分食甚分加既内分为生光分生光分加既外分为复圆分也不及减者加日周减之满日周去之推时刻同前
　　按月食有五限辰刻异于日食者日食只十分故其食而既也即其食甚也才食而既其光即生则其生光之分亦即其食甚也若月食则十五分自食既以至生光厯时且乆为刻皆殊中折二数以知食甚总计亏复故有五限也以定用减小余者所算定用原是食甚距初亏之数也故以减食甚得初亏以既外加初亏及生光者所算既外原是初亏距食既及生光距复圆数也故以加初亏得食既以加生光得复圆至于所算既内原是食既至生光折半之数即是食既生光中距食甚之数也故以加食既得食甚以加食甚得生光不及减加日周者是食甚在子正后初亏等在子正前也加满日周去之者是食甚等在子正前复圆等在子正后也凡言时刻同前者皆依发敛加时推法也
　　推月食入更防法
　　视望下盈缩厯与太阳立成同日之晨分就加一倍得数用五千分而一【句误按当作五而一下同】得为更法分也【定数满法得千分不满法得百分也】将更法又用五千分而一得为防法分也【定数满法得百分不满法得十分也　句误甚按当作满法者百已上不满法者二百已上也大约更法有干者则不满法】
　　按更防倍晨分者凡日入后二刻半而昏日未出前二刻半而晨晨则辨色未昏则不禁行晨昏啓闭以此为节是益昼五刻损夜五刻圣人扶抑之道无所徃而不存也其晨分皆自子正距晨之数夜之有晨分犹日之有半昼分也逆推子正前距昏之数正与相等故倍其晨分即为夜刻也于是以五除之即其夜每更所占时刻之数也假如晨分二千五百倍之五千五除之则知每一更中占有一千分也满法者是在五千分已上故知得数为千分不满法者是在五千分已下故知得数为百分于是又置更法以五除之即其夜每防所占刻数也假如更法分一千五除之则知每防中占有二百分也其防法得数无论满法不满法总是百分不必定数又除法只是单五每夜五更每更五防故以五除之也
　　推初亏等更防法
　　视初亏分如在晨分已下者就加入晨分共为初亏更分也如在昏分已上者内减去昏分余为初亏更分也却以元推更法分为法除之命起一更算外得为初亏更数也其不及更法数者却以元推防法分为法除之命起一防算外得为初亏防数也次四限更防仿此而推各得更防也【若在日入以上昏分以下者命为昏刻若在日出以下晨分以上者命为晨刻皆无更防】
　　按初亏等分如在晨分已下者是在子后也加入晨分是逆从子前昏刻算起也其在昏分已上是在昏后也故减去昏分是减去昼刻截从初昏算起也二者总是从初更初防起算【初更初防即一更一防】加减后得数即知今距初更初防已若干数于是以本日更法除之其满过更法有防数便知已过防更故算外命为更数也其不满更法而余者则正是初入此更以来未满之数故又以防法除之其满过防法有防数便知在此更中已过防防故算外命为防法便知所推初亏等尚在苐防更苐防防中未满也其有总不满更法数者则只是初更其有以防法除总不满法者则只是初防也
　　推月食起复方位法
　　视月食入隂阳厯如是阳厯者初起东北食甚正北复圆于西北也如是隂厯者初起东南食甚正南复圆于西南也若食在八分已上者无论隂阳厯皆初起正东复圆于正西也
　　按月食起复方位主月体言之即人所见月之上下左右也以卯位言之则东为下西为上北为左南为右以酉位言之则东为上西为下南为左北为右也月食入隂阳厯亦主月道言之如是阳厯食是月在日道南其入闇虚被掩者在北故食起东北甚于正北复于西北也如是隂厯食是月在日道北其入闇虚被掩者在南故食起东南甚于正南复于西南也其食在八分已上者是月入闇虚正相掩而过故食起正东复于正西也凡闇虚在日所冲太阳每日行一度闇虚随之而移月之行天既视闇虚为速故其食也皆闇虚先在东月自西来道有必经无所于避遂入其中而为所掩既受掩矣则行而出于闇虚之东却视闇虚又在月西故月食亏初皆在东复末皆在西也又按厯经此亦据午地言之
　　推月有带食分法同日食推
　　月有带食例
　　昏【月未出已复光若干月已出见复光若干】　　晨【月未入见复光若干月已入未复光若干】昏【月未出已食若干月已出见食若干】　　　晨【月未入见食若干月已入不见食若干】按月带食法同日食而只互易其晨昏书法者何也葢月食于望望者日月相望故日出则月入月出则则日入故易日之昏为月之晨易日之晨为月之昏也其所以同者何也假如日入分在复圆分已下是复圆在日入月出后于日为见食甚不见复末者于月则为见复末不见食甚也若日出分在复圆分已下是复圆在日出月入后于日为见复末不见食甚者于月则为见食甚不见复末也之二者总是以食甚分减日出入分其所推带食则总是日月出入前距食甚之数其以减食分而余者亦总是日月出入后未复光之数故总谓之已复光未复光而以所推带食分録于前也又如日入分在初亏分已上是初亏在日入月出前于日为见亏初不见食甚者于月则为见食甚不见亏初也若日出分在初亏分已上是食甚在日出月入后于日为见食甚不见亏初者于月则为见亏初不见食甚也之二者总是以日出入分减食甚分其所推带食分则总是日月出入后距食甚之数其以减食分而余者亦总是日月出入前已食之数故总谓之见食不见食而以所推带食分録于后也【余详日食】又按厯经月食既者以既内分减带食差余进一位如既外分而一以减既分即带食出入所见之分不及减者为带食既出入葢凡所推带食差是食甚所距日出入时刻今以既内分减之而余者即是日出入后距食既前或日出入前距生光后其间所有时刻也进一位者即是以既分乘之也又以既外分除之则知其食既生光距日出入时于既外全数中分得防许时刻即知其于食既全数内分得防许食分也故以减食既十分即为带食出入之食分也不及减者是带食差少于既内分其日出入分已在既内分内故为带食既出入也
　　推食甚月离黄道宿次度法
　　置元推食甚入盈缩厯行定度全分如是盈厯者加半周天一百八十二度六二八七五及天正黄道箕宿度其得为黄道定积度也如是缩厯者止加天正黄道箕宿度内减去七十五秒余为黄道定积度也无论盈缩厯皆以其黄道各宿次积度钤挨及减之余为食甚月离黄道某宿次度分也
　　按月食黄道定积度者逆计月离度前距天正日躔宿度之数也元推食甚入盈缩厯行定度则是所求日躔距天正宿度乃月食所冲也如日在北正月食于南正故盈厯加半周天便是食甚月离宿度又加天正箕宿度便知食甚月离距黄道箕宿初度若干也其缩厯行定度则是日躔距夏至度数故即用其数为月离葢月食日冲日躔夏至宿后第防度月食即亦在冬至宿后第防度故不必加半周天也内减去七十五秒者盈厯缩厯相距半嵗周不及半周天七十五秒减黄道积度钤法仝日食不赘
　　依授时厯经黄赤道法【勿庵补定】
　　求四正后赤道积度
　　置天正冬至所在宿赤道全度以天正赤道减之余为距后度以赤道宿度累加之即各得其宿距冬至后赤道积度加满象限去之为四正宿距后度亦以赤道宿度累加之满象限去之即各得其宿距春分夏至秋分后赤道积度
　　按四正者四仲月中气即二至二分也凡天正赤道度是天正冬至前距其宿初度之数故以减其宿全度即各得冬至后距其宿末度之数也于是以后宿赤道累加之即知冬至后各宿距冬至度所积之数也满象限去之者加满象限是其宿当四正所躔故减去象限即知四正后距其宿末度之数也于是又以赤道各宿度累加之即各得四正后各宿所距四正度之数也
　　求赤道变黄道
　　置各宿距四正后赤道积度用黄赤道立成视在至后者以第三格赤道积度相挨者减之余【有十定三有分定二】为实以其上第二格黄道率乘之【不用乘只加定四子】以下第四格黄道率为法除之【有度去四有十去三不满法再去一视定有四子为度三子为十分】加入第一格黄道积度即为其宿距至后黄道积度其夏至后再加周半天即各得其宿距天正黄道积度也若在分后者以第一格赤道积度相同者减之只用小余【有十定三有分定二】为实以下第四格黄道率为法【有度定四○度定三】乘之【言千定一】得数以其上第二格赤道率除之【不用除只去四子视定有四子为度三子为十分】加入第三格黄道积度即得其宿距分后积度其春分后再加一象限秋后分再加三象限即各得其宿距天正黄道积度也于是各置其宿距天正黄道积度以相挨前一宿黄道积度减之即各得其宿黄道本度也【秒就近约为分】
　　按至后不用乘者其立成黄道率只是一度乘过数不动故只加定四子也分后不用除者其立成赤道率亦是一度除过数亦不动故只虚去四子也夏至后加半周天春分后加一象限秋分后加三象限者此所求黄道积度皆距四正起算故各以四正距天正黄道数加之即其宿前距天正之数也葢至后黄道虽减于赤道分后黄道虽加于赤道其实至四立之后则加之极而反减减之极而反加总计一象皆得九十一度有竒此天道如环平陂徃复间不容髪也减前宿积度为其宿本度者积度即是距天正数原包前宿在内故减之即得本度也【秒就近约为分者凡秒五十已上收为分已下弃之就整数也其七十五秒寄虚度】
　　求天正冬至黄道度
　　置周天度【三百六十五度二五七五】内减天正前一宿距天正黄道积度余命为天正冬至宿黄道度分也若迳求者置象限以其年天正赤道度减之余为天正前宿距秋分后赤道积度依赤道变黄道法求出其宿距分后黄道积度以减象限余为天正黄道度
　　按周天度是自天正后积至天正前黄道总数故减去前宿距天正黄道积度即得天正距所在宿初度之数也迳求法置象限者即是自天正前距秋分后赤道总数也内减去天正赤道度其余即是前宿距秋分后赤道积度也赤道变黄道法即是以立成第一格积度减余以第四格度率乘以第二格度率除加入第三格积度而命为前宿距秋分后黄道积度也又以减象限者此所为象限即是自天正前距秋分后黄道总数故减去前宿距秋分黄道积度其余即是天正冬至距其宿初度黄道之数也
　　求黄道宿积度定钤
　　置天正冬至宿黄道度及分加入其宿距至后黄道积度及分共得为天正冬至宿黄道定积度以各宿黄道度累加之即各得其宿黄道定积度
　　按分至每嵗有差黄道因之而易即不能每嵗歩之当于六十六年嵗差一度时更定度钤始为无也凡冬至所在宿皆有前后距其黄道皆减于赤道今所推其宿至后积度是自冬至日躔后距其宿末度黄道数其天正黄道宿度则是自冬至日躔前距其宿初度黄道数也合二数为其宿初度距其末度总数故即命为天正宿定积度也于是以各宿黄道度累加之即所得其宿所距天正宿初度之数而命为定积度也
　　求日月食甚宿次黄道度及分秒法同通轨
　　又术置所推食甚盈缩厯缩厯加半周天为黄道定积度月食盈缩厯俱加半周天满周天分去之为黄道定积度皆迳以距天正黄道积度相挨者减之即各得日月食甚黄道宿度及分秒
　　按此法不用定积度钤故亦不加天正黄道度然必每年歩定黄道积度方可用之也
　　赤道宿度
　　角十一度【一○】亢○九度【二○】氐十六度【三○】房○五度【六○】心○六度【五○】尾十九度【一○】箕一十度【四○】
　　右东方七宿七十九度二十分
　　斗廿五度【二○】牛○七度【二○】女十一度【三五】虚○八度【九五太】危十五度【四○】室十七度【一○】壁○八度【六○】
　　右北方七宿九十三度八十分太
　　奎十六度【六○】娄十一度【八○】胃十五度【六○】昴十一度【三○】毕十七度【四○】觜○○度【五】　参十一度【一○】
　　右西方七宿八十三度八十五分
　　井三十三度【三○】鬼○二度【二○】栁十三度【三○】星○六度【三○】张十七度【二五】翼十八度【七五】轸十七度【三○】
　　右南方七宿一百○八度四十分
　　黄赤道立成











<子部,天文算法类,推步之属,历算全书,卷二十三 >
<子部,天文算法类,推步之属,历算全书,卷二十三 >
<子部,天文算法类,推步之属,历算全书,卷二十三 >
<子部,天文算法类,推步之属,历算全书,卷二十三 >
<子部,天文算法类,推步之属,历算全书,卷二十三 >















　　厯算全书卷二十三
　　钦定四库全书
　　厯算全书卷二十四
　　宣城梅文鼎撰
　　厯学骈枝卷四
　　盈缩厯立成
　　太阳冬至前后二象盈初缩末限
　　太阳夏至前后二象缩初盈末限
　　布立成法
　　厯经盈缩招差法
　　太隂迟疾立成
　　布立成法
　　求每限月平行度法
　　厯经迟疾厯三差法
　　日出入晨昏半昼分立成
　　冬至后半嵗周
　　夏至后半嵗周
　　考立成法















　　太阳冬至前后二象盈初缩末限















<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>


　　【置本限八十八度九○九二二五加入盈积度二度四○一四即合周嵗一象限九十一度三一○六二五之数】





　　太阳夏至前后二象缩初盈末限







<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>















　　【置本限九十三度七一二○二五减去缩积度二度四○一四即合周嵗一象限九十一度三一○六二五之数】布立成法
　　先依厯经盈缩招差各以其日平差立差求到每日盈缩积次以相挨两日盈缩积相减余为每日盈缩加分以其日加分盈加缩减一度即每日日行度又以两日加分相减余为每日平立合差再置末日平立合差以初日平立合差减之余为实末日日数为法法除实即得每日平立合差之差数也【如盈初置八十七日下平立合差六分五五六八内减初日四分九三八六余一分六一八二为实八十七日为法除之得○一八六为每日之差缩初置九十二日下平立合差五分九二六六内减初日四分四三六二余一分四九○四为实九十二日为法除之得○】
　　【一六二为每日之差】又法【盈初置立差三十一缩初置立差二十七各六因之即得每日平立合差之差数】
　　厯经盈缩招差法



　　凡求盈缩积皆以入厯初末日乘立差得数用加平差再以初末日乘之得数以减定差余数复以初末日乘之得数万约为分即各得其日盈缩积
　　太隂迟疾厯立成















<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>




　　布立成法
　　依厯经垜叠招差各以平差立差求到各限迟疾度次以相挨两限迟疾度相减余为各限损益分次以各限损益分加减每限月平行度得为各限迟疾行度也数止秒秒以下不用其加减法在疾厯益加损减迟厯反之
　　求每限月平行度法
　　置小转中【十三日七七七三】以每日月平行度【十三度三六八七五】乘之得【一百八十四度一八五二七九三七五】为实以一百六十八限除之得一度○九六三四○九四是为每限月平行度也
　　厯经迟疾厯三差法
　　立差　三百二十五
　　平差　二万八千一百
　　定差　一千一百一十一万
　　凡推迟疾在八十四限以下者为初限以上者去减一百六十八限余为末限置立差以初末限乘之得数用加平差再以初末限乘之以减定差余数再以初末限乘之得数满亿为度即得各限迟疾积度【凡初限是从初顺数至后末限是从未尽日逆溯至前故其数并同也】
　　月与日立法同但太阳以定气立限故盈缩异数太隂以平行立限故迟疾同原







　　日出入晨昏半昼分立成
　　冬至后半嵗周














<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>








　　夏至后半嵗周







<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>
<子部,天文算法类,推步之属,历算全书,卷二十四>












　　考立成法
　　以半昼分转减五千分【半日周】余为日出分　日出分减去二百五十分为晨分　以晨分减日周一万分余为昏分　昏分减去二百五十分为日入分
　　又防法【晨分与昏分相并成日周一万又日出分与日入分相并亦成日周一万】














　　厯算全书卷二十四
<子部,天文算法类,推步之属,历算全书>
　　交防管见小引
　　交食为验厯大端其事之著者有三一曰食分深浅一曰加时早晚一曰起复方位古法至授时立法已详新法有西洋所测更密几于无可复议独其所谓起复方位并以东西南北为言【如日食八分以上初亏正西复圆正东八分以下阳厯初亏西南食甚正南复员东南隂厯初亏西北食甚正北复员东北月食八分以上初亏正东复员正西八分以下阳厯初亏东北食甚正北复员西北隂厯初亏东南食甚正南复员西南之类】而东西南北并以日月光体中心为主故其边向北极处斯谓之北向南极处斯谓之南而东西从之亦以日月之边向东升处即谓之东向西没处即谓之西此中西厯法所同也然天既北倚赤道之势与北极出地相应皆南高而东西下黄道斜交赤道又因节气而殊初亏食甚复圆各限加时又别是故人所见日月光体之东西南北非日体之东西南北也故于仰观不能尽合密测者以日月体匀为细分而求其亏甚所当之处于理为尽然必测器精良用法取影庶几可知终不能若食分深浅加时早晚之可以万目同观众着无疑也愚今别立新术凡亏复各限并于日月光体之上下左右直指其蚀损所在而不用更杂以东西南北之名欲令测候之时举目共见即步算之疎密纎毫莫遁或于测学不无小补犹冀髙贤深明理数有以进而教之也
　　康熙四十有四年嵗在防防作噩勿庵梅文鼎谨识时
　　年七十有三









　　钦定四库全书
　　厯算全书巻二十五
　　宣城梅文鼎撰
　　交防管见
　　求初亏复员定交角
　　以初亏复员定时分依法求其距午时分午后以加午前以减各加减日实度所对时分【入九十度表取之】为初亏复员时定总时
　　以定总时各求其日距限限距地髙遂以得其交角加减之得初亏复员时定交角
　　求初亏复员时先阙后盈之防在日体上下左右
　　法自天顶作垂弧过日心以至地平分日体员周左右各一百八十度次依定交角度分日在限西初亏为右下之角复员为左上之角其度右旋日在限东初亏为右上之角复员为左下之角其度左转并自垂弧左右起算数至定交角度分即得太阳员周初亏时先阙复员时后盈之防其定交角或为钝角者上下相易【如本为右下者变为右上本为右上者变为右下左亦然】是为亏复时交道中径　食十分者用此即中西旧法所谓八分以上初亏正西复员正东者也【初亏复员各依其定交角度分取之】
　　若食九分以下当先求蚀纬差角法为并径与月视黄纬若半径与蚀纬差角之正也以月视黄纬化秒乘半径为实以并径减一分化秒为法除之得蚀纬差角之正查正得度分以加减亏复时交道中径得日体周边先缺后盈之防
　　视纬北者日在限西初亏以加复员以减日在限东初亏以减复员以加视纬南者日在限西初亏以减复员以加日在限东初亏以加复员以减并置交道中径以蚀纬差角度分加减之得数仍自垂弧左右起算得初亏何处先缺复员何处后盈上下左右皆可预定
　　求食甚在日体上下左右
　　惟食十分者食甚时两心相掩或全黒或作全环皆无上下左右可论其食九分以下皆以隂阳厯论南北视纬若食甚时正在黄平象限则视纬北者食甚在日体上半缺口正向天顶形如仰瓦即旧法所谓正北视纬南者食甚在日体下半余光厚处正对天顶缺处正向地平两角下垂形如覆梳即旧法所谓正南也若此者只有上下可言而无左右偏侧之度其余日在限西则南纬在左下北纬在右下日在限东南纬在右下北纬在左下并以食甚时定交角之余度或左或右并从天顶垂弧之两旁起算即得食甚在日体上下左右之度
　　求日体周边受蚀几何
　　法用太阳太隂两半径相并为和相减为较和较相乗为实月视黄纬为法除之得数以加减月视黄纬讫乃折半以乘半径又为实以太阳半径为法除之得余查表得度倍之即食甚时日体受蚀度分【以太阳全周分三百六十度内该受蚀者几何度】加减例【日半径大于月以得数加黄纬日半径小于月置黄纬以得数减之】
　　求日食三限在地平上髙度
　　食甚时日距地髙即可径用　初亏复员各以定时求其距午分依日赤纬南北度入髙弧表即各得亏复时地平上髙度【如无正表取前后二表数以中比例酌之假如其地极出地三十一度则查三十度表及三十二度表以两表数并而半之即是本地髙弧之数】又算法【以限距地髙度与日距限之余度相加为捴相减为较捴较各取余视捴弧过象限则两余相并不过象限两余相减并折半得髙弧正捡表得髙度】
　　求日食三限地平经度
　　法以地平纬度之余度分与极出地之余度分相加为总相减为较总弧较弧之余相减若总弧过象限则相加并折半为法【初数】又取较弧矢与日距北极度之矢【对弧矢也日赤纬在南者以加象限赤纬在北者置象限以赤纬减之即各得距北极度】相减得较较乘半径为实实如法而一得角之矢【以矢命度】若日食在午前其角度为距正北子正之度食在午后以减半周为距正南午正之度【正矢与大矢并同一法】三限皆如是
　　求带食分在日体上下左右
　　以日出入时距纬为法半径乘月视黄纬为实实如法而一得正查表得带食纬差角度分如求初亏复员之法以带食纬差角加减白道中径得带食分在日体上下左右若带食在初亏后食甚前其加减用初亏法带食在食甚后复员前其加减用复员法
　　带食在初亏后食甚前者　隂厯日在限西加　日在限东减
　　阳厯日在限西减　日在限东加
　　带食在食甚后复员前者　隂厯日在限西减　日在限东加
　　阳厯日在限西加　日在限东减
　　右并置月道中径以带食纬差角度分加减之得数仍自垂弧左右起算即得带食时食分最深之处在日体上下左右【凡带食出入时或防亏或见蚀半或半以上其余光皆成两角外向均折两角取其中即带食分最深之处】
　　求带食出入时日边受蚀几何
　　以太阳太隂两半径相并为和相减为较和较相乘为实日出入时距纬为法除之得数以加减日出入时距纬【日半径大于月以得数加入距纬日半径小于月置距纬以得数减之】乃折半用乘半径又为实太阳半径为法除之得余查表得度倍之为带食出入时太阳周边受蚀之分【以三百六十度分太阳全周内该缺几何度分】













　　作日食分图法【交食之验非图莫显图必分作其象始真故不惮反覆详明以着其理】
　　一定日食时交道斜正
　　作立线以象垂弧此线上指天顶下指地平即地平经度圏之一象限也线上取一防为心规作员形以象太阳其员周为地平经线所分左右各一百八十度依本限定交角作防【或初亏或复员或食甚各有定交角】若日距限在西其度右旋日距限在东其度左旋于太阳员周上下并从垂线分处数至定交角度止得两防聮为一直线必过太阳之心两端稍引长之横出是为日食时月道交于垂弧之象若日距限西交道左昂右低日距限东反之其初亏食甚复员三限距限东西有时而异虽其不异亦必有逺近髙下之殊则交道低昂异势未可以一法齐也今三限各求定交角依度作图不论东西南北一以太阳边左右上下言其亏甚之状即测算可以相符厯法之疎宻可以众睹更无丝毫可容假借









　　如图甲乙为垂弧　甲丁乙丙为日体　乙己丙为定交角丁己甲为对角乙至丙甲至丁皆定交角之度因日距限在限西故右旋数其度　　丙丁为上下两防己为日心聮丙丁为直线则过日心稍引长之至庚则成交道因在限西故月道左昂右低【交道即月道也为月视纬所成在食十分时可名月道其食不满十分者可名月道平行线】










　　各号并与前同
　　惟日距限在限东故从乙至丙从甲至丁并左旋数定交角度而庚辛月道右昂左低













　　如图月道平过与天顶垂弧相交成十字正角而又在午方则上北下南左东右西各如本位矣【如旧法食十分初亏正西复圆正东食八分以下者隂厯初亏西北食甚正北复圆东北阳厯初亏西南食甚正南复圆东南惟此时为然】此必日食在黄平象限左右因定交角加减而成正角然不常有即有之又未必在正南方则与东西南北之名不相叶应故不如用定交角直以上下左右言其方向【黄平象限有离午正二十三四度时又有定交角加减则虽离午正三十余度之逺而能有此象盖即月道之九十度限也食既者遇之亏必正右复必正左北纬者亏右上复左上而食甚正向天顶南纬者亏右下复左下而食甚向地平】















　　己为日戊为月
　　乙至丙甲至丁皆交角之度
　　丙为初亏丁为复圆
　　戊丙己丁为月道
　　此因日食十分故即用丙丁二防为初亏复圆即旧法所云初亏正西复圆正东者也然以日距限西故初亏在日体右下复圆在日体左上









　　此亦日食十分因距限在东故初亏在日体为右上复圆在日体为左下
　　凡日距限西者复圆交角必小于初亏日距限东者复圆交角必大于初亏故必分作其图始能合算今从简省以交角相同者合为一图非谓一食中亏复同角也











　　一图初亏
　　先以初亏定交角如法作垂弧及交道安太阳于交防若食十分者于太阳右方截取交道如月半径之度以此为心规作月体与太阳边相切即初亏时先缺之防【图己见前】
　　若食不满十分者用纬差角度算太阳边周之度月视黄纬在北向上数之在南向下数之并从太阳右方交道起算数至纬差角度止即为初亏时先缺之防自太阳心向此防作直线透出其外稍引长之以并径为度从心截取引长线作防即初亏时两心之距也以截防为心太隂半径为度作圆形即初亏时太隂来掩太阳相切之象也从太隂心作直线与交道平行则月视行之道也从太阳心作垂线至视行线成十字角即月视黄纬也　以上并不论初亏是午前午后亦不论地平方位或在正南或偏东西并同一法食甚复圆仿此









　　乙己丙交角乙丙其度从丙过己心至丁而引长之即月道平行线
　　丙己庚为纬差角丙庚其度因月视黄纬在北故从交道丙向上数其度至庚庚即初亏时先缺之防
　　从太阳心己作直线过庚防而透出其外为己庚戊线乃并日月两半径【得己戊】为度截己庚戊线于戊戊即太隂心也以戊庚月半径从戊心作圆为太隂与太阳边相切于庚初亏象也
　　从月心戊作戊辛癸线与丙己丁平行月视行道也【此月视行线乃人所见月心所行故以丙己丁交线为月道平行线】从太阳己心作十字垂线至月视行线上如己辛月视黄纬也













　　乙己丙交角以乙丙为度从丙过己心作月道平行线丙己庚纬差角以丙庚为度因月视黄纬在南故从交道丙向下数其度至庚庚即初亏时先缺之防【此为纬差角大于定交角故易右为左】
　　从己心向庚作己庚戊线而以己戊并径度截之于戊用为月心规作月体与太阳相切于庚象初亏也从戊心作癸戊辛线与丙己丁平行月视行道也从己心作己辛线与戊辛相遇成方角月视黄纬也以上二宗为日距限西日距限西者初亏定交角并为右下之角然惟食十分时则初亏右下与定交角同防其余则北纬者能易右下为右上前条是也南纬者能易右下为左下此条是也












　　甲己丁交角以丁甲为度从丁过己心作丁己丙月道平行线
　　丁己庚纬差角以丁庚为度因月视黄纬在北从交道丁向上数至庚以庚为初亏之防【此亦纬差角大于定交角故易右为左】如前从己心向庚作透出线截之于戊使己戊同并径则戊为月心从戊心作圆形象初亏时太隂以其边切太阳于庚从戊作戊辛癸线为月视行之道与丁己丙平行又从己作己辛线为月视黄纬辛为正角








　　诸号同前
　　惟以月视黄纬【即己辛】在南故纬差角【丁己庚角】从交道【丁】向下数其度【至庚】为初亏之防
　　以上二者为日距限东凡初亏在限东者其定交角为右上之角然惟日食十分与定交角同防而初亏右上其余北纬者能易右上为左上南纬者能易右上为右下此二条可以推矣

　　一图食甚
　　先以食甚定交角作垂弧月道于交防安太阳并如初亏法次于太阳周边数定交角余度若日距限西其度左旋日距限东其度右旋并于日体上下方从垂线数起至定交角余度止各作防聮为一直线稍引长之此线与月道为正十字能过月道之极即月道之经圏食甚时太阳太隂并在此线之上乃以月视黄纬求其距若视纬在北向上量之视纬在南向下量之并从太阳心截取视纬于月道经线作防即食甚时两心之距也以此为心月半径为度规作月体即见食甚时月掩太阳在日体上下左右几何度分此时两心之距为最近其食分最深于此线上分太阳光体为十平分即所食之分可见若于太阳之边数其所蚀光界即知太阳周边受蚀几何度分
　　若于月心作线与月道经线为十字正角即自亏至复月行之道也两端稍引长之用并径为度从太阳心截之左右各得一防即初亏复圆之防也【右为初亏左为复圆】如此即为总图【総图惟食甚为正形初亏复圆亦得大槩仍当于分图攷之】
　　若食十分者或全黒或作金环并无视纬更无上下左右可论不用此法
　　又若食甚时定交角满九十度则北纬正对天顶余光有如仰盂南纬正对地平余光有如覆椀其月道左右平衡其南北视纬即于垂弧取距【北纬自太阳心向上南纬自太阳心向下并以月视黄纬取其度为两心之距】不须另作月道经线又于月道经线以月视黄纬量其距若隂厯向上量之阳厯向下量之并自太阳心量至视黄纬止从此作线与月道经线为十字角即与亏复月行之道平行南北差之理亦自可见












　　乙己丙为定交角其度自乙右旋至丙丙己丁线过太阳心为月道平行线
　　乙己庚为定交角之余角其度自乙左旋至庚庚为食甚所向之方从庚过太阳心作午己庚线为太阳全径分为十分　依月视黄纬自太阳心己截至戊以戊为心月半径壬戊为度作圆以象食甚时掩日之月　计所掩径自庚至壬得蚀六分余光自壬至午得四分计所掩边自酉过庚至卯得缺光之边一百三十分余光自酉过午至夘得未掩之边二百三十分约为蚀三之一而强【此以太阳边周为三百六十分也分亦可名度】
　　从月心戊作戊癸线与太阳径为十字角与交线平行是为月视行之道以并径为度自太阳心己截戊癸月道于辛于子各为心作太隂象即见初亏于酉复圆于卯可当总图










　　此与前图皆食在限西故乙己丙定交角同势惟月视黄纬在北故用甲庚余角从甲左旋数至庚为食甚所向之方亦作午己庚十分全径而透出之用月视黄纬截之于戊戊为心戊壬半径作月体交加于太阳光体之上计所掩自庚至壬得蚀四分有竒其自未过庚至丑为所蚀之边　又如法从戊心作月视行之道以幷径截之于辛于子各作月体即见卯酉为亏复之防几食在限西者南纬必食甚左下北纬必食甚右上惟交角大者余角小交角小者余角大而大致不改即二图可槩其余
　　其初亏交角必大于食甚复员交角必小于食甚全图聊举大意仍以分图为定












　　乙己丙定交角其度自乙左旋至丙丙己丁过太阳心为月道平行线
　　乙己庚余角度自乙右旋至庚庚己午太阳全径引长之以月视黄纬度截之于戊戊为食甚时月心所到其边掩太阳至壬午壬为食甚所向之方分太阳全径为十分午壬为所掩之分得二分有竒未午丑为所缺之边约得九之二









　　此与前图皆食在限东乙己丙交角同势惟月视黄纬在南故用甲己午余角【即乙己庚】右旋从乙至庚庚防为食甚所向庚己午太阳全径十分以月视黄纬截己戊戊为月心作太隂体掩太阳至壬得八分有竒未庚丑为所缺之边约得九之四凡食甚在限东者北纬必左上南纬必右下虽角有大小其大致不变以上二图可槩其余　以上食甚四图或居太阳体之左上左下右上右下并以定交角论其余角不论地平经度之东西南北并同一理即令食甚正午而距限有东西即交道有低昂必无正北正南如旧法所云者也














　　此月视纬在北
　　日食七分竒
　　甲为食甚在日体上方余光如仰盂













　　此月视纬在南
　　日食五分
　　戊为食甚
　　在日体下方
　　余光如覆椀
　　惟此二图是交角成象限若又居正南方则北纬食甚可称正北南纬食甚可称正南









　　一图复圆
　　以复圆定交角作垂弧月道安太阳并如上法
　　若食十分者于太阳左方截取月道如月半径之度以此为心规作月体与太阳边相切即复圆时后盈之防【图亦见前】
　　若食不满十分者用纬差角度算太阳边周之度北纬向上数之南向下数之并从太阳左方交道起数至纬差角度止即为复圆时后盈之防自太阳心向此防作直线透出其外稍引长之以并径为度从心截取引长线作防即复圆时两心之距以截防为心规作太隂与太阳相切即复圆时太隂行过太阳初离之象也













　　甲己丁交角【即乙己丙】其度甲丁从丁过己心作丙己丁线引长之即月道平行线
　　丁己庚为纬差角其度丁庚因月视黄纬在南从交道丁向下数其度至庚庚即复圆时后盈之防　从太阳心己出直线过庚而透出其外为己庚戊线以幷径为度截之于戊以戊为心月半径为界作太隂圆体切太阳边于庚即太隂行过太阳初离之象也　从月心戊作戊辛直线月视行之道也而己辛者月视黄纬也








　　甲己丁交角【即乙己丙】其度甲丁从丁作月道平行线过己心至丙而引长之
　　丁己庚纬差角大于交角而月视黄纬在北法当从交道丁向上数丁庚之度跨甲而至庚庚即复圆时复光最后之防　又法从己心作丙己丁之十字垂线乃以月视黄纬为度截之于辛则己辛即食甚两心之距也从辛又作十字长垂线与丙己丁交道平行如戊辛癸即月视行之道也次以幷径为度截月视行道于戊以戊为心月半径为度作复圆时太隂象即其边切太阳于庚
　　以上二图皆复圆距限西也凡复圆限西者其定交角为左上之角然惟食十分其防不改其余则有易为正左稍下如前图者有易为右上如此图者余可数推











　　乙己丙交角以乙丙为度从丙作月道平行线过己心至丁而引长之
　　因月视黄纬在北从交道丙向上数纬差角丙己庚之度至庚即庚为复圆之防　又法以丁午丙半周度折半于午从午作线至太阳心己为丙己丁之十字垂线于此垂线上截取辛己如月视黄纬即于辛防作十字交线与交道线【即月道平行线】平行为月视行之道于此月视行道取戊己斜距如并径则戊防即复圆时太隂之心从心作太隂体即切太阳于庚而正居太阳左方















　　此交角与差角同度也庚己丙交角其度自庚数至丙防为月道平行线所过【丙己丁过心线为交道即月道平行线】
　　丙己庚差角自丙数至庚【因南纬向下数】庚防为复圆时太隂初离太阳边犹相切之处也差角丙庚之度与交角庚丙等故相减至尽而正居太阳之底也　如用又法从己心作己午垂线以月视纬截辛防从辛作十字线如辛癸与交线平行为月视行道即可以戊己并径截戊防为太隂心其边即切太阳于庚亦同
　　凡复圆限东者定交角必居左下然惟食十分者则然其余则有变为日体正左或日体正下者如以上二条者可类推也





















　　甲为九十度限　乙为黄道过午规交角　乙丙为黄道在午规距天顶之度今用乙甲丙正弧三角形有甲正角　乙交角　乙丙弧而求甲丙弧为九十度距天顶之度　法为半径与丙乙弧正若乙角之正与丙甲正也
　　【一　半径二　丙乙正】
　　【三　乙角正四　丙甲正】
　　増沿厯书乃以丙乙余与乙角余相乗为实半径除之得丙甲正失其防矣
　　简庵曰甲角非正角也何以言之自天顶出线过赤道则为正角其过黄道不能成正角甲角既为天顶线过黄道所作之角则必非正角勿庵曰不然甲防者九十度限也若甲非正角则不得为九十度限矣
　　简庵曰赤道能为正角者以天顶线能过北极也若黄极则不能过天顶天顶线既不串黄极则甲必不能为正角明矣勿庵曰子午线所以能穿天顶与北极者以赤道在平地上半周一百八十度而交子午圈处为其折半最中之处故天顶线交赤道成十字角也天顶线与赤道作正角惟此一处盖惟此处能使地平经线【即天顶出线至地平分方位之线】与赤道经线【即北极出线至赤道分时刻之线】合而为一【从地平经线言之为子午规从赤道言为过极圈】他处则不能也黄道亦然其在地平上亦一百八十度每度并从黄极出经线至黄道上成正角但不能过天顶而必有一度为黄道半周折半之处则此一经线必过天顶而穿黄极天顶线既穿黄极则其交黄道处必成十字正角矣天顶线与黄道作正角亦惟此一处【亦如赤道之有子午规】盖亦惟此处能使地平经线与黄道经圈合而为一而他度不能西法用九十度限其理如此故甲角必正角简庵闻此欣然首肯焉











　　本法用乙甲丙形求丙甲为九十度距天顶　今依简庵説用丁戊丙形求得戊丙为天顶距黄极之度以减象限即得丙甲距天顶之度
　　法曰以正午黄经之赤道同升度取丁角【从冬至数之即得】以各地北极出地余度取丁丙边　以两极相距二十三度半为丁戊边
　　是为一角两边可求戊丙边
　　若用垂弧法虽多转折其理无讹　若用加减代乘除法乃捷矣
　　又按此以正弧形为本形改用斜弧为次形亦弧三角中一法往所未及也可见学问相长之无穷
　　既得甲丙边又原有乙丙边甲正角可求甲乙边为九十度距午规











　　丁北极　戊黄极　丑寅圈径五度为白道极所行之迹　丑为今所求月道心【即白道极所到】得丑寅边为丑戊寅角之度亦即为丁戊丑角度　先用丁戊丑弧三角形有丁戊边【为两极距二十三度半】有丑戊边【为月道大距五度】有戊角【即上所论】　可求丑丁边为白道极距北极之弧　可求丑丁戊角
　　次用丁丑丙弧三角形　有丑丁弧【为先所求】有丙丁丑角【以先有之戊丁丙角与今得之丑丁戊角相加减得丙丁丑角】有丁丙边【即本地北极出地余度】可求丑丙边为白道极距天顶之弧亦即为白道九
　　十度距地平之髙度　求白道极所在【即丑防】法曰凡白道极随交防而移交防逆行故白道极亦逆行也先求正交【或中交】在黄道度分离此一象限即为半交最逺之所此防与白道极相应若系半交是阳厯则白极在黄极南半交是隂厯则白极在黄极北极距黄极五度竒即丑戊也丑戊弧五度循黄极而左旋有时而合于两极距线为寅戊或戊辛则无丑戊丁角自此以外皆有戊角此算之根也















　　设白道极【丑】在寅即丑戊寅角法当以戊寅五度【白极距黄极】与丁戊二十三度半相减余十八度半为寅丁寅丁丙弧三角形有寅丁边【为白极距北极】有丁丙边【北极距天顶】有丁角可求寅丙边为白极距天顶












　　又设【丑】防在辛即以戊辛加戊丁为一边【辛丁】如上法可求辛丙弧为白极距天顶
　　以上二者因白极距黄极之线与黄极距北极同一大圈之经度故丁戊线有加减而丁角无加减故只用一弧三角形即可得之此惟月边半交在二至度然后能如是
　　设正交在秋分之度中交在春分之度则阳厯半交在冬至黄道外隂厯半交在夏至黄道内各五度竒而白道极在两极距线外亦五度竒如辛如酉
　　法当以白黄大距五度竒【辛戊或酉戊】加两极距二十三度半【戊丁】共得二十八度半竒【辛丁或酉丁】为一边　丁丙为一边【北极距天顶】丁为一角【或辛丁丙或酉丁丙】　可求辛丙边【或酉丙边】即白道极距天顶度以减九十度余为白道距天顶度【捷法即以所得白道极距天顶命为白道九十度距地平】
　　此图丁辛线己用弧线不能作两白道极圈

















　　如图丙为天顶丁为北极丁戊二十三度半即以丁为心戊为界运规作圆即黄极绕北极之圈再以丁戊引长之至于辛又以戊为心辛为界作圆为白极绕黄极之迹戊辛为黄白距五度竒【此图则戊酉可省】
　　今聮丁辛丙成三角形如上论余观图自明
　　更当明者白道限度之不能与黄平象限同在一度即若黄平象限之不能与赤道髙度同在一度同也黄平象限与赤道髙度能在一经度者惟极至圈在子午规之度为然白道限度之能与黄平象限同在一经度者惟两交在二分之度又极至圈同在午规时也
　　又设正交在春分之度中交在秋分之度则阳厯半交在夏至黄道外隂厯半交在冬至黄道内各五度竒而白道极在两极距线内亦五度竒如寅如未
　　法当以白黄大距五度竒【寅戊或未戊】去减两极距二十三度半【戊丁】得余十八度半弱【寅丁或未丁】为一边　丁丙为一边　丁为一角【或寅丁丙或未丁丙】可求寅丙边【或未丙边】为白极距天顶即命为白道九十度距地平之髙图如后














　　以上二者并只用一弧三角形何则以交防在二分也交防在二分则半交与白极并在极至交圈故丁戊弧自有加减而丁角无加减若交防离二分则否何则交防逆行即罗计度也交防周于天而半交大距亦一周天而白极亦周于黄极左右之小圈故丁角有加减而必用两三角形也
　　求戊角【用两三角形必先取戊角】　法曰正交在秋分则白极在辛【即在酉】从辛左旋过丑至寅而复于辛以生戊角戊角之度或鋭或钝皆以交防距分之度命之
　　白极小圏以罗计一周而复于元度【假如正交自秋分向夏至逆行过秋分二十度则白极离辛防亦二十度以减半周余百六十度为戊钝角】
　　求丁角【戊丁丙角】　法曰视极至交圏距午圏若干度分即得戊丁丙角【以加时午正黄道度取之】
　　白道九十度限用法
　　依前所论以求加时白道九十度限在地平上之髙的确不易【用斜弧三角形】　但如此则交食表所算九十度限俱可不用当另算白道九十度表
　　法曰丑戊丁三角形以丁戊边【两极距二十三度半】丑戊边【白极距黄极五度】戊角【白极距冬至经圏之度亦即正交离秋分之余度】为二边一角可求丁丑边【此边之度天下所同】丁角【此角亦天下所同】其法并以戊角之大小立算【只算半周可以立表矣】
　　正交在【秋分前以过夏至而至春分春分前以过冬至而至秋分】之度角在极至圏【西东】戊丁丙三角形　求丁角
　　法曰以应时法求加时午正黄道【可借用黄道九十度表】取其赤道同升度即得丁角
　　视同升度在冬至后半周其距冬至度即为丁角【其角在子午线西】若同升度在夏至后半周即以距夏至度去减半周余为丁角【其角在子午线东】此丁角亦天下所同
　　丑丁丙三角形　先求丁角
　　法曰以先有之两丁角相减或相并即得丁角
　　两丁角俱在西或俱在东【则相并】两丁角一在西一在东【则相减】此丁角亦天下所同
　　次求丁丙边
　　法曰丁丙者各地之北极距天顶也以北极髙度减象限得之
　　次求白道九十度限之髙
　　法曰既有丁角【即上所求】丁丑边【即先所求】丁丙边【即极距天顶】为一角两边可求丑丙边【为白极距天顶度】以减象限得白道九十度限距天顶亦即得其距地平之髙
　　既得白道九十度限距地平之髙再求得月在白道上距九十度限之度分【法以月距交前交后度减象余即得】可求其交角【白道交天顶经度之角也】
　　此交角可借黄道交角表用之　但须补作黄道北五度表既得交角则髙下差可知而东西南北差悉定矣



















　　康熙四十三年五月十七日乙卯朢月食分秒时刻并起复方位
　　京师月食十分三秒
　　初亏子正二刻三分　东北
　　食既丑初三刻八分
　　食甚丑正一刻二分
　　生光丑正二刻一分
　　复圆寅正初刻一分　正北稍偏西
　　右计食限内凡十三刻十三分
　　按食限内共十三刻十三分折半得六刻十四分故以此减食甚时刻得初亏【自初亏子正二刻三分至食甚丑正一刻二分正得六刻十四分】加食甚亦得复圆【自食甚丑正一刻二分至复圆寅正初刻一分亦得六刻十四分】是亏至甚甚至复时刻适均也时刻所以适均者月行天之度均也然则作图之法自当以食甚月体置于亏复两限适中之处而不宜偏侧矣今监颁蚀图乃偏置于东若是则亏至甚月行之度分多甚至复月行之度少度既不均则时刻亦宜増减若时刻既无増减则图之偏者必非正法矣
　　又按食既至食甚食甚至生光时刻亦宜适均与亏至甚甚至复之理无二【厯书本法亏复折半之数谓之食甚距分以减食甚得初亏若以加食甚得复圆其食既至生光折半数谓之食既距分以减食甚得食既以加食甚亦得生光并无长短伸缩】今图中所注食既至食甚时刻多【食既是丑初三刻八分至食甚丑正一刻二分计一刻○九分】食甚至生光时刻少【食甚丑正一刻至生光丑正二刻一分只十四分】相差十分何也岂以食甚图偏而自疑其法耶不然何以若是
　　又按交食表食甚距分是一时四十四分【即监推六刻十四分】食既距分是四十二分【实计二刻十二分】月食只十分○三秒食既生光不得有五刻九分之乆【倍食既距分得八十四分实五刻○九分】盖觉其非是而弃表不用也然表之数宜改而其法不宜改【表自既至生光五刻九分监推只二刻○八分是改数也厯书以距分加减食甚得既与生光而监推相差三分刻之二是改法也】今改其数幷改其法不知何所见而云然也
　　或疑月行有迟疾自生光至食甚行迟故厯时刻多食甚至生光行疾故厯时刻少此亦説之可通者也然月之迟疾必以渐成决无于二刻八分中顿有十分之差【月平行二刻八分只行天三分度之一而弱】且食既生光既有迟疾之差初亏复圆何以独无可谓进退失据矣
　　又按食甚云者以月于此时侵入闇虚独湥也则其距前后之时刻必为折中均平之处也故月食未既者必于食甚时定其食分以此时所蚀之分最大也【假如月食九分则惟食甚时能满九分前后皆少食八分以下尽然】是以谓之食甚若图有偏侧不得谓之食甚矣
　　食未既时有食分以攷之【食分最多时始为食甚】食既矣则食甚无可指惟頼食既生光时刻折半取中而今乃相差若此又何所据而为食甚耶
　　又详检之初亏至食既【计五刻五分】食既至食甚【计一刻九分】食甚至生光【计十四分不满一刻】生光至复圆【计六刻】无一相同而迟疾皆不伦初限较末限既先疾而后迟【初亏至食既五刻五分是初限行疾也生光至复圆整六刻是末限行迟也】二限较三限又先迟而后疾【食既至食甚一刻九分是次限行迟也食甚至生光只十四分而不满刻是三限又行疾也】是初亏行疾限至食既而忽迟食既行迟限至食甚而顿疾食甚行疾限至生光以后而又迟不识月转迟疾有如此行度否乎


　　厯算全书卷二十五
　　钦定四库全书
　　厯算全书卷二十六
　　宣城梅文鼎撰
　　交食求卷一
　　厯书有交食求七政引二目刻本逸去兹以诸家所用细草补之并稍为订定以便初学
　　日食
　　一求诸平行
　　首朔根　　　检二百恒年表本年下首朔等五种年
　　根并纪日録之
　　朔防　　　　用十三月表以所求某月五种朔策之
　　数録于各年根下
　　平朔　　　　以首朔日时与朔实及纪日并之【满二十四
　　时进一日满六十日去之】
　　太阳平引　　以太阳引根与朔策并之
　　太隂平引　　以太隂引根与朔防并之
　　交周平行　　以交周度根与朔策并之
　　随视其宫度
　　○宫二十度四十分内
　　五宫○九度二十分外
　　六宫十一度二十分内
　　【十一】宫十八度四十分外
　　以上俱有食再于实交周详之
　　太阳经平行　以太阳经度根与朔防并之
　　二求日月相距
　　日定均　　　以太阳平引宫度检一卷加减表如平
　　引满三十分进一度查之【记加减号】
　　月定均　　　以太阴平引宫度检一卷加减表如平
　　引满三十分进一度查之【记加减号】
　　距弧　　　　以日月定均同号相减异号相加即距弧
　　距时　　　　以距弧度分于四行时表月距日横行内检取相当或近小数以减距弧得时【视相当近小数本行上顶格所书时数録之即是】其余数再如法取之得时之分秒【依上法用相当近小数取之】并所得数即为距时
　　随定其加减号
　　两均相减者日大则减　日小则加
　　两均相加者日大则加　日小则减
　　两均一加一减者　　　加减从日
　　三求实引
　　日引弧　　　以距时时及分入四行时表取太阳平
　　行两数【两数谓时及分下同】并之【依距时加减号】
　　日实引　　　置太阳平引以日引弧加减之即得月引弧　　　检四行时表取距时【时分】下太阴平引两
　　数并之【依距时加减号】
　　月实引　　　置太阴平引以月引弧加减之即得四复求日月相距
　　日实均　　　以日实引宫度检一卷加减表如实引
　　满三十分进一度查之【记加减号】
　　月实均　　　以月实引宫度检一卷加减表如实引
　　满三十分进一度查之【记加减号】
　　实距弧　　　以日月实均同减异加即得
　　实距时　　　以实距弧度分检四行时表与前距时
　　同【加减号亦同前】
　　五求实朔
　　实朔　　　　置平朔以实距时加减之即得如加满二十四时者进一日不及减者借二十四时减之则退一日为实朔也
　　六求实交周
　　交周距弧　　检四行时表以实距时【时分】取交周平行
　　两数并之即得【依实距时加减号】
　　交周次平行　置交周平行以交周距弧加减之即得实交周　　　置月实均【记加减号】以加减交周次平行即
　　得实交周
　　随视其宫度以辨食限
　　凡阴厯○宫十七度四十分以内
　　五宫十二度二十分以外
　　凡阳厯六宫○八度二十分以内
　　【十一】宫廿一度四十分以外
　　实交周入此限者并有日食
　　七求躔离实度
　　日距弧　　　以实距时【时分】检四行时表取太阳平行
　　两数并之即得【依实距时加减号】
　　日次平行　　置太阳经度平行以日距弧加减之即
　　得
　　日实度　　　置日实均【记加减号】以加减日次平行即日
　　实度
　　八求视朔
　　加减时　　　以日实度检一卷加减时表【如日实度满三十分
　　进一度取足】记加减号
　　视朔　　　置实朔以加减时加减之即得
　　九求径距较数
　　月距地　　　以月实引查二卷视半径表月距地数
　　即得【度取相近者用之】
　　月半径　　　查月距地下层有太阴之数即月半径月半径　　　以日实引加减六宫检视半径表取太阳之数即得【日实引在六宫以下加六宫如四宫则用十宫实引在六宫以上减六宫如十宫则用四宫】
　　并径　　　　以日月二半径并之即是
　　月实行　　　以月实引宫度【满三十分进一度查】检二卷太隂
　　实行表【度取相近者用之】
　　十求近时
　　总时　　　　检四卷九十度表【九十度表一名黄平象限表其表随地不同如在京师立算取四十度在江南取三十二度冬依极出地取本表用之】以日实度取表第一行宫度得相对第二行防时防分另以视朔时分与十二时相加减得数以加入之即为总时总时过二十四时去之用其余
　　加减十二时法
　　视朔在十二时以上　减去十二时【止用余数】视朔在十二时以下　加上十二时用之
　　日距限　　　以总时【时分】入黄平象限本表第二行取其相对第三行九十度限下之宫度分用中比例得数与日实度相减即得日距限度分并东西号
　　定东西法
　　日实度大内减限度　日在限东
　　日实度小去减限度　日在限西
　　限距地髙　　以总时【时分】相对本表第五行限距天顶数置象限九十度减之余数即限距地髙
　　日赤道纬　　以日实度在三宫以下者加九宫在三宫以上者减去三宫用检五卷太阳距赤纬表即得【记书南北号】
　　日距地髙　　以【日赤纬视朔时】检六卷髙弧表【髙弧随地不同各依北极髙度取用】先以纬度或南或北之数检右直行次以视朔检上横行其视朔满十二时去之用其余刻入表【假如十二时三十三分止以三十三分作二刻入表】不满十二时则置十二时减之用其余入表【加减余一时即作四刻】
　　月髙下差　　以九求月距地数及日距地髙度【满三十分进一度】检八卷太阳太阴视差表先以月距地数检右直行次以日距地髙检上横行得数内减去本数上之太阳视差分秒即月髙下差
　　两圏交角　　用本求日距限限距地髙【满三十分进一度】检七卷交角表【以限距地查左右直行以日距限检上横行用中比例取之】得数以减象限即得
　　定交角　　　置交角加减白道角五度为定交角【实交周是○宫十一宫日距限在限西则减在限东则加若实交周是五宫六宫日距限在限西则加在限东则减】
　　时差　　　　用定交角月髙下差检八卷时气差表【以定交角检左右直行以月髙下差检上横行】即得时差【顺度用上时差号逆度用下时差号】
　　近时距分　　月实行化秒为一率六十分为二率时差化秒为三率二三相乗一率除之即得【零及半者收作一数】
　　近时　　　　置视朔以近时距分加减之即得【日在限西则加限东则减如定交角大于象限则反其加减　若适足象限则无时差即以视朔为食甚真时不用后法】
　　十一求真时
　　近总时　　　置总时以近时距分加减之即近总时
　　【日在限西则加限东则减】
　　日距限　　　以近总时如前法取之记东西号限距地髙　　以近总时如前法取之
　　日距地髙　　以日赤道纬及近时如前法检髙弧表月髙下差　　以九求月距地及【本求】日距地如前法检
　　视差表
　　两圏交角　　以日距限限距地髙如前法检交角表
　　【如前加减为定交角】
　　近时差　　　以定交角度及月髙下差如前法检时
　　气差表
　　视行　　　　以近时差与先得时差相减为较若先得时差小以较减之若先得时差大以较加之即为视行又防法倍先得时差内减去近时差得视行亦同
　　真时距分　　以十求内先得时差化秒与近时距分相乗为实以视行化秒为法除之即得
　　真时　　　　置视朔以真时距分加减之即真时【亦以
　　限西加限东减】
　　十二求考定真时
　　真总时　　　复置总时以真时距分加减之【日在限西则加
　　限东则减】即真总时
　　日距限　限距地髙【并以真总时查】　　日距地髙【以真时】月髙下差　　两圏交角【定交角】以上并如前法
　　【真时差气差】　　　以本求【定交角月髙下差】如前法取【时差表内得时差即
　　得气差】
　　以真时距分与月实行化秒相乗为实一小时化秒为法除之得数为真距度【秒六十收为分】
　　食甚定时　　以所得真距度与本求真时差相较若相等者即用真时为食定时【如此即不用后条距较考定法】
　　距较度分　　若【真距度真时差】相较有余分即为距较度分
　　【差数秒不论】
　　距时损益分　以真时距分与距较度分化秒相乗为实十求内先得时差化秒为法除之得数为距时损益分　若真时差大于真距度则为益分　真时差小于真距度则为损分【须记损益分】
　　【考定】真时距分　置真时距分以所得损益分如号损益
　　之即是
　　【考定】食甚时　　复置视朔时以考定真时距分加减之
　　【东减西加并如原号】为考定食甚时
　　十三求食分
　　距时交周　　以实朔与真时相减得较数如前法取
　　四行时表交周度即得【限东为减号限西为加号】
　　定交周　　　置实交周以距时交周加减之即得月实黄纬　　以定交周检太阴距度表【依中比例求之式如左】假如定交周○宫十度十四分求共黄纬


　　一率　全度六十分　二率　三百○七秒三率　小余十四分　四率　　七十一秒以所得四率【七十一秒收为一分一十一秒】如十度黄纬共得黄纬五十二分五十七秒　其纬在北
　　中比例加减法【表上数前少后多者加前多后少者减】
　　辨月纬南北　并视定交用是【○宫　五宫六宫十一宫】其纬在【北南】月视黄纬　　置月实黄纬以气差加减之即得视纬凡月实纬在南以气差加月实纬在北以气差减若实纬在北而气差大于实纬当以实纬转减气差为视纬其纬变北为南
　　并径减距　　置前并径内减去一分再以月视纬减之即并径减距如月视黄纬大于并径不及减则不得食矣
　　食分　　　　倍日半径为一率　十分为二率　并径减距为三率求得四率为食甚分秒
　　十四求初亏时刻
　　日食月行【复圆同用】以日实引检八卷日食月行表【分三表查】五六七宫在最髙限取【二三四八九十】宫在中距限取○一十一宫在髙冲限取【如日实引满十五度进一宫查之】法以月实引宫检直行【如月实引满十五度亦进一宫查之】又以月视黄纬分检上横行取纵横相遇之数即所求日食月行度分
　　前总时　　　以十二求真总时内减一时即前总时日距限【记东西号若真时在限西而初亏限东则为异号】　限距地【并以前总时如法求之】日距地髙　　置真时内减一时如前法以日赤纬检
　　髙弧表
　　月髙下差　　以【九求】月距地及【本求】日距地髙如前法检
　　视差表
　　两圏交角【定交角】以【本求】日距限及限距地检交角表【如前法求之】前时差　　　以【本求】定交角及月髙下差如前法检时
　　气差表
　　差分　　　　以【前真】时差相减并即差分【法恒用减惟定交角过九
　　十度则相并　其东西异号者恒相并惟定交角过九十度则相减】
　　视行　　　　置月实行以差分加减之即得视行
　　日在限【西东】前时差大则【加减】　小则【减加】
　　若差分用并者则恒减【又若食甚真时定交角满象限无真时差可较即用前时差减或初亏定交角满象限无前时差即用真时差减并减实行为视行】
　　初亏距时分　以本求视行化秒为一率一小时六十分为二率置日食月行分内减一分化秒为三率二三相乗为实一率为法除之得数即初亏距时【以满六十分为一时】
　　初亏时刻　　置真时【即食甚】内减去初亏距时分即初
　　亏时刻
　　十五求复圆时刻
　　后总时　　　用十二求真总时加一时即后总时日距限　　　以后总时如前法求之【记东西号若真时在限东复员
　　在限西为异号】
　　限距地髙　　以后总时取之并如前法
　　日距地髙　　用真时加一时以日赤纬检髙弧表【如前法】月髙下差　　以月距地【九求】及本求日距地髙检视差
　　表【如前法】
　　两圏交角【定交角】以本求日距限限距地髙检交角表【如前法】后时差　　　以【本求】定交角及月髙下差检时气差表
　　差分　　　　以后时差与真时差相减并得差分【法同
　　初亏】
　　视行　　　　置月实行以差分加减之即得视行
　　日在限【西东】　后时差大则【减加】小则【加减】
　　【若差分用并者恒减　又若食甚眞时定交角满象限无眞时差可较卽用后时差或复员定交角满象限无后时差亦卽用眞时差法恒用减与初亏同】
　　复圆距时分　置日食月行分【即初亏所用】内减一分化秒为三率一小时六十分为二率本求视行化秒为一率二三相乗为实一率为法除之得复圆距时【分满六十为时】
　　复圆时刻　　置真时恒以复圆距时加之即得十六求宿度
　　黄道宿度　　置日实宫命黄道宫名即食甚时黄道宫度【○宫起星纪】以各宿黄道宿钤近小者去减黄道宫度即得食甚时黄道宿度【记冩宿名】法以所求年距厯元戊辰之算乗嵗差五十一秒加入宿钤然后减之如加嵗差后宿钤转大于食甚黄道不及减退一宿再如法减之【如角宿不及减用轸宿是也】
　　赤道宫度　　以黄道宫度入一卷升度表对度取之【黄道满三十分进一度查】即得所变食甚时赤道宫度【记写宫名】
　　或检仪象志八卷取用亦同
　　赤道宿度　　以所入宿黄道宫度并其宿南北纬度入仪象志八卷内如法求其宿赤道宫度置所得食甚时赤道宫度以本宿赤道宫度减之余为食甚时赤道宿度又法以弧三角求之其法别具【见补遗】
　　定日食方位　食八分以上者初亏正西复圆正东不及八分者防月实黄纬号在南者初亏西南食甚正南复圆东南黄纬号在北者初亏西北食甚正北复圆东北
　　○宫至五宫为阴厯其号在北
　　六宫至十一宫为阳厯其号在南
　　又法不论东西南北惟以人所见日体上下左右为凭详交防管见
　　补遗
　　带食法
　　求日有带食
　　若食在朝者初亏时刻在日出前食在暮者复圆时刻在日入后是有带食也
　　求带食距分
　　若带食在朝者以日出时刻在暮者以日入时刻并与食甚时刻相减余即为食距分
　　辨食分进退
　　凡日出入时刻在食甚前其所带食分为进也【食在朝为不见初亏尚可见食甚复圆日在暮为但见初亏不得见食甚复圆】
　　若日出入时刻在食甚后其所带食分为退也【食在朝为不见初亏食甚但见复圆食在暮为可见初亏食甚不见复圆】
　　若日出入时刻与食甚同则不用更求带食分即以原算食分为日出入时刻所带食分其食十分者为带食既出入【食在朝为不见初亏食在暮为不见复圆】
　　求带食出入之分
　　带【己退方进】之分者以【复圆初亏】距分化秒为法并以带食距分化秒日食月行化秒相乗为实实如法而一得数自乗又以月视黄纬化秒自乗并而开方得数收为分【以六十秒为分】得日出入时距纬以减并径余数以十分乘之为实太阳全径为法除之得日出入时带食之分
　　算赤道宿度用弧三角法
　　一求赤道纬度
　　两极距二十三度三十一分半为一邉本宿距星去黄极度为一邉二邉相加为总相减为较总弧较弧各取余以总弧不过象限两余相减过象限相加并折半得初数　又以黄道经度为对角取其矢【黄道春分后三宫以正夏至后三宫以余并与半径相减为正矢秋分后三宫以正冬至后三宫以余并与半径相加为大矢】以乘初数为实半径为法除之得矢较以加较弧矢得赤道纬度矢矢与半径相加减得本宿赤道纬度正【加矢较后得数小于半径则转减半径为正其纬在北若加后得数大于半径则于内减去半径为正其纬在南】
　　一求赤道经度
　　以所得赤道纬度是北纬与象限相减南纬与象限相加为去北极度用与两极距度相加为总相减为较总较各取余以总弧不过象限两余相减过象限相加并折半为初数　又以宿去黄极度取矢与较弧矢相减得较以乗半径为实初数为法除之得角之矢与半径相加减得本宿赤道经度之【角之矢小于半径为正矢其经度在南六宫若矢度大于半径为大矢其经度在北六宫】
　　春分至秋分半周为北六宫所得为大矢当于得数内减半径为赤道经度之
　　春分后三宫为赤道正　夏至后三宫为赤道余
　　秋分至春分半周为南六宫所得为正矢当置半径以得数减之为赤道经度之
　　春分后三宫为赤道正　夏至后三宫为赤道余
　　作日食总图法【依旧法稍爲酌定】
　　先定东西南北之向
　　作正十字线其横者黄道也以左为东以右为西其立者黄道经圏也以上为北以下为南次以十字交处为心太阳半径为界规作图形以象太阳光体太阳居十字正中则东西南北各正其位矣
　　次定食限
　　十字心为心太阳太阴两半径相并为度【用太阳半径原度以后量视纬亦同】规作大圆于太阳之外是为食限太阴心到此圏界始得与太阳相切过此则不食也
　　次求月道
　　实交周在○宫十一宫为月道由阳厯入阴厯也法于圆周上下各自南北线左旋数五度识之【圆周并分三百六十度】若实交周是五宫六宫为月道由阴厯入阳厯也则于圆周上下各自南北线右旋数五度识之并以所识聫为直线必过圆心是为月邉上经线也于此线上从圆心量至月视黄纬为度【视纬在北自圆心向上量之视纬在南自圎心向下量之】即食甚时月心所到防也于此防作横线与月道经线相交如十字则自亏至复月行之道也此线两端引长与大圏相割东西各有一防即为初亏复圆时月心所到之防也【西为初亏东为复圆】
　　次考食分
　　初亏食甚复圆三防各为心以太隂半径为度作圆形以象月体即见初亏时太隂来掩太阳其邉相切复圆时太隂已离太阳其光初满食甚时太阴心与太阳心相距最近食分最深若以太阳全径分为十分则所掩分数惟此时与所算相符故谓之食甚也
　　又初亏时或在日体正西或在西南西北复圆时或在日体正东或在东南东北食甚时或在日体正南或在正北或食十分则正相掩无南北并以太阳心为中论其南北东西一一皆如所算　又或有时太隂全径小于太阳全径十秒以上两心虽正相掩不能全食当依月径于太阳光界之内规作太隂即见四面露光之象为金环食也
　　辨日实度大小法
　　凡论日食在限东西并以日实度大于黄平限度则食在限东若小于黄平限度则食在限西其法有三其一日实度与限度同在一宫之内即以度分之多少为大小
　　假如限度在寳瓶宫十度日实度在寳瓶宫十五度是日实度大则内减限度得食在限东五度也　若日实度在寳瓶宫七度是日实度小则置限度以日实度减减之得食在限西三度也
　　其二日实度与限度不同宫则以一宫通作三十度然后相较
　　假如限度在寳瓶宫十度日实度在双鱼宫十五度法以寳瓶宫十度作四十度【寳瓶是一宫一宫者三十度也既原带有三十度加入今限度十度共得限度四十度为自○宫初度算起也】以双鱼宫十五度作七十五度【双鱼是二宫原带有六七度加入今日实度十五度共得日实度七十五度亦自○宫初度算起也】相减得日实度大于限度三十五度为食在限东之距也若限度在寳瓶十度而日实度在磨羯十五度法以实瓶十度作四十度【解见上】与磨羯十五度相减【磨羯是○宫故只用本度亦是从○宫初度起算】得日实度小于限度二十五度为食在限西之距也
　　其三日实度与限度不同宫而其宫相隔太逺如一在磨羯寳瓶双鱼一在天秤天蝎人马则以加十二宫之法通之然后相较
　　假如限度在天蝎十五度日实度在寳瓶十度相隔太逺【天蝎是十宫寳瓶是一宫相隔九宫是太逺也】法当于寳瓶加十二宫得十三宫十度内减天羯十宫余三宫十度作一百度内又减天蝎宫原有十五度余八十五度为日实度大于限度之距而食在限东
　　又如限度在双鱼宫五度日实度在人马宫二十五度【双鱼是二宫人马是十一宫相隔九宫】法当于双鱼加十二宫得十四宫○五度内减人马十一宫余三宫○五度作九十五度内又减人马宫原有二十五度余七十度为日实度小于限度之距而食在限西
　　凡限度为地平上黄道半周之最髙度日实度或在其东或在其西皆距限度在一象限内若过象限即在地平以下不得见食矣故无隔三宫以上之事然反有隔九宫以上者右旋一周之度毕于人马【十一宫】而复起磨羯【○宫】故以加十二宫之法通之而隔九宫以上者距度反近亦只在三宫以下为象限内而已









<子部,天文算法类,推步之属,历算全书,卷二十六>
<子部,天文算法类,推步之属,历算全书,卷二十六>
<子部,天文算法类,推步之属,历算全书,卷二十六>
<子部,天文算法类,推步之属,历算全书,卷二十六>
<子部,天文算法类,推步之属,历算全书,卷二十六>















　　厯算全书卷二十六
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　歴算全书卷二十七
　　宣城梅文鼎撰
　　交食防求卷二
　　日食附说
　　第一求
　　恒年表以首朔为根何也曰首朔者年前冬至后第一朔也因算交防必于朔望故以此为根也根有五种曰干支也太阳太隂各平引也太隂交周太阳经度各平行也太阳太隂各二而干支者所以纪之也西厯于七政皆起子正而此处首朔日食有小余者交防无一定之时故也纪日者年前冬至次日之干支也首朔日时者年前十二月朔距冬至之日时也以此相加得首朔之干支及其小余矣于是再以逐月之朔实加之得各月平朔干支及其小余矣
　　太阳平引与其经度不同何也曰太阳引数从最髙冲起算而经度从冬至起算也冬至定于○宫初度最髙冲在冬至后六七度且每年有行分此西厯与古法异者也
　　第二求
　　日定均者即古法之盈缩差也月定均者迟疾差也距弧者平朔与实朔进退之度也距时者平朔实朔进退之日时也因两定均生距弧因距弧生距时即古法之加减差也
　　第三求第四求五求
　　平朔既有进退矣则此进退之时刻内亦必有平行之数故各以加减平行而为实引也实引既不同平引则其均数亦异故又有实均以生实距弧及实距时也夫然后以之加减平朔而为实朔也
　　平朔古云经朔实朔古云定朔然古法定朔即定于第二求之加减差其三求四求之法古亦有之谓之定盈缩定迟疾则惟于算交食用之而西厯用于定朔此其微异者也
　　第六求【原为第九】
　　朔有进退则交周亦有进退故有实交周按古法亦有定交周其法相同然必先求次平行者以实朔原有两次加减也只用月实均者其事在月也其序原居第九今移此者以辨食限也
　　第七求【原为第六】
　　经度有次平行者以实朔有两次加减故经行亦有两次加减乃得日实度也只用日实均者其事在日也
　　第八求
　　问平朔者古经朔也实朔者古定朔也何以又有视朔曰此测騐之理因加减时得之古法所无也
　　何以谓之加减时曰所以求实朔时太阳加时之位也盖厯家之时刻有二其一为时刻之数其一为时刻之位凡布算者称太阳右移一度稍弱为一日又或动天左旋行三百六十一度稍弱为一日此则天行之健依赤道而平转其数有常于是自子正厯丑寅复至子正因其运行之一周而均截之为时为刻以纪节以求中积所谓时刻之数也凡测者称太阳行至某方位为某时为某刻此则太虚之体依赤道以平分其位一定于是亦自子正歴丑寅复至子正因其定位之一周而均分之为时为刻以测加时以凌犯所谓时刻之位也之二者并宗赤道宜其同矣然推二分之日黄赤同防【经纬并同】二至之日黄赤同经【纬异经同】则数与位合【所算时刻之数太阳即居本位与所测加时之位一一相符】不用加减时其过此以徃则二分后有加分加分者太阳所到之位在实时西二至后有减分减分者太阳所到之位在实时东也然则所算实朔尚非实时乎曰实时也实时何以复有此加减曰正惟实时故有此加减若无此加减非实时矣盖此加减时分不因里差而异【九州万国加减悉同非同南北东西差之随地而变】亦不因地平上髙弧而改【髙弧虽有髙下加减时并同非若地半径及蒙气防差之以近地平多近天顶少】而独与实时相应【但问所得实时入某节气或在分至以后或在分至以前其距分至若同即其加减时亦同是与实时相应也】故求加减时者本之实时而欲辨实时之真者亦即徴诸加减时矣
　　其以二分后加二至后减何也曰升度之理也凡二分以后黄道斜而赤道直故赤道升度少升度少则时刻加矣二至以后黄道以腰围大度行赤道杀狭之度故赤道升度多升度多则时刻减矣
　　假如所算实朔巳定于某日午正时而以在二分后若干日当有加分则太阳加时之位必在午正稍西从而测之果在午正之西与加分数合即知实朔之在午正者真也
　　又如所算实朔是未正而在二至后当有减分太阳加时之位必在未正稍东从而测之果在未正之东与减分数合即知实朔之在未正者确也
　　加减时即视时也一曰用时其实朔时一曰平时加减时之用有二其一加减实时为视时则施之测騐可以得其正位如交食表之加减是其正用也其一反用加减以变视时为实时则施诸推步可以得其正算如月离表之加减是其反用也然其理无二故其数亦同也【月离表改用时为平时即是据所测视时求其实时以便入算】
　　古今测騐而得者并以太阳所到之位为时故曰加时言太阳加临其地也然则皆视时而已视时实时之分自厯书始发之然有至理厯家所不可废也
　　第九求【原为十求】
　　月距地者何即月天之半径也月天半径而谓之距地者地处天中故也地恒处天中则半径宜有恒距而时时不同者生于小轮也月行小轮在其髙度则距地逺矣在其卑度则距地近矣每度之髙卑各异故其距地亦时时不同也
　　日半径月半径者言其体之视径也论其真体日必大于月论其视径日月略相防所以能然者日去人逺月去人近也然细测之则其两视径亦时时不防此其故亦以小轮也日月在小轮髙处则以逺目而损其视径在其卑处则以近日而増其视径矣
　　检表法不同者视半径表并起最髙而加减表太阳引数起最卑太隂引数起最髙故月实引只用本数而日实引加减六宫也
　　并径者日月两半径之縂数也两半径时时不同故其并径亦时时不同而时分之深浅因之亏复之距分因之矣
　　月实行者一小时之实行也其法以月距日之平行每日分为二十四限即一小时平行也各以其应有之加减分加减之即一小时之实行也虽亏复距甚未必皆为一小时而以此为法所差不逺【此与授时用迟疾行度内减八百二十分者同法】
　　第十求【原为十一】
　　縂时者何也以求合朔时午正黄道度分也何以不言度而言时以便与视朔相加也然则何不以视朔变为度曰日实度者黄道度也时分者赤道度也若以视朔时变赤道度亦必以日实度变赤道度然后可以相加今以日实度变为时即如预变赤道矣此巧算之法也其必欲求午正黄道何也曰以求黄平象限也【即表中九十度限】何以为黄平象限曰以大圏相交必互相均剖为两平分故黄赤二道之交地平也必皆有半周百八十度在地平之上【黄道赤道地平并为浑圆上大圏故其相交必皆中剖】其势如虹若中剖虹腰则为半周最髙之处而两旁各九十度故谓之九十度限也此九十度限黄赤道并有之然在赤道则其度常居正午以其两端交地平常在卯正酉正也黄道则不然其九十度限或在午正之东或在午正之西时时不防【惟二至度在午正则九十度限亦在午正与赤道同法此外则无在午正者而且时时不同矣】其两端交地平亦必不常在卯正酉正【亦惟二至度在午正为九十度限则其交地平之处即二分防而黄道与赤道同居卯酉此外则惟赤道常居卯酉而黄道之交于地平必一端在赤道之外而居卯酉南一端在赤道之内而居卯酉北】而时时不等故也【黄道东交地平在卯正南其西交必酉正北而九十度限偏于午规之西若东交地平在卯正北其西交地平必酉正南而九十度限偏于午正之东则半周如虹者时时转动势使然也】盖黄道在地平上半周之度自此中分则两皆象限若从天顶作线过此以至地平必成三角而其势平过如十字故又曰黄平象限也【地平圏为黄道所分亦成两半周若从天顶作弧线过黄平象限而引长之成地平经度半周必分地平之两半周为四象限而此经线必北过黄极与黄经合而为一】
　　问黄平象限在午正必二至日有之乎曰否每日有之也凡太阳东升西没成一昼夜则周天三百六十度皆过午正而西故每日必有夏至冬至度在午正时此时此刻即黄平象限与子午规合而为一每日只有二次也自此二次之外二至必不在午正而黄平象限亦必不在二至矣观浑仪当自知之
　　黄平象限表以极出地分何也曰凖前论地平上黄道半周中折之为黄平象限其两端距地平不防而自非二至在午正则黄道之交地平必一端近北一端近南【亦前论所明】极出地渐以髙则近北之黄道渐以出近南之黄道渐以没而黄平象限亦渐以移此所以随地立表也
　　求黄平象限何以必用縂时曰黄平象限时时不同即午规之地亦时时不同是午正黄道与黄平象限同移也则其度必相应是故得午正即得黄平【黄平限为某度其午正必为某度谓之相应然则午正为某度即黄平限必某度矣故得此可以知彼】而縂时者午正之度也此必用縂时之理也
　　日距限分东西何也曰所以定时差之加减也【凡用时差日在限西则加日在限柬则减】
　　日距地髙何也曰所以求黄道之交角也【时差气差并生于交角又生于限距地及限距日】二者交食之关键而非黄平象限无以知之矣
　　日距地髙何也谓合朔时太阳之地平纬度也亦曰髙弧髙弧之度随节气而殊故论赤纬之南北赤纬之南北同矣又因里差而异故论极出地极出地同矣又以加时而变故又论距午刻分极出地者南北里差距午刻分者东西里差也合是数者而日距地平之高可见矣
　　日赤纬加减宫数者何也纬表○宫起春分而日实度○宫起冬至故三宫以下加九宫三宫以上减去三宫以宫数变从纬表也
　　视朔时加减十二时者何也求太阳距午刻分也日在地平上之弧度惟正午为髙其余则渐以下或在午前或在午后皆以距午为防其距午同者髙弧之度亦同也视朔满十二小时是朔在午后也故内减十二时用其余为自午正顺数若不满十二时是朔在午前则置十二时以视朔减之而用其余为自午正逆推即各得其距午之刻分矣
　　其必求髙弧者何也所以求月髙下差也髙下差在月而求日距地髙者日食时经纬必同度故日在地平之髙即月髙也
　　何以为月髙下差曰合朔时太隂之视髙必下于真髙其故何也月天在日天之内其间尚有空际故地心与地面各殊地所见谓之视髙以较地心所见之真髙徃徃变髙为下以人在地靣傍视而见其空际也故谓之月髙下差【地心见食谓之真食地靣见食谓之视食真食有时反不见食见视食时反非地心之真食纵使地心地靣同得见食而食分深浅亦必不同凡此皆月髙下差所为也】
　　月髙下差时时不同其縁有二其一为月小轮髙卑即第九求之月距地数也在小轮卑处月去人近则距日逺而空际多髙下差因之而大矣在小轮髙处月去人逺则距日近而空际少髙下差因之而小矣其一为髙弧即本求之日距地髙也髙弧近地平从旁视而所见空际多则髙下差大矣髙弧近天顶即同正视而所见空际少则髙下差小矣【若髙弧竟在天顶即与地心所见无殊无髙下差】小轮髙卑天下所同髙弧损益随地各异故当兼论也两圏交角何也曰日所行为黄道圏以黄极为宗者也人在地平上所见太阳之髙下为地平经圏以天顶为宗者也此两圏者各宗其极则其相遇也必成交角矣因此交角遂生三差日食必求三差故先论交角也何以谓之三差曰髙下差也东西差也南北差也是谓三差
　　三差之内其一为地平纬差即髙下差前条所论近地平而差多者也其一为黄道经差即东西差其一为黄道纬差即南北差此三差者惟日食在九十度限则黄道经圏与地平经圏【即髙弧】相合为一而无经差故但有一差【无经差则但有纬差是无东西差而有南北差也而两经纬既合为一则地平之髙下差又即为黄道之南北差而成一差】若日食不在九十度而或在其东或在其西则两经圏不能相合为一遂有三差【月髙下差恒为地平髙弧之纬差而黄道经圏自与黄道为十字正角不与地平经合以生经度之差角是为东西差又黄道上纬度自与黄道为平行不与地平纬度合以生纬度之差角是为南北差东西南北并主黄道为言与地平之髙下差相得而成句股形则东西差如句南北差如股而髙下差常为之合之则成三差也】因此三差有此方见日食彼方不见或此见食分深彼见食分浅之殊故交食重之而其源皆出于交角
　　得数减象限何也以表所列为余角也表何以列余角曰三差既为句股形则有两圏之交角即有其余角而交角所对者为气差【即南北差】余角所对者为时差【即东西差】作表者盖欲先求时差故列余角然与两圏交角之名不相应故减象限而用其余以归交角本数也
　　定交角何也所以求三差之真数也何以为三差真数曰日食三差皆人所见太隂之视差而其根生于交角则黄道之交角也殊不知太隂自行白道与黄道斜交其交于地平经圏也必与黄道之交不同角则所得之差容有未真今以隂阳厯交黄道之角加减之为定交角以比两圏交角之用为亲切耳【详补遗】时差古云东西差其法日食在东则差而东为减差减差者时刻差早也日食在西则差而西为加差加差者时刻差迟也其故何也太阳之天在外太隂之天在内并东陞而西降而人在地靣所见之月度既低于真度则其视差之变髙为下者必顺于黄道之势故合朔在东陞之九十度必未食而先见【限东一象限东下西髙故月之真度尚在太阳之西未能追及于日而以视差之变髙为下亦遂能顺黄道之势变西为东见其掩日矣】若合朔在西降之九十度必先食而后见【限西一象限黄道西下东髙故月之真度虽已侵及太阳之体宜得相掩而以视差之故变髙为下遂顺黄道之势变东而西但见其在太阳之西尚逺而不能掩日矣】而东西之界并自黄道九十度限而分此黄平象限之实用也问日月以午前东升午后西降何不以午正为限而用黄平象限乎曰此西法之合理处也何以言之日月之东升西降自午正而分者赤道之位终古常然者也日月之视差东减西加自九十度限而分者黄道之势顷刻不同者也若但从午正而分则加减或至于相反授时古法之交食有时而踈此其一端也问加减何以相反曰黄平限既与午正不同度则在限为西者或反为午正之东在限为东者或反为午正之西日食遇之则加减相违矣假如北极出地四十度设午正黄道【即縂时】为寳瓶十七度其黄平限为防鱼十一度在午正东二十四度而日食午初日实度躔二宫二度在限西九度宜有加差若但依午正而分则食在午前反当有减差是误加为减算必先天矣又设午正为天蝎二度其黄平象限为天秤八度在午正西二十四度而日食午正后二刻日实度躔九宫二十四度距限东十六度宜有减差若但依午正而分则食在午后反有加差是又误减为加算必后天矣
　　时差表有倒用之说何也曰此亦因交角表误列余角也今既以交角表之数减九十度为用则交角已归原度而此表不湏倒用矣
　　近时距分者何也即视朔时或加或减之时刻分也所以有此加减者时差所为也然何以不径用时差曰时差者度分也以此度分求月之所行则为时分矣【查厯指所谓时差即近时距分而东西差即时差表皆易之今姑从表以便查数也】
　　近时何也所推视朔时与真朔相近之时也食在限东此近时必在视朔时以前故减食在限西近时必在视朔时以后故加
　　十一求【原为十二】
　　近縂时何也近时之午正黄道度也朔有进退午正之黄道亦因之进退故仍以近时距分加减十求之视朔午正度为本求之近时午正度
　　既有近时又有近时之午正度则近时下之日距限及距限地髙日距地髙以及月髙下差两圏交角凡在近时应有之数一一可推因以得近时之时差矣【内除月距地数在九求日赤纬在十求并用原数其余并改用近时之数故皆复求然求法并同十求】既得时差可求视行
　　视行者何也即近时距分内人目所见月行之度也何以有此视行曰时差所为也盖视朔既有时差则此时差所到之度即视朔时人所见月行所到差于实行之较也视朔既改为近时则近时亦有时差而又即为人所见近时月行所到差于实行之较矣此二者必有不同则此不同之较即近时距分内人所见月行差于月实行之较矣故以此较分加减时差为视行也本宜用前后两小时之时差较加减月实行为视行【如用距分减视朔者则取视朔前一小时之时差若距分加视朔者则取视朔后一小时之时差各取视朔时差相减得较以加减月实行即为一小时之视行】再用三率比例得真时距分法为月视行与一小时若时差度与真时距分也今以近时内之视行取之其所得真时距分防
　　何以明其然也曰先得时差即近时距分之实行也实行之比例防则视行之比例亦防
　　一　一小时实行　一小时视行　法为一小时之实行与二　一小时　　　一小时　　　一小时若时差度与近三　时差【近时距分之实行】视行【即近时距分之视行】时距分则一小时之视四　近时距分　　近时距分　　行与一小时亦若视行
　　度与近时距分也
　　一　一小时视行　视行　　　　今一小时视行与一小二　一小时　　近时距分　　　时既若时差与真时距
　　三　时差　　　时差　　　　　分则视行与近时距分四　真时距分　真时距分　　　亦必若时差与真时距
　　分矣
　　问视行之较一也而或以加或以减其理云何曰凡距分之时刻变大则所行之度分变少故减实行为视行若距分之时刻变小则所行之度分变多故加实行为视行假如视朔在黄平限之东时差为减差而近时必更在其东其时差亦为减差乃近时之时差所减大于视朔所减是为先小后大其距分必大于近时距分而视行小于实行其较为减又如视朔在黄平限之西时差为加差而近时必更在其西时差亦为加差乃近时之时差所加大于视朔所加是亦为先小后大其距分亦大于近时距分而视行亦小于实行故其较亦减二者东西一理也若视朔在黄平限东其时差为减而近时时差之所减反小于视朔所减又若视朔在黄平限西其时差为加而近时时差之所加反小于视朔所加此二者并先大后小则其距分之时刻变小矣时刻变小则视行大于实行而其较应加东西一理也
　　如图戊爲黄平象限甲爲视朔甲乙爲视朔时差甲丙甲丁并近时时差其甲乙时差爲视朔时顺黄道而差低之度变爲时卽爲近时距分此分在限东爲减差若在限西







　　卽爲加差其理一也若以甲丙爲近时差则大于甲乙其较度乙丙依实行比例求其较时则距分变而大矣距分变大者行分变小法当于甲乙差度内减去乙丙较度【卽乙庚】其余如甲庚则是先定甲乙距分行行甲乙度者爲实行而今定甲乙距分只行甲庚度者爲视行也故在东在西皆减也
　　又若以甲丁爲近时差则小于甲乙其较乙丁依实行比例求其较时则距分变而小矣距分变小者行分变大法当于甲乙差度外加入乙丁较度【亦卽乙庚】成甲庚则是先定甲乙距分行甲乙度者为实行而今定甲乙距分能行甲庚度者为视行也故在东在西皆加也防法用倍时差减近时差何也曰即加减也何以知之曰凡时差先小后大者宜减今于倍小中减一大是于先得时差内加一小时差减一大时差也即如以较数减先时差矣先大后小者宜加今于倍大内减一小是于先得时差内加一大时差减一小时差也即如以较数加先时差矣数既相合而取用不烦法之善者也真时距分者何也即视朔时或加或减之真时刻也其数有时而大于近时距分亦有时而小于近时距分皆视行所生也视行小于实行则真时距分大于近时距分矣视行大于实行则真时距分小于近时距分矣其比例为视行度于近时距分若时差度与真时距分也真时何也所推视朔之真时刻也真时在限东则必早于视朔之时真时在限西则必迟于视朔之时此其于视朔并以东减西加与近时同惟是真时之加减有时而大于近时有时而小于近时则惟以真时距分为防不论东西皆一法也
　　若真时距分大于近时距分而在限东则真时更先于近时在限西则真时更后于近时是东减西加皆比近时为大也若真时距分小于近时距分而在限东则真时后于近时在限西则真时先于近时是东减西加皆比近时为小也
　　十二求【原为十三】
　　真縂时何也真时之午正黄道也故仍以真时距分加减视朔之縂时为縂时【即是改视朔午正度为真时午正度】
　　近时既改为真时即食甚时也然容有未真故复考之考之则必于真时复求其时差而所以求之之具并无异于近时所异者皆真时数耳【谓日距限限距地髙日距地髙月髙下差两圏交角防项并从真时立算】是之谓真时差
　　既得真时差乃别求真距度以相考则食甚定矣【考定真时全在此处】何以为真距度曰即真时距分内应有之月实行也盖真时差是从真时逆推至视朔之度真时距分内实行是从视朔顺推至真时之度此二者必相等故以此考之考之而防则真时无误故即命为食甚定时也
　　其或有不防之较分则以法变为时分而损益之于是乎不防者亦归于相防是以有距较度分考定之法也距较度分者距度之较也损益分者距时之较也其比例亦如先得时差度与真时距分故可以三率求也真时差大者其距时亦大故以益真时距分益之则减者益其减原在限东而真时早者今乃益早若加者亦益其加原在限西而真时迟者今则益迟矣　真时差小者其距时亦小故以损真时距分损之则减者损其减原在限东而真时早者今改而稍迟若加者亦损其加原在限西而真时迟者今改而稍早矣
　　如是考定真时距分以加减视朔为真时即知无误可谓之考定食甚时也
　　气差古云南北差凖前论月在日内人在地靣得见其间空际故月纬降髙为下夫降髙为下则亦降北为南矣此所以有南北差也【南北差生于地势中国所居在赤道之北北髙南下故也】然又与髙下差异者自天顶言之曰髙下自黄道言之曰南北惟在正午则两者合而为一髙下差即为南北差其余则否
　　气差与时差同根故有时差即有气差而前此诸求但用时差者以食甚之时未定重在求时也今则既有真时矣当求食分故遂取气差也【时差气差并至真时始确】
　　十三求【原为十四】
　　距时交周何也即实朔距真时之交周行分也故以实朔与真时相减之较查表数然何以不用视朔曰原算实交周是实朔故也
　　定交周者何也真时之月距交度也食甚既定于真时则一切视差皆以食甚起算故必以实朔交周改为食甚之交周斯之谓定交周也月食黄纬者食甚时月行隂阳厯实距黄道南北之纬度也月视黄纬者食甚时人所见月距黄道南北纬度则气差之所生也月行白道日行黄道帷正交中交二防月穿黄道而过正在黄道上而无距纬其距交前后并有距纬而每度不同然有一定之距是为实纬实纬因南北差之故变为视纬即无一定之距随地随时而异但其变也皆变北为南假如月行隂厯实纬在黄道北则与黄道实逺者视之若近焉故以气差减也若月行阳厯实纬在黄道南则与黄道实近者视之若逺焉故以气差加也至若气差反大于实纬则月虽隂厯其实在黄道北而视之若在南故其气差内减去在北之实纬而用其余数为在南之视纬也
　　并径减距者何也并径所以定食分减距所以定不食之分也距者何也卽视纬也并径则日月两半径之合数也假令月行阴厯其北纬与南北差同则无视纬可减而并径全爲食分其食必旣其余则皆有距纬之减而距大者所减多其食必浅距小者所减少其食必深是故并径减余之大小卽食分之所由深浅也若距纬大于并径则日月不相及或距纬等于并径则日月之体相摩而过不能相掩必无食分矣
　　并径内又先减一分何也曰太阳之光极大故人所见之食分必小于眞食之分故预减一分也
　　然则食一分者卽不入算乎曰非也并径之分度下分也【毎六十分爲一度】食分之分太阳全径之分也【以太阳全径十平分之假令太阳全径三十分则以三分爲一分】是故并径所减之一分于食分只二十余秒
　　问日月两半径旣时时不同则食分何以定曰半径虽无定而比例则有定但以并径减余与太阳全径相比则分数覩矣【分太阳全径爲十分卽用爲法以分并径减距之余分定其所食爲十分中几分】有时太阴径小于太阳则虽两心正相掩而四面露光厯家谓之金环是其并径亦小于太阳全径虽无距纬可减而不得有十分之食故也【细草原用表今改用三率其理较明法亦简易】
　　十四求
　　日食月行分者何也乃自亏至甚之月行度分也【自甚至复同用】其法以并径减一分常为视纬常爲句句求股卽得自食甚距亏与复之月行度分矣
　　【按此卽授时厯开方求定用分之法所异者并径时时增减与旧法日月视径常定不变者殊耳】
　　前总时何也卽食甚前一小时之午正度也得此午正度卽可得诸数以求前一小时之时差谓之前时差前时差与眞时差之差分卽视行与实行之差分故以差分加减实行得视行也假如日在限西而前时差大于眞时差是初亏所加多而食甚所加反少也以此求亏至甚之时刻则变而小矣时刻小则行分大故以差分加实行爲视行若日在限西而前时差小于眞时差是初亏所加少而食甚所加渐多也以此求亏至甚之时刻则变而大矣时刻大则行分必小故以差分减实行爲视行若日在限东而前时差大于眞时差是初亏所减多而食甚所减渐少也以此求亏至甚之时刻则变而大矣时刻大者行分小故以差分减实行爲视行若日在限东而前时差小于眞时差是初亏所减少而食甚所减反多也以此求亏至甚之时刻则变而小矣时刻小者行分大故以差分加实行爲视行食甚定交角满象限不用差分何也无差分也何以无差分曰差分者时差之较也食甚在限度卽无食甚时差无可相较故初亏径用前时差复圆径用后时差又食甚在限度则初亏距限东而前时差恒减复圆距限西而后时差恒加减时差则初亏差而早加时差则复圆差而迟其距食甚之时刻并变而大也时刻大者行分小故皆减实行为视行【又若初亏复圆时定交角满象限亦无差分而径用食甚之时差减实行爲视行与此同法其初亏复圆距食甚之刻分亦皆变大而行分变小也视行之理此爲较着】初亏距时分者初亏距食甚之时刻也用上法得视行爲食甚前一小时之数而初亏原在食甚前则其比例爲视行之于一小时犹日食月行之于初亏距时故可以三率取之也【日食月行减一义见前条】
　　既得此初亏距分则以减食甚而得初亏时刻也
　　十五求
　　后縂时者即食甚后一小时之午正度分也用此午正度得诸数以求后一小时之时差为后时差又以后时差与真时差相较得差分以加减实行为视行并同初亏但加减之法并与初亏相反
　　假如日在限西而后时差大于真时差是食甚所加少而复圆所加多则甚至复之时刻亦变而大矣时刻大者行分小故以差分减实行为视行
　　若日在限西而后时差小于真时差是食甚所加多而复圆所加反少则甚至复之时刻亦变而小矣时刻小者行分大故以差分加实行为视行
　　假如日在限东而后时差大于真时差是食甚所减少而复圆所减反多则甚至复之时刻变而小矣时刻小者行分大故以差分加实行为视行
　　若日在限东而后时差小于真时差是食甚所减多而复圆所减少则甚至复之时刻变而大矣时刻大者行分小故以差分减实行为视行【食甚在限度求视行之理已详十四求】复圆距时分三率之理并与初亏同惟复圆原在食甚后故加食甚时刻为复圆时刻
　　十六求
　　黄道宫度内减宿钤何也黄道宫度起冬至各宿黄道起距星也凡距星所入宫度必小于日实度宫度故以相减之较为食甚时所入本宿度分也其每年加五十一秒者恒星东行之度即古嵗差法也因嵗差所加故有宿钤在日实度以下而变为日实度以上则食甚时所入非其宿矣故退一宿用之也其以嵗差【五十一秒】乘距算【本年距歴元戊辰】之数各宿并同虽退一宿所加不异也赤道宫度可以升度取者黄道上升度一定也若赤道宿度则不可以升度取何也各宿距星多不能正当黄道而在其南北各有纬度故必以弧三角求之为正法也
　　此后原有十七求以算东西异号今省不用何也曰东西异号之算厯书语焉不详故细草补作之亦有思致但所求者仍为黄平象限之东西故必复求定交角今于十四求十五求即得定交角为白道限度之东西简易直防可不必更多葛藤矣故省之也


　　附说补遗
　　求縂时条加减十二时
　　问求縂时与求日距地髙二条并以视朔与十二时相加减然后用之而用法不同何也曰求縂时条是欲得午正黄道距春分之升度故并从午正后顺推【如视朔过十二时则内减十二时而用其余数是从午正后数其距视朔之时刻也若视朔不及十二时则以十二时加之是从先日午正后数其距今视朔之时刻也故其法皆为顺数】日距地髙条是欲得视朔距午正之度故各从午正前后顺推逆数【如视朔为十二时去之而用其余数是从视朔时逆推其己过午正之刻也若视朔不满十二时则置十二时以视朔时减之而用其余数是从视朔顺数其未及午正之刻也　其视朔满十二时减去之两法并同惟视朔不满十二时用法则异】
　　附又法
　　问视朔在午前若用减十二时法亦可以得縂时乎曰可其法亦如求日距地髙置十二时以视朔时减之求到视朔未至午之刻去减日实度距春分时刻【即九十度表第二行对日实度之时刻】亦即得縂时与上法同此法可免加满二十四时去之然遇日实度距春分时刻不及减又当加二十四时然后可减矣假如日实度是春分后相距只一时而视朔在午正前三时是爲日实度小不及减法当以日实度加二十四时作二十五时减去三时余二十二时爲总时
　　定交角或问
　　问定交角满象限以上反其加减何也曰此变例也西厯西加东减并以黄道九十度限爲宗今用定交角则是以白道九十度限爲宗而加减因之变矣
　　问白道亦有九十度限乎歴书何以未言曰歴书虽未言然以大圏相交割之理征之则宜有之矣何则月行白道亦分十二宫【视月纬表可见】则亦爲大圏其交于地平也亦半周在地平上则其折半之处必爲白道最高之处而亦可名之爲九十度限矣【或可名白道限度】
　　若从天顶作高弧过此度以至地平则成十字正角而其圏必上过白道之极成白道经圏与黄平象限同【黄平象限上十字经圏串天顶与黄道极故亦成黄道经圏与此同理】月在此度卽无东西差而南北差最大与高下差等【前论月在黄平象限无东西差而卽以高下差爲南北差其理正是如此但月行白道当以白道爲主而论其东西南北始爲亲切】若月在此度以东则差而早宜有减差在此度以西则差而迟宜有加差但其加减有时而与黄平象限同有时而与黄平限异故有反其加减之用也
　　问如是则白道亦有极矣极在何所曰白道有经有纬【凡东西差皆白道经度南北差皆白道纬度】则亦有南北二极为其经纬之所宗但其极与黄极恒相距五度以为定纬【虽亦有小小増减而大致不变】其经度则嵗嵗迁动至满二百四十九交而徧于黄道之十二宫则又复其始【约其数十九年有竒】法当以黄极为心左右各以五纬度为半径作一小圆以为载白道极之圏再以正交中交所在宫度折半取中即于此度作十字经圏必串白道极与黄道极矣则此圏之割小圆防即白道极也问何以知此圏能过黄白两极也曰此圏于黄道白道并作十字正角故也【凡大圏上作十字圏必过其极】问此圏能串两极则限度常在此度乎曰不然也此度能串黄白两极而未必其串天顶如黄道上极至交圏也若限度则必串天顶以过白极而未必其过黄极如黄道上之黄平限也是故白道上度处处可为限度亦如黄道上度处处可为黄平限但今在地平上之白道半周某度最髙即其两邉距地平各一象限从此度作十字经圏必过天顶而串白道之两极何也此圏过地平处亦皆十字角即与地平经圏合而为一所谓月髙下差即在此圏之上矣【惟白道半交为限度能与黄平限同度此外则否况近交乎故必用定交角也】
　　以定交角推白道限度
　　白道限度大约在黄道交角之八十五度【定交角三此满象限过此则有异号】
　　若太隂定交周是○宫十一宫而黄平限在午正之东乃白道限度则更在其东而原以限东宜减者今或以定交角大而变为限西宜加矣
　　若定交周是五宫六宫而黄平限在午正西白道限度必更在其西而原以限西宜加者今或以定交角大而变为限东宜减矣
　　以上二宗并离午正益逺交食遇此则古法益踈而新法犹近
　　若定交周是○宫十一宫而黄平限在午正西乃白道限度或尚在其东而原以限东宜减者今以定交角大而变为限西宜加矣
　　若定交周是五宫六宫而黄平限在午正东乃白道限度或尚在其西而原以限西宜加者今以定交角大而变为限东宜减矣
　　以上二宗并离黄平限而近午正交食遇此则有时古法反亲而新法反踈若白道限度径在午正则古法宻合矣
　　由是之加减东西差宜论白道明甚厯书略不言及岂非缺陷之一大端
　　问定交角者所以变黄道交角为白道交角也然何以不先求白道限度曰交角者生于限度者也交角变则限度移矣故先得限度可以知交角【交角之向指以距限东西而异交角之大小以距限逺近而殊】而既得交角亦可以知限度故不必复求限度也
　　其加减以五度何也曰取整数也古厯测黄白大距为六度【以西度通之得五度五十四分竒】西厯所测只五度竒而至于朔望又只四度五十八分半今论交角故祗用整数也【若用弧三角法求白道限度所在及其距地之髙并可得交角细数然所差不多盖算交食必在朔望又必在交前交后故也】
　　问五度加减后何以有异号不异号之殊曰近交时白道与黄道低昻异势者也【惟月在半交能与黄道平行亦如二至黄道之与赤道平行也若交前交后斜穿黄道而过不能与黄道平行亦如二分黄道之斜过赤道也故低昻异势】然又有顺逆之分而加减殊焉其白道斜行之势与黄道相顺者则恒减减惟一法【减者角损而小也虽改其度不变其向】若白道与黄道相逆者则恒加加者多变遂有异号之用矣【加者角増而大也増之极或满象限或象限以上遂至改向】
　　是故限西黄道皆西下而东髙限东黄道皆西髙而东下此黄道低昻之势因黄平象限而异者也而白道正交【○宫十一宫也即古法之中交】自黄道南而出于其北亦为西下而东髙【黄道半周在地平上者偏于天顶之南以南为下北为上正交白道自南而北如先在黄道之下而出于其上故比之黄道为西下而东髙也】白道中交【五宫六宫也即古法之正交】自黄道北而出于其南亦为西髙而东下【白道自北而南如先在黄道之上而出于其下故比之黄道为西髙而东下也】
　　假如日食正交而在限西日食中交而在限东是为相顺相顺者率于交角减五度为定交角是角变而小矣角愈小者东西差愈大故低昻之势増甚而其向不易也【限西黄道本西下东髙而正交白道又比黄道为西下东髙则向西之角度变小而差西度増大其时刻迟者益迟矣限东黄道本西髙东下而中交白道又比黄道为西髙东下则向东之角度变小而差东之度増大其时刻早者益早矣是东西之向不易而且増其势也】
　　假如日食正交而在限东日食中交而在限西是为相逆相逆者率于交角加五度为定交角是角变而大矣角愈大者东西差愈小故低昻之势渐平而甚或至于异向也【限东黄道本西髙东下而正交白道比黄道为西下东髙则向东之角渐大而差东度改小时刻差早者亦渐平若加满象限则无时差乃至满象限以上则向东者改而向西时刻宜早者反差迟矣限西黄道本西下东髙而中交白道为西髙东下则向西之角渐大而差西度改小时刻差迟者亦渐平若加满象限则无时差乃至满象限以上则向西者改而向东而时刻宜迟者反差而早矣】
　　凡东西差为见食甚早晚之根如上所论定交角所生之差与黄道交角无一同者则欲定真时刻非定交角不可也若但论黄道交角时刻不真矣
　　凡东西差与南北差互相为消长而南北差即食分多少之根如上所论则欲定食分非定交角不能也但论黄道交角食分亦悮矣
　　差分有用并之理
　　问差分本以两时差相较而得【十四求已有备论】今乃有用并之法何也曰异号故也此其白道限度必在两食限之间【或限度在甚与复两限之间则食甚在限东而复圆限而或限度在亏与甚之间则食甚在限西而初亏限东】两食限一距限东一距限西其两时差必一为减号一为加号是为东西异号无可相较故惟有相并之用也
　　乃若定交角大于象限则先为同号而变为异号其食甚必在黄平限及白道限度之间【食甚在黄平限西白道限度东则先推食甚复圆同号者变为异号矣食甚在黄平限东白道限度西则先推食甚初亏同号者变为异号矣】两食限既变为东西异号则其两时差亦一加一减变为相并矣
　　问异号恒相并固也乃复有定交角过九十度而仍用相较为差分者何也曰此异号变为同号也其黄平限必在两食限之间而白道限度或反在食限之外则能变异号为同号【假令黄平限在复与甚之间甚距限东复距限西本异号也而复圆之定交角过象限则白道限度必又在复圆之西而先推黄平限复圆在西者今推白道限度复圆在限东即复圆食甚变为同号矣又加黄平限在亏与甚之间亏距限东甚距限西本异号也而初亏之定交角过象限则白道限度必又在初亏之东而先推黄平限初亏在东者今推白道限度初亏在限西即初亏食甚变为同号矣】又如前论食甚在黄平限及白道限度之间能变同号为异号即亦能变异号为同号【凖前论食甚在黄平限西白道限度东能变食甚与复圆异号则先推食甚与初亏异号者今反同号矣若食甚在黄平限东白道限度西能变食甚与初亏异号则先推食甚与复圆异号者今反同号矣】凡此之类变态非一皆于定交角取之故可以不用十七求也
　　相并为差分者并减实行为视行之理
　　问用差分取视行有减实行加实行之异而相并为差分者一例用减何也曰凡相较为差分者有前小后大前大后小之殊故其于实行有减有加【觧见前条】减者常法加者变例也【凡减实行为视行者在限东者益差而东在限西者益差而西食限中如此者多故为常法若加实行为视行者限东者反损其差东之度在西者反损其差西之度乃偶一有之故为变例】若相减为差分者不论前后之大小縂成一差故于实行有减无加只用常法也【十四求附说论食甚初亏复圆三限定交角满象限并用时差减实行与此同理盖彼以无可相较故径用一时差此则虽有两时差不以相较而且以相益故其时刻并变大而行分变小故皆减实行为视行也】
















　　己为天顶　庚为黄道极　丑寅癸为地平　子为黄平象限度　子辛丙癸为地平上黄道之一象限　甲乙丁壬为黄道北纬　己乙丙寅为地平经圏　乙为天上太隂实纬【在黄道北】　丙为人所见太隂视度【正当黄道】乙丙为髙下差【是地平上髙弧差】　乙丁为东西差【是黄道经度差】丙丁为南北差【是黄道纬度差】　盖髙卑差以天顶为宗下至地平为直角南北差以黄极为宗下至黄道为直角东西差以中限为宗下至黄极为直角而其根皆生于地靣与地心不同视之故也























　　设太隂实髙在乙视髙在庚髙弧上乙庚之距为髙下差
　　从黄极出经线至太隂实度【乙】又从黄极出经线至视度庚必过【丁】黄道上乙丁之距为东西差
　　实度乙正当黄道视度庚在黄道南其距丁庚纬度与乙丙防是为南北差










　　设太隂实髙在庚视髙在乙髙弧上庚乙之距为髙下差
　　从黄极出经线二一过实髙庚指黄道度丁一过丙至视度乙黄道丁乙之距为东西差【与丙庚防】
　　实度庚在黄道北其纬度庚丁与丙乙防视度乙正当黄道无纬度丙乙为南北差【与丁庚防】










　　设太隂实髙在辛视髙在庚髙弧上辛庚之距为髙下差
　　从黄极出经线二一过太隂实髙度辛至黄道乙乙为实度一过北纬甲及黄道丁至太隂视髙度庚丁为视度黄道上乙丁之距为东西差【与甲辛丙庚防】
　　月实纬辛在黄道北其距辛乙与甲丁防视纬庚在黄道南其距丁庚与乙丙防甲庚为南北差【与辛丙防】厯算全书卷二十七
　　钦定四库全书
　　厯算全书卷二十八
　　宣城梅文鼎撰
　　交食防求卷三【订补】
　　月食
　　一求诸平行
　　首朔根　　　查二百恒年表本年下首朔等五种年
　　根并纪日录之
　　朔策望策　　用十三月表以所求某月五种朔策并
　　望策之数録于各年根之下
　　平望　　　　以首朔日时与朔策望策并纪日并之
　　【满二十四时进一日满六十日去之】
　　太阳平引　　以太阳引根与朔策望策并之【满十二宫去之
　　后并同】
　　太隂平引　　以太隂引根与朔策望策并之
　　交周平行　　以交周度根与朔策望策并之
　　随视其宫度以辨食限
　　○宫○六宫十五度以内
　　五宫十一宫十五度以外
　　以上宫度俱有食
　　太阳经平行　以太阳经度根与朔望二策并之二求日月相距
　　日定均　　　以太阳平引宫度查一卷加减表如平
　　引满三十分进一度查之【记加减号】
　　月定均　　　以太隂平引宫度查一卷加减表如平
　　引满二十分进一卷查之【记加减号】
　　距弧　　　　以日月定均同号相减异号相并即得
　　距时　　　　以距弧度分于四行时表月距日横行内查得相当或近小数以减距弧得时【视相当近小数本行上顶格所书时数录之即是】其余数再如法查取得时之分秒【依上法用相当近小数取之】并所查数即为距时
　　随定其加减号
　　两均同加者日大则加　日小则减
　　两均同减者日大则减　日小则加
　　两均一加一减者　　　加减从日
　　三求实引
　　日引弧　　　以距时时及分查四行时表太阳平行
　　两数并之【依距时加减号】
　　日实引　　　置太阳平引以日引弧加减之即得月引弧　　　查四行时表取距时时分下太隂平行
　　两数并之【依距时加减号】
　　月实引　　　置太隂平引以月引弧加减之即得四复求日月相距
　　日实均　　　以日实引宫度查一卷加减表如实引
　　满三十分进一度查之【记加减号】
　　月实均　　　以月实引宫度查一卷加减表如实引
　　满三十分进一度查之【记加减号】
　　实距弧　　　以日月实均同减异加即得
　　实距时　　　以实距弧度分查四行时表与前距时
　　同【加减号亦同前】
　　五求实望
　　实望　　　　置平望以实距时加减之即得如加满二十四时则进一日不及减借二十四时减之【则实望退一日】
　　六求实交周
　　交周距弧　　查四行时表实距时时分下交周平行
　　两数并之即得【依实距时加减号】
　　交周次平行　置交周平行以交周距弧加减之即得【凡加者满三十度进一宫满十二宫去之为○宫减者遇所减度数反小则加三十度退一宫减之○宫度不及减则加十二宫然后减之】
　　实交周　　　置月实均【记加减号】以加减交周次平行即
　　得
　　七求月距黄纬
　　月距黄纬　　以实交周查太隂距度表依中比例法
　　求之
　　假如实交周十一宫十九度十四分先以十九度查得五十六分五十三秒又以十九度与二十度之数相减得较五分○七秒化作三百○七秒与实交周小余十四分相乘用六十分为法除之得七十一秒収作一分十一秒以减十九度之数得五十五分四十二秒即月距纬【其纬在南】中比例加减法　视表上数前【少多】后【多少】者【加减】
　　又法　视表上宫名在上者以所得
　　中比例数加○宫六宫是也　表上
　　宫名在下者以所得中比例数减五
　　宫十一宫是也
　　辨交食月纬南北法
　　视实交周是【○六】宫【五　十一】宫其纬在【北南】
　　八求径距较数
　　月半径　　　以月实引查二卷视半径表即得影半径　　　月半径下层即景半径
　　景差　　　　以日实引加减六宫查视半径表即得
　　实景　　　　景半径内减去景差即实景
　　并径　　　　以实景加月半径即得
　　并径减距　　置并径以月距纬减之即得如距纬大
　　于并径不及减则不得食矣
　　九求食分
　　食分　　　　以月半径倍之为一率并径减距为二率月食十分为三率二三相乘一率除之即得食分
　　十求躔离实度
　　日距弧　　　以实距时时分查四行时表太阳平行
　　两数并之即得【依实距时加减号】
　　日次平行　　置太阳经平行以日距弧加减之即得日实度　　　置日实均【记加减号】以加减日次平行即得月实度　　　以日实度加减六宫即月实度【记写宫名】十一求视望
　　加减时　　　以日实度查一卷加减时表即得【记加减号】
　　视望　　　　置实望以加减时加减之即得
　　十二求所食时刻
　　月实行　　　以月实引查二卷太隂实行表得之【实行表三度一查假如某宫一度二度俱在○度下查若四度五度俱在三度下查余仿此】
　　初亏距弧　　以距纬加并径与并径减距相乘平方
　　开之即得
　　初亏距【时分】　　置距弧用三率法化时即得
　　食既距弧　　实景内减去月半径余数与距纬相加为和相减为较和较相乘平方开之即得
　　食既距【时分】　　置距弧用三率法化时即得
　　三率法
　　月实行化秒为一率六十分为二率【初亏食既】距弧化秒为三率求得【初亏食既】距【时分】为四率
　　初亏时刻　　置视望以初亏距【时分】减之即初亏时刻复圆时刻　　置视望以初亏距【时分】加之即复圆时刻食限縂时　　复圆时刻内减去初亏时刻即縂时食既时刻　　置视望以食既距【时分】减之即食既时刻生光时刻　　置视望以食既距【时分】加之即生光时刻既限縂时　　生光时刻内减去食既时刻即得十三求宿度
　　黄道宿　　　以黄道距宿钤减月实度即得【记写宿名】其宿钤每年加嵗差行五十一秒如实度小于宿钤不及减改前宿
　　赤道宫度　　以月实度用弧三角求之即得【记写宫名
　　求赤道经纬弧三角法见日食防求下同】
　　赤道宿度　　以所入宿黄道经纬【加过嵗差之宫度为经其纬用恒星表取之】用弧三角法求到本宿赤道经度以减月赤道度得食甚时赤道宿度【如不及减取前一宿如法用之】
　　十四求各限地平经纬
　　各限交周　　置实交周以初亏食既距弧加减之得
　　各限交周【以查月距度表得各限月纬】
　　黄白差角　　定为四度五十九分【此朔望交角也各限有微差可以不论】
　　是○宫【十一】宫上方差角在黄经度西是五宫六宫上方差角在黄经度东用月实度入极圏交角表取其余度即得是【○一二三四五】宫上方差角在赤经度西是【六七八　九十十一】宫上方差角在赤经度东
　　月赤道差　　以所推黄白黄赤两差角东西同号者相并异号者相减即得【记东西号】其异号以小减大并以度之大者为主命其东西
　　以上所推食甚时差角各限同用【各限亦有微差可以勿论】
　　距午度分　　置各限时刻如在子后者即为距午时【此从午正顺数】如食在子前者置二十四时以各限时刻减之余为距午时【此从午正逆推】再以时变为度即得各限太隂距午度分时变度法　每一时变十五度每时下一分变度下十五分时下四分成一度时下一秒变度下十五秒时下四秒成一分秒满六十収为分分满六十収为度
　　各限髙度【即地平纬】以极距天顶为一邉月实度距北极为一邉【以黄赤距度南加北减象限得之】二邉相加为縂相减为存存縂各取余相加减【縂弧不过象限相减縂弧过象限相加若存弧亦过象限则仍相减】并折半为初数【各限同用】乃以各限距午度取其矢【距午度过象限则用大矢】以乘初数去末五位为矢较用加存弧矢得对弧矢矢减半径得余命为髙度正查表得髙度【所得对弧即月距天顶乃髙度之余故其余即髙度正】
　　一率【半径】二率【角之矢】三率【初数】四率【两矢较】
　　各限方向【即地平经】以极距天顶为一邉月距天顶为一邉【髙度之余】二邉相加为縂相减为存存縂各取余相加减【并如髙度法】如法取初数【各限不同】乃以月距北极为对弧取其矢【月在赤道南用大矢】与存弧矢相减为矢较进五位为实初数为法实如法而一得所求矢【即地平经度皆子午规所作天顶角度分之大小矢】矢与半径相减得余查其度命为月距正子午方地平经度【凡正矢去减半径得鋭角余其度子后食者逆推子前食者顺数并距正子方立算大矢内减半径得钝角余其度子后食者顺数子前食者逆数并距正午方立算即得各限月在地平上方位】
　　一率【初数】二率【两矢较】三率【半径】四率【角之矢】
　　地经方位度分钤【鋭角用本度钝角用外角度并以余查表取之】





　　地经赤道差　以月距北极为一邉月距天顶为一邉二邉相加为縂相减为存存縂各以余相加减【如前法】取初数【各限不同】以天顶距北极为对邉取其矢【各限同用】与存弧矢相减得矢较进五位为实初数为法实如法而一得差角矢【从北极作赤道经圏过月心又从天顶作髙弧过月心得此差角】矢减半径得余命度【记东西号】


　　地经白道差　置所推地经赤道差以月赤道差加减之【东西同号者相并异号者相减】即得各限白道经度差于地经髙弧之数【记东西号】若月赤道差大于地经赤道差法当反减其号东西互易并以月赤道差之号命其东西【月食有初亏子前复圆子后者各依本限论之各限时刻在子前用子前法在子后用子后法】　此线所指即月行白道之极【犹赤经线之指北极】
　　订补月食绘图法
　　赤经主线　　縂图先作立线以象赤道经此线上指北极下指南极线左为东线右为西为作图主线
　　闇虚食限　　主线上取一防为心地景半径为度作圆形以象闇虚　又以闇虚心为心并径【景半径月半径相加】为度作大圆于闇虚之外是为食限　又径较为度【景半径月半径相减】作小圆于虚闇之内是为既限
　　黄道交角　　以月实度入极圏交角表取之命为食
　　甚时黄道与赤经所作之角
　　黄道线　　　依黄道交角度分作角于主线左右皆自主线起算数食限上度分作识向闇虚心作直线令两端透出即上下各成相对二角并如黄道交赤道之角而此线象黄道


　　凡上方角度【右顺左逆】下方角度【左顺右逆】并自主线起算数食限大圆周度分作识从此作过心直线至对邉则角度皆防
　　白道经度　　依所推月赤道差角于赤经左右数其度【亦借圆邉数之其左右如先所推】作识向圆心作直线而透出之即食甚时白道经线
　　白道　　　　亏复各取月纬于黄道上下作两平行虚线【阳厯用南纬此二平行线作于黄道下方隂厯用北纬作两平行线于黄道上方】虚线两端必与食限大圆相遇而各成一防依法各取其合用之防聫为一直线即自亏至复所行白道也【交前先逺后近以逺防为初亏近防为复圆交后先近后逺以近防为初亏逺防为复圆初亏防在西复圆防在东隂阳厯并同一法】
　　白道线与经线相遇成十字角十字中心一防即食甚时月心所到也以月半径为度从心作圆形以象食甚时月体即见其为闇虚所掩分数与所推月食分秒相符【法以月体匀分十分即见此时月入闇虚若干分数或全在其中而为食既或深入其中而食既外尚有余分一一皆可见】又此时月心与闇虚心正对其相距之分即食甚时月纬与所推亦合
　　亏复真象　　又以白道割外圆之防各为心月半径为度作小圆二以象初亏复圆时月体即见初亏时月以邉渐入闇虚复圆时月体全出闇虚其先缺后盈之防皆有定在
　　食既生光　　若食既者白道必横过内园【即既限】亦相割成两防即食既生光时月心所到也两防各为心月半径为度作圆形二以象食既生光时月体即见食既时月体全入闇虚而光尽失生光时月体渐出闇虚而光欲吐其欲既未既欲吐未吐之时月体必有一防正切闇虚之邉皆有定处
　　取白道简法　不必求亏复月纬但以月距黄纬于白道经线作识【隂厯在北阳厯在南并距闇虚心立算】为食甚月心所到从此作横线与经线十字相交即成白道【余同上】
　　右縂图以上为北下为南左为东右为西中西厯法所同也若月食子正即赤道经与午规为一而所测如图然各限时刻不同【假如初亏子正复圆必在子后若复圆子正初亏必在子前相距有十二三刻以上化为度有相距三四十度以上】则经线午规相离而南北东西易位食近卯酉变态尤多非精于测算不能明也故有后法
　　新増月食分图法
　　髙弧主线　　作立线以象髙弧【上指天顶下指地平】不论东西南北在何方位并以天顶为宗直指其上下左右是为各限绘图之主线
　　白道线　　　主线上取一防为心规作月体【并以所推月半径度分为半径其周分三百六十度】月邉上方数所推各限地经白道差之度作识【差东者逆数向左差西者顺数向右并从主线上方割圆周处起算】从此作过心直线即白道经线也于月心作横线与白道经线十字相交以象白道
　　十分真像　　白道经线上于月心起算取月距黄纬作识【隂厯作识于月心之下方阳厯作识于月心之上方并如月距黄纬度分以月半径之度凖之】即闇虚心也【月距黄纬即食甚时两心之距】闇虚心为心实景半径为度作圆分于月体即见食甚时月入闇虚被掩失光晦明邉际了了分明
　　受蚀处所　　视月邉所缺若干度分【在月全周三百六十度中亏若干】其与白道经线相割处必正对闇虚【即缺邉度折半取中之防】即旧法所谓月食方位也此防或在月体之上或在月体之下与其左右一一可指其余光若新月或大或小必皆曲抱此防而斜侧仰俯皆可豫定其形【算缺邉度法别具】若食既者不用此条
　　食之深浅　　又以月体全径分为十分【于白道经线上分之】即食甚时亏食深浅或被食若干分数而有余光或全入闇虚月光全失而为食既【即食十分】或深入闇虚而食既之外尚有余分【即食十一二分以上至十六七分不防】并丝毫不爽
　　初亏复圆　　如法作主线及月体白道【并如食甚】乃于白道上自月心取初亏距弧之度作识【初亏于月心之左复圆于月心之右即食甚时月心所到】从此作垂线截如月距黄纬之度【阳厯向上作之隂厯向下作之即食甚时两心之距】垂线末为闇虚心从闇虚心作直线至月心必割月邉此防即初亏复圆时先缺后盈之防【在初亏则此处先缺在复圆则此处后盈】并可以月体之上下左右命之【又防法于初亏距弧作识处以月距黄纬为度依上下之向作弧分虚线于月心以并径为度亦作弧分虚线两虚线交处即闾虚心从闇虚心作虚直线割月邉至月心即于割防作识命为先缺后盈之防可不作垂线直线】
　　【若以实景半径为度从闇虚心向月邉作半圆以象闇虚其邉与月邉相切即先缺后盈之像益复分明】
　　食既生光　　立主线绘月体取白道经线作白道【并如初亏复圆】白道上以食既距弧度作识【食既于月心之左生光于月心之右并自月心起算与亏复同】从此作垂线寻闇虚心【阳厯向上隂厯向下并如月距黄纬之度亦同亏复】作直线自闇虚心过月心至邉即食既生光时后入先出之防【欲既未既时此处有余光后没光欲生时此处有微光先吐】于月体之上下左右皆有定处
　　【防法以月距黄纬于食既距弧作识处依隂阳歴之向作虚弧又以径较为度自月心依左右之向作虚弧两虚弧交处即闇虚心从闇虚心作直虚线过月心至邉即食既时后没生光时先见之防】
　　【若以实景半径从闇虚心作半圆以包月体即见食既时月体全入闇虚生光时月体将出闇虚而各有二邉相切之一防　若闇虚半径稍缩其度则食既时后没余光生光时微光先吐皆了然可见】
　　月食法
　　辨月有食　月食子后者视复圆时刻若在日出后月食子前者视初亏时刻若在日入前是有食也
　　若日出入时刻与食甚相同者不用布算即以所推食分为食分诸限时刻有与日出入同者亦然皆不必推食
　　食距时　　食在朝者以日出时刻在暮者以日入时刻并与食甚时刻相减余即为食距时【法同日食】
　　食距弧　　初亏距时化秒为法初亏距弧化秒与食距时化秒相乘为实实如法而一得数为食距弧【秒满六十収为分】
　　食距心径　以食距弧月距黄纬各自乘两数相并平方开之得数为食距心径【法实俱化秒得数収分】
　　食分秒　　月全径【化秒】为一率月食十分【化秒】为二率置并径内减食距心径余数【化秒】为三率求得四率即月出入时食分秒【秒满六十収分】凡食分必小于食分【食既者食必不满十分若满十分为食既出入其减余必大于月全径】
　　一法置食距心径内减径较【月半径影半径之较】余数化秒为三率如上法求之得未食余光分秒以转减月食十分为食分秒【如食距心径小于径较不及减者为食既出入其食距时必小于食既距时】
　　辨食分进退　凡月出入时刻【即日出入时刻】在食甚前其所食分为进【食在朝者为但见初亏不见食甚复圆在暮者为不见初亏但见食甚及复圆若食既者在朝为见初亏不见食既或见食既而必不见生光复圆在暮为不见初亏但见食既或并不见食既而但见生光复圆】
　　若月出入时刻在食甚后其所食分为退【在朝为见初亏食甚不见复圆在暮为不见亏与甚但见复圆若食既者在朝为但见初亏食既食甚生光不见复圆或并不见生光在暮为不见初亏食既食甚生光但见复圆或并可见生光】
　　食作图法
　　縂图　　　　以食距心径为半径闇虚心为心作圆周取其与白道横线相割防为月出入时月心所到用此为心如法作圆以象出入地平时月体即见其时月体有若干分秒在闇虚内与所算食分相符【圆周割白道必有二防当以食分进退详其左右如法取之】


　　分图　　　　如法先求月出入时地经白道差法曰以黄赤距度【用月实度取之】取余【即存弧余又即縂弧余】命为初数【縂存两余同数故也】以极出地度正减半径命为对弧矢【即极距天顶之矢】以黄赤距度取矢【即存弧矢】二矢度相减得较数进五位为实初数为法法除实得差角矢【矢减半径得余以余查表得度】即月出入时地经赤道差【食在朝者差角在西若在暮者差角在东】
　　防法　　　　以黄赤距度之余内减极出地之正得余数进五位为实仍以黄赤距度之余为法除之得差角矢
　　若月实度正与二分同度即以极距天顶度分命为地经赤道差不湏布算凡各限时刻有与日出入同者并可依此法求其地经赤道差角
　　置地经赤道差以各限同用之月赤道差加减之【东西同号者加异号者减】即月出入时地经白道差【记东西号】次作髙弧主线【如各限法】规作月体于圆邉数地经白道差之度作识【依白道差东西之号并自髙弧上方交月邉处起算差东者逆而向左差西者顺而向右】从此作过心直线以象白道经线又于月心作十字横线以象白道【其法并同各限】
　　白道上以食距弧为度作识【即食甚月心所到也食分进者此防在月体左方退者在月体右方】从此作垂线【阳厯作垂线向上隂厯作垂线向下】截其长如月距黄纬之度【即闇虚心所在】从此向月心作直线至对邉【此即月出入时月与闇虚两心相对之径线】乃分月体为十匀分【即于径线上分之】
　　末以闇虚心为心实景半径为度作圆分于月体内即见月体在闇虚内有防何分与所推食分秒相符其余光若新月者偃仰纵横皆如所见矣


　　康熙五十七年戊戌二月十五甲午日夜子初二刻八分望月食分秒起复时刻方位　【依厯书本法】
　　月食十七分三十一秒
　　初亏　　亥初二刻十三分
　　食既　　亥正三刻
　　食甚　　夜子初二刻八分
　　生光　　十六日子正二刻一分
　　复圆　　丑初二刻三分
　　食限内共计十五刻五分
　　既限内七刻八分
　　食甚月离黄道鹑尾宫二十五度五十三分为翼宿六度食甚月离赤道鹑尾宫二十六度一十四分为翼宿十四度三十八分
　　以上诸数并主京师立算江南省月食分秒宿度并同惟各限时刻加八分









　　右图为黄道上日月躔离右旋之度自西而东乃步算之根也日行迟月行疾闇虚地影居日之冲故闇虚之行即日行也初亏时月在闇虚之西及至复圆遂出其东日月并右旋而有迟速于斯着矣月道之交于黄道也有隂厯焉有阳厯焉有交前交后焉今二月月食交后隂厯也距交逺则黄纬大而受蚀浅距交近则黄纬小而受蚀深今距交未及一度黄纬只四分故入影最深而食分最大自甲至卯共十七分竒厯厯可数也自丙至丁为自亏至复月行之度折半于乙为食甚故亏至甚甚至复时刻俱等与算数相符按图索之了如指掌矣【若乙防稍偏即度有参差与算理不合】





















　　亥初三刻六分月食初起
　　髙四十七度二十四分
　　距正午东五十度零四分　在巽方
　　初见微蚀处在月体下方之左












　　亥正三刻九分月食至尽
　　髙五十五度二十九分
　　距正午东三十度零三分　在巳方
　　欲既未既些少余光在月体右上












　　右图为地平上太隂加临方向东升西没其行左旋乃测騐之用也假如欲初亏法以盘针考定巽方定为月食初亏时地平经度【又法择平地画以圆圏对子午卯酉作十字线分圆周为四自卯至午匀分九十度自午至酉亦如之乃自午向卯数五十度为初亏方位各限俱如是】至亥时初三刻【用星晷香漏或自鸣钟定之】其时太隂巳到巽方在地平上髙四十七度竒【用象限仪等器测之】即见月体下方偏左处渐有微缺是为月食初亏在月体下方之左也　此不论东西南北惟以月体对天顶处为上对地平处为下左右亦然测时湏正身直立向月平观即上下左右丝毫不爽　食既防各限并同






















　　子正二刻九分月光始生
　　髙五十七度五十分
　　过午正西十八度三十一分　在丁方
　　微光初见时在月体左方稍下












　　丑初二刻十一分月光尽复
　　髙五十五度半
　　过午正西二十七度三十九分　在未方
　　光欲满时些少微缺在月体右方畧上




　　因五限縂图限于尺幅月影缩小故复作分图以便测騐内惟食甚月在闇虚地形深处聊可得其地平经纬无上下左右可言故分图只四限












　　厯算全书卷二十八
　　钦定四库全书
　　厯算全书卷二十九
　　宣城梅文鼎撰
　　古算衍略
　　古算器攷
　　或有问于梅子曰古者算学亦有器乎曰有曰何器曰古用筹筹何似曰汉书言之矣用竹径一分长六寸二百七十一而成六觚为一握度长短者不失毫厘量多少者不失圭撮权轻重者不失黍絫又世説言王衍持牙筹防计此用筹之明证也曰若是则筹可用竹亦可用牙矣然则即今之筹笇非欤曰非也今西厯用筹亦起徐李诸公葢从厯家之立成而成即立成表之活者耳故一筹即备九数若古之用筹用以纪数而无字画故一筹只当一数乘除之时以筹纵横列于几案一望了然观古算字作祘葢象形也然则起于何时曰是不可攷然大易揲蓍亦以一蓍当一数则其来逺矣蓍策所以决疑非常用之物故特隆重其制而加长长则不可以横故皆纵列惟分二象两之后挂一防以别之使无凌杂余皆纵列也又其数只四十九故四揲以稽其实数其用専専则诚也布算之法有十百千万之等以乗除而升降又日用必需之物故其制短使几案可列其言六寸成觚者有度量之用古尺既小于今尺才四寸竒葢亦取其便于手握耳【浦江吴氏中馈録有算条巴子切肉长三寸各如算子様亦可以想其长短】然则其用之若何曰五以下皆纵列六以上则横置一筹以当五而纵列其余【式详后】然则十百千万何以列之曰其式皆自左而右略如珠笇之位亦如西域欧逻写算之位皆顺手势不得不同也曰亦有征欤曰有之蔡九峯洪范皇极数所纪算位一至五皆纵列六至九皆横一于上以当五又自一之一至九之九皆并列两位自左而右此用于宋者也又授时厯草所载乘除法实之式皆纵横排列自左而右以万千百十零为序此用于元者也左传史赵言亥有二首六身下二如身为绛县老人日数士文伯知其为二万六千六百六旬而孟康杜预顔师古释之皆以为亥字二画在上其下三六为身如笇之六葢横一当五又竪一于横一之下则为六矣与皇极同也又言下亥二画竪置身傍葢即竪两笇为二万又并三六为六千六百六旬而四位平列与厯草同此又用于三代及汉晋者也曰厯草又有一至五横纪之处何欤曰此亦非起于厯草也何以知之唐人论书法横直多者有俯仰向背之法若直如笇子便不是书其言笇子即所列筹也然兼横直画言之则唐人用筹为算亦有横直可知干凿度云卧算为年立算为日葢位数多者恐其相混故三十三二十二之类笇位皆一纵一横以别之纵即立算横即卧算也干凿度不知作于何人然其在汉魏以前无可疑者则横直相错之法古有之矣五以下既可易纵为横则六以上横一当五者亦可易之而纵又何疑于厯草哉曰然则今用珠盘起于何时曰古书散亡苦无明据然以愚度之亦起明初耳何以知之曰归除歌括最为简妙此珠盘所恃以行也然九章比类所载句长而澁葢即是时所创后人踵事増华乃更简快是书为钱塘吴信民作其年月可攷而知则珠盘之来则自不逺
　　按钦天监厯科所通轨凡乘除皆有定子之法惟珠算则可用然则珠算即起其时又尝见他书元统造大统厯访求得郭伯玉善算以佐成之即郭太史之裔也然则珠盘之法葢即伯玉等所制亦未可定
　　曰南雷畣牧斋流变三疉之问既云长水分别算位本位是竪进一位即是横本位是横进一位即是竪又引凿度卧算立算以证之矣然其所图算位俱作圆防殊无横直之形何耶曰南雷固言今之算器数分于珠是指珠算也又云长水之算只用今器其所谓横竪者分别算位南雷之意葢谓长水姑借横竪之语以分算位而实用珠算非实有横竪也然以【鼎】观之疏既以一横二竪当十二复以一竪二横当百二十终以一横二竪当千二百而皆曰进动算位明是用筹非用珠也故当十进百之时则当取去第一叠零位之二竪而加十位之一横为二横又添一竪于百位则成百二十矣故曰进动算位为第二叠也百进千则又取去十位之二横而増一竪于百位为二竪又别増一横于千位成千二百故亦曰进动算位为第三叠也説本明晰与今珠算何涉乎若如南雷所图则横竪字为赘文矣是故布筹可纵可横此亦一证
　　又按朱子语类云潜虚之数用五只似如今算位一般其直一画则五也下横一画则为六横二画则为七此又一证也【蔡九峯皇极数以横画当五故下竪一画为六竪二画为七与此相反然理则相通厯草则兼用之葢皆本之古法】



　　古布算式




　　皇极数图【见性理大全】


　　厯草算式
　　立差　　　　定平差　　　定平积





　　右式皆因数有雷同故纵横列之以为别亦自然之理也
　　乘除法实式【亦见厯草】















　　亥字二首六身攷
　　左传襄公三十年三月癸未绛县老人曰臣生之嵗正月甲子朔四百有四十五甲子矣其季于今三之一也师旷曰鲁叔仲恵伯防郤成子于承匡之嵗也【注鲁文公十一年乙巳嵗】七十三年矣【注自乙巳嵗至今年戊午首末七十四年而曰七十三者葢计其全数而言未满七十三年也】史赵曰亥有二首六身【注言亥字上二画为首六画为身如算之六者三也春秋时有此字体□】下二如身是其日数也【注如徃也言除下亥上二画徃置身旁也□便是此老人从初生年起至今癸未日之日数也葢以亥之二画为二万之数以三六之算为六千六百六旬之数也】士文伯曰然则二万六千六百有六旬也按古法每年三百六十五日又四分之一七十三年该二万六千六百六十三日又四分之一故注以正月甲子为夏正建寅之月而三月癸未杜氏长厯及孔疏皆以为当作二月为夏之十二月也其癸未日长厯以为是二十三日然则春秋所纪者自用周正而晋人所言者自是夏正故鲁史纪戊午二月者晋人所言则仍为丁巳之十二月所以士文伯云七十三年也















　　筹有色以分正负
　　沈存中括笔谈曰天有黄赤二道月有九道此皆强名非实有也亦由天之有三百六十五度天何尝有度以日行三百六十五日而一朞强谓之度以步日月五星行次而巳日之所由谓之黄道南北极之中间度最均处谓之赤道月行黄道南谓之朱道北谓之黒道东谓之青道西谓之白道黄道内外各四并黄道而九日月之行有迟有速难以一术御故因其合散分为数段每段以一色名之欲以别算位而已如算法用赤筹黒筹以别正负之数厯家不知其意遂以为实有九道甚可嗤也
　　按此又宋算用筹之明证




　　方田通法序
　　学必有原不得其原不可以为学九数之学具列周官而孔子言游艺在志道据徳依仁后唐十经博士期业成以五年可形下视哉客嵗之冬从竹冠先生饮令弟乐翁所得观先生捷田歌括离竒出没杯酒间未深领其趣属他故覊治城且匝月既无携书可破岑寂乃稍忆所疑演而通之因浩然叹数学之有源虽至近若方田而易简中精深尔尔也算具不具仗三寸不聿为之今年春里中有事履亩或见问桐陵法遂出斯编相质命曰方田通法云
　　阏逢执徐日躔在奎勿庵梅文鼎识





　　方田通法
　　太极生生之数
　　数始于天一终于地十十亦一也天地之地始终乎一故曰太一太一者太极也自极而仪而象而卦皆加一倍三加而止万事托始焉是故制器者尚其象玑衡八尺周于八方寻常则之以度百物葢取诸此
　　两地之数
　　一生二二者两地也两一则二两二则四两四则八两八则十有六四象相交成十六事卦有内外也庾以命斗秉以命斛斤两则之以权百物葢取诸此
　　参天之数
　　一生二二生三三者参天也参一而三参二而六参四而十有二参八而二十有四作厯者以纪中节八节二十四气八卦二十四爻也是故玉衡之尺八而玑围二十有四斤之两十有六而铢二十有四二十有四者权度之所生数之纲也从而十之以为地纪而畆法生焉
　　畆法
　　二百四十步　古法步百为畆畆百为夫今二百四十步为畆相起于唐太宗
　　步法
　　五　合参两则五犹合四行为土土之生数也倍五则十土之成数也乗者从生故平方五尺为步而用以乗除者从成故积步二百四十为畆而用以除
　　方田原法
　　以所丈田横步与其纵步相乗得数为实以一畆二百四十步为法除之满法为畆不满退除为分厘　田之为字衡缩相交矩其外格其内象平方也田不能皆方或圆或直或梯或斜或如牛角或为矢弧不皆方故为之法以方之大约不离横纵者近是九章之术首列方田君子絜矩之道欤
　　截归法
　　或八归三归各一次或四归六归各一次或五因一十二归　邵子曰三八二十四也四六亦二十四也倍十二亦二十四也丈量家用截法可以观已
　　减法
　　或折半减二或减六减五各一次　即定身除也
　　飞归法
　　进一除二四　进二除四八　进三除七二　进四除九六　五除一二　一四四作六　一六八作七　一九二作八　二一六作九　见一加三隔位四　见二加六隔位八　不尽者留法喝之
　　又
　　三六作一五　六作二五　八四作三五　一○八作四五　一三二作五五　一五六作六五　一八作七五　二○四作八五　二二八作九五
　　留法
　　一留退四一六六　二留退八三三三　三留一二五四留一六六六六　五留二○八三三　六留二五七留二九一六六　八留三三三三三　九留三七
　　五　其法是除用之似乗以其为除后得数也故谓之留　若用以喝稍者言退者本位不则进一位或稍子位多者喝完总移进之更妙
　　凡加留减者如加减法只记原实于各挨身加减之若原用因法者则又下一位挨加减之皆记原实以留法喝之言退者各又退一位
　　以上截留飞减四法皆于乗土之后用以求畆惟留法则有不尽故长于喝稍
　　后有用两求斤留法附录之　一退六二五　二一二五　三一八七五　四二五　五三一二五　六三七五　七四三七五　八五　九五六二五　十六二五十一六八七五　十二七五　十三八一二五　十
　　四八七五　十五九三七五
　　新増径求畆步法
　　其法不用乘土以所得横纵之歩先得者为实后得者为法径求之可以抵掌而办原法二十有二竹冠道士衍为百二十有三勿庵氏引而伸之且三百八十有四也倚数之妙乃至斯乎而岂有外于参两乎又岂有加于所谓一者乎法列如后
　　减二　即十二除凡法之可以两者皆减二是为畆法之半或折半六归之
　　八除　或二十五于下位加之凡法之可以参者皆八除是为畆法三分之一
　　四十八除　即折半飞归也凡法之可以五者皆四十八除是两其畆法也
　　四除　或二十五乗之凡法之可以六者皆四除是为畆法六分之一
　　六除　凡法之可以四者皆六除是为畆法四分之一三除　凡法之可以八者皆三除是为畆法八分之一下加　凡法之上位得一者皆下加
　　上加　凡法之下位得一者皆上加凡加毕再用留法或飞归之
　　折半　凡法之十二者皆折半为畆法六分之五减六　凡法之可以十五者皆减六即两求斤留法也为畆法三分之二又为六分之四
　　减五　凡法之可以十六者皆减五即十五除也为畆法八分之五
　　加留减留　凡法之可借上者皆加留可借下者则减留所以通其穷也
　　随数喝畆　凡二十四则随数喝之
　　倍法　凡四十八五除之即二因也
　　减八　即畆法八分之六也凡法之可以八分用六者十八除之又为四分之三
　　九除　即畆法八分之三凡法之可以八分用三者九除之
　　二十一除　即畆法八分之七凡法之可以八分用七者二十一除
　　因法代除　如四十八则二因之如七十二则三因九十六则四因又如十二五因一四四六因一六八七因一九二八因二一六九因又如六用二五因八四用三五因一○八用四五因一三二用五五因一五六用六五因一八用七五因二○四用八五因二二八用九五因
　　加法代除　如三加二五即一二五乗所以代八除也三六加五即十五乗也又如四二径加七五五四二次加五皆不用除







<子部,天文算法类,推步之属,历算全书,卷二十九>
<子部,天文算法类,推步之属,历算全书,卷二十九>
<子部,天文算法类,推步之属,历算全书,卷二十九>
<子部,天文算法类,推步之属,历算全书,卷二十九>
<子部,天文算法类,推步之属,历算全书,卷二十九>
　　原法歌诀【出桐陵】
　　量田捷法少人知　不乗一数便留之　二弓折半六而一　三步之中用八归　四步由来六归是　五步还宜六八归　六数四归无走作　八上三归无改移十二将来折一半　十六三而加倍齐　二十四中
　　随数喝　廿五中分六八归　三十二上尤甚准　四因还要用三归　四十八上加一倍　八卦宫中谁得知　三归八因尤甚准　胜如神见不差池　七二倍之加遍五　九十六上四因之　十五之中逢二八七五之中四八归　三七半时当八八　九弓加五四归竒　十八折之加五定　三六之中加五施　此是明师真口诀　千金不度世人知
　　附归除捷法
　　多上空加一【多上者实多于法也空者实首隔一位也凡实多于法则于实前隔一位上一子若法实两数等亦同】
　　依前除莫疑【依前者即以前法数除之也】
　　少前数上五【少前者实少于法也即于实之前位上五子　不隔位】
　　折半数除之【折半除者用法数之半而除之也　用五乗代折半甚捷】
　　无除随上一【无除者上五之后不及除半数也既不及除随于实前位上一子】
　　化下照前除【化下者退下一位也照前除者即依法数降一位而除之也】












　　区田图刋误
　　按区田古法并以方一尺五寸为区通计毎亩可二千七百区空一行种于所种行内隔一区种一区除隔空外可种六百七十五区【此亦约畧之説后又云毎区一斗每亩可收六十六石而诗亦云限将一亩作田规计区六百六十二并大同小异】是四分而种其一也今农书之图黑白相间是二分种一与説相背且如所图既不便于营治亦不便于浇灌反不如姜田之用濶沟通人行之为便矣谨依古説改作之如左
　　又按四分种一亦是约畧之数若细求之则四邉近田堘处可只空半区要以随方就圆使其易行亦不在拘拘于尺寸之间也孟子曰此其大略也若夫润泽之则在君与子吾于区田亦云
　　如甲乙为田内毎画方一尺五寸为区【如甲子】直行毎隔一行种一行【如甲戊丙巳】因得横行亦然【如庚甲辛癸】其播种之区四面合之各成小平方如丙辛方中间子丑为种地卯寅方中间午未方为种地皆居小平方之中央又蝉聫而下通计毎田一畆为种区者约四之一图中白者是空地黒者是种区














　　区田説
　　向读嵇叔夜养生论谓区种之法亩可得粟数十钟已读王氏农书详着其法而农政全书载汜胜之书及务本书谓汤有七年之旱伊尹作为区田教民粪种负水浇田诸山陵倾坂及田邱城上皆可为之王祯田古人每区收谷一斗每亩可收六十六石今人学种可减半计贾思协曰兖州刺史刘仁之昔在洛阳于宅田七十步之地域为区田收粟三十六石然则一亩之收过百石矣古説彰彰如是而或者疑之【徐扈先生以为古今斗斛之异】余以为不必疑也葢徴之于姜芋矣吾乡土瘠每亩收稻麦不过数石而芋则每亩二十余石多者三十余石姜之下者二十余石其上者至四十余石然而种姜一亩有稻田六亩以上之工岂非粪多力勤之効乎攷姜田营治之法其畊甚深在一尺以上通水沟虽止数寸而畦土斜杀而上种姜棱背相距空间与棱背畧相等是亦空一行种一行也即区种之遗法也姜田惟空直行而区田复空横行是其功又倍于姜田也多收之数又何疑焉【又攷遂宁王灼晦叔糖霜谱蔗田亦云区种而其深畊摩劳开渠濶尺深尺五及今年为蔗田明年改种五谷以休地诸法并同姜田】　又按区田毎区方一尺五寸【贾氏説又有方深各六寸及方九寸深六寸诸法】葢欲于城上斜坡立区故为此制若平田亦可变通











　　畸零法解【乗法】
　　假如其处地畆被水所淹今涸出五分之四于中又有髙地居七分之四问若干
　　答曰髙地为三十五之十六
　　法用母乗母子乗子　两母【五七】相乗
　　三十五为母　两子【四四】相乗十六为
　　子　乗得三十五之十六
　　解曰分总地为五分而涸出居其四四又将此涸出之四分分为七分而髙地居其四若以总地分三十五分则髙地居其十六矣
　　本法置实子五之四以法子七之四乗之得十六为实法母七为法除之得五之二又小分七之二为髙地然七除不尽当用通分法以小分母七通原分母五为三十五得数二通为十四加入之二共十六是三十五之十六也
　　今不用七除其子而以七乗其母得数亦同【母既七倍而子不动是七之一也故乗母即同除子】
　　以数明之　设原数三千五百畆内涸出五之四是二千八百畆也以此二千八百畆分为七分而髙地居其四是一千六百畆也则髙地于原数为三十五之十六矣
　　又假如有米一宗内分七之四于预备仓收贮又于预备仓内取五之四先给赈荒问若干
　　答曰三十五之一十六　法见前
　　解曰分总米为七分而预备仓得其四又分预备仓米为五分而先给赈济者得其四若以总米分为三十五分则先给赈济者得其十六
　　本法置实七之四以法子之四乗之得一十六为实法母五为法除之得三又五之一如法用通分以小分五通大分七为三十五又通得数三为十五加子一为十六即三十五之十六也
　　今不用五除子而用五乗母即得三十五之十六省通分矣【母乗得五倍则子为五之一】
　　以数明之　设原米四千二百石分为七分而取其四为预备仓是二千四百石也预备仓米又分五分而取其四以给赈是一千九百二十石也若分原米为三十五分每分一百二十石则给赈米得十六分【四千二百是三十五个一百二十石一千九百二十是十六个一百二十石故也】
　　又法
　　法用倒位互除以代乘法　以法子四除实母七得一七五为母　以法母五
　　除实子四得○八○为子　乗得一七五之八○各进位而倍之即三十五之十十六
　　本法四乗五除今不以四乗其子而反以四除其母即得数同也【母既改为四之一而子不动即子为四倍故除母可代乘子也然除法多有不尽不如母乘母子乘子为便】
　　还原


　　畸零除法
　　假如营兵奉裁五之一留五之四其所支月饷为某仓米七之四问未裁时月饷几何
　　答曰该支仓米七之五
　　法用倒位互乗以当除法　以法子之四乗实母七得二十八为母　以法母五乗实子之四得二十为子　除得二十八之二十　约为七之五
　　解曰兵奉裁留五之四其原额未裁则五之五也故其原支仓米亦必七之五乃四而増一之比例
　　本法置实七之四　以法母五乗之得七之二十为实
　　以法子之四为法除之得七之五
　　今不用四除其子而以四乗其母得数亦同【母既四倍于原母而原子不动如四之一故乗母可代除子】
　　又法
　　法以法母五除实母七得一四为母又以法子之四除实子之四得一○为子　除得一四之一○　约之亦得七之五
　　此不用五乗其子而以五除其母得数亦同【母既五除则为原母五之一而原子不动如五倍矣故除母可当乗子】
　　论曰以上三法所得并同然倒位乗尤妙葢以乗代除则无畸零不尽之数故也
　　以数明之　设营兵三千其五之四则二千四百也仓米二千五百二十石其七之四则一千四百四十石也七之五则一千八百石也兵二千四百而给米一千四百四十石则兵三千当给一千八百石
　　还原
　　用倒位互除　以代乗法　法子四除实母二十八得七为母　法母五除实子二十得四为子　乗得七之四复合原数
　　问仓米七之四可给营兵五之四若仓米全发给兵几何
　　答曰给兵五之七
　　如法倒位　以法子之四乗实母五得二十为母　以法母七乘实子之四得
　　二十八为子　除得二十○之二十八　约为五之七　子大于母收为一又五之二是可给原额兵而仍多五分之二也
　　解曰原给仓米七之四而今全给七分是四分而増其三也故兵亦四分増三【于五之四増五之三即为五之七】
　　本法置实之四以法母七乘之得五之二十八为实法子四为法除之得五之七【今以四乗母代四除子与前条同】
　　以前数明之仓米二千五百二十石分为七分则每分三百六十石营兵三千分为五分则每分六百以仓米四分给兵四分是每米三百六十石给兵六百名也今仓米全给为三百六十石者七则兵为六百者亦七是四千二百名也除三千名满原额净多一千二百名之饷为五分之二【以七除五不尽故不用又法】













　　厯算全书巻二十九
<子部,天文算法类,推步之属,历算全书>
　　筹算自序
　　唐有九执厯不用布算唯以笔记史谓其繁重其法不传今西儒笔算或其遗意欤笔算之法详见同文算指中厯书出乃有筹算其法与旧传铺地锦相似而加便防又昔但以乘者今兼以除且益之开方诸率可谓尽变矣但本法横书彷佛于珠算之位至于除法则实横而商数纵颇难定位愚谓既用笔书宜一行直下为便辄以鄙意改用横筹直写而于定位之法尤加详焉俾用者无复纎疑即不敢谓兼中西两家之长而于筹算庶几无憾矣
　　康熙戊午九月已亥朔日躔在角宛陵梅文鼎勿庵撰筹算有数便奚囊逺涉便于佩带一也所用乘除存诸片楮久可覆核二也斗室匡坐笔徐观诸数厯然人不能测三也布算未终无妨泛应前功可续四也乘除一理不湏歌括五也尤便学习朝得暮能六也原法横书故用直筹筹直则积数横彼中文字实用横书也今直书故用横筹筹横则积数直其理一也亦有数便自上而下乃中土笔墨之宜便写一也两半圆合一位便查数二也商数与实平行便定位三也












　　钦定四库全书
　　厯算全书巻三十
　　宣城梅文鼎撰
　　筹算一
　　作筹之度
　　凡筹以牙为之或纸或竹片皆可长短任意以方正为度
　　凡筹背面皆平分九行每行以曲线界之为两半圆状凡筹背面皆相对第一筹之隂即为第九便检寻也二与八三与七四与六五与空位皆仿此共五类类各五筹当珠盘二十五位或更加之亦可　外有开方大筹为平方立方之用详见别巻
　　筹式列左



<子部,天文算法类,推步之属,历算全书,卷三十>
　　作筹之理
　　凡筹每行以曲线界之成两位其下为本位上为进位假如本位一两则进位为十两
　　凡列两筹则行内成三位下之进位与上之本位两半圆合成一位故也　列三筹则成四位　列四筹则成五位　五筹以上皆仿此
　　凡筹有明数有暗数明数者筹面所有之数是也暗数者行数也假如第一行即为一数第二行即为二数
　　凡筹与行数相因而成积数假如第二筹之第四行即为八数第九筹之第八行即为七二数
　　筹算之资
　　凡用筹算当先知并减二法今各具一则
　　并法
　　并者合也合众散数为一总数也又谓之垜积　其法先列散数自上而下对位列之千对千百对百十对十单对单以类相附
　　列讫并为一总数　其法从最下小数起自下而上如画卦之法　数满十者进位作暗马而本位书其零
　　恐混原数故以此
　　别之便覆核也
　　假如有米三千四百八十石又五千○六十八石又二万六千九百石合之共几何

　　如图散数三宗依法并之为
　　一总数得三万五千四百四
　　十八石

　　减积法
　　减者去也于总数内减去几何则知其仍余几何也减与并正相反减而剰者谓之减余
　　其法以应减去之数列左以原有之总数列右而对减之
　　千对减千百对减百十对减十单对减单
　　减而尽者抹去之　减而不尽者改而书之
　　本位无数可减合上位减之假如欲减八十而原数只有七十但其上位有一百则合而减之于一百七十内减八十仍余九十
　　假如有银三十二万五千三百一十两支放过二十九万五千三百○五两仍余几何
　　依法减之仍余三万○○○
　　五两

　　十万千百十两
　　如图先于三十万内减二十万余一十万改三为一次减九万而万位无九合上位共一十二万减之
　　余三万抹去一二改书三
　　次减五千　次减三百　皆减尽皆抹去之书作○次减五两而两位无五于一十两内减之抹去一
　　○改书○五　减讫余二○○○三
　　凡算有乘有除乘者用并法除者用减法
　　筹算之用
　　凡算先别乘除乘除皆有法实实者现有之物也法者今所用以乘之除之之规则也
　　凡筹算皆以实列位而以筹为法法有几位则用几筹如法有十系两位则用两筹法有百系三位则用三筹
　　凡法实不可误用唯乘法或可通融若除法必须细认俱详后





　　乘法
　　勿庵氏曰凡理之可言者皆其有数者也数始于一相縁以至于无穷故曰一与一为二二与一为三自此以徃巧厯不能尽乘之义也故首乗法
　　解曰乗者増加之义其数渐陞如乗髙而进也亦曰因言相因而多也珠算有因法有乗法在筹算总一乘法殊为简易
　　法曰凡两数相乘任以一为实一为法
　　假如以人数给粮或以人为实粮为法或以粮为实人为法皆可
　　凡算先列实【列书之于纸或粉板亦可依千百十零之位列之自左而右】
　　次以法数用筹乘之
　　法有几位则用几筹
　　【假如法为六十四则用第六第四两筹法为三百八十四则用第三第八第四共三筹】
　　凡乘皆从实末位最小数起
　　视原实某数即于筹其行取数列之
　　【假如实是二则取第二行数】
　　凡列乘数皆自下而上如画卦
　　凡实有几位挨次乗之但次乗之数必髙于前所列之数一位
　　【假如先乘者是单次乗者必是十故进位列之】
　　乗讫乃以并法并之合问










<子部,天文算法类,推步之属,历算全书,卷三十>








　　又法
　　凡法尾空位者省不乗但于并数之后补作圏于其下以存其位尤为简捷
　　如上图乘讫并得三○
　　○○因法尾有空又补
　　作一圏是为三○○○
　　○则知所得三万
　　定位法见前
<子部,天文算法类,推步之属,历算全书,卷三十>
　　又若田为一亩二分则所得为三合何也亩下有分故得数之三○○其尾○又是勺下之分也此定位之精理须细审之













<子部,天文算法类,推步之属,历算全书,卷三十>
　　一四二四四四五七五共九位因实尾空位【无零年故也】用省乘法加一○于末位下共十位而以尾○命为分得一十四万二千四百四十四日五十七刻五十○分合问




　　除法
　　勿庵氏曰天地之道盈虚消息而已无有盈而不虚无有消而不息乘者息也盈也除者消也虚也二者相反而不能相无其数每相当不失毫厘如相报也邵子曰算法虽多乘除尽之矣故除法次之
　　解曰除者分物之法也原作几何今作几分分之则成各得之数而除去原数也有归除有商除珠算任用筹算则独用商除为便以意商量用之故曰商除
　　法曰凡除以所分之物为实今欲作几分分之为法法与实须审定倘一倒置则毫厘千里矣【假如有粮若干分给若干人则当以粮为实以人之数为法除之盖粮数是所分之物人数是用以分之之法也若倒用以粮分人则所误多矣】　凡法有几位则用几筹　乃列实【自上而下直书之】　视筹之第几行中积数有与原实相同者或略少于实者用其数以减原实而得初商　有不尽者如法再商或三商以上皆如之实尽而止　余实不满法以法命之
　　凡商数皆以筹之行数为其数【假如所减是等第一行即商一数第二行即商二数】
　　书商数法曰凡书商数皆与减数第一位相对　若所减第一位是○则补作○于原实首位上而对之【此定位之根】
　　定位法曰除毕以商得数与原实对位求之皆于法首位之上一位命为单数【程大位曰归于法前得零古法实如法而一是也】此有二法　有法少实多者从原实内寻法首位认定逆转上一位命为单数【如米则为单石钱则为单文之类】既得单数则上而十百千万下而分秒忽微皆定矣此为正法
　　有法反多实反少者乃变法也法从原实首位逆溯而上至法首位止又上一位命为单数【此是虚位借之以求实数】既得单数乃顺下求之命所得为分秒之数


　　初商除尽式　　　　法此欲分为七十二分也故以七二为
　　假如太阳每　　　　　法用两筹
　　嵗行天三百　　　　实三六○　　如图先列三百六十度
　　六十度分为　　　　　百十　　　为实次简两筹行内有
　　七十二每　　　　　　　　　　三六○与实相同用减
　　几何度　　　　　　　　　　　原实恰尽　次查所简
　　【答曰】每五度　　　　　　　　　　系筹之第五行商作五又查所减第一位是三将商数五对三字书之
　　定位法曰此法少于实也宜于原实内寻十度位即法首位也法首再上一位为单度定所得为五度假令实是三千六百则所得为五十度如后图
　　定位法曰此亦法少于实也法亦于
　　原实内寻法首十位再上一位为单
　　位单位空补作圏再上一位是十度
　　定所得为五十度用筹同而得数逈
　　异定位之法所以当明也
　　再商式　　　　　　法此欲分为一十二分也故以一二
　　假如皇极经世　　　　为法用两筹
　　一元共一十二　　　实　　　　　　如图列实【一元总数】简万九千六百年　　　○一二九六○○筹第一行是○一
　　分为一十二会　　　　十万千百十年二商作一数【第一行故】
　　各几何　　　　　　　　　　　　　【商一】减实一十二万
　　答曰每防一万　　　　　　　　　　余九千六百不尽
　　○八百年　　　　　　　　　　　　再用筹如法除之又因所减数是○一二故于原实首补作圏而以商得一对此○位书之【即所减筹上第一位也】此定位之根不可错须细审之
　　简两筹第八行是○九六与余实
　　相合再商八【第八行故也】减余实九千
　　六百恰尽
　　此所减数亦是○九六故以商得
　　八进位书之以暗对其○
　　如此审定商数位置已知不错而初商次商隔一位不相接是得数有空位也乃于其间补作圏为一○八
　　假如隔两位则作两圏三位以上仿此求之若非于商数审其位置鲜不误矣此算中一大闗键也非此则不能定位
　　定位诀曰此亦法少于实也从原实内寻法首十位再上一位是单年单位空补作圏又上一位是十十亦

　　【亦补作圈又上一位是百知所】






　　【得为八百年　　　　　　也知百知千万矣定为一万○八百年假　　　　　　　如黄钟之法此欲分得二】【千一百八十实一十七万七乃为一分故以二一八七千】
　　【一百四十七为法用四筹】
　　【七其分法二千一百八十】
　　【七问若干分答曰八十一】
　　空
　　二千一百八十七再商之

　　简筹第一行是○二一八七正合
　　余实再商一除实恰尽
　　次商一进位书暗对所减○位
　　定位诀从原实寻法首位千逆转
　　上一位得单分则余位皆定

　　按筹算原书于定位颇略又其为法原实横而商数纵各居其方不相依附定位颇难故虽厯书间有讹位今特详之而两两直书于定位尤易亦足见余之非好为异也












　　四商法
　　假如有小珠三十　　　　四此欲分为九分有【为主】竒也万三千一百五十四故粒【则六分五厘是其竒零九分之分去声】换得大珠重九钱以为法用筹三根【九六五】六分五厘每大
　　珠一如后图列实　　　　先简筹第钱换小珠【三】
　　几何粒行略少　　　　　于【二八九五】实商减答曰【三】每
　　钱换三万五实余　　　　实【二十八万九千】千五【五百五万三千】
　　百六十粒以　　　　　　【六百五】续商以钱
　　次简筹第【五】行是【四八二五】为略少于余
　　实商【五】减余实【四万八千二百五十】仍余【五千
　　四百○四】以待第三商
　　原实　　　　　　　又简筹第【五】行是【四八二五】为略少于余
　　实又商【五】减余实【四千八百二十五】仍余
　　商数　　　　　　　　【五百七十九】知尚有第四商也
　　又简筹第【六】行是【五七九○】与余实恰合
　　四次商数俱对首位　　商作【六】除余实【五百七十九】恰尽定位诀从原实中寻法首【单】位逆转上一位得【单】粒定所得为【三万五千五百六十○粒】命为大珠每钱所换小珠之数五园问曰法是钱数实是粒数不类也何定位亦如是准乎勿庵曰此定位之法所以的确不易也且钱与粒不类子疑之固矣抑知单与单之为一类乎葢所问是每钱若干故钱数为单位若问每分若干则法首钱数为十位得为【三千五百五十六】矣故定位须详问意乃要诀也
　　法有○筹式　　　　　法此欲分作【九百○七分】也故以【九○七】
　　假如布二万　　　　　　为法用三筹
　　一千七百六　　　　　　　　　　　如图简筹第【二】行
　　十八丈给与　　　　　　　　　　　【一八一四】商作【二】减实
　　九百○七人　　　　　　　　　　　【一万八千一百四十】余【三千六百】
　　各几何　　　　　　　　　　　　　【二十八丈】次简第【四】行
　　答曰【每人二　　　　　　　　　　　三六十四丈　　　　　　　　　　　二八】商【四】除实尽以上例皆法少于实故法首在原实中乃本法也
















　　以上两例皆法多于实者其法首位或在原实中必原实首位也或不在原实中则在其原实上几位也要之皆不能满法其所得必为分秒乃通变之法也
　　论曰除者分也吾欲作几分分之则为法所分之物为实所分之物能如所欲分之数则为满法满法则成一整数假如【三十六】人分布而布有【三十六】丈则各人分得一丈古云实如法而一正谓此也程大位算法统宗曰归扵法前得零其意亦同此立法之本意也乃有所分之物原少于所欲分之数是不满法也既不满法则不能成一整数而所分者皆分秒之数假如【三十六】人分布【二十七】丈则每人不能分一丈只各得【七尺五寸】是于【一丈】内得其【七分五秒】也然必先知整数然后可以知分秒故必于原实上虚拟一满法之位若曰能如此则分得整数矣而今不能则所分得者皆分秒也于是视所拟整数虚位距商数若干位而命之若相差一位则得为十之一【如两有钱尺有寸】隔位则为百之一【如两有分丈有寸】此乃通变之法要其为法上得零则一而已矣
　　又论曰此原实即不满法也若余实不满法除之终不能尽则以命分之法御之详后
　　命分法
　　法曰凡除法商数至单已极而有余实不尽者不能成一整数也则以法命之此有二法
　　一法即以除法为命分不尽之数为得分则云几十几分之几
　　解曰命分者以一整数拟作若干分而命之如满此数则成一整数而今数少故命之也得分者今所仅有之数在命分数内得若干也【命分者古谓之分母得分者古谓之分子】
　　假如古厯以九百四十分为日法每年三百六十五日又九百四十分日之二百三十五约为四之一【约法见后】
　　一法除之至尽古厯家所谓退除为分秒是也单下有一位命为十分之几有两位命为百分之几十几三位则命分千四位则命分万皆以除得数为得分
　　假如授时厯法每嵗三百六十五日二千四百二十五分是以万分为日即命分也
　　式如后
　　假如五尺为歩每方一歩积二十五尺今有积二百四十尺得若干步
　　答曰九步又五分步之三

　　如图列实简筹第九行是二二
　　五商作九【第九行故】减实二百二十
　　五尺余一十五不尽以法命之
　　命为九步又二十五分歩之一
　　十五约为五之三【约分法见后】

　　若用第二命分法再列余实加
　　○位商之以得其分秒如后
　　余实下加一圈则一十五尺通
　　为一百五十分可再商矣
　　简等第六行是一五○商六分
　　除余实恰尽
　　命分九歩六分【即十分歩之六
　　命分第二法与法多于实除法同故皆曰除分秒也】
　　若余实为一十六尺则又不尽一尺法当于不尽一○之下再加一圈为一○○使此一尺化为一百分而再除之得四厘共九歩六分四厘【即百分歩之六十四】
　　约分法
　　约分者约其繁以从简也
　　法曰母数子数平列相减而得其纽数即以纽数为法转除两原数而得其可约之分
　　凡约分相减不拘左右但以少减多如左少右多则以左减右左多右少则以右减左若减之后或多者变而少则转减之必减至左右相同无可减而止即纽数也【若一减之即得纽数则不必转减】
　　解曰纽数者互相减之余数相等者也以此除两数则皆可分乃两数之枢纽
　　若相减至尽而无纽数者则不可约
　　假如母数二十五子数一十五约之若干
　　畣曰五之三
　　一○　先以【十五】　　复以【一十】　○五
　　二五　减【二十五】一○转减【十五】　一○
　　一五　余【一十○】一五　余【○五】　　○五
　　复以【○五】转减【一十】余【○五左右皆五即为纽数】以纽数【○五】为法转除母【二十五】得【五】除子数【一十五】得【三】故曰五之三葢母数是五个五子数是三个五也
　　此转减例
　　又如母数九百四十子数二百三十五约之若干畣曰四之一
　　先以【二百三十五】减【九百四十】余【七百○五】又减之余【四百七十○】又减之余【二百三十五】
　　左右皆【二百三十五】即纽数也
　　以纽数【二百三十五】转除母数【九百四十】得【四】除子数【二百三十五】得一故曰四之一
　　母数是四个【二百三十五】
　　子数是一个【二百三十五】
　　此不转减例
　　厯算全书巻三十
　　钦定四库全书
　　厯算全书巻三十一
　　宣城梅文鼎撰
　　筹算二之三
　　开平方法
　　勿庵氏曰自周髀算经特着开平方法其説谓周公受于商髙矩地规天为用甚大然有实无法故少广之在九数别自为章今以筹御之简易直截亦数学之一乐也
　　解曰平方者长濶相等之形也其中所容古谓之幂积亦曰面幂西法谓之面面有方有圆此所求者方面也其法有方有亷有隅总曰平方也【幂音覔覆物中也】开亦除也以所有散数整齐而布列之为正方形故不曰除而曰开平方四边相等今所求者其一边之数西法谓之方根
　　如后图方者初商也初商不尽则倍初商之根为亷法除之得两亷又以次商为隅法自乘得隅隅者以补两廉之空合一方两亷一隅成一正方形
　　如图一方两廉一隅除积仍不尽则合初商次商倍之为廉法除之以得次两廉又以三商为隅法自乘得隅合一方四廉两隅成一正方形【商四次以上仿此加之】
　　解曰上两位者自乘之积也假如方一十则其积一百方二十则其积四百以至方九十则其积八千一百也下一位者方根也假如积一百则其根一十积四百则其根二十乃至积八千一百则其根九十也平方筹式列左



　　开平方筹只用两位积数何也曰开方难得者初商耳平方积数虽多而初商所用者只两位次商以后皆亷积也亷积可用小筹除之开方大筹専为初商故积止两位
　　筹下一位单数也而实有百也万也百万也亿也百亿也万亿也百万亿也皆与单同理故独商首位者用下位之积数焉【其积自○一至○九其方根为一二三】
　　筹上一位十数也而实有千也十万也千万也十亿也千亿也十万亿也干万亿也皆与十同理故合商两位者用上下两位之积数焉【其积自一六至八一其方根自四至九】
　　用法曰先以实列位列至单位止实有空位作圏以存其位次乃作凡作之法皆从实单位实单位起作一毎隔位则之而视其最上一以为用首位有防者以实首一位独商之【乃补作一圏于原实之上亦成两位之形】
　　首位无在次位者以实首位合商之
　　皆视平方大筹积数有与相同或差小于实者用之以减原数而得方数即初商也
　　定位法曰既得初商则约实以定其位知其所得为何等【或单或十或百之类】以求次商
　　其法依前隔位所作之总计之视有若干防
　　假如只一者初商所得必单数也【自方一至方九】则初商已尽无次商矣
　　有二者初商所得必十数也【自方一十至方九十】初商十数者有次商
　　有三者初商所得必百数也【自方一百至方九百】初商百数者有次商又有三商
　　有四者初商千也有商四次焉
　　有五者初商万也有商五次焉
　　次商法曰依前术定位则知其宜有次商与否
　　若已开得单数虽减积不尽不必更求次商也虽未开得单数而初商减尽亦不必更求次商也惟初商未是单数而减积又有不尽是有次商矣次商者　倍初商为亷法用小筹以除之【初商一则用第二筹初商七则用第一第四两筹皆取倍数】视筹积数有小于余实者用之为亷积视亷积在小筹某行命为次商数
　　既得次商减去亷积即用次商数为隅法以求隅积隅积小平方也即隅法自乘之数也【可借开方筹取之】若隅积大于余实不及减者转改次商及减而止
　　以数明之　假如积一百其方根十即除实尽此独用方法无亷隅矣若积一百四十四初商十除实百余四十四则倍初商之根得廿为亷法【在初商之两旁故曰亷亷有二故倍之也】次商二以乘亷得四十为亷积又次商二为隅法自乘得四为隅积共四十四除实尽开其根得一十二也
　　商三次以上法曰次商所得尚非单数而减积又有不尽是有第三次商矣
　　商第三次者合初商次商数皆倍之为次亷法　如前用筹以除余实求得第三商以减亷积
　　又即以第三商之数为隅法以求隅积皆如次商
　　商四次五次以上并同第三商
　　命分法曰但开至单数而有余实者是不尽也不尽者以法命之法以所开得数倍之又加隅一为命分不尽之数为得分　凡得分必小于命分
　　亦有开未至单宜有续商而其余实甚少不能除作单一者亦如法命之而于其开得平方数下作圈纪其位如云平方每面几十○又几十几分之几　或平方每面几百○○又几百几十几分之几
　　若欲知其小分别有开除分秒法见第七巻
　　列商数法曰凡初商得数而书之有二法　其法依前隔位所作以最上一为主凡得数皆书于此之上一位五以上者又进一位故有二法也
　　其故何也五以上之亷倍之则十故豫进一位以居次商四以下虽倍之犹单数也所以不同凡归除开平方须明此理不则皆误矣　大约所商单数必在亷法之上一位乃法上得零之理也平方有实无法亷法者乃其法也
　　凡次商列位亦有二法　次商用归除除法者皆书于筹之第一位故次商以之
　　看次商所减之数其筹行内第一位是空与否若不空即以次商数对而书之对余实首一位是也
　　若第一位是圈即以次商数进位书之以暗对其圏余实上一位是也
　　知此则知空位矣次商有一定之位故空位亦一定也如次商与初商隔位则作圈隔两位作两圈是也
　　商三次以上书法并同
　　隅积定位法曰凡减隅积皆视其隅数为何等【隅数即次商之数也或单或十或百千等】以求其积
　　隅数是单其减隅积亦尽于单位
　　隅数是十其减隅积必尽于百位
　　隅数是百其减隅积必尽于万位
　　隅数千其隅积必百万
　　隅数万其隅积必亿
　　每隅数进退一位则隅积差两位【隅积小平方也故皆与初商同理】
　　还原法曰凡开方还原皆以所开得数为法又为实而自相乘之有不尽者以不尽之数加入即得原数
　　假如有积三百六十平方开之
　　列位【单位作圈】作防【从单位起】
　　视首位有以首位三百独商之乃视平方筹积数有小于○三者是○一也○一之方一故商一十【有二故初商是十】
　　于原实内减去方积一百余二百六十【初商是十知有次商】以上一为主凡得数皆书于此之上一位此常法也四以下用常法
　　次倍初商【一十】作【二十】用第二筹为亷法
　　视筹第九行积一八小于二六次商九于初商一十之下去亷积一百八十余八十【所减数在筹上一位不空故以商数九对余实首位书之】
　　次以次商九为隅法其隅积八十一大于余实不及减应转改次商为八视筹之第八行积数【一六】减亷积一百六十余一百【所减第一位下空故对位书之】
　　乃以次商八为隅法减隅自乘积【六十四】余【三十六】不尽
　　隅数单故减隅积亦尽于单位
　　初商【一十】次商【八】共【一十八】是已开至
　　单位也而有单位也以法命之　以平方【一十八】倍之又加隅【一】共【三十七】为命分
　　命为平方一十八又三十七分之三十六
　　还原法
　　以平方一十八用筹为法即以平方
　　一十八为实而自相乘之得三百二
　　十四加入不尽之数三十六共得三
　　百六十如原数
　　命分还原论详别巻
　　假如有积一十二万九千六百平方开之
　　列位　作

　　视首位无在次位以两位一
　　十二万合商之
　　乃视平方筹积有小于一二者是
　　○九其方三也于是商三百【三故初商百】减去方积九万余三万九千六百【初商百故知有次商】
　　次倍初商【三百】作【六百】用第六筹为亷法
　　视筹第六行积数【三六】小于【三九】次商六十于初商三百之下减去亷积三万六千余三千六百【所减首位不空故对书之】次以次商【六十】为隅法减隅积三千六百恰尽【隅数十故减隅积必尽于百位】
　　凡开得平方三百六十○　开方虽未至单减积已尽是方面无单数也后仿此
　　还原法
　　以所得平方三百六十○为法为实而自相乘之得一十二万九千六百○○如原数
　　假如有积一千平方开之
　　列位　作防
　　视在次位以首二位一千○百合商之
　　乃视平方筹小于【一○】者【○九】也【○九】
　　之方三商作三十【二防故初商十】减方积九百余一百次以初商【三十】倍作【六十】用第六筹为亷法
　　视第六筹第一行是【○六】小于【一百】次商一千初商三十之下减亷积六十余四十【所减是○六首位空也故书于进位以对其○今虽对于余实以所减六十言之犹进位也列位之理明矣】
　　次以次商一为隅法减隅积一余三十九不尽【隅积尽单位】
　　所开已至单位而有不尽以法命之倍所商三十一又加隅一共六十三为命分
　　命为平方三十一又六十三分之三十九
　　此以上皆初商四以下列位之例　皆以最上之一为主而书其初商所得数于防之上一位乃常法也
　　假如有积四千○九十六平方开之
　　列位　作
　　视在次位以四千○百合商之
　　乃视平方筹积数有三六小于四○
　　其方六也商作六十【二防故初商十】减方积
　　三千六百余四百九十六【初商十故知有次商】
　　以最上一为主而书其得数于之上两位乃进法五以上用进法
　　次倍初商【六十】作【一百二十】为亷法【用第一第二两筹】视筹第四行积数【四八】小于余实次商四于初商六十之下减亷积四百八十余一十六【所减是○四八首位空也故次商四进位书之若初商不进则次商同位矣】
　　次以次商四为隅法减隅积一十六恰尽【隅数单故隅积尽单位】
　　凡开得平方六十四
　　假如有积八千○九十九以平方开之
　　列位　作
　　视在次位以八千○百合商之
　　乃视平方筹有【六四】小于【八○】　其方
　　八也于是商八十【二防故初商十】除实六千
　　四百余一千六百九十九【初商是十宜有次商】次以初商八十倍作一百六十为亷
　　法【用第一第六两筹】
　　合视两筹第一行积【一六】与余实同宜商【一十】因无隅积改用第九行【一四四】次商九于初商八十之下减亷积一千四百四十余二百五十九【所减第一位不空故对位书之】
　　次以次商九为隅法减隅积【八十一】仍余一百七十八不尽【隅数单隅积尽单位】
　　已开至单位而有不尽以法命之　应倍所商八十九又加隅一共一百七十九为命分
　　命为平方八十九又一百七十九分之一百七十八【因少一数故不能成九十之方】
　　假如有积二千五百四十八万二千三百○四平方开之列位　作
　　视在次位以二千五百万合商
　　之
　　乃视平方筹积有【二五】与实相
　　同其方五也商五千【四防故初商千】除方积二千五百万余四十八万二千三百○四【初商千有次商】
　　【又法既以四防知所得为五千倍之则为一万即亷法也法上一位便是单逆上三倍则五千位矣】
　　次倍初商【五千】作【一万】为亷法【用第一筹】
　　视筹第四行积四与余实同次商四十于初商五千之隔位减亷积四十万余八万二千三百○四【所减是○四故进位书之以对其○然与初商五千犹隔一位故知所得为四十此定位之法之妙也】次以次商四十为隅法减隅积一千六百余八万○七百○四【隅数十故减隅积尽于百位　商至十有末商】
　　次合初商次商倍之得【一万○○八十】为亷【用第一第八并二空位共四筹】
　　【大凡商五数以上则其亷法视所商方数必进一位不论初商次商皆然若四以下则其亷法视方数必同位亦初次商尽然】
　　合视筹内第八行积数【八○六四】小于余实又次商八于先商五千○四十之下减亷积八万○六百四十余六十四【此所减第一位亦是○故商数八亦进位书之以对其○】
　　次以末商八为隅法用减隅积六十四恰尽【隅数是单故减隅积亦必尽于单位】
　　凡开得平方五千○四十八
　　以上皆商五以上进书例也
　　常法中有初商得二或四者进法中有初商得七或九者并杂见开方分秒法并开方捷法中










　　开立方法【筹算三】
　　勿庵氏曰物可以长短度者泰西家谓之线线之原度一横一缩而自相乘之以得其羃积者平方也西法谓之方面方面与线再相乘而得其容积则立方也西法谓之体
　　解曰平方长濶相等形如碁局立方长濶髙皆相等形如骰子细分之有方有平亷有长亷有小隅总曰立方
　　立方亦有实无法以所有散数整齐之成一立方形故亦曰开
　　立方长濶髙皆等今所求者其一边之数故西法亦曰立方根
　　如图方者初商也初商不尽
　　则再商之于是有三平亷三
　　长亷一小隅共七并初商方
　　形而八合之成一立方形
　　如图方形者长濶髙皆如初商之数
　　方形只一
　　如图平亷形者长濶相同皆如初商数其厚则如次商数　【平亷形凡三以辅于方形之三面】长亷者长如初商数其两头髙与濶等皆如次商数　【长亷形亦三以补三平亷之隙】
　　小隅者长濶髙皆等皆如次商数　【其形只一以补三长亷之隙】
　　商三位图
　　如后图一方三平亷三长亷
　　一小隅除实仍不尽则更商
　　又得次平廉次长廉各三
　　次小隅一合之共十五形凑
　　成一大立方形　次平亷之
　　长濶相等皆如初商并次商
　　之数厚如三商数其形三以
　　辅初商并次商合形之外　次长亷之长如初商并次商之数其濶与厚相等皆如三商数其形亦三以补次平亷之隙次小隅之长濶髙皆等皆如三商数其形只一以补次长亷之隙
　　立方筹式【列后】
　　解曰上三位者自乘再乘之积也假如根一十则其积一千根二十则其积八千乃至根九十则其积七十二万九千也　次两位者自乘之积即平方也置于立方
　　筹者以为亷法之用假如初商一百则
　　其平亷亦方一百其积一万乃至商九
　　百则其平亷方九百而积八十一万也
　　又如次商一十则其长亷之两头亦必
　　方一十而积一百乃至次商九十则其
　　长亷之两头必方九十而积八千一百
　　也　下一位者方根也假如立积一千
　　则其根一十立积八千则其根二十乃
　　至积七十二万九千则其根九十也
　　立方筹三位何也自乘再乘之数止于三位也且以为初商之用故只须三位其余实虽多位皆亷积耳



　　用法曰先以积列位至单位止无单者作圈以存其位次作从单位起每隔两位作一【即满三位去之之法也】讫视最上一以为用
　　在首位者独商之以首位为初商之实
　　单数商法也　若千若百万若十亿若万亿若千万亿凡以三位去之余一位者皆与单法同
　　在次位者合首两位为初商之实
　　十数商法也　若万若千万若百亿若十万亿若兆凡以三位去之余二位者皆与十同法
　　在第三位者合首三位为初商之实
　　百数商法也　若十万若亿若千亿若百万亿若十兆凡以三位去之余三位者皆与百同法
　　又法视其在首位则于原实之上加两圈在次位者上加一圈皆合三位而商之
　　次以初商之实与立方筹相比勘视立方筹积数有与实相同或差小于实者用之以减原实而得其立方之数即初商也
　　定位法曰既得初商则约实以定位知所得立方为何等【或单或十百等】以知有续商与否　皆以前所作防而合计之视有若干之命之
　　假如只有一则商数是单　初商已得单数无次商
　　有二防者商数十　初商十数者有商两次焉有三者商数百　初商百数者有三三次焉四商千　五防商万　每多一防则得数进一位而其商数亦多一次皆以商得单数乃尽也
　　减积法曰凡初商减积皆止于最上之位
　　次商法曰依前定位若初商末是单而减积未尽是有次商也次商者有平亷法有长亷法有隅法【解曰平亷古曰方法长亷法古曰亷法以后或曰平亷长长亷从质也或省曰方法亷法从古也】
　　先以所得初商数三之为亷法
　　又以初商数自乘而三之为三法　以方法用筹除积以得次商【以列位之法定之其法见后】
　　既得次商用其数以乘方法为三平亷积
　　又以次商自乘以乘亷法为三长亷积
　　其次商即为隅法　以隅法自乘再乘得小立方积为隅积
　　乃并三平亷三长亷一小隅积为次商亷隅共积若此亷隅共积与余积适等或小于余积则减而去之视其仍余若干以为用【或续商或以法命之】
　　若共积反大于余实不及减转改次商及减而止【若次商单一而无减以法命之】
　　商三次法曰次商尚未是单而减积未尽是有第三次商也
　　第三次商者合初商次商得数而三之为亷法又合初商次商得数自乘而三之为方法　如前以方法用筹除余实求得第三商【亦以列位法详其所得】
　　既得第三商如前求得三平亷三长亷一小隅积以减余实其法并同次商
　　四次以上皆同法
　　命分法曰但商得单数而有不尽则以法命之　未商得单数而余实甚少不能商单一者亦以法命之其法以所商立方数自乘而三之【如平亷】又以立方数三之【如长亷】又加单一【如小隅】并三数为命分不尽之数为得分　其命分必大于得分
　　列商数法曰依前隔位作防以最上一为主而论之有三法凡商得立方一数者于此之上一位书之【或单一或一十或一百或一千并同】此常法也
　　若商得立方二三四五者于此之上两位书之【单十百千其法并同】乃进法也
　　若商得立方六七八九者于此之上三位书之【单十百千其法并同】乃超进法也
　　平方只有进法而立方有三法何也平方以亷法为法而平方只二亷故其亷法之积数只有进一位故止立进法与常法为二也立方以方法为法而立方有三平廉故其方法之积数有进一位进两位故立进法超进法而与常法为三也其预为续商之地使所得单数居于法之上一位则同
　　假如立方单一其方法单三　若立方单二则方法一十二变为十数进一位矣故单一用常法而单二即用进法也
　　又如立方单五其方法七十五　若立方单六则方法一百○八又变百数进两位矣故单五只用进法而单六以上必用超进之法也
　　假如立方一十其方法三百　若立方二十则方法一千二百变千数进一位矣故一十只用常法而二十即用进法也
　　又如立方五十其方法七千五百　若立方六十则方法一万○八百又变万数进两位矣故五十仍用进法而六十以上必用超进之法也
　　若宜进而不进宜超进而不超进则初商次商同位矣不宜进而进则初商次商理不相接矣此归除开立方之大法也
　　其次商列位理本归除以所减积数首一位是空不是空定其进退皆同平方　商三次以上并同
　　隅积法曰隅法单隅积尽单位　隅法是十隅积尽于千位
　　隅法百隅积尽百万之位　以上仿求　大约隅法大一位则隅积大三位
　　还原法曰置开得立方数为实以立方数为法乘之得数再以立方数乘之有不尽者加入不尽之数即得原实
　　假如有积一千三百三十一立方开之
　　列位　作【从单位起】
　　视首位有以○○一千为初商
　　之实
　　乃视立方筹有○○一其立方一
　　于是商一十【有二故商十】减去立方积一千余三百三十一【初商十者有次商也】
　　以最上为主商一数者书于防之上一位常法也次以初商一十而三之得三十为亷法
　　又以初商一十自乘而三之得三百为方法【用第三】

　　视筹第一行积数○三与余
　　实同次商一于初商一十之
　　下【减积首位是○故进位书于一十之下以暗对其○】
　　于是以次商一乘方法仍得三百为平亷积　又以次商一自乘仍得一用乘亷法仍得三十为长亷积又以次商一自乘再乘皆仍得一为隅积　并三
　　积共三百三十一除余实恰尽
　　凡开得立方一十一【还法以立方一十一自乘得一百二十一又以一十一再乘合原积】
　　假如有积一十二亿五千九百七十一万二千立方开之列位　作
　　视首位有以○○一十
　　亿为初商之实
　　乃视立方筹有○○一其方亦一于是商一千减立方积一十亿余二亿五千九百七十一万二千次以初商一千而三因之得三千为亷法
　　又以初商一千自乘得一百万而三之得三百万为方法【用第三筹】
　　视第三筹之第八行积数二四小于余实次商八十于初商一千之下一位【所减首位不空故次商八书本位而上一位作○因与次商隔位故知其是十】
　　就以次商八十乘方法三百万得二亿四千万为平亷积
　　又以次商八十自乘得六千四百用乘廉法三千得二千九百二十万为长亷积　又次商八十自乘再乘得五十一万二千为隅积　并三积共二亿五千九百七十一万二千除实尽
　　凡开得立方一千○八十○【初商千次商○八是十而除实已尽是所商单位亦○也此列位之妙】
　　以上皆商得一数例也　皆以最上一为主而以初商得数书于之上一位乃常法也惟商得一数者可用常法一十一百一千一万并同
　　假如有积九千二百六十一立方开之
　　列位　作
　　视在首位以○○九千命为初商之实
　　乃视立方筹积有小于○○九者
　　○○八也其立方二于是商二十
　　【二故初商十】减立方积八千余一千二
　　百六十一
　　以最上一为主而以得数书于防之上两位乃进法也商二至五之法也
　　次以初商二十用三因之得六十为亷法
　　又以初商二十自乘得四百而三因之得一千二百为方法【用第一第二两筹】
　　合两筹第一行积一二与余实相同次商单一于初商二十之下【所减首位空宜进书也若初商不先用进法则无以处次商矣故进法自商二始】
　　就以次商一乘方法仍得一千二百为三平亷积又以次商一自乘得一用乘亷法仍得六十为三长亷积又以次商一自乘再乘皆仍得一为隅积　并三积共一千二百六十一除实尽凡开得立方二十一
　　假如有立方积三万二千七百六十八立方开之问得若干
　　列位　作
　　视在次位以○三万二千为初
　　商之实乃视立方筹积小于○三
　　二者是○二七其立方三也于是
　　商三十【二防故初商十】减商三十【二故初商十】减立方积二万七千余五千七百六十八
　　次以初商三十用三因得九十为亷法
　　又以初商三十自乘得九百而三之得二千七百为方法【用第二第七两筹】
　　合视两筹第二行积○五四小于余实次商单二于初商三十之下【所减首位○宜进书以对其○】
　　就以次商单二乘方法得五千四百为平亷积　又以次商自乘得四用乘廉法得三百六十为长廉积又以次商自乘再乘得八为隅积　并三积共五
　　千七百六十八除实尽凡开得立方三十二
　　假如有立方积一十一万七千六百四十九立方开得若干
　　列位　作
　　视在第三位以一十一万七千为初商之实
　　乃视立方筹积有小于一一七者
　　○六四也其立方四于是商四十
　　【二故初商十】减立方积六万四千余五
　　万三千六百四十九　次以初商四十用三因之得一百二十为亷法
　　又以初商四十自乘得一千六百而三之得四千八百为方法【用第四第八两筹】
　　合视两筹第九行积数四三二小于余实次商九于初商四十之下【所减首位不空故本位书之】
　　就以次商九乘方法得四万三千二百为平亷积又以次商九自乘得八十一用乘亷法得九千七百二十为长亷积　又以次商九自乘再乘得七百二十九为隅积　合计亷隅三积共五万三千六百四十九除实尽
　　凡开得立方四十九
　　假如有积一千六百六十三亿七千五百万立方开得若干
　　列位　作
　　视在第三位以一千六百六十亿为初商之实
　　乃视立方筹有小于一六
　　六者是一二五其立方五
　　也商作五千【四商千】除立方
　　积一千二百五十亿余四百一十三亿七千五百万次以初商五千用三因之得一万五千为亷法又以初商五千自乘得二千五百万三因之得七千五百万为方法【用第七第五两筹】
　　合视两筹第五行积三七五小于余实次商五百于初商五千之下【所减首位不空故书本位】
　　就以次商五百乘方法得三百七十五亿为平亷积又以次商五百自乘得二十五万用乘亷法得三
　　十七亿五千万为长亷积　又以次商五百自乘再乘得一亿二千五百万为隅积　并三积共四百一十三亿七千五百万除实尽　凡开得立方五千五百○○
　　以上乃商得二三四五之例也　皆以最上一为主而以初商所得进书之上两位进法也初商得二三四五者用进法单十百千并同
　　假如有积二十六万二千一百四十四立方开之列位　作
　　视在第三位以二十六万二
　　千为初商之实
　　乃视立方筹有小于二六二者
　　二一六也其立方是六商六十【二防商十】减立方积二十一万六千余四万六千一百四十四
　　以最上一为主而以得数书于之上三位超进法也乃商六至九之法也
　　次以初商六十用三因之得一百八十为亷法又以初商六十自乘得三千六百而三因之得一万○八百为方法【用第一空位第八三筹】
　　合视筹第四行积四三二小于余实次商四于初商六十之下【所减首位是○故进位书之以对其○】
　　就以次商四乘方法得四万三千二百为平亷积又以次商四自乘得一十六用乘亷法得二千八百八十为长亷积　又以四自乘再乘得六十四为隅积　并三积共四万六千一百四十四除实尽凡开得立方六十四
　　假如有积三十七万三千二百四十八立方开之列位　作
　　视在第三位以三十七万三千为初商之实
　　乃视立方筹积有小于三七三
　　者是三四三其立方七也商七
　　十【二商十】减立方积三十四万三
　　千余三万○二百四十八次以初商七十用三因之得二百一十为亷法
　　又以初商七十自乘得四千九百三之得一万四千七百为方法【用第一第四第七三筹】
　　合视筹第二行积二九四小于余实次商二于初商七十之下【所减首位空故进位书之以对其○】
　　就以次商二乘方法得二万九千四百为平亷积又以二自之得四用乘亷法得八百四十为长亷积又以二自乘再乘得八为隅积　并三积共三万
　　○二百四十八除实尽凡开得立方七十二
　　假如有积五十三万一千四百四十一立方开之列位　作
　　视在第三位以五十三万一千为初商之实
　　乃视立方筹积有五一二小于
　　五三一其方八也商八十【二商十】减立方积五十一万二千余一
　　万九千四百四十一
　　次以初商八十用三因之得二百四十为亷法又以八十自乘得六千四百三之得一万九千二百为方法【用第一第九第二三筹】
　　合视筹第一行是一九二小于实次商一于初商之下　就以次商一乘方法为平亷积　又以一自乘用乘亷法为长亷积　又以一自乘再乘为隅积并三积共一万九千四百四十一除实尽
　　凡开得立方八十一
　　假如有积九十七万○二百九十九立方开之
　　列位　作
　　视在第三位以九十七万○为初商之实
　　乃视立方筹有七二九小于九七○其方九也商九
　　十【二商十】减积七十二万九千余
　　二十四万一千二百九十九

　　次以初商九十三之得二百七十为亷法
　　又以九十自之得八千一百而三之得二万四千三百为方法【用第二第四第三三筹】
　　合视筹第九行是二一八七小于余实次商九于初商九十之下【所减首位不空故本位书之】
　　就以次商九乘方法得二十一万八千七百为平亷积　又以九自乘得八十一以乘亷法得二万一千八百七十为长亷积　又以九自乘再乘得七百二十九为隅积　并三积共二十四万一千二百九十九除实尽凡开得立方九十九
　　此以上皆初商六七八九之例也　皆以最上一为主而以得数书于之上三位乃超进法也初商六七八九用超进之法单十百千并同
　　命分例
　　假如有立方八百一十尺问立方每面各若干
　　列位　作
　　在第三位以八百一十○尺为
　　初商之实
　　视立方筹有小于实者为七二九
　　其立方九商九尺减积【七百二十九尺】余【八十一尺】
　　此商数已至单尺而有不尽当以法命之
　　法以商数九自乘【八十一】而三之得【二百四十三】如平亷又置商数九而三之得【二十七】如长亷　加小隅一共【二百七十一】为命分
　　命为立方每面九尺又二百七十一分尺之八十一此商得单数而有不尽以法命之例也
　　又如有立方积一亿二千五百七十五万尺问立方若干
　　列位　作
　　在第三位以一亿二千五百万
　　尺为初商实
　　视立方筹有【一二五】恰与实合商【五百尺】减实【一亿二千五百万尺】余【七十五万○○○○尺】
　　有三故知所商是【五百尺】宜有第二商第三商也乃以初商【五百尺】自乘【二十五万尺】而三之得【七十五万尺】为平亷法又以初商【五百尺】三之得【一千五百尺】为长亷法视余实【七十五万尺】仅足平亷之数而无长亷知第二商第三商皆空也补作两圈而以法命之
　　法以平亷法长亷法合数加小隅一共【七十五万一千五百○一尺】为命分
　　命为立方每面五百尺又七十五万一千五百○一分尺之七十五万○○○○
　　此商数虽未至单而余实甚少不能成一整数亦以法命之例也
　　厯算全书巻三十一
　　钦定四库全书
　　厯算全书巻三十二
　　宣城梅文鼎撰
　　筹算四之五
　　开带纵平方法
　　勿庵氏曰算有九极于勾股勾股出于圆方故少广旁要相资为用也然开平方以御勾股而纵法以御和较古有益积减积翻积诸术参伍错综尽神通变要之皆带纵一法而已
　　【平方者长濶相等如碁局也平方带纵者直田也长多于濶之数谓
　　之纵纵之濶如平方之数其长则如纵之数纵与方相乘得纵积以
　　加方积成一直田形积也】
　　平方与方纵两形初商之积也两
　　亷一隅一亷纵者次商之积也亷
　　有二故倍之亷之纵只一故不倍
　　也
　　如前图除积不尽则有第三商如
　　此图虽三商亦只倍亷而不倍纵
　　四商以上仿此详之

　　用法曰先以积列位如法作防从单位起隔位防之视防在首位独商之防在次位合两位商之皆命为实次以带纵数用筹与平方筹并列之各为法
　　视平方筹积数有小于实者用其方数为初商用其积数为方积【初商自乘之数也】　即视纵筹与初商同行之积数用之为纵积【初商乘纵之数也如初商一则用纵筹第一行】兼方积纵积两数以减原实而定初商【必原实中兼此两积之数则初商无悮矣故曰定】　若原实不及减改而商之如前求得两积以减之为初商定数　不及减又改商之及减而止若应商十数因无纵积改商单九是初商空也则于初商之位作○而纪其改商之数于○下若次商者然【初商应是百而改九十应是千而改九百并同】
　　定位法曰既得初商视所作原实之防共有几何以定其得数之位以知其有次商与否【如一防则得数是单而无次商二防则得数是十而有次商之类皆如平方法取之】
　　次商法曰依前定位知初商未是单数而减积又有未尽是有次商也　次商之法倍初商加入纵为亷法用筹除之　视亷法筹行内之积数有小于余实者用为亷积以减余实用其行数为次商　就以次商自乘为隅积以减余实以定次商【必余实内有亷隅两积则次商无误】不及减者改商之及减而止皆如平方法
　　商三次以上并同次商
　　命分法曰若得数已是单而有不尽则以法命之　法以所商数倍之加入纵为亷又加隅一为命分不尽之数为得分
　　亦有得数非单而余实少在亷法以下不能商作单一者亦以法命之　法即以亷法加隅一为命分
　　列商数法曰依平方法视所作防而以最上一防为主若初商五以上【不论单五或五十或五千或五百并同】皆用进法书其其得数于防之上两位则不论纵之多少也
　　若初商四以下【亦不论单十百千】则以纵之多少而为之进退法以纵折半加入初商【单从单十从十百千各以类加】若满五以上者变从进法书于防之上两位【如初商四而纵有二初商三而纵有四之类】
　　若纵数少虽加之而仍不满五数者仍用常法书其得数于防之上一位【如初商四而纵只有一初商三而纵只有二只有二之类】总而言之所商单数皆书于亷法之上一位故初商得数有进退之法乃豫为亷法之地以居次商也初商五以上倍之则十虽无纵加亷法已进位矣初商虽四以下而以半纵加之满五则其倍之加纵而为亷法也亦满十而进位矣亷法进位故初商必进两位书也若加半纵仍不满五则其亷法无进位矣故初商只进一位而书之葢豫算所商单数已在亷法之上也
　　又初商若得单数其亷法即为命分凡商得单数必在命分之上一位以此考之庶无谬误
　　假如有直田积六十三步但云濶不及长二步
　　列位【依平方法】作防【从单位起】
　　视防在次位合六十三步商之为实次以平方筹与纵二筹平列之各为法
　　视平方筹积有【四九】小于【六三】其方七也商作单
　　七【用进法书于防之上两位　一防知所商是单】
　　即视带纵筹第七行积数【一四】用为纵积
　　并方积【四十九】纵积【一十四】共六十三除实尽【此亦偶除尽耳设不尽其命分必是十数故前商七之数必进书之以存其位】
　　定为濶七步　加纵二步得长九步
　　凡得数在五以上用进法书于防之上两位此其例也
　　假如有直田六百三十步但云长多濶二步
　　列位【无单位补作圈】作防
　　视防在首位独商之以○六百步
　　为实
　　以平方带纵二各用筹为法
　　视平方筹积数有【○四】小于【○六】
　　其方二商二十步【二防故初商十】自乘得方积【四百步】随视纵筹第二行是【四】得纵积【四十步】并两积共四百四十步以减原实余一百九十步再商之【初商十故有次商也商数二十以纵折半得单一加之共二十一仍不满五数故只用常法书于防之上一位】
　　次以初商【二十步】倍之【四十步】加纵【二步】共四十二步为亷法【用第四第二两筹】
　　合视两筹第四行积数【一六八】小于【一九○】次商【四】减亷积一百六十八步余二十二步【所减首位不空次商故书本位】次以次商【四步】为隅法自乘得【一十六步】为隅积用减余实不尽六步以法命之【初商虽不进位所得次商单数已在命分之上一位矣列商数法妙在于此】倍所商【二十四步】为【四十八步】加纵【二步】又加隅【一步】共五十一步为命分
　　命为濶【二十四步】又【五十一分步之六】加纵【二步】得长【二十六步】又【五十一分歩之六】
　　凡得数在四以下以半纵加之仍不满五则只用常法书于防之上一位此其例也
　　假如有直田五亩但云长多濶八十八步
　　列位【以亩法二百四十通之得一千二百步十步单步空补作两圈】作防
　　视防在次位合商之以一千二
　　百步为实纵有两位用两筹与
　　平方筹并列各为法
　　先视平方筹有【○九】小于【一二】宜商三十【二防商十】因有纵改商二
　　十其方积四百步纵积一千七
　　百六十步【初商十与纵相乘故纵单数皆成十数】兼两积共二千一百六十步大于实不及减所商有误抹去之
　　改商【一十步】其方积【一百步】其纵积【八百八十步】并两积共除实九百八十步余二百二十步再为实以求次商【初商十故有次商也】
　　【纵折半四十四步加初商一十步共五十四步故变用进法】
　　次以初商【一十步】倍之【二十步】加纵【八十八步】共一百○八步为亷法【用第一空位第八三筹】
　　合视筹第二行积【二一六】小于【二二○】次商【二步】于初商【一十步】之下减亷积一百一十六余四步【所减首位○故进书之初商豫进正为此也】
　　次以次商【二步】自乘得四步为隅积除实尽
　　定为濶一十二步加纵【八十八步】得长一百步
　　假如有直田一十二亩半但云长多濶七十步
　　列位【以亩法二百四十通之得三千步百十单皆作圈】作防
　　视防在次位以三千○百步为实
　　以平方带纵七十各用筹为法
　　先视平方筹积有二五小于【三○】宜
　　商【五十】因纵改商【四十步】其方积一
　　千六百步其纵积二千八百步共四
　　千四百步大于实不及减抹去之
　　改商【三十步】其方积【九百步】其纵积【二千一百步】共三千步除实尽
　　【纵七十折半三十五加初商三十共六十五是五以上也故用进法书商三于防上两位假有余实则当再商或命之以分今虽商尽当存其位　命分者亷法加隅一也倍初商加纵共一百三十是原实百者亷法之位也进一位乃单位初商不进两位何以容单数】
　　凡开得平方三十步为田濶　加纵七十步共一百步为长
　　假如有直田七亩但云长多濶六十步
　　列位【以亩法二百四十通之得一千六百八十步单位空作圈】作防
　　视防在次位合商之以一千六百步
　　为实
　　以平方带纵六十步用筹各为法
　　先视平方筹有一六与实同宜商四
　　十【二防初商是十】因带纵改商三十步其方
　　积【九百步】纵积【一千八百步】共二千
　　七百步大于实不及减抹去之
　　改商【二十步】其方积【四百步】纵积【一千二百步】共减一千六百步余八十步再商之
　　【纵折半三十加初商共五十故进书之】
　　【假余实满命分一百○一步即当商一步故初商豫进以居次商今次商虽空当存○位故也】
　　次以初商【二十步】倍之【四十步】加入纵六十步共一百步为亷法　亷法大于余实不及减次商作○其余实以法命之　法以亷法加隅一为命分
　　命为濶【二十步】又【一百○一分步之八十】加纵为长【八十步】又【一百○一分步之八十】
　　假如有直田四亩但云长多濶九十步
　　列位【以亩法通之得九百六十步】作防
　　视防在首位独商之以○九百为实
　　以平方带纵九十步各用筹为法
　　先视平方筹积有【○九】与实同宜
　　商三十步【二防故初商十】因带纵改商二
　　十步其方积【四百步】纵积【一千八】
　　【百步】不及减又改商一十歩其方积【一百步】纵积【九百步】共一千步仍不及减　此有二防宜商十步今改商一十仍不及减是初商十位空也
　　【纵九十折半四十五加初商十步满五十以上故商一进书防之上两位】
　　改商单九步其方积【八十一步】纵积【八百一十步】共八百九十一步以减实余六十九步不尽【此宜商十数者变商单步故初商之位作○而以改商之九步书于○位下如次商然也盖必如此书之所商单数乃在命分之上一位也】
　　商数已得单步而有不尽以法命之以商九步倍之加纵九十步共一百○八步更加隅一步共一百○九步为命分
　　命为濶九步又【一百○九分步之六十九】　加纵为长九十九步又【一百○九分步之六十九】
　　以上四则乃纵多进位之法也凡得数虽四以下以半纵加之满五即用进法书于防之上两位此其例也
　　开带纵立方法【筹算五】
　　勿庵氏曰泰西家説勾股开方甚详然未有带纵之术同文算指取中算补之其论带纵平方有十一种而于立方带纵终缺然也程汝思统宗所载又皆两纵之相同者惟难题堆垜还原有二例只一可用其一强合而已非立术本意又不附少广而杂见于均输虽有善学何从而辨之兹因筹算稍以鄙意完其缺义取晓畅不厌烦复使得其意者可施之他率不穷云尔
　　凡立方带纵有三
　　一只带一纵
　　如云长多方若干或髙多方若干是也【即同髙】
　　一带两纵而纵数相同
　　如云长不及方若干髙不及方若干是也【此方多数为纵】

　　一带两纵而纵数又不相同
　　如云长多濶若干濶又多髙若干是也
　　大约带一纵者只有纵数而已带两纵者有纵亷又有纵方故其术不同





　　带一纵图三
　　此长多于方　　　　　此髙多于方
　　也为横纵横　　　　　也为直纵直
　　纵之形濶与　　　　　纵之形长濶
　　髙等如其方　　　　　相等如其方
　　其厚也如其　　　　　其髙也如其
　　纵所设　　　　　　　纵所设
　　俱立方一纵形一合为长立方形
　　如图立方形方纵形合者初商
　　也平亷三内带纵者二长亷三
　　内带纵者一小隅一此七者次
　　商也
　　平亷所带之纵长与立方等厚
　　与次商等其髙也则如纵所设
　　长亷所带之纵两头横直等
　　皆如次商其髙也如纵所设
　　用法曰以积列位乃作防从单位起隔两位防之防毕视积首位有防独商之以首位为初商之实首位无防以首位合有防之位商之　防在次位以首两位为初商之实　防在第三位以首三位为初商之实　皆同立方法
　　先视立方筹积数有小于初商之实者用其方数为初商【定位法合计所作防共有若干一防者商单数二防则商十数每一防进一位皆如立方】用其积数为初商立方积【定位法视初商方数若初商单数其积亦尽于单位若初商十数其积乃尽于千位每初商进一位其积进三位亦可以防计之皆如立方】
　　次以初商自乘以乘纵数为纵积
　　合计立方积纵积共数以减原积而定初商【若初商无误者原实中必兼此两积】命初商为方数加纵数为髙数【或长数皆依先所设】不及减者改商之及减而止
　　次商法曰依前定位知初商是何等【或单十百千等】若初商未是单数而减积又有不尽是有次商也
　　法以初商自乘而三之又以纵与初商相乘而两之共为平亷法　又法以初商三之纵倍之并其数与初商相乘得数为平亷法　或以初商加纵而倍之并初商数以乘初商为平亷法并同
　　又以初商三之加纵为长亷法
　　乃置余实列位以平亷法除之得数为次商【用筹为法除而得之】
　　【依除法定其位】
　　于是以次商乘平亷法为三平亷积　又以次商自乘以乘长亷法为三长亷积　就以次商自乘再乘为隅积　合计平亷长亷隅积共若干数以减原实【原实中兼此并积知次商无误矣】乃并初商次商所得数为方数加纵命为髙数【或长数皆如先所设】合问　不及减者改商之及减而止
　　商三次者以初商次商所得数加纵而倍之并商得数为法仍与商得数相乘为平亷法
　　又以商得数三之加纵为长亷法　余并同次商
　　命分法曰己商至单数而有不尽则以法命之　其法以所商得数加纵倍之加所商得数以乘所商得数【如平亷】又以所商得数三之加纵【如长亷】并两数又加单一【如隅】为命分不尽之数为得分
　　或商数尚未是单而余实甚少在所用平亷长亷两法并数之下或仅同其数【仅同者无隅积】是无可续商也亦以法命之法即以所用平亷长亷两法并之又加隅一为命分
　　列商数法曰依立方法以初商之实有防者为主【即原实内最上之一防】凡初商得数必书于防之上一位乃常法也惟初商一数者用常法
　　有以初商得数书于防之上两位者进法也初商二三四五者用进法
　　有以初商得数书于防之上三位者超进法也初商六七八九者用超进之法
　　若纵数多亷法有进位则宜用常法者改用进法宜用进法者用超进之法宜超进者更超一位书之其法于次商时酌而定之葢次商时有三平亷法三长亷法再加隅一为命分法于原实寻命分之位为主命分上一位单数位也从此单数逆寻而上自单而十而百而千至初商位止有不合者改而进书之若与初商恰合者不必强改此法甚妙平方带纵亦可用之
　　若宜商一十而改单九或宜商一百而改九十凡得数退改小一等数者皆不用最上一防而以第二防论之此尤要诀【或于初商位作圈而以所商小一等数书于圈之下即可以上一防论也细考其数则同此商数列位立法之妙宜详翫之】
　　假如浚井计立方积七百五十四万九千八百八十八尺但云深多方八百尺　法以立方带纵为法除之列位　作防
　　视防在首位独商之以○
　　○七百万尺为初商之实
　　以立方筹为法　视立方筹积有○○一小于○○七商一百尺【三防故初商百商一百故用常法书于防之上一位】得立方积一百万尺【三防者方积尽百万之位　初商之方积皆尽于最上之一防】
　　次以初商一百尺自乘一万尺乘纵八百尺得八百万尺为纵积　并两积九百万积大于原实不及减抹去之不用改商如后图
　　视立方筹第九行积七二九改商九十尺得立方积七十二万九千尺【百改十故亦改用第二防第二防是十位故方积亦尽于千位】次
　　以初商九十尺自乘八千一
　　百尺乘纵八百尺得六百四
　　十八万尺为纵积　并两积
　　共七百二十万○九千尺以减原实余三十四万○八百八十八尺再商除之【初商一百今改商九十故上一防不用用第二防论之商九者书于第二防之上三位超进法也】
　　次用次商又法以纵八百尺加初商九十尺而倍之得一千七百八十尺并初商九十尺共一千八百七十尺用与初商九十尺相乘得一十六万八千三百尺为平亷法　又以初商九十尺三因之得二百七十尺加纵八百尺共得一千○七十尺为长亷法乃列余实以平亷为法除之【用第一第六第八第三共四等】
　　商九十用超进法书于第二防之上三位今以纵多致亷法进为十万故次商时应更为酌定又超一位书之然后次商单数在亷法上一位矣改如后图【亷法十万上一位单数位也今商九十不合在此位故改之】



　　合视筹第二行积○三三六六小于余实次商二尺于初商九十之下【所减首位是○法宜进书也初商不改而更超之何以居次商】就以次商二尺乘平亷法得三十三万六千六百尺为平亷积　又以次商二尺自乘四尺用乘长亷法得四千二百八十尺为长亷积　又以次商二尺自乘再乘得八尺为隅积　并三积共三十四万○八百八十八尺除实尽
　　乃以商数命为井方　加纵为井深
　　计开
　　井方九十二尺深八百九十二尺
　　此超进法改而更超一位也


　　带两纵纵数相同图二
　　此髙不及方也方之横与直俱
　　多于髙是为两纵两纵者纵廉
　　二纵方一并立方而四
　　立方形长濶髙皆相等
　　纵亷形髙与濶相等如其方之
　　数其厚也如所设纵之数
　　纵方形两头等皆如纵数其髙也如立方之数两纵亷辅立方两面而纵方补其隅合为一短立方形
　　不及之数有在立方旁者观后图可互见其意





　　如图初商有立方有纵廉二纵方一共四形今只图其二余为平廉所掩意防之可也【此横头不及方也即前图之眠体】
　　次商平廉三内带一纵者二带两纵者一长廉三内带纵者二小隅一共七
　　平廉带一纵者濶如初商加纵为长厚如次商其带两纵者髙濶皆等皆如初商加纵之数厚如次啇
　　长廉带纵者长如初商加纵之数其两头横直皆等皆如次商
　　无纵长廉长如初商两头横直等如次商
　　小隅横直髙皆等皆如次商
　　用法曰先以纵倍之为纵廉【两纵并也】以纵自乘为纵方【两纵相乘】
　　此因两纵数同故其法如此也若两纵不同径用乘法并法矣
　　乃如法列位作防求初商之实
　　以立方筹为法求得初商方数及初商立方积【皆如立方法皆依定位法命之】
　　次以初商乘纵方得数为纵方积　又以初商自乘数乘纵亷得数为纵亷积
　　合计纵方纵亷立方之积共若干数以减原实而定初商【皆如一纵法】
　　命初商为髙数【或深数皆如所设】加纵为方数【不及减改商之若初商未是单数则以余实求次商】
　　次商法曰以初商加纵倍之以乘初商髙数得数　又以初商加纵自乘得数　并之共为平亷法【又法初商三之加纵以初商加纵乘之得数为平亷法亦同】
　　次以初商加纵倍之并初商数共为长亷法【又法初商三之纵倍之并为长亷法亦同】
　　乃置余实列位　以亷法位酌定初商列法而进退之以平亷为法而除余实得数为次商【皆以所减首位是○与否而为之进若退】　又法合平亷长亷两法以求次商
　　于是以次商乘平亷法为平亷积　又以次商自乘数乘长亷法为长亷积　又以次商自乘再乘为隅积　合计平亷长亷隅积共若干数以减余实而定初商【皆如一纵法】
　　【又法以次商乘长亷法为长亷法又以次商自乘为隅法并平亷长亷隅法以与次商相乘为次商亷隅共积以减余实亦同】
　　乃命所商数为髙【或深之类如所设】加纵数命为方合问
　　不尽者以方倍之乘髙又以方自乘【如平亷】又以方倍之并髙【如长亷】又加单一【如隅】为命分
　　假如有方台积五百八十六万六千一百八十一尺但云髙不及方一百四十尺　以带两纵立方为法除之【方者长濶等每面各多髙一百四十尺】
　　先以纵一百四十尺倍之得二百八十尺为纵积又纵自乘之得一万九千六百尺为纵方
　　列位　加防
　　视防在首位独商之以○
　　○五百万尺为初商之实
　　视立方积有○○一小于
　　○○五商一百尺【三防故商百尺】得立方积一百万尺【商一数宜用常法书于防之上一位今因纵多致亷法升为十万法上一位为单单上一位为十今初商是百尺故改用进法书之亷法之升见后】
　　就以初商一百尺乘纵方得一百九十六万尺为纵方积
　　又以初商一百自乘一万乘纵亷得二百八十万尺为纵亷积
　　合计立方纵方纵亷积共五百七十六万尺以减原实余一十万○六千一百八十一尺【初商百尺宜有续商】初商一百尺髙也　加纵共二百四十尺方也次以方倍之四百八十尺用乘髙数得四万八千尺又以方自乘之得五万七千六百尺并之得一十万○五千六百尺为平亷法
　　又以方倍之并髙得五百八十尺为长亷法
　　乃列余实　以亷法酌定初商改进一位书之
　　以平亷法用筹除余实
　　视筹第一行○一○五六
　　小于余实次商一尺于初
　　商一百尺之隔位【所减是○一○五六首位○宜进书然犹与初商隔位故知为单一尺】　就以次商一尺乘平亷法如故又以次商一尺自乘以乘长亷法亦如故就命为平亷长亷积　又以次商自乘再乘仍得一尺如故　合计三积共一十万○六千一百八十一尺除实尽
　　乃以所商数命为台髙　加纵为方
　　计开
　　台髙一百○一尺　方二百四十一尺
　　此常法改用进法也
　　假如有方池积五十万丈但云深不及方五十尺　先以纵【五十】尺倍之一百为纵亷　又纵自乘之得【二千五百】尺为纵方
　　列位　加防
　　视防在第三位合商之以五十
　　万○○尺为初商之实
　　视立方筹有三四三小于五○
　　○宜商七十尺【二防商十尺】因纵改商六十尺得立方积二十一万六千尺　次以初商六十尺自乘三千六百尺用乘纵亷一百尺得三十六万尺已大于实不及减不必求纵方积矣　改商五十尺用筹求得立方积一十二万五千尺
　　就以初商五十尺乘纵方得纵方积亦一十二万五千尺　又以初商五十尺自乘二千五百尺用乘纵亷得纵亷积二十五万尺　并三积共五十万尺除实尽　以商数命为池深　加纵为方
　　计开　池深五十尺　方一百尺
　　此进法改为超进也【假有次商则其平亷法二万尺矣假有命分则其命分二万○二百五十一矣】　亦有髙与长同而濶不及数者准此求之但以初商命为濶而加纵为髙与长






　　带两纵纵数不相同图二
　　此长多于濶而髙又多于
　　长也是为两纵而又不相
　　同凡为大纵亷小纵亷各
　　一纵方一并立方形而四
　　立方形长濶髙相等
　　大纵亷横直等如其方而
　　髙如大纵　小纵亷髙濶
　　等如其方而厚如小纵
　　纵方形之两头髙如大纵厚
　　如小纵其长也则如立方大
　　纵　小纵以辅立方之两
　　面而纵方补其阙合为一长
　　立方形如图初
　　商有立方有大纵廉小纵廉
　　纵方各一共四只图其二余
　　为平廉所掩也次商平廉三
　　内
　　带小纵者一带大纵者一带
　　两纵者一长廉【在初商大纵立方之
　　背面】三内带小纵
　　者一带大纵者一小隅一共
　　七在初商
　　大纵立方之
　　带小纵平亷濶如初商长如初商加小纵之数髙如次商
　　带大纵平亷濶如初商髙如初商加大纵之数厚如次商
　　带两纵平亷濶如初商加小纵之数髙如初商加大纵之数厚如次商
　　带小纵长亷长如初商加小纵之数　带大纵长亷髙如初商加大纵之数　无纵长亷长如初商数其两头横直皆如次商之数
　　小隅横直髙皆如次商之数
　　用法曰以两纵相并为纵亷　以两纵相乘为纵方列位作防求初商之实　以立方筹求得初商立方积　以初商求得纵方纵亷两积　皆如前法乃以初商命为濶　各加纵命为长为髙
　　求次商者以初商长濶髙维乘得数而并之为平亷法
　　又以初商长濶髙并之为长亷法
　　乃置余实列位【以平亷酌定初商之位】以平亷为法求次商及平亷积长亷积隅积以减余实乃命所商为濶各以纵加之为髙为长【如所设】皆如前法
　　不尽者以所商长濶髙维乘并之【如平亷】又以长濶髙并之【如长亷】又加单一【如隅】为命分
　　假如有长立方形积九十尺但云髙多濶三尺长多濶二尺
　　先以两纵相并五尺为纵亷　以两纵相乘六尺为纵方
　　列位　作防
　　视防在第二位合商之以○九十
　　○尺为初商之实
　　乃视立方筹有○六四小于○九○宜商四八因有纵改商三尺得二十七尺为立方积【原实只一防故初商是单商三故书于防之上两位用进法也】
　　次以初商三尺自乘九尺乘纵亷得四十五尺为纵亷积
　　又以初商三尺乘纵方得一十八尺为纵方积并三积共九十尺除实尽
　　乃以初商命为濶　各加纵为髙为长
　　计开
　　濶三尺　长五尺　髙六尺
　　假如有立方积一千六百二十尺但云长多濶六尺髙多濶三尺
　　先以两纵相并九尺为纵亷　以两纵相乘一十八尺为纵方
　　列位　作防
　　视防在首位独商之以○○一千
　　尺为初商之实
　　乃视立方筹有○○一与实同商一十尺【二防商十】得立方积一千尺次以初商一十尺自乘一百尺乘纵亷得九百尺为纵亷积又以初商一十尺乘纵方得一百八十尺为纵方积　合计之共二千○八十尺大于实不及减【商一十故用常法书于防之上一位】改商九尺得七百二十九尺为立方积【十变为单则上一防不用用第二防故商九书于第二防之上两位用超进法也】
　　次以初商九尺自乘八十一乘纵亷亦得七百二十九尺为纵亷积
　　次以初商九尺乘纵方得一百六十二尺为纵方积并三积共一千六百二十尺除实尽
　　乃以商数命为濶　各加纵为长为髙
　　计开
　　濶九尺　长一十五尺　髙一十二尺
　　假如有长立方积六万四千尺但云长多濶五尺髙又多长一尺
　　先以长多五尺髙多六尺并之得【十十】为纵亷　又以五尺六尺相乘三十为纵方
　　【解曰长多濶五尺髙又多长一尺是髙多濶六尺也】
　　列位　作防
　　视防在第二位合商之以○六
　　万四千尺为初商之实
　　视立方筹有○六四与实同宜
　　商四十尺因有纵改商三十尺【二防故商十尺】得二万七千尺为立方积【商三十故书于防之上两位用进法也】
　　次以初商三十尺自乘九百尺乘纵亷得九千九百尺为纵亷积
　　次以初商三十尺乘纵方得九百尺为纵方积并三积共三万七千八百尺以减原实余二万六千二百尺再商之【初商十宜有次商】
　　初商三十尺濶也　加纵五尺共三十五尺长也又加一尺共三十六尺髙也
　　乃以初商长濶髙维乘之
　　濶乘长得一千○五十尺　髙乘濶得一千○八十尺　长乘高得一千二百六十尺
　　并三维乘数共三千三百九十尺为平亷法【又法并长与髙乘濶又以髙乘长并之亦同】
　　次以初商长濶髙并之共一百○一尺为长亷法【又法初商三之加两纵亦同】
　　乃以平亷用筹为法以余实列位除之
　　如后图合视筹第六行是二○三四小于余实次商六尺【所减首位不空故书本位】得二万○三百四十尺为平亷积【次商乘平亷法也】
　　次以次商六尺自乘三十六尺乘长亷法得三千六百三十六尺为长亷积又以次商六尺自乘再乘得二百一十六尺为隅积
　　并三积共二万四千一百九十二尺以减余实余二千○○八不尽以法命之
　　法以初商濶髙长各加次商为濶髙长而维乘之濶乘长得一千四百七十六尺　髙乘濶得一千五百一十二尺　长乘髙得一千七百二十二尺
　　并得四千七百一十尺【如平亷】又并濶髙长得一百一十九尺【如长亷】又加一尺【如隅】共得四千八百三十尺为命分不尽之数为得分
　　命为四千八百三十分尺之二千○○八即竒数也计开
　　濶三十六尺有竒【音基】　长四十一尺有竒髙四十二尺有竒
　　假如有长立方形积一十万○一千尺但云长多濶五尺髙多濶六尺
　　先以两纵并得一十一尺为纵亷
　　以两纵乘得三十尺为纵方
　　列位　作防
　　视防在第三位合三位商之以
　　一十万○一千为初商之实
　　乃视立方筹有○六四小于一
　　○一商四十尺【二防商十】得六万四千尺为立方积【商四十故书于防之上两位进法也】
　　次以初商自乘一千六百尺乘纵亷得一万七千六百尺为纵亷积
　　次以初商乘纵方得一千二百尺为纵方积
　　并三积共八万二千八百尺以减原实余一万八千二百尺再商之
　　初商四十尺濶也　加纵五尺得四十五尺长也加纵六尺得四十六尺髙也
　　乃以初商濶长髙而维乘之
　　长乘濶得一千八百尺　濶乘髙得一千八百四十尺【又法并髙与长九十一尺以濶四十尺乘之共三千六百四十尺省两维乘其数亦同】髙乘长得二千○七十尺
　　并维乘数共五千七百一十尺为平亷法
　　又以濶长髙并之共一百三十一尺为长亷法乃列余实以平亷用筹为法除之
　　合视筹第三行是一七一三小于
　　余实次商三尺【所减首位不空故本位书之】就
　　以次商三尺乘平亷法得一万七
　　千一百三十尺为平亷积　又以
　　次商三尺自乘九尺乘长亷法得一千一百七十九尺为长亷积　又以次商三尺自乘再乘得二十七尺为隅积　并之得一万八千三百三十六尺大于余实不及减
　　改商二尺
　　就以次商二尺乘平亷法得一万一千四百二十尺为平亷积【即用筹第二行取之】
　　次以次商自乘四尺乘长亷法得五百二十四尺为长亷积　又以次商自乘再乘得八尺为隅积并之共一万一千九百五十二尺以减余实仍余六千二百四十八不尽以法命之
　　法以濶长髙各加次商二尺为濶长髙而维乘之并髙四十八尺长四十七尺共九十五尺以濶四十二尺乘之得三千九百九十尺【代两维乘】又以长乘髙得二千二百五十六尺并得六千二百四十六尺　又以长濶髙并之得一百三十七尺　又加一尺　共六千三百八十四为命分
　　命为六千三百八十四之六千二百四十八即竒数计开
　　濶四十二尺有竒
　　长四十七尺有竒
　　髙四十八尺有竒





　　厯算全书卷三十二
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书卷三十三
　　宣城梅文鼎撰
　　筹算六之七
　　开方捷法
　　勿庵氏曰亷隅二形也故有二法今借开方大筹为隅法列于亷法筹之下而合商之则亷隅合为一法而用加捷矣存前法者所以着其理用捷法者所以善其事
　　平方
　　法曰如前列实从单位作防每隅位防之以求初商【初商列位有常法进法俱如前】既得初商即倍根数为亷法【亦同前法】以亷法数用筹【亷法几位用筹几根】列于平方筹之上为亷隅共法【或省曰次商法】合视亷隅共法筹某行内有次商之实同者或略少者减实以得次商【以本行内方根命之】
　　三商者合初商次商倍之以其数用筹列平方筹上为亷隅共法【或省曰三商法】以除三商之实而得三商四商以上仿此求之
　　解曰隅者小平方也故可以平方筹为法　亷之数每大于隅一位今以平方筹为隅列于亷之下则隅之进位与亷之本位两半圆合成一数故亷隅可合为一法
　　【何以知亷大于隅一位也曰有次商则初商是十数矣平方亷法是初商倍数其位同初商故大于隅一位】
　　凡初商减积尽最上一防故最上一防者初商之实也次商减积尽第二防故第二防以上次商之实也三商减积尽第三防故第三防以上三商之实也推之第四防为四商之实第五防为五商之实【以上并同】
　　审空位法曰若次商之实小于亷隅共法之第一行【凡筹第一行最小数也】则知次商是空位也【不能成一数故空】即作圈于初商下以为次商　乃于亷法筹下平方筹上加一空位筹为亷隅共法以求三商【若空位多者另有简法见后】三商实小有空位并同
　　假如有平方积二千四百九十九万九千九百九十九尺问每面若干
　　列位　作防
　　如图防在次位以二千四百
　　万为初商实
　　视平方筹有小于二四者是
　　一六其方四也商四千尺减积一千六百万尺【有四防故初商是千而有次商】
　　次以初商四千尺倍之得八千尺为亷法用第八筹列平方筹上为亷隅共法





　　以第二防余实八百九十九万为次商实视筹第九行合数八○一小于实次商九百尺减实八百○一万尺
　　【此所减首位不空故对位书之】
　　次倍初商次商共四千九百尺得九千八百尺用第九第八两筹列平方筹上为廉隅共法　以第三防上余实九八九九为三商之实
　　合视筹第九行是八九○一小于实商九十尺减余
　　实八十九万○一百
　　尺
　　【首位不空故亦对位书之】



　　次倍三次商共四千九百九十尺得九千九百八十尺用九九八三筹列平方筹上为廉隅共法
　　以第四防上余
　　积九九八九九
　　为四商之实
　　合视筹第九行
　　积八九九○一
　　小于实商九尺
　　减余实八万九
　　千九百○一尺
　　不尽九千九百九十八尺
　　开方已得单尺而有不尽以法命之倍方根加一数得九千九百九十九为命分
　　凡开得平方四千九百九十九尺又九千九百九十九之九千九百九十八
　　右例可明四以上用常法之理葢积所少者不过万分之一不能成五数之方而其法迥异
　　加空筹式
　　假如有平方积一千六百七十七万七千二百一十六问每面若干
　　列位　作防
　　如图防在次位以一千六百万
　　为初商实
　　视平方筹有一六与实同其方
　　四商四千尺减积一千六百万尺【凡余实必在商数下一位起倘空位则作圈补之后仿此】　次以初商四千尺倍得八千尺为亷法用第八筹列平方筹上为亷隅共法【筹见前例】
　　以第二防上余实○七七为次商实
　　筹最小数是○八一【第一行数】大于实
　　不及减是商数无百也
　　乃于初商四千下作一圈以为次
　　商【减去实中○位】　次如上图加一空位筹于次商亷法之下平方筹之上为三商亷隅共法
　　以第三防上七七七二为三商实






　　视筹第九行是七二八一小于实商九十尺减积七十二万八千一百
　　次合初商次商三商共四○九倍之得八一八为廉法






　　去空位筹加一八两筹列于平方筹之上为四商廉隅共法
　　以第四防上四九一一六为四商之实
　　合视筹第六行数与实合商六尺减积四万九千一百一十六尺恰尽
　　凡开得平方四千○九十六尺
　　假如有平方积九亿○○一十八万○○○九步问每面若干
　　列位
　　作防
　　如后图防在首位以○九亿步为初商实
　　视平方筹有○九与实同商
　　三万步【五防故初商万】减积九亿步
　　次以初商三万步倍之得六
　　万步用第六筹加平方筹上为次商法【即廉隅共法】　以第二防上为次商之实视实三位俱空无减知商数有空位且不止一空位也如前法宜挨次商得一空位则于原实内销一圈【凡续商之实必下于前商之实一位故虽○位必减去之以清出续商之实】而于共法筹内加一空位筹如此挨商颇觉碎杂故改用又法
　　又法曰凡实有多空位者知商数亦有多空不必挨商当于原实中审定可减之数在何位则此位之上皆连作圈而径求后商如此余实有三圈皆无积可减必至○一乃有可减而法是第六筹筹最小是○六大于○一仍不可减必至一八方可减而一是筹之进位当以商数对之则知以上俱是空位乃皆作圏合视之有三圈即次商三商四商也干原实内销去三圈如后图
　　此即次商三商四
　　商合图也

　　次加三空筹于平亷【第六筹】之下平方之上为五商亷隅共法　径以第五防上一八○○○九为五商实
　　视筹第三行数与余实合商三尺
　　除积一八○○○九恰尽




　　凡开得平方三万○○○三步
　　又假如积二千五百○七万○○四十九尺问方若干列位　作防
　　如图防在次位以二千五
　　百万尺为初商实
　　视平方筹有二五与实同
　　其方五商五千尺减积二千五百万尺
　　次倍初商五千尺得一万○千尺用一筹空位筹为廉法【凡商得五数则原带有空位】列平方筹上为次商法　实多空位以前除又法审之必至○七万尺乃有可减而○七之○与筹上首位之○对当以商数居之则知此以上俱无商数也于是于初商五千下作两圏如后图





　　此次商三商合图也【原实上减两圏商数下加两圏】
　　如上图加两空位筹于廉法一万○千之下平方之上为四商法
　　以○七○○四九为四商实【次商三商之两防已销故径用第四防】
　　视筹第七行相合商七尺减实
　　恰尽
　　凡开得平方五千○○七尺
　　又假如积五千六万三千五百○○尺问方若干列位
　　作防　如图防在次位以五十六万为初商实
　　视平方第七行是四九小
　　于实商七百尺除实四十
　　九万
　　次倍初商七百得一千四百用第一第四两筹列平方筹上为次商法　以第二防上○七三五为次商实
　　合视第五
　　行是○七
　　二五小于
　　实商五十
　　尺减去余
　　积○七万
　　二千五百
　　尺
　　次合商数七百五十倍之得一千五百○尺应用第一第五空位三筹加于平方筹上为三商法以第三防上○一千○○尺为三商实而实小于法不能成一尺乃于商数未作一圏以为三商其不尽之数以法命之
　　凡亷隅共法筹第一行数即命分
　　也葢能满此数即成一单数矣
　　凡开得平方七百五十○尺又一
　　千五百○一之一千○○○约为
　　三之二弱
　　立方
　　法曰如前列实隔两位作防以求初商既得初商即以初商数自乘而三之为平亷法【即方法】以平亷法用筹列于立方筹之上【借立方筹为隅法也】为平亷小隅共法别以初商数三之而进一位为长亷法【即亷法】以长亷法用筹列于立方筹之下【法于长亷数下加一空筹以合进一位之数】先以平隅共法【即平亷小隅共法或省曰共法】为次商之法即截取初商下一位至第二防止为次商之实法除实得次商【视共法筹内有小于实者为平亷亷小隅共积用其根数为次商】次以次商之自乘数【即大筹立积下所带平方积数】与长亷法相乘【以平方数寻长亷筹之行取其行内积数用之】得数加入平隅共积为次商总积以此总积减次商之实及减则已倘不及减转改次商及减而止【因亷积或大有不及减者】
　　三商者合初商次商数自乘而三之为平亷法以其数用筹列方筹上为平亷小隅共法
　　别以初商次商数三而进位以其数用筹加一空位筹列立方筹下为长亷法
　　截取次商下一位至第三防为三商之实共法为法除之以得三商【其积为共积】　次以三商自乘数与长亷法相乘得数加入共积为三商总积　减实【又一法长亷法不必加空位筹得于得数下加一圏即进位也】
　　四商以上仿此
　　解曰隅者小立方也故可以立方筹为法平亷之数每大于隅二位今以立方筹为隅列于平亷下则隅之首位与平亷之末位两半圆合成一数故平亷小隅可合为一法　长亷之两头皆如次商自乘之数故可以平方乘之又长亷之数每大于隅一位故于下加一空筹以进其位便加积也
　　【何以知平亷大于隅二位而长亷只大一位也曰平亷者初商自乘之数也初商于次商为十数十乘十则百数矣隅积者次商本位也故平亷与隅如百与单相去二位也若长亷只是初商之三倍位同初商初商与次商如十与单故长亷与小隅亦如十与单相去一位也】
　　凡初商积尽于上一防故上一防为初商实次商积尽于第二防故第二防以上为次商实推之三防为三商实四防为四商实以上并同
　　审空位法曰若次商之实小于平亷小隅共法之第一行或仅如共法之第一行而无长亷积则次商是空位也即作圏于初商下以为次商乃于平亷筹下立方筹上加两空位筹为三商平亷小隅之共法以求三商其长亷法下又加一空位筹【并原有一空位筹共两空位筹】为三商长亷法【又法长亷不必加空筹但于得数下加两圏】　若商数有两空位者平亷小隅筹下加四空位筹长亷积下加三圏
　　解曰有空位则所求者三商也初商于三商如百与单而平亷者初商之自乘百乘百成万故平亷与三商之隅如万与单大四位也此加两空筹之理也【平亷原大二位加二空筹则大四位矣】初商与三商既如百与单则长亷与隅亦如百与单大两位也此又加一空筹之理也
　　初商列位商一用常法二至五用进法六至九用超法今各存一例于后
　　假如有立方积六百八十五万九千尺问每面若干列位　作防
　　如图防在首位以○○六百
　　万为初商实
　　视立方筹有小于○○六者
　　○○一也其立方一商一百尺【三防故初商百】减积一百万尺次截取第二防上五八五九为次商实







　　以初商一百尺自乘得一万尺而三因之得三万尺为平廉法用第三筹列立方筹上为平廉小隅共法
　　别以初商一百尺三而进位得三百○十尺为长廉法
　　列立方筹下视平隅共法筹第九行是三四二九小于实商九十尺
　　次以第九行平方八一乘长廉三得二四三○以加共积得五百八十五万九千为次商九十尺之积除实尽
　　次商十宜有三商而除实已尽是方面无单数也凡开得立方每面一百九十○尺
　　假如有立方积一千二百八十六亿三千四百六十七万○五百九十二尺问方若干
　　列位
　　作防
　　如图防在第三位以一
　　千二百八十亿为初商
　　实
　　视立方筹内有小于一二八是一二五其方五也商五千尺【四防故初商千】减积一千二百五十亿
　　次截取第二防上○三六三四为次商实
　　以初商五千自乘得二千五百万而三之得七千五百万为平廉法用七五两筹列立方筹上为平廉小隅共法别以初商五千尺三而进位得一万五千○百尺为长亷法用筹列立方筹下
　　视共法筹第一行是○
　　七五○一大于实不及
　　减知次商百位空也于
　　初商下作一圏为次商【原实上减一圏】
　　乃截第三防三六三四六七○为三商实
　　次于平亷筹下立方筹上加两空位筹为平亷小隅共法
　　于长亷筹下又加一空位筹【原有一空位筹共二空位】为长亷法
　　视共法筹第四行



　　是三○○○○六
　　四小于实用为共
　　积商四十尺　以长廉法与四行之平方一六相乘得二四○○○为长廉积加入共积得三○二四○六四减积三十○亿二千四百○六万四千尺次以商数五千○四十自乘得二千五百四十○万一千六百尺而三之得七千六百二十○万四千八百尺为平廉法列立方筹上为平隅共法别以商数五千○四十尺三而进位得一万五千一百二十○尺为长廉法列立方筹下
　　乃截第四防
　　六一○六○
　　六五九二为
　　四商之实
　　视共法筹第
　　八行六○九
　　六三八九
　　一二小于实
　　商八尺以长亷法与第八行平方六四相乘得九六七六八○为长亷积以加共积得六一○六○六五九二除实尽
　　凡开得立方每面五千○四十八尺
　　右加两空筹例
　　假如有立方积七千二百九十七亿二千九百二十四万三千○二十七尺问每面若干
　　列位　作防
　　如图防在第三位以七
　　千二百九十亿为初商
　　实　视立方筹方九之
　　积七二九与实同商九千尺减积七千二百九十亿【四防故初商千】次截第二防○○○七二九为次商实以初商九千尺自乘八千一百万尺而三之得二亿四千三百万尺为平亷法列立方筹上为平亷小隅共法别以初商九千尺三而进位得二万七千○百尺为长亷法列立方筹下　视共法筹第一行是○二四三○一大于实不及减知次商百位空也于初商九千尺下作一圏为次商【原实上减去一圏】乃于平亷筹下立方筹上加两空筹为平廉小隅共法于长亷筹下又加一空筹得二七○○为长亷法　截取第三防○○七二九二四三为三商实　视共法筹第一行是○二四三○○○一大于实仍不及减知三商十位亦空也于商得九千○百下加一圏为三商【原实上又减去一圏又法实多空不必挨商但寻至不空之界如○七乃与平亷相应即于○七之上初商之下作连圏为次商三商而于原实中销两圏】
　　此次商三商合图也
　　乃于平亷筹下立方筹
　　上又加两空筹【共四空筹】为
　　平亷小隅共法　其长亷筹下又加一空筹【共三空筹】得二七○○○为长亷法【或不必加筹只于得数下加三圏亦同】
　　截取第四防○七二九二四三○二七为四商实








　　视共法筹第三行是○七二
　　九○○○○二七小于实商
　　三尺　以长亷法与第三行
　　平方○九相乘得二四三○
　　○○为长亷积以加共积得
　　○七二九二四三○二七除实尽
　　凡开得立方每面九千○○三尺
　　右加四空筹例
　　开方分秒法【筹算七】
　　勿庵氏曰命分古法也然但可以存其不尽之数而已若还原则有不合故有分秒法以御之也虽亦终不能尽然最小之分即无关于大数视命分之法不啻加宻矣
　　平方
　　法曰凡开平方有余实不能成一数不可开矣若必欲开其分秒则于余实下加二圏【原实一化为一百分】如法开之所得根数是一十分内之几分也或加四圏【原实一化为一万分】如法开之所得根数是一百分内之几分也或加六圏【原实一化为一百万分】如法开之所得根数是一千分内之几分也如此递加两圏则多开得一位乃至加十圏【原实一化为百亿分】其根数则十万分内之几万几千几百几十几分也
　　假如平方积八步开得二步除实四步余四步不尽分秒几何
　　法于余实下添两圏则余实四步
　　化为四百○○分为次商之实
　　依捷法以初商二步倍作四步为
　　亷法列平方筹上为亷隅共法简
　　筹第八行积三八四小于余实次商八分除实三百八十四分开得平方每面二步八分不尽一十六分再开之
　　又于余实下加两圏则余实一十六分化为一千六百○○秒为三商之实
　　依捷法以初商次商共二步八分倍之得五步六分为亷法列平方筹上为亷隅共法简筹第二行积一一二四小于余实商作二秒除实一千一百二十四秒共开得平方每面二步八分二秒不尽四百七十六秒
　　此单下开两位式也所不尽之数不过百分之四若欲再开亦可得其忽防如后式
　　还原以二步八二用筹为法又以二步八二列为实而自相乘之得七万九千五百二十四分加不尽之分四百七十六共八万乃以一万分为一步之法除之【当退四位】仍得八步合原数
　　解曰此以一步化为百分故其积万分何也自乘者横一步直一步也今既以一步化为一百分则是横一百分直一百分而其积一万分为一步





　　假如平方九十步开得九步除实八十一步余实○九步不尽【小分几何】
　　法于余实九步下加八圏则余实九步化为九亿共作五防而以第二防○九亿○○分为次商之实依捷法以初商九步倍作一十八步为亷法列平方
　　筹上为亷隅共法简筹第
　　四行○七三六略小于余
　　实商四千分除实七亿三
　　千六百万分余一亿六千
　　四百○○万分为第三商
　　之实【第三防也】
　　又依捷法以初商次商九步又十之四倍之得一十八步八为亷法列平方筹上为亷隅共法简筹第八行一五一○四略小于余实商八除实一亿五千一百○四万余一千二百九十六万分○○为第四次商之实【第四防也】
　　又依捷法以三次所商共九步四八倍之得一十八步九六为亷法列平方筹上为亷隅共法简筹第六行一一三七九六略小于实商六除实一千一百三十七万九千六百分余一百五十八万○四百○○分为第五次商之实【第五防也】
　　又依捷法以所商九步四八六倍之得一十八步九七二为亷法列平方筹上为亷隅共法简筹第八行一五一七八二四略小于实商八除实一百五十一万七千八百二十四分余六万二千五百七十六分不尽凡开得平方每面九步四千八百六十八分【亦可名为四分八秒六忽八防】不尽一○○○○○○○○之○○○○六二五七六【即一万分之六分有竒】
　　虽不尽不过万分之一不足为损益可弃不用还原以九步四八六八用筹为法又为实自乘得八十九亿九千九百九十三万七千四百二十四分加入不尽之分六万二千五百七十六共九十亿以一亿分为一步之法除之【当退八位】仍得九十步合原数解曰此以一步化为一万分故其自乘之积一亿何也自乘者横一步直一步之积也今既以一万分为步则是横一万分直一万分而其积一亿为一步





　　若依命分法则还原不合
　　如前例　原实八步开得方二步除实四步不尽四步法当倍每方二步作四步又加隅一步为命分命为二步又五分步之四意若曰若得五步则商三步矣今只四步是五分内止得四分也然还原有不合何也
　　以算明之
　　用通分法以命分五通二步得一十分又加得分四共一十四分自乘得一百九十六为实以命分五自
　　乘得二十五分为法【每步通作
　　五分横一步直一步则共得二十五分也】除之
　　得七步又二十五分之二十一以较原实少二十五之四
　　以图明之
　　每步作五分其羃积二十五分方二
　　步积四步共一百分又五之四以乘
　　方二步得四十分倍之为亷积八十
　　分又五之四自乘得隅积一十六分
　　共九十六分以合原余积四步该一百分少二十五分之四
　　以此观之实数每缩虚数常盈故命分之法不可以还原　其故何也曰隅差也何以谓之隅差曰平方之有竒零其在两亷者实其在隅者虚何也亷之虚者一面而隅之虚者两面也即如二步五之四谓五分内虚一分故不能成一歩也然试观于图两亷之四步皆虚一分【横四分直五分积二十分以二十五分计之是为于五分之中虚一分】而隅之一步虚一分有零【横四分直亦四分积一十六分虚九分以二十五分计之是为五分之中虚二分弱】则是边数二步五之数者其积不及五之四也今余积四步者实数也其边数常盈于五之四有竒也而命之曰五之四宜其不及矣然则古何以设此法曰古率常寛以为所差者防故命之也不但此也古率圆一围三方五斜七今考之皆有防差故曰寛也
　　愚常考定开平方隅差之法法曰如法以命分之毋通其整而纳其子【即得分】为全数以全数自相乘得数为通积另置分毋以分子减之余数以乘分子而加之为实乃以分毋自乘为法除之即适还原数　如上方二步五之四以分毋五通二步得十纳子四共十四自乘得方积一百九十六分另以分子四减分毋五余一以转乘分子四得四即隅差也以隅差加入方积共二百分为实乃以分毋五自乘得二十五为法以除实得八步合原积
　　又如后例　原实九十步开得九步除实八十一步不尽九步法当倍每方九步作十八步又加隅一共十九步为命分命为九步又十九分步之九意若曰若得十九歩则加商一步成十步今只九步是十九分内只得九分也然还原亦不合
　　以算明之
　　用通分法以命分十九通九步得一百七十一步又加得分九共一百八十步自乘得三万二千四百为实以命分十九自乘得三百六十一为法【每步十九分横十九分直十九分共得三百六十一分也】除之得八十九步又三百六十一分之二百七十一以较原实之九十步计少三百六十一分之九十分




　　若依隅差之分以得分九减命分十九余十转乘得分得九十分为隅差以加自乘通积三万二千四百共得三万二千四百九十为实乃以命分自乘三百六十一为法除之恰得九十步合原积
　　以图明之
　　甲戊丁庚形者方九步九分
　　之总形也通为一百八十分
　　积三万二千四百分以三百
　　六十一为步除之较原实少
　　九十分
　　内分甲丙乙巳形为初商方九步之形其积八千一歩戊乙形庚乙形次商亷积之形也长九步【通为一百七十一分】濶九分积一千五百三十九分两亷共计三千○七十八分
　　丁乙者小隅者横直各九分以较亷积中每一步之形【如丑乙】欠一丁癸形即隅差也
　　以积考之亷九步每步濶九分长一步【通为十九分】积一百七十一分隅濶九分长亦九分积八十一分少九十分为隅差





　　立方
　　法曰凡立方有余实不能成一数不可开矣若必欲知其分秒则于余实下加三圏【原实一化为一千分】如法开之所得根数是一十分之几分也若加六圏【原实一化为一百万分】所得根数是一百分之几分也若加九圏【原实一化为十亿】则根数是一千分之几分也若加十二圏【原实一化为万亿】则根数是一万分之几分也
　　解曰平方筹两位故两位作防而其化小分亦以两位为率葢积多两位则根数可多一位也【亷一位隅一位故两位】立方筹三位故三位作防而其化小分亦以三位为率葢积多三位则根数可多一位也【平亷一位长亷一位隅一位故三位】
　　假如立方积一十七步开得立方二步除八步余实九
　　步不尽法于余实下
　　加十二圈则余实九
　　步化为九万亿分【増
　　四防可加开四位】
　　依捷法截第二防○九○○○为次商之实　以初商二自乘【四】而三之得一十二步为平亷法列立方筹上为平隅共法　以初商【二】三而进位得【六○】为长亷法列立方筹下　简共法筹第五行积【○六一二五】小于实商五分【六行七行亦小于实因无长亷积故不用】
　　乃以第五行平方【二五】与长亷法相乘得【一五○○】为长亷积以加共积共得【○七六二五】是为次商五分之积以除实余一三七五以俟三商
　　又截取第三防一三七五○○○为三商之实　以初商次商共二步五分自乘得【六二五】而三之得【一八七五】为平亷法列立方筹上为平隅共法　以初商次商【二步五分】三而进位得【七五○】为长亷法列立方筹第七行【一三一二八四三】共法【八四三】小于实商七秒　乃以第七行平方【四九】与长亷法相乘得【三六七五○】为长亷积以加共积共得【一三四九五九三】为三商七秒之积以除实余○二五四○七以续商
　　又截取第四防○二五四○七○○○为四商之实以商数【二五七】自乘得【六六○四九】而三之得【一九八一四七】为平亷法列立方筹上为平隅共法　以商数【二五七】进位而三之得【七七一○】为长亷法列立方筹下简共法筹第一行【○一九八一四七○一】小于实商一忽
　　乃以第一行平方【一】乘长亷得【七七一○】为长亷积以加共积得【一九八二二四一一】为商一忽之积以除实余○五五八四五八九以末商
　　通第五防○五五八四五八九○○○为末商之实以商数【二五七一】自乘得【六六一○○四一】而三
　　之得【一九八三○一二三】为平亷法列立方筹上为平隅共法　以商数【二五七一】进位而三之得【七七一三○】为长亷法列立方筹下简共法筹第二行【○三九六六○二四六○八】小于实商二防
　　乃以第二行平方【○四】乘长亷法得【三○八五二○】为长亷积以加共积得【○三九六六三三三一二八】为末商二防之积以减实余一六一八二五五八七二不尽
　　凡开得立方每面二步五分七秒一忽二防【不尽之数不能成一防弃不用】
　　还原以二步五七一二用筹为法别以二步五七一二列为实以法乘实得六六一一○六九四四






　　再乘之得一十六万九千九百八十三亿八千一百七十四万四千一百二十八分








　　乃以不尽之积一十六亿一千八百二十五万五千八百七十二分加入再乘积共得一十七万亿以一万亿为一步之法【以一步为万分横一万直一万商一万共一万亿】除之得一十七步合原数



　　若依命分法则还原不合
　　如前所设立方积一十七步开得立方每面二步除积九步余九步法当以立方二步自乘得四步而三之得十二步为平亷又以立方二步三之得六步为长亷又加【一步】为隅共【一十九步】为命分命为立方二步又十九分步之九意若曰余积若满十九步则加商一步矣今只有九步是以十九分为一步而今仅得九分也然还原则有不合
　　以算明之
　　用通分法以命分十九通立方二步得【三十八分】又加得分九共【四十七分】此即所云二步又十九分之九乃立方一面之数也以此自乘得【二千二百○九分】再乘得【一十○万三千八百二十三】乃立方二步又十九分之九所容积数也为实别以命分十九自乘得【三百六十一】再乘得【六千八百五十九】乃方一步之积为法以除实得【一十五步又六千八百五十九之九百三十八】较原实一十七步少【一步又六千八百五十九分之五千九百二十一】
　　其故何也曰长亷小隅之差也何以言之曰立方之有竒零其在平亷者实其在长亷小隅者虚何也平亷之虚者一面而长亷虚两面小隅虚三面故也今以十九分为一步其立方积【六千八百五十九分】为步法以十九分除之得每【三百六十一】为分法平亷每步【横十九分直十九分髙九分积三千二百四十九】分法除之得九是为十九分之九适合命分之数也
　　若长亷【横九分直十九分髙九分积一千五百三十九分】分法除之得四分有竒而已以较平亷九分之积【三千二百四十九】少【一千七百一十分】三长亷共【六步】共少【一万○二百六十分】步法除之得一步又三千四百○一分为长亷差
　　若小隅【横直髙各九分积七百二十九分】分法除之得二分有竒而已
　　以较平亷九分之积【三千二百四十九】少二千五百二十分为隅差
　　合亷隅两差计之共少一步又六千八百五十九分之五千九百二十一
　　以图明之
　　丑寅为立方一步之形每步通为十九分横直髙各十九分积六千八百五十九分是为步法
　　以十九分除步法得三百六十一分是为分法
　　亷隅总图【见左】
　　甲乙丙三平亷也纵横各方二步通为三十八分厚九分积一万二千九百九十六分三亷共三万八千
　　九百八十八分丁戊巳三长亷
　　也各长二步通为三十八分厚
　　濶各九分积三千○七十八分
　　三亷共九千二百三十四分
　　庚小隅也长濶髙皆九分积七
　　百二十九分
　　三长廉三平廉一小隅共包一正方形在内
　　正方形纵横各二步通为三十八分　积五万四千八百七十二分
　　总形方二步九分通为四十七分髙如之　积一十○万三千八百二十三分　以步法除之得一十五步有竒不满原实一步又五千九百二十一分
　　平亷方二步其容四步即辛壬癸
　　子之分形也每步纵横皆一步通
　　为十九分厚皆九分积三千二百
　　四十九【辛一形积如此壬癸子者同】　以分除之适得九分
　　长亷长二步【如丑寅合形】通为三十八
　　分厚九分皆与平亷同所不同者
　　平亷濶十九分而长亷濶只九分
　　故长亷二步尚不及平亷一步之积以积计之每长亷一步【如丑形】积一千五百三十九分较平亷每步之积【如丑夘合形】少一千七百一十分【如丑之虚分夘】三长亷计六步共少一万○二百六十分是为长亷之差
　　小隅横直髙皆九分【如未形】于平亷
　　一步之积不及四之一以积计之
　　小隅之积七百二十九较平亷一
　　步之积【如未申合形】少二千五百二十分【如未之虚分申】是为小隅之差　合二差共一步五千九百二十一分今考定开立方亷隅差法法曰凡立方有命分者如法以分母【即命分】通其整而纳以分子【即得分】为立方全数以全数自乘再乘得数为立方通积另置命分【母数】与得分【子数】各自乘得数以相减用其余数以乘得分得数为隅差又置命分与得分相减用其余数转与得分相乘以乘命分得数是为长亷每步虚数又以长亷法乘之得数为长亷差合二差数以加通积为实以命分自乘再乘得数为法除之即适还原数如所设立方积十七步开得立方二步又十九分
　　之九法以分母【十九】通立方二步而以分【子九分】纳之共【四十七分】为立方全数以全数自乘再乘得【一十○万三千八百二十三】为通积另置命分【十九】自乘得【三百六十一】内减分子【九】自乘【八十一】余【二百八十分】以分子【九】乘之得【二千五百二十分】为隅差又置命分【一十九】内减得分【九】余十分转乘得分【九】得【九十分】以乘命分【十九】得【一千七百一十分】为长亷每步虚数又以长亷法【六步】乘之得【一万○二百六十分】为长亷差合二差共一万二千七百八十分以加通积共得一十一万六千六百○三分为实以命分一十九自乘再乘得六千八百五十九分为法以除实得一十七步合原积










　　厯算全书卷三十三
　　笔算自序
　　或问笔算西人之法耳子何规规焉曰非也自图书启而文字兴参两倚数毕天下之能事六书九数皆原于易非二事也古人算具以筹策纵横布列畧如筮法之挂扐其字象形为祘是故其纵立者一而一其上横者一而五珠盘之位实此权舆夫用蓍在立卦之后则筹策之算必不在文字先矣是故筹策之未立形声防画自足以用而筹策之所得又将纪之简策以诏方来书与数之相须较然眀也近数百年间再变而为珠盘踵事生新以趋简易然观九章中盈朒方程必列副位厥用仍资笔札其源流不可想见与故谓笔算为西人独智者非也曰今所传同文算指西镜録等书亦唐九执厯元明间回囘土盘之遗耳与中算固各有本末矣曰是则然矣然安知九执以前不更有始之始者乎西人之言厯也自多禄某以来二千年屡变而宻溯而上之亦不能言其始于何人其为算也亦若是己矣夫古者圣人声教洋溢无所不通南车记里之规随重译而四逹我则失之彼则存之乌乎识其然乌乎识其不然耶且夫治理者以理为归治数者以数为断数与理协中西非殊是故礼可以求诸野官可以问诸郯必以其西也而摈之取善之道不如是隘也况求之于古抑实有相通之故乎曰然则子何以易衡而直曰旁行者西国之书也天方国字自右而左欧逻巴字自左而右皆衡列为行彼中文字尽然也彼之文字既衡故笔算亦横取其便于彼用耳非求异于我也吾之文字既直故笔算宜直亦取其便于用耳非矜胜于彼也又何惑焉问者以为然遂书其语为序康熙癸酉二月初吉宣城梅文鼎撰




　　发凡
　　笔算之便与筹算同然筹仍资笔而笔则无假于筹于文人之用尤便【笔算无歌括最便学习又无妨酬应乆可覆核皆与筹算同详筹算书】
　　笔算易横为直以便中土盖直下而书者中土圣人之旧而吾人所习也与筹算易直为横其理正同
　　笔乗原法以法实相叠殊混人目今所更定者一纵一横法实各居其所而纵横相遇处得数生焉不惟便用而已其所以然之理亦按图可知
　　笔除原法得数与原实相离定位易淆今所更定者法实与得数两两相对算理井然定位尤简
　　【所谓原法者并据同文算指乃西土之旧式利西泰所授而李水部之藻所刻也厥后有西镜録等书稍稍讲明定位之用盖亦酌取中法而为之然于古人实如法而一之防似犹有隔兹以法上得零之诀定之庶令学者一望而知所兾髙贤有以教之幸甚】



　　钦定四库全书
　　厯算全书卷三十四
　　宣城梅文鼎撰
　　笔算卷一
　　列位法
　　数始于一究于九毕于十十则又复为一矣等而上之为百为千为万乃至兆亿皆得名之为一即皆得名之为二三四五六七八九故必先稽其位而列之并减乘除以此为基非是则算无可施矣法具如后【以一位言之有自一至九之名此如同軰之有长防合上下之位言之有单十百千万之等此如己身而上有高曽祖父己身而下又有子孙云仍故单以下复有畸零之位也】
　　列位式
　　万　千　百　十　零
　　【此姑以五位为式位有多寡皆以零数为根零亦曰单】
　　假如有数二万四千七百五十九依法列之
　　二　四　七　五　九
　　【凡列数以最下小数为单单上有一位共二位即是十数有三位是百有四位是千有五位是万不必更书十百千万等字但稽其有若干位即得之矣】
　　又如有数四千○九十六依法列之
　　四　○　九　六
　　【凡数大小相乘中有空者必作○以存其位如此式有千有十有单而无百故于百作○以存其位】
　　又如有数一万○八百
　　一　○　八　○　○
　　【凡数以单位为根今此数无千无十而并无单故必补作三○以成五位则知首位是一万矣】
　　又如有数一十二万九千六百
　　一　二　九　六　○　○
　　【原数四位无空然无十无单故必补作两空以成六位则知首位为十万】
　　畸零列位式
　　凡整数自单而陞若畸零数则自单而析故单位者数之根也然整数之陞以十为等自单而十而百而千而万皆一法也【万以上有以十万为亿十亿为兆十兆为京自此而垓而秭壤沟涧正载皆以十而变谓之小数有以万万为亿亿亿为兆兆兆为京以上尽然皆以自乘而变谓之大数今所用者以万万为亿万亿为兆万兆为京以上尽然皆以万而变谓之中数三者不同然其列位皆以十为等故曰一法也】若畸零之式其故多端约而言之亦只二法其一以十为等其一不以十为等而各以其所立之率为等是二法者又各分二类列之各有其法【详后】
　　其一以十为等分二类
　　假如钱粮料则毎田一亩该五分九厘八毫六七忽九微三纎四沙八尘九埃二渺一漠
　　依法列之
　　○○五九八六七九三四八九二一
　　两钱分厘毫丝忽微纎沙尘埃渺漠
　　【右式今所通用自两而下以十之一为钱又以钱十之一为分分十之一为厘如是递析为毫为忽以至渺漠皆以十为等】【原科则自分起以至渺漠计十二位今加两○为十四位者乃列位之法也何也分之上有钱钱之上有两两为单数凡列畸零之数必以单数为根始便合总故两数虽空必存其位也】
　　凡度法以丈为单数则其十之一为尺又十析之为寸为分为厘毫丝忽之属【亦有以尺为单以寸为单者皆如所设】
　　凡量法以石为单数则其十之一为斗又十析之为升为合为勺之属【亦有以斗为单数者皆如所设命之】法并同上
　　右法以十为等即以一位为一名如上位是两下一位即是钱此为一类
　　假如授时厯法毎一平朔二十九日五十三刻零五分九十三秒依法列之


　　【右式日为单数而以日百析之为刻又百析之为分又百析之为秒故列位时必作防以志之使知日下二位始为单刻由是而分而秒皆隔两位而变其名然仍是以十为等　凡作防必单位如日为单位下又有单刻单分单秒之属】
　　凡开平方尺有百寸寸有百分其法同上
　　凡开立方尺有千寸寸有千分则三位而变即隔三位作防以志之法亦同上
　　右法虽亦皆以十为等而不以一位为一名或隔两位或隔三位前法只寻单位即知其余此法单位之下仍须各寻单位盖前法之分秒只有单而此法分秒各有十有百故必以作防之处知其为单分单秒是与前法微别又为一类也其一不以十为等而各以其所设之率为等亦分二类
　　假如回囘厯法以六十分为一度六十秒为一分太阳三十日平行二十九度三十四分一十秒作何排列


　　【右以度为单数下两位为分又下两位为秒故作防志之畧同授时然皆以六十而进非以百也其自秒以下为微纎等数凡在授时以百为数者回回之法皆以六十为之是虽不以十为等而所设六十之率钜细同法西洋法亦然】
　　又如古量有以四升为豆四豆为区四区为釜皆以四为率又如杨子云太以三方统九州二十七部八十一家其递析也皆以三
　　又如测量家以矩度分十二度每一度又分十二分是又以十二为率也右诸率皆不用十而所用之率屡析不易是为一类
　　假如物重十六两为一斤二十四铢为一两今有物二斤四两半作何排列


　　【此以斤为单数斤下二位为两又下二位为铢铢与两皆斤之分秒也故作防志之亦同前法但铢以二十四为率两以十六为率二率不同】
　　又如厯家以甲子六十为旬周每日十二时又分初正【西厯谓之二十四小时】每各四刻每刻有十五分今依新法筭得辛未年冬至为旬周之第五十日二十二时二刻七分依法列之


　　【此以日为单数下二位析日为时又下一位析时为刻又下两位析刻为分皆日下之畸零也然时之率二十时刻之率四分之率十五各率不同所当细玩】
　　右法既不以十为等而所用之率又不齐同是又一类也【此二类不以十分为率而各有其率即通分子母之法也但通分以子母并列又是一法别卷详之】并法
　　凡数合总法当用并有诸数于此并而合之为一总数又名垜积即珠盘之上法也【数相并则相益而多故亦名加法在钱谷之用则所以稽总撒】
　　法曰置所有防数几宗各依列位法自上而下对位列之万千百十单各以类从
　　列讫仍并之自上而下如画卦之法
　　数满十者进位作号而本位纪其零
　　纪号式
　　丨□□□□丅□□□【此古算位也用以别原数便稽核也】
　　假如有丝八百九十二斤又一千○八十八斤又【三百五十斤　合之若干】
　　如上式防数三宗依法列位并之
　　得总数二千三百三十斤


　　假如有绢四丈五尺六寸又五丈○三寸又八丈五尺合之若干



　　九减试法



　　【凡九减之法不论单十百千之位亦不计○位只摢现有之数而合计之先减减数首行八九二合得十九减去二九余一以合次行一八八共得十八减去二九恰尽只余三行三五合成八数纪于右次减总数二三三合得八纪于左　左右相同知其不误】





　　【第二图先减防数首行四五成九减去余六合次行三成九减去余五合三行八五共十八成二九减尽纪○于右　次以总数一八九成二九减尽纪○于左　左右相同知其无误　或问九减不计上下之位何也曰此防法也凡九减者数不变假如以九减一十则仍余一减二十则仍余二推之百千万亦然故不论位】七减试法




　　【凡七减与九减不同须论位减实数　第一图先减防数自上而下头一排只有一作一十算合第二排八三得十一共二十一以七减之尽第三排九八五合得二十二以七减之余一作一十合第四排八二得十共得二十以七减之余六纪于右　次减总数亦自上起首位无七有二合第二位作二十三以七减之余二又合第三位作二十三以七减之余二合末位○作二十减二七余六纪于左　左右相同不误】




　　【第二图先减防数头一排四五八合十七以七减之余三作三十合第一排两个五成十共四十以七减之余五作五十合下六三成九共五十九以七减之余三纪右次减总数首两位十八以七减之余四合第三位○作四十以七减之余五作五十合下位九共五十九以七减之余三纪左左右相同不误】
　　畸零并法
　　假如有物十斤四两十二铢又九斤十一两十二铢共若干
　　答曰二十斤
　　【铢数并得卄四成一两进位并原数共十六两成斤进位并原数十九斤
　　共卄斤铢率卄四两率十六不同故以防隔
　　之凡率不同难用九减七减只以减法
　　还原其法于总数内减原防数一宗其余一宗必合减余是为无误减法
　　见后详通分】
　　假如品官计俸原厯任过三年○九个月今又歴任一年十一个月共若干
　　答曰共歴任五年○八个月
　　【先并月得二十再以十二个月成一年进位纪号余八个月次并一年三年加所进一年共五年并得五年○八个月此因月法十二非以满十而进故以防隔之此亦非满十而进不用九减七减只以减法还原】
　　递加法
　　假如授时厯歳实【三百六十五日二十四刻二十五分】两次加气策【一十五日二十一刻八十四分三十七秒五十微】共若干
　　答曰【三百九十五日六十七刻九十三分七十五秒】






　　此递并法借前总数当防数用之如此则可以层累而加
　　【前条三百八十○日四十六刻竒是从嵗前冬至算至本年小寒此条三百九十五日六十八刻弱是又算至本年大寒】
　　截小总法【凡并法头项太多者截分小总则易清乃垜积之防法】
　　假如河工一十二宗一工【五千○十四工】又【三千三百工】又【八百九十一工】又【二千○九十工】又【九百○九工】又【一千○八十工】又【二千○二十工】又【九十一工】又【六百六十七工】又【四千七百工】又【七百三十工】又【八十二工】问共数
　　答曰二万一千五百七十四工
　　法曰【先以河工十二宗任分为三段依法并之各成小总再合各小总依法并之为一大总合问】





　　【或有极多至百十宗者宜多分小总小总又并为小总末乃并为一大总变繁为简最便覆核】减法
　　凡数相较法当用减有两数于此以相减则得其大小之较也有全数于此减其所去则得其留余之数也【在钱糓之用则减为开除减余为实在若收受则所减为已完减余为未完其法与并法正相对其用亦相需也】
　　法曰置原数于右置减数于左依列位法自上而下对位列之【若两数相较则以大数列右以当原数小数列左为减数】乃以两数相较以少减多【原数必多减数必少若原数反少则有转减】减讫列减余之数于左行
　　凡减自下小数起本位无可减借上位一数化十而减之则于上位作防以为志【还原时即用此防为进位之志或不用防用短直亦同】
　　假如有库银十万两支放过五万九千五百○三两问存库若干　答曰四万○四百九十七两



　　【此因数万以下俱空故皆用借十作防之法自最下两位起两位空作防于上位借十两减三存七　支数原无十两因借减之防宜减十两而十两亦空复作防于上位借一百内减一十存九十　支数五百加借防共六百亦作防借一千减六百存四百　支数九千凑借防成一万作防于万位凑原支五万共六万又作防于首位借十万减六万存四万】
　　还原用并法【即借用本图】从两位起以支放三两并存留七两得十两作防于十两位凑存留九十两成一百两又作防于百位凑支放五百存留四百并得一千作防于千位凑支放九千成一万作防于万位凑支放五万存留四万共成十万作防于首位至此存留支放俱无可辏浄十万两作一十万字于原银位合总无差
　　递减法
　　假如有应进贡【貂皮一千五百张收过九百○五张次年补收四百九十五张仍欠若干】答曰【一百张】

　　【以头一次九百○五张依法减原额一千五百张得减余五百
　　九十五张为欠数次以补收四百九十五张减欠
　　数五百九十五张得减余一百张为仍欠数】

　　因两次递减亦减两次试之
　　【九　六　七　二　先以原额减余数列右减　□　减　□　合收欠减余数列左】
　　【试　一　试　○　次以欠数取减余列右法　□　法　□　合续收仍欠减余列左】
　　还原【倒用前图】以仍欠一百并续收四百九十五得五百九十五合前欠数　又以欠五百九十五并先收九百○五得一千五百合原额　凡递减者亦以递并还原
　　透支转减法
　　假如有钱一万五千○三十文陆续支用过一万六千○五十文该有透支若干答曰净多支一千○二十文



　　此因支数多于原数故以原数转减支数而得透支之数【凡两数相较多寡皆仿此】
　　还原以多支一千○二十并原钱一万五千○三十
　　得一万六千○五十合支用数
　　畸零减法
　　假如有地丁银三千五百零三两徴完三千二百一十两零三钱五分仍未完若干　答曰二百九十二两六钱五分



　　还原以已完未完相并得数合额编之数【此原数至两而止因减而有钱与分之数盖以两为单数其钱为两十之一分又为钱十之一皆畸零也】
　　假如授时厯毎月二节气共三十○日四十三刻六十八分七十五秒经朔二十九日五十三刻○五分九十三秒两数不同是生月闰该若干
　　答曰月闰九十○刻六十二分八十二秒
　　太阳节气　　　　　　　　　此经朔减节气也
　　太阴经朔　　　　　　　　　经朔小节气大相减
　　月闰　　　　　　　　　　　之较是为月闰还原以月闰并经朔得总即仍合节气之数


　　假如品官计俸以三年为满今厯任过一年零七个月该补若干　答曰该补一年零五个月
　　【此以十二个月为一年故减法不同
　　先减七个月月位无可减作防于年位借一年为十二月减七存五
　　次减一年并所借一防共二年以减三年余一年】
　　还原以己厯一年○七个月补俸一年○五个月相并得三年合总
　　假如有海濵田一百三十一顷四十亩被潮坍损二顷八十五亩一百五十九步仍余若干
　　答曰仍存田一百二十八顷五十四亩八十一步解曰【此以百亩成顷二百四十步为亩故列位时须作防别之而减法亦同
　　先减一百五十九步原数无步作防于亩位借一亩
　　为二百四十步纪号于原位乃如法减之】
　　仍存一二□五□○八□
　　还原以坍损田及仍存田相并得原田数合总右二式畸零之率不同难用九减七减只以并法还原【余详通分】
　　钱粮四柱法
　　四柱者旧管新收开除实在也各衙门造册必归四柱则收放可稽在笔算为减并合用盖旧管新收用并法开除用减法其实在则减余也亦有减尽无余者则无实在即于实在项下直注曰无其事件创立前无所承者则无旧管亦有存留不动之项则有旧管而无新收其法并同【如无旧管则注曰旧管无或无新收则亦曰新收无】若所出浮于所入则为透支当用转减之法也【开除本用以减今反将并旧管新收以减开除故曰转减】凡转减者亦当于实在项下注明【如云实在无外多支若干是也】式如后
　　假如藩库原存地丁银一十二万○三百○三两今于康熙三十年征收一百四十一万○五十五两六钱节次支放过一百二十二万二千○五两六钱问该存留若干答曰三十万○八千三百五十三两
　　【先用并法得旧管新收共一百五十三万○三百五十八
　　两六钱再用减法于共数内减去开除一百卄二万二千
　　○五两六钱得实在存留三十万○八千三百五十三两
　　以旧管新收共数与开四　除实在并数各依试法】
　　【四　左右列减余相同知其不误　九减七减并余
　　四可省一图】
　　假如仓内原存米四千四百石新收某处解到米五百○三石麦三千六百石奉文支放兵米五千石问实在若干答曰【米支放讫仍缺额九十七石麦实在三千六百石存仓】
　　麦
　　【法以旧管新收共米】　旧管　无
　　【四千九百○三石转】　新收　三六○○
　　【减开除五千石得缺】　开除　无
　　【项九十七石】　实在　三六○○

　　【试法合旧管新收加入缺项而九减七减之纪余于右　又单
　　用开除一项九减七减纪余于左以左右相同知其无误
　　凡转减者仿此试之】
　　假如某镇军饷原存二千一百○三两支放过正月分口粮折银一千八百○九两续于二月有某处解到协济银三千五百两于四月内发过草料银八百九十二两又制造盔甲银用过九百九十九两五钱续准某军门公文发到饷银一千○九十两问今库内现存若干　答曰仍存二千九百九十二两五钱




　　以上先用并法变六宗为两宗然后相减



　　若依四柱法则当以协济三千五百两院发一千○九十两另并为新收四千五百九十两
　　【九　六　七　三】
　　【试　□　试　□右试法并以旧管新收并为
　　一宗而九减之纪余于右以开除实在并为一宗而九减
　　之纪余于左七减亦然所不同者除实
　　在减至钱数则旧管新收亦必减至○钱位止然后左右
　　相较可以无误此七减之要诀所当熟翫】
　　淮仓销算【邸抄附録为式】
　　户部题为差委司属官员事查得淮仓监督将任内自康熙廿九年九月初六日起至三十年八月初七日止收放钱粮数目造册具题前来查册开旧管银三万八千一百一两五钱三分零米麦四万五千一百六十九石九斗三升零新收银一万二千一百四十八两九钱九分零米麦一万七千三百六十九石二斗六升零又收过商税等银三万一千六十四两八钱六分零内相符准销银一万八千三百一十五两一钱五分零米麦一千一百一十九石八斗四升零行查催解银三万五百五十四两八钱零米麦一万三千二百五十石八斗二升零存剩银三万二千四百四十五两四钱三分零米麦四万八千一百六十八石五斗三升零将解支欵项开后一解部银一万七千六百二两三钱五分零米一百三石毎石九钱折银九十二两七钱麦一千一十六石八斗四升零每石五钱折银五百八两四钱二分零等语查前项银两已经解到收讫无庸议一给门军口粮银七百一十二两八钱等语查系应给之项无庸议一解河工银五千八百一十三两二钱六分零查未开解交年月日期应令开明报部之日查核一给淮安等卫廿九年分行粮银五千三百两三钱二分零米麦一万三千二百五十石八斗二升零月粮银一万四千七百三十二两九钱查总漕未奏销应俟奏销到日查核一解淮安府银四千七百八两三钱二分零查卄八九两年解府银两尚未动支今何得又行起解应令作速解部一存剩银三万二千四百四十五两四钱三分零米麦四万八千一百六十八石五斗三升零应将此解部米麦存仓备用又收过房田税契银四百二两六分六厘零查前项银两已经解到收讫无庸议者奉
　　防依议　　今以四柱法核之如后










　　【桉此即原题四柱册也旧管者即四柱之旧管也新收及商税皆新收也准销即除存剩即实在其行查催解银则四柱中原作开作而部不准销改入实在之数也】法【以准销查催共数与旧管新收共数相减即得存剩】
　　细账













　　【仍原数不动】
　　以上并依法合总无讹
　　外有房田税契银另项附销不在四柱之内









　　厯算全书巻三十四
　　钦定四库全书
　　厯算全书巻三十五
　　宣城梅文鼎撰
　　笔算巻二
　　乘法
　　以数生数是之谓乗数不能自生相得乃生故乗亦曰因【生则不穷故乘有陻义生则日积故乘有载义】有一位乗有多位乗【或分一位曰因多位曰乘然古皆谓之乘今从古】皆有法有实有得数
　　【凡实数纵列于右凡法数横列于下纵横相遇而得
　　数生焉直行所对者法数也斜行
　　所对者实数也而纪得数则以横行定之
　　或问实何以对斜行曰法有进行故得数斜陞是故
　　右第一行是法单位乘出之数也其次行则法十位
　　乘出之数也又次而百而千视此矣故其乗得数不
　　出斜格　此虚位也单十百千周流迭居皆于临时
　　定之】
　　凡乘出数皆有本位有进位如有十数又有零数【三四一十二四四一十六之类】则纪零于本位【本格之右方】纪十于进位【上一格之左方】有十数无零数则纪十于进位而本位作○【五四成二十五六成三十之类】有零数无十数则纪零于本位而进位作○【一一如一二二如四之类】凡法实有空位则本位进位俱纪○
　　凡乘皆从法尾位起【即右第一行】对定实数相乗自下而上如画卦之法右行乘毕挨乗左行毎移一行必进上一位其各行中斜对实数自下而上皆如右行法
　　凡法与实有空位则无可乘然必于本位进位各作○以存其位【若实尾有空位则于合摠时补之】
　　凡各行乗讫必覆核之乃以并法合总而纪于左方以为得数实尾有几○皆作于总数之下
　　凡乗讫定位皆于原实内寻原问毎数为根以横行对定得数命为法尾数则上下之位皆定
　　凡数单乗单成单【甲为本位戊为进位】十乘十成百【乙为本位已为进位】百乘百成万【丙为本位庚为进位】千乗千成百万【丁为本位辛为进位】前图可明
　　定位又法【法曰有本数有大数有小数如原问是毎亩之价而原实恰止于亩数是本数也凡本数即用得数尾位命为法尾数　若原问是毎亩之价而原实只有十亩或只有百亩是大数也凡大数当于得数尾位下增○然后于所增○位命为法尾数若大几位亦增几○皆增至毎位止即命末○为法尾数也若原问是每亩之价而原实不止于亩亩下有分厘是小数也凡小数当于得数之尾截去之原畸零几位亦截去几位然后命之即所截之上一位为法尾数是也】
　　凡乗毕恐其有误宜用除法还原【置得数为实以法数为法除之即得原实或置得数为实以实数为法除之亦得法数】不则以九减七减试之尤防
　　【先以法数如法九减之而纪其余于右如甲次以实数亦九减之而纪
　　其余于左如乙再以左右两减余相乘得数仍九减之而纪其余于上方
　　如丙　末以得数亦九减之而纪其余于下方如丁　丁丙相同即知无
　　误七减亦然】
　　【先以法数实数各如法九减之而并纪其余如甲与乙　次以两减余相
　　乗得数仍九减之而纪其余如丙以上并居左方　末以得数亦九减之
　　而纪其余于右方如丁　视丙丁相同卽知无误　如甲乙二者内有一
　　○卽丙亦○又或甲爲一数卽丙数同乙皆不用乗　七减亦然】
　　一位乗式
　　假如有熟田三千五百一十九亩每亩编银六分问该若干答曰二百一十一两一钱四分
　　【法从下起先以法数六乘实数九呼六九五十四纪四于
　　于本位纪五于进位进乘实数一呼一六得六纪六于本
　　位纪○于进位进乗实数五呼五六成三十纪○于本位
　　纪三于进位进乘实数三呼三六一十八纪八于木位纪
　　一于进位　乘毕以倂法合总】
　　定位法　因原问是毎亩科则就于右行原实内寻每亩数为定位之根横对左行得数命法尾分则其余皆定【根是九亩横对是四分则上位是钱又上是两又上十两又上是百两定所得为二百一十一两一钱四分】


　　两位以上乗式
　　假如有金九钱八分五厘每两价银八两八钱问该若干　答曰八两六钱六分八厘
　　【先以法八钱乗实数五呼五八成四十纪○于本位纪四于进位进
　　乗实数八呼八八六十四纪四于本位纪六于进位进乗实数九呼
　　八九七十二纪二于本位纪七于进位
　　次进一位以法八两乗实五呼五八成四十纪○于本位进乗实八
　　呼八八六十四纪四本位纪六进位进乘实九呼八九七十二纪二
　　本位纪七进位乗毕以并法合总】
　　定位法【原问毎两之价而实无两当于实九钱上补作○两位为根以横对得数定为法尾钱即上下之位俱定】
　　定位又法【此小数也原问以毎两价为法而实有钱分厘共小三位即于得数截去尾三位定第四位为六钱】
　　【法实减余平列左上相乘而减之列左下
　　得数减余列右下以相同为定】
　　假如有钱三十万零五百八十文每千卖银九钱零五厘该若干
　　答曰二百七十二两零二分四厘九毫
　　【先以法数五乗实数八纪四○次乘实数五纪二五
　　次乗实数○○本位进　位俱纪○次乗实数三纪一五
　　进一位以法数○乘实○无可乘于本位进位各纪
　　○以存其位又进一位以法数九乘实
　　数八纪七二进乗实数五纪四五进乘两○纪○进
　　乗实数三纪二七乘毕以并法合总】
　　定位【原问是毎千之价当于原实内寻干位为根以对得数命为法尾厘则其余皆定】定位又法【此亦小数也实有十丈于原问毎干为小两位当于得数截去末两位定为法尾厘】


　　【此即前问也因法有空位省不乘但于法首九
　　钱起进二位乘之即得数无讹与前法同
　　本宜进一位乘九钱今进两位以合空位之数
　　若法有两空即进三位以上仿论】
　　假如星命家以年月日时配成八字【以七百二十乗七百二十】问共该若干
　　答曰五十一万八千四百
　　【如法乗讫并之得五一八四】
　　定一【原问七百二十年月下毎一数中各配七百二十日
　　时宜于原实下补作○单位为根以对得数定法尾十】或用又法【实数止于十大于毎数一位乃大数也宜
　　径于得数増一○位定法尾一】
　　解曰【六十年各十二月则前四字七百二十六十日各十二时下四字亦七百二十故以相乘即能尽八字之变】
　　假如西厯天度毎周三百六十今有星行天三百周该若干答曰一十万零八千度
　　【依法乘讫用并法合总得一○八】
　　定位【原问是毎周之度今实数是三百周当于原实下补作两○至毎周位止
　　以此为根横对得数定法尾十度而得数空补作一○上一位为百度位得数亦空
　　又补作○是得数无百无十也再上为千为万为十万定所得为一十万○八千】或用又法【星行三百周大于毎周两位乃大数也法径于得数下增两○
　　定末○为法尾十度即得数皆定】
　　【此先置三百六十为实而以三百周为法乘之也得
　　数一○八与前法同但变两位乘为一位乘其用更
　　简】
　　定位【用大数法以实止十度无毎位径于得数
　　下补作一○定为法尾百即得数定为十万○八千】
　　假如有珠子三分五厘毎两值银二十四两该
　　若干
　　答曰八钱四分

　　依法乘而并之得八四○
　　定位【原问珠毎两价今实数只有分乃进位作
　　○于钱位又上作○于两位两为根横对得数为法尾数
　　两而两位空补作　定所得为八钱四分】

　　定位又法【此小数法也实有分厘在原问毎两下三位宜截去得数末三位定法尾数两而得数只三位无可截乃补作○于得数之上然后截之定为○两】
　　此与前条金价并畸零乘法也【余详通分】
　　省乘法【古谓之加法】
　　假如有漕粮三百六十石毎石耗米四斗问正耗共若干答曰共五百○四石
　　此就身加法也【原数即当得数不动只挨身加四
　　先于六十石加四六二十四石又于三百石加三四一百二十石末
　　用并法连原数并之合总凡加法定位依原数不湏更求下同】

　　【加法九试七试略同并法并合原数加数减余列右共数减余列左此及下
　　条并九减七减俱无余】
　　假如银五十四两毎两月息二分五厘今两个月共本息若干
　　答曰共五十六两七钱
　　【此因所加是分在两下二位故隔位加　又因毎月二分半今两个
　　月该五分故以五分为法先于四两加二○进于五十加二五末以
　　并法连原数合总】
　　省乘又法【古谓之求一乘法】
　　凡法数之首为一数者即原数不动而挨身加之与前两条同也若法首非一数者以法变为一数则亦可挨加此为本非一数求而得之故名求一乗法也　其法遇法首为二为三则折半用之而倍其实　法首遇五六七八九则加倍用之而半其实　法首遇四则取四之一用之而四其实【如此则法首成一数可用省乘】
　　【凡求一乘法定位亦于原实内寻毎数为根以横行对得数定之但此所对得数恒为法首位数　若乘法则为法尾位数与此不同乃理势之自然不可不知】
　　假如前条珠三分五厘价毎两值银二十四两用乘法得价银八钱四分今以法数折半作一十二两实数加倍作七分挨身加之所得正同而用加防矣
　　【原数不动即用为法首一数所乘也挨身以法次位二与原数相乘呼二七加
　　一十四本位纪一下位纪四加讫以并法合总亦连原数作数并之】定位【亦从原数七分上加两○寻毎两位为定位之根横对左行总数得法首
　　位是十两下一位是两俱空位补作两○再下一位即钱定所得为八钱四分】
　　又如前条钱三十万○○五百八十文毎千价九钱○五厘以钱折半【十五万○二百九十】为实价加倍【作一两八钱一分】为法
　　【原数借为得数不动　以法去首位一只用八一挨身加
　　之自下起于九加七二九于二加一六二其○位无加于
　　五加四○五于实首一加八　一加讫合　原数并总】定位【寻原数千位为根横对左行得数得法首两位】
　　并乘法【凡有数次乗者并为一次乗亦算家简法旧谓之异乗同乘】
　　假如原本银三千二百两毎两一年获息一钱五分六厘二毫五丝已经四年该息若干　答曰二千两
　　【法先以三千二百两乘四年得一万二千八百两再
　　以息银乘之是并两次乘为一次乘也】





　　截乘法【凡乗法位多者截作数次乘之以便初学其法与并乗相反而其理相通】
　　假如有三十二人各给布六丈四尺共若干
　　答曰二百○四丈八尺
　　【先置六丈四尺以十六人为法用省乘就身加六得一百○二丈四尺又
　　二乘加倍合总解曰十六乘又二乘即三十二乘也】定位【凡就身加者原数即可定位如前条漕粮毎石加四斗是也此
　　条是十六加首行六四虽以原数当得数而六丈四尺已陞为六十四丈
　　矣　若加倍自是本位此在用算者临时消息之也】
　　或置三十二人以八丈乘两次亦同




　　解曰八乘二次即六十四乗也
　　或置六丈四尺以四乗之得数又以八乗之所得亦同





　　解曰四乗一次又八乗一次即三十二乗也










　　除法
　　以数剖数是之谓除除其原数以归各数故除亦曰归【除与乘对理精用博近或谓之分义则浅矣】
　　有一位除有多位除【或分一位曰归多位曰除或曰归除曰混归然古皆曰除】皆有法有实有得数【得数一名商数】
　　实其物也法其则也法实在乘法或可互用而除法必须审定乘法以法与实相遇而生一数如阴阳相交而生物也故虽互用而其交之理不易其生之用亦不易也除法以实满法而成一数如镕金以就型也故曰实如法而一若倒用之则非矣【实如法而一或变文曰如某数而一如用三除者省文曰以三而一言以三数成一数也而字皆连上为文或者不察遂竟以而一当除之字义失其防矣】定法实诀
　　凡审法实有二诀一曰先有定则即以定则为法其所除者必同名之物也【如有定则之银为法而除总银以定则之米为法而除总米是也】一曰先无定则而求定则须详问意以所用求之者为法其所除者必异名之物也【如以总米除总银以总银除总米是也】何以为先有定则也以事明之如银籴米而先知每米一石之银若干是先有定则之银也即以此定则之银为法而以总银为实以法除实则得总银所籴之总米矣【此为有总银数又有米毎石之银数故以银除银而得总米】
　　若先知毎银一两之米若干是先有定则之米也即以此定则之米为法而以总米为实以法除实则得总米所粜之总银矣【此为有总米数又有银毎两之米数故以米除米而得总银】
　　是皆所除者同名而所得者异名也又谓之以毎数求总数【凡以毎数求总数者以每数为法毎数即定则也以比例求之更明图具左方】




　　何以为先无定则而求定则也如有总米又有总银而无毎数则当于问意详之问者若欲知每米一石之银是以米分银也则以总米为法总银为实问者若欲知每银一两之米是以银分米也则以总银为法总米为实是所除者异名而所得者亦异名也又谓之以总数求每数【凡以总数求毎数先无定则故必于问者之所求酌之亦有比例之理】




　　又防法
　　凡不动者为法动者为实何以明之如有总米总银而欲知毎米一石之银则将变总银为每米之银是银动而米不动也故以米为法若欲知每银一两之米则将变总米为毎银之米是米动而银不动也故以银为法其以毎数求总数者先有定则不动即用为法尤为易见
　　凡布算乗易而除难除法之难尤在法实法实无误则思过半矣此乃珠算笔算所同也故首辨之如右若笔算除法更有宜知者数端具如后方
　　一列位【法实既辨即当列位】
　　其法先作两直线自上而下平行相望约其间可容字两行为率其长短则视位数多寡定之先以实数列于右直线之右自上而下依列位法书之次以法数列于右直线之左亦自上而下其千百十单皆与实相对或法数有千而实只有百者即对书于上一位余皆仿此亦有实数无分秒而法数有之者亦对书于实尾之下次约实以求得数【得数亦名商数】
　　以法约实纪其得数于左线之右视法首位是言如之数【如三三如九之】则书于实之上一位而于实首添作○以遥对之或法首位是言十之数【如二六一十二之类】则书于实首之对位其次商三商以上皆依此书之若书之而不相接辏是商数有空位也补作○此定位之根慎不可错次乘商数求应减之数以减原实
　　以商得数与法数相呼乗之而纪数于左线之左皆以乘数之进位对商数纪之【如二六一十二则以一十对商数书之如三三如九是为○九则以九上之○对商数书之他皆仿此】乃遂以乗出数与右行原实对减【周减法】足减者于原实抹改之不足减者改商数其乗出数亦抹去便续商也
　　次定得数之位
　　先于法数之上一位作□为识以对得数命为单位等而上之则十百千万等而下之则分秒忽微皆从此定
　　次命分
　　除有不尽者以法命之用法数为母不尽之数为子命为几分之几
　　次还原
　　凡除法恐其有误当以乘法还原用法数与得数相乗除有不尽者并入之即得原实
　　又法仍以除法还原用得数为法转除原实即复得法数除有不尽者以减原实为实然后除之
　　又法以九减七减试之以法数九减七减皆用其所减之余纪右再以得数如法减之纪其余于左左右两余数相乗仍如法减之纪其余于上方末以原实亦如法减之纪其余于下方上下相同则无误矣
　　又简法作直线于左方以应减之数依并法并之必合原实有不尽数亦并入之【此法更简更确】
　　按笔除原法以法实上下相叠不论数之何等【谓十单分秒之等】而但齐其尾殊欠条理又以得数横续于法实之尾定位易淆今法与实皆用真数相对而宜减之数先列左方对减无误即古人实如法而一之故了了分明据法首定位尤为简快
　　一位除式
　　假如有额编地丁银二百一十一两一钱四分其科则毎亩六分问原地若干
　　答曰三千五百一十九亩
　　审法实诀【此为以毎数求总数也其毎数六分为先有之定则不动故以为法】





　　【右并法还原即用原列应减之数并之必合原实是为简法】列位法【如法作两直线先以实数二一一一四列于右直线之右自上而下顺布之次以法数六列于右直线之左因法系六分故与实分位相对】
　　商除法【次以法数约实法是六实是二以六除二当合下位作廿一除之商作三以乘法六呼三六一十八是言十之数将商得三以法首二书于左直线之右以乘得一八书于左直线之左因是言十之数以乗得进位一字对商数三字书之遂以此乘得一八用减法与原实二一对减先于实次位减八实系一不足减作防借上一数为十一减八余三改书三于实一之右次于实首位减一实系二因借去一防只作一减尽作○乃作线抹去二一存○三亦于左作线抹去减数一八】
　　【次商以六除三亦当合下位作三一除之商作五以乘法六呼五六成三十是言十之数将次商五对实三字书于初商之下亦以乗得三○依法以三字为进位对次商五字书于左直线之左依法对减实三】

　　【作○仍作线抹去实三亦于左减数抹去三○三商以六除一合下位作十一商作一呼一六如六是言如之数将三商一对实上位一字书于次商五之下依法以乘得○六对所商一字书于左线之左以对减实一一以六减一不足减作防借上成十一减六余五改书　五于右抹去一一亦于左减数抹去○六末商以六除五亦合下位作五十四商作九呼六九五十四是言十之数将商得九对实五字书于三商一之下依法以乘得五四对所商九字书左线之左以对减实五四恰尽俱改书○而抹去五四左减数亦抹去　共商得三五一九】
　　定位诀【于右线法数六字上一位作□为单位之识以横对左得数九字定为单九亩进位是十亩又进百亩又进千亩命所得为三千五百一十九亩】
　　乗法还原【以法六分乘得数三千五百一十九亩仍得原实见乗法】除法还原【以得数为法除原实仍得法数六分　见后条】试法
　　【九减得数无余纪○于左法数余六纪于右左右相乗仍纪○于上
　　九减原实无余纪○于下凡○位与他数相乗所得皆○】

　　【七减得数余五纪左法数余六纪右左右相乗仍以七减余二纪于
　　上七减原实余二纪于下两试皆上下相同知其不悮】
　　【论曰除法以乘法还原犹之乘法以除法还原此旧法珠算所必需若除法以除法还原则旧所无也同文算指用九减七减试法可免还原颇称巧防今以并法代之则试法亦省故称简法焉兹各具一则用相参互以明筭理握算者择而用之可也今定笔除只用简法还原若笔乘仍用试法】
　　多位除式
　　假如有熟地三千五百一十九亩共征银二百一十一两一钱四分问每亩科则若干　答曰毎亩六分审法实【此以总数求毎数也问者欲知毎亩科则是将以总银变为毎银银数动地亩不动故以地为法银为实】
　　列位法【先以实数自上而下顺布于右线之右次以法数对书于右线之左实首位是二百法首是三千法大于实一位故进一位列之凡进位列者皆不满法】





　　商除法【以法数约实法首是三实是二合两位二一除之宜商七因法有次位须留余地改商六以乗法三呼三六一十八是言十之数以商数六对实首二书于左直线之右以乘得一八书于左线之左遂以商数六徧乗法次位五呼五六成三十乗得三○挨书于一八之下一位又以商数徧乗法第三位一呼一六如六乘得○六挨书下一位又以商数六徧乗法末位九呼六九五十四乘得五四又挨书下一位如此徧乗法四位讫乃以乘出数为减数对减原实恰尽】
　　定位【寻法首上一位为单位横对左线得数上二位定为两顺下一位是钱此二位俱空补作○○再下是分定所得为六分】
　　此一次除尽例也又为法大实小故所得不能成整数【两为整数今所得是分在两下二位】
　　【若用乘法还原同前条还原法若用除法还原即前条除法】
　　此所定单位在得数之外乃借虚位以定实数【下条同】其故何也曰法是三千有零能满此数始能成一两故曰实如法而一今法大实小是实不满法不能成一数所得者乃剖一整数而得其若干如此条所得乃百分两之六也【详命分】
　　假如有银八两六钱六分八厘换金毎金一两该银八两八钱问换金若干
　　答曰九钱八分五厘
　　定法实诀【此为以银除银金价八两八钱是先有之定则不动就以为法】






　　【如前法对列法实于右线之左右初商法八实八宜商一因无次商改退商九以乗法八得七二又乗法次位八亦得七二依法挨书遂以对减实三位八六六余○七四　次商八以乘法八得六四乗法次八亦得六四依法书之遂以对减余实七四八余○四四　三商五以乗法八八得四四○依法书之遂以对减余实恰尽】
　　定位【法数上一位为单位横对得数上一位是两定为○两九钱八分五厘法实首位同而法次位八大于实次位六故亦借虚位以定实数説在前条】
　　【甪乗法还原见乗法第二条　用除法还原以金九钱八分五厘为法除实得毎两价八两八钱即畸零法也详通分】
　　假如有银四万八千两六十四人分之该若干
　　答曰各七百五十两





　　假如有银二百七十二两○二分四厘九毫毎钱一千银九钱○五厘问钱若干　答曰三十万零五百八十文定法实【此先有定则九钱○五厘故以为法】
　　【此法有○位例也亦是得数有○之例
　　初商三以乗法九得二七法次位空无乘挨作○○以存其位
　　再乗法末位五得一五各如式书之以对减原实二七二○余
　　○○○五　实空位无可商次商从实五字起商作五以乘法
　　九得四五法次位空亦作○存位　乗法末位五得二五如式
　　书之以对减实五二四九余○七二四】
　　【初商三乗九得二十七是言十之数宜对实首位二字书得数三次商五乗九得四十五亦是言十之数宜对余实首位五字书得数五如此审定而书则乘出减实之数与实相对了了分明便知不误然初商次商不相接续所差二位是得数有二空位也补作○○于初商次商之间以存得数之空位如是则次商之事毕　末商八以乗法九得七二法次位无乘亦作○存之法末位乗得四○以对减余七二四恰尽】定位【此因所问是毎千之价故千即单数也从法上一位横对定为千文之位上为万又上十万定所得为三十万○○五百八十文】
　　若以数三十万○○五百八十文为法除原实二百七十二两○二分四厘九毫亦复得九钱○五厘为毎千之价如后图
　　审法实【此问钱价是以钱分银故以总钱为法总银为实】
　　列位之理【所欲知者毎千之价故以千为
　　单以万为十以十万当百与原银对列
　　其书商数如式不错则得数之空位自明定位亦自无
　　舛説见前此两条互相还原　若以
　　乗法还原并用乘法第三条】

　　命分法
　　凡除法至单而止故曰实如法而一所谓一者即单一数也其有除至单数而仍有不尽之余实或法之数本大于实皆不能成一整数则以法命之其法有二其一除之至尽如计轻重者不满一两则除之为若干钱若干分及厘毫丝忽前条法大实小及得数单下仍有数位者是也【若授时厯万分为度百秒为分及钱钞论贯贯之下有百冇十有零文尤为易见】其一以法数为分母不尽之数为分子命为几分之几【如以三除五内除三数满法成一整数余实二不能成整则以此二数各剖为三分共成六分而以三除之各得二分是为三分之二也】假如十九人分银二百五十四两问各若干
　　答曰各十三两零十九分之七
　　【以十九人为法除二百五十四两各得一十三两不尽七两以法命
　　之　其法以法十九命为分母不尽七数为分子命为十九分两之
　　七　解曰一整两各剖为十九分则不尽之七两共剖为一百三十
　　三分以十九人分之各得七分并整数分数为毎人分得一十三两
　　零十九分两之七】
　　【若用乘法还原法以十九人乗得数十三两得共二百四十七两加
　　八不尽七两共二百五十四两合原实】
　　【若用除法还原　法置原实内减不尽之数七两余二百四十七两为实毎人十三两为法法除实得十九人】
　　论曰古人只用命分后世乃有除之至尽之法然终不能尽【如以十九人除七两各得三钱六分八厘四毫二丝一忽终余一忽】故不如命分之简妙【如钱粮尾数一忽之下仍冇微纎等七位不等徒滋繁文无禆实用然亦终不能尽若命分之法只一语喝尽更无渗漏然后知古法为无】
　　省除法【旧名定身除亦名减法凡法首位是一数者用之】
　　假如漕粮正耗共五百○四石每正米一石除耗四斗问正米若干
　　答曰三百六十石
　　【先以原数五定正数为三书直线左以应减耗数四乗所定正三得
　　耗一十二并正三共得四二以减原数五○余○八次以余数八定
　　正数为六书正数三之下以减耗四乗六得二十四并正六共得八
　　四减余数恰尽合得数减数并之即还原数或用
　　加四亦同】
　　定位【凡省除皆以原数定位】
　　省除又法【古谓之求一除法】
　　凡定身除惟法首是一数者可用今以倍半之法求之则法首皆变为一数
　　其法遇法首位是二是三法实皆折半遇四则折半两次遇五六七八九法实皆加倍【如此则法首位皆成一数】假如前条六十四人分银四万八千两用除法各得七百五十两今以法实各折半两次用定身除所得亦同
　　【先以法六十四折半作三十二又折半一十六为法实四万八千折
　　半作二万四千又折半一万二千为实用定身除法先以实首两位
　　一二定七为得数法去首位一不用只用六以乘得数七得四十二
　　书左并得数七共一一二以减原实一二余○○八次以余实八定
　　五为得数亦以法六乗得三○挨书于左以减余实八恰尽】
　　定位【得数七对原实千因法是有十之数退一等作七百定所得为七百五十石　假如十人七千即毎人七百故法有十者退一位也凖此推之法有百退二位有千退三位万以上仿此论之凡省除依原实定位当知此诀】
　　并除法【旧名异除同除】
　　凡有当除数次者则以法相乗为法作一次除之亦简法也【如以四除之又以五除之又以七除之则以四乘五得二十又以七乘得一百四十共为法以除之是并数次除为一次除也】
　　假如经商获利二千两原本三千二百两已经四年问毎年毎两之息
　　答曰毎两息一钱五分六厘二毫半

　　法曰先以四年乗原本【三千
　　二百】得【一万二千八百】为总法【本法宜以
　　二千二百除二千得毎两之息再以四年除之得毎
　　年毎两之息今并两次除为一次除足简法也】

　　截除法【与并除相反所以便初学】
　　凡除有法数位繁者或可以截为两次除以从简易假如五十六人分银【一千五百一十二两】各若干
　　答曰各二十七两




　　【此因法五十六是七八相乘之数故先以八除得一百八十九两仍用为实再以七除之得二十七两合问】
　　【或先用七除得数二百一十六两复以八除之亦得二十七两为毎人数】


　　【右省除式也只作一直线书原实于右纪得数于左而以九九数呼而减之不必另书减数凡法只一位者用此为便】
　　假如铜一百二十八斤价二十两问毎斤若干
　　答曰毎斤一钱五分六厘二毫半【原法三位今用截除三次俱一位为法可用省除】







　　假如银一千○八十两置田二百一十六亩问田价每亩若干
　　答曰五两　【原法三位今用六除三次亦同】





　　约分法
　　凡命分有可约者以法约之古法曰可半者半之不可半者以少减多更相减损求其有等以等约之【以等数除母子数则皆除尽西人谓之纽数】
　　假如八十一人分银二十七两问各数　答曰各得三分两之一
　　法曰【以八十一除二十七不能各得一两依命分法八十一为分母二十七为分子命为八十一分两之二十七又以法约之为三之一】解曰【八十一是三个二十七若剖毎两为八十一分即各得其二十七分是三之一也】
　　分母八一　【约分法曰置分母八十一用递减法以分子二十七减之余五十四复以二十七减】分子二七　【之仍余二十七如是则两数齐同是有等也即用此等数二十七为法转除分母八】减余五四　【十一得三除分子得一如此则不用细分但以毎两均剖为三而各得其一分即三又减分子】二七　【人共一两也若分子是五十四则用转减法以子五四】仍余二七　【转减母八一余廿七又以母余二十七转减子五四亦余卄七是相等也就以此等数卄七为法除母八一得三除子五四得二是为约得三之二】
　　假如米八十五石分结一百○二人问各若干
　　答曰各得六分石之五
　　法曰【人多米少不能各一石依命分法以一○二为分母八五为分子命为一百○二之八十五以法约之为六分之五】【约分法曰置分母一百○二以分子八十五减之得余十七用转减法以余十七减分子八十五余六十八又递减之余五十一又减之余三十四又减之余亦十七是相等也就此等数十七为法转除母数一百○二得六除子数八十五得五约为六分之五解曰一百○二是六个十七八十五是五个十七故曰六之五即六人共米五石也若以米毎石均分六分八十五石共得五百一十分为实以一百○二人为法除之得五是毎　所得为一石米中六分之五也】







　　厯算全书巻三十五
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　歴算全书卷三十六
　　宣城梅文鼎撰
　　笔算卷三
　　异乘同除法
　　以先有之数知今有之数两两相得是生比例莫善于异乘同除乃古九章之枢要也先有者二今有者一是已知者三而未知者一用三求一故西法谓之三率今先明同异名之説以着古法次详三率之用以显通理
　　异者何也言异名也同者何也言同名也假如以粟易布则粟与粟为同名布与粟为异名也
　　何以为异乗同除也主乎今有之物以为言也假如先有粟若干易布若干今复有粟若干将以易布则当以先所易之数例之是先易之布与今有之粟异名也则用以乗是谓异乗若先有之粟与今有之粟同名也则用以除是谓同除皆用以乘除今粟故曰主乎今有以为言也【置今有粟以异名之布乘之为实再以同名之粟为法除之是皆以今粟为主而以先有之二件乘除之也】





　　问何以不先除后乗曰以原总物除原物总价则得每物之价以乗今有总物亦可得今有之总价然除有不尽则不可以乗故变为先乗后除其理一也
　　假如原有豆一百○八石价银三十六两今有豆一百三十五石问价若干
　　答曰四十五两


　　法曰置今豆一百三十五石以原豆价三十六两乗之得四千八百六十两为实以原豆一百○八石为法除之得四十五两为今豆应有之价【见以物求价也若还原则以价求物】
　　假如原有银四十五两买豆一百三十五石今有银三十六两问豆若干
　　答曰一百○八石
　　法以豆一百三十五石乘价三十六两得四千八百六十石为实以价四十五两为法除之得一百○八石合问西人三率法
　　其法以先有之二件为一率二率今有之二件为三率四率则前两率之比例与后两率之比例等故其数可以互求
　　【今冇之二率先只有其一合前有之二率共为三率以求之而得今有之余一率是以三求一故曰三率法实四率也】
　　假如一率是三二率是四三率是九则四率必为十二何也三与四之比例若九与十二也故以四【二率】九【三率】相乘【卅六】为实以三【一率】为法除之必得十二【四率】
　　若互用之以四率为一率则十二与九之比例若四与三故曰可以互求【此即还原之理】
　　【解曰以三比四以九比十二并三分加一之比例以十二比九以四比三并四分减一之比例凡言比例等者皆如是
　　此以上图之四率为
　　一率也故其序皆倒
　　而所得四率即上图
　　之一】
　　又更而互之




　　凡二三相乘与一四相乘等积此立法之根观右图可明【四九相乘三十六而十二与三相乘亦三十六故以三除三十六得十二以十二除三十六亦复得三此前两图互求之理若更一四为二三其实同为三十六故以四除之得九以九除之亦复得四此后两图互求之理】
　　又错综之




　　此又以前图之二与三更之则前两率之第二变为后两率之第一而其比例亦等【凡一率二率为前两率乃先有之二件也三率四率为后两率乃今有之两件也今以二率三率相易则是先有之次率变为今有之首率也然以比例言之在前图为三与四若九与十二者在此图则三与九亦若四与十二也】
　　若以一率除二率得数以乗三率亦得四率【如以一率三除二率九得三以乘三率四亦必得四率十二以一率四除二率十二得三以乗三率三亦得四率九但先除后乗多有不尽之分故异乗同除为算家大法乃中西两术所同也】
　　试仍以古图明之
　　原有小麦十二石　换食盐九石　【俱四分之三比例若以上□左】今有小麦　四石　换食盐三石　【右更置即成三率之前四图】
　　更之【以纵为横】
　　原有粱米　三石　换棉布九疋　【俱三倍之比例若以上下左右】今有粱米　四石　换棉布【十二】疋　【更置即成三率之错综四图】辨法实
　　凡三率之用皆以二率乘三率为实首率为法除之以得所求为四率
　　然何以定其孰为一率孰为二率三率也曰此则古人同异名之法不可易也诀曰凡今有之已知者常定为三率【其未知者待算而知则常为四率】视先有之物与三率之今有同名者定为首率其与今有异名必为二率矣
　　又诀曰凡三率之法以三件求一件其所求之一件未知而三件则巳知也此已知之三件中必有两件同名【如价与价物与物之类】就以此同名之两件审其孰为先有定为首率【其今有者则为三率而其余异名之一件亦必先有也恒为二率】
　　假如有句股形田长一百三十五步阔四十五步今截相似形长一百○八步问阔若干
　　答曰截阔三十六步







　　定法实诀
　　以今截长一百○八步定为三率长与长同名以原长一百三十五步定为首率濶与长异名以原濶四十五步定为二率
　　又诀【此巳知之三件是原长原阔截长内长与长同名以原长是先有之数定为首率截长是今有之数为三率原濶与长异名为次率】
　　按原长与原濶即大句大股截长截濶即小句小股也四者皆可以递互相求三率中更互错综之理尤为易见




　　以比例言之大股与大句若小股与小句也更之则小股与小句亦若大股与大句也此为以股求句反之而以句求股则大句与大股亦若小句与小股也又更之则小句与小股亦若大句与大股也




　　又错综之则大股与小股若大句与小句也而大句与小句亦必若大股与小股矣又小句与大句若小股与大股也而小股与大股亦必若小句与大句矣是为三率之八变
　　异乘同除定位法
　　三率定位与乗法除法无异【乗法以实单位为根定所对得数为法尾数除法以法首上一位作识定所对得数为所求单数并详前巻】但所用之实以二率三率相乗而得握算者或疑其数之骤陞而不能守其定法则定位必讹而其理益晦矣故复论之【诸家算术往往有定位不确者皆由见乘后数多未免惊怖而輙为酌改故也】
　　假如六个时辰马行二百一十里今行五个时辰当有若干里
　　答曰一百七十五里




　　论曰试以六时除马行【二百一十里】得每时行【三十五里】以乘【五】时亦得【一百七十五里】原无可疑今先乗后除故以【一千○五十里】为实骤观之似乎太多究竟除后得其本数而已
　　假如银【三十二两】换钱【三万六千文】今有银【二十八两】问钱若干答曰三万一千五百文





　　若以【三十二两】除【三万六千】得毎两钱【一千一百二十五文】以乗【二十八两】亦得三万一千五百文【知得数之同则知一百万零八千之非误】
　　异乗同除约分法
　　三率内有两率相凖可用约分者即改用所约之数易繁为简如法乘除所得无误而用加防矣【两率者其一首率其一次率或三率也凡以法约之必两率相准次率三率祗用其一皆取其与首率相凖也　或两率并为偶数则俱折半或两率并可均剖为四则折半两次或两率并可均分为三则各取三之一或两数互减而得等数则以等数约之并如约分法】




　　【论其比例　半之则　以三约之　以九约之　再约之为十八比　九与八　则六与十　则二与十　则为一十六若九　之比例　六之比例　六之比例　与八若十九与八　亦若九　若三十三　若十一与　十一与十八也　　十九与　与八十八　八十八　　八十八八十八】
　　假如赁房九个月银七十八两问住二年该若干答曰二百零八两【法以二年成二十四个月依式列之】



　　四　　　　　　　　　　二百零八【八乗廿六即得此数】假如八色金六十两换银二百八十八两今有九色金五十两该若干
　　答曰二百七十两【此以金折成足色六十两作四十八两五十两作四十五两算之】



　　四　　　　　　　　　　　二百七十【十八乘十五得此数右皆约得一数为首率故不须除但以二率乗三率即得所求为四率】
　　重测法【三率有叠用两次者谓之重测即两个异乘同除】
　　假如有夏布四十五丈欲换棉布但云毎夏布三丈价二钱棉布七丈价七钱五分问换棉布若干　答曰二十八丈一　夏布　三丈　　先用为法


　　四　价　三两　法除实得此数
　　重列
　　一　价【七钱五分】　　　　又用为法


　　四　棉布　【二十八丈】　法除实得此数
　　此因两布各有其价故先用法求得第四率以夏布变为银就以此定为重列之第三率【即今价也】而以棉布价【七钱五分】为首率【以与今价同名也】棉布【七丈】为次率【以与今价异名也】如法乘除得所换棉布为四率
　　并乗除法
　　以两次乘除并而为一是合两三率为一三率也即古法之同乘同除【古以并乘为异乗同乗以并除为异除同除今乘除俱用并法故谓之同乘同除也】假如今有芝麻五十四石欲换黄米但云芝麻三石换緑豆五石换黄米三石问该换黄米若干
　　答曰六十七石五斗
　　本法　　　　　　　重列
　　一　麻　　三石　　豆　　四石
　　二　豆　　五石　　米　　三石
　　三　今麻　【五十四石】　　今豆九十石【此重列之第三即先得之第四乃本法也】四该豆　【九十石】　　　米【六十七石五斗】
　　简法【即并法】
　　【今以两首率相乘为首率
　　亦以两次率相乘为次率
　　以两九十石对去不用故三率
　　省乗是为并法实简法也】
　　论曰本用两次乘除今以豆【四石】乘麻【三石】得【十二石】以除是并两次除为一次除也以米【三石】乘豆【五石】得【十五石】以乗是并两次乘为一次乗也依法求之即得所换米【六十七石五斗】与两次求者数同【又因一率二率可用约分约之为四与五而法益简】
　　然则第三率何以独异【第三率径用今麻不以豆九十石乗之是与并两首率为首率并两次率为次率者逈别】曰重列之第三即先得之第四故可以对去不用不惟不用亦可不求【重列之第三率既无乗并之用则原列之第四率不必更求其数】而乗除之用已偹【今麻原系第三率今仍用为第三是三率之用本无所缺】即所求之得数已清矣【若第三率用豆九十石乗过之则所得第四率亦必为豆九十石乘过之米得数后必以九十石除之始能清出米数反多曲折今对去豆九十石不用则所得四率即米数直截了当】故为简法
　　又式
　　假如有战兵七百名毎年额饷一万二千六百两内有新着伍兵三百名已经应役七个月问该饷银若干答曰三千一百五十两




　　依重测并乘除法当以【十二月】乘【七百名】得【八四○○】为法以【七个月】乗【一万二千六百】得【八八二○○】又以【三百名】乘之得【二六四六○○○○】为实法除实得三千一百五十两为兵三百名七个月之饷今用约分以【七百】与【三百】约为七与三【皆百约之】则首率次率各有【七】对去不用可省并乘
　　重列之时径以【十二】为首率饷银【一二六○○】为次率【三】为三率依法乘除而得四率　又以首率【十二】三率【三】约为四与一则径以饷【一二六○○】为实以四为法除之得【三千一百五十】合问变测法【古谓之同乗异除在三率谓之变测即几何原本之互视法也】
　　凡异乘同除皆以先有之一率为法【即首率】以先有之又一率乘今有之一率为实【即二率三率相乗】
　　若同乘异除则反以今有之一率为法【同文算指列于第三今依法实之序定为首率】以先有之两率自相乘为实【同文算指列于第一第二今定为第二第三】虽亦以法除实得今所求之又一率【即四率】与诸三率同而法实相反故曰变测
　　假如用秤称物物重秤不能称外加一锤称得【八十四斤】本锤【一斤五两】加锤【一斤三两】问其物实重若干
　　答曰一百六十斤
　　一　锤重二十一两　　　　　为法


　　四　实重一百六十斤　　法除实得数
　　法以锤【一斤五两作二十一两】加锤【一斤三两作十九两】共重【四十两】为先有之一率称重【八十四斤】为先有之又一率相乘【三三六○】为实以本锤重【二十一两】为今有之一率为法法除实得实重【一百六十斤】为所求今有之又一率合问
　　假如秤失去锤有所称物【重一百六十斤】今以他物代锤【重四十两】称得重【八十四斤】问锤重若干　答曰一斤五两
　　一　物重一百六十斤
　　二　称得重八十四斤
　　三　【他物代锤】重四十两
　　四　锤重二十一两
　　假如布幔一具用布十六丈五尺布濶二尺今有布濶一尺五寸如式作幔该用若干
　　答曰二十二丈
　　一　今濶一尺五寸
　　二　原濶二尺
　　三　原长十六丈五尺
　　四　今长二十二丈
　　假如储粟方窖长【一丈二尺】濶【九尺】深【一丈】今欲别穿一窖藏粟与之等长亦【一丈二尺】但深加【二尺五寸】该濶若干
　　答曰濶七尺二寸
　　一　今深十二尺五寸
　　二　原深十尺
　　三　原濶九尺
　　四　今濶七尺二寸
　　【此原长不动而加深减濶也　今深今濶相乘得九十尺与原深乘原濶等以乘长一十二尺得一千零八十尺亦等则其藏粟等】
　　又问若依原窖之濶【九尺】但加长【三尺】该深若干
　　答曰深八尺
　　一　今长十五尺
　　二　原长十二尺
　　三　原深十尺
　　四　今深八尺
　　【此原濶不动而加长减深也今长乘今深得一百二十尺与原长乘原深等以乘濶九尺并得一千零八十尺】
　　假如有方仓高【一丈八尺】濶【二丈】深【二丈一尺】今更造一仓亦深【二丈一尺】但高减三尺问阔若干
　　答曰濶加四尺【共濶二十四尺所储米石即同原仓之容】
　　一　今高十五尺
　　二　原高十八尺
　　三　原濶二十尺
　　四　今濶二十四尺
　　【此原深不动而减高増濶也当与右二条叅防仓之高即窖之深仓之深即窖之长】
　　【今高乘今濶得三百六十尺与原高乗原濶等再以深二丈一尺乘之得七千五百六十尺与原仓之容积等】
　　假如原借八五色银四十八两今还九六色银问该若干答曰四十二两五钱
　　一　今银色九六　　　　　为法


　　四　今还四十二两【五钱】法除实得数
　　【解曰原银八五色是毎两实折八钱五分故以乘原银得四十两零八钱乃折实纹银之数也还银九六色是毎九钱六分成一两故以除折实纹银得四十二两五钱为应还之数凡零乘数反损零除数反增详别巻】
　　假如有田一区用三十二人耕治五日而毕今用四十人问该几日　答曰四日
　　一　今用四十人
　　二　原用三十二人
　　三　原耕五日
　　四　今耕四日
　　假如决水修池水窦濶三尺十二日涸出今开濶八尺问水涸几日
　　答曰四日有半
　　一　今濶八尺
　　二　原濶三尺
　　三　原十二日
　　四　今四日半
　　假如额兵五千六百设有一年之饷今祗留兵三千三百六十名问其饷可支几时
　　答曰一年零八个月
　　一　今兵三千三百六十
　　二　原兵五千六百
　　三　原设饷十二个月
　　四　今可支二十个月









　　歴算全书巻三十六
　　钦定四库全书
　　厯算全书巻三十七
　　宣城梅文鼎撰
　　笔算巻四
　　通分法【并减乘除并有子母通分之用故别自为巻其畸零以十百千万为等者不用此法】
　　凡整数下有零分而不以十分成整当用通分其法以一整数剖为若干分是为母数其所零分在母数中得几分之几是为子数
　　通分子母列位法
　　通分列位其法有三曰化整为零曰以整零曰收零为整
　　假如有物一斤四两则以一斤通为十六两加入所四两共二十两而列之
　　二○【斤以十六两为母其所四两是子今化斤为两则可乘除谓之以母从子也】
　　若欲通为铢则以毎两二十四铢为母通二十两为四百八十铢
　　四八○【此以斤通为两两又通为铢是两次用通分也】
　　若畸零累析有用通分三次四次以上者准此论之如皇极经世一元有十二防一防有三十运两次通之则一元有三百六十运　一运有十二世一世有三十年两次通之则一运有三百六十年
　　若以元通为年则用四次【元通为防防又通为运运又通为世世又通为年是四次用通分也】通得十二万九千六百为一元年数
　　假如古歴十九年七闰谓之一章其月谓之章月二三五【此以毎年十二月通十九得二百二十八月加入闰七月共得二百三十五月为一章之月】右化整为零　古通分法曰通以分母纳以分子盖言以分母通其整数而以所零分加入也然亦有不纳子而但通其整之时既以分母通之则整数不用全化为分故西学谓之化法
　　别有变零为整之法与此化整为零之法似同而实不同所以为零乘之用盖化整则全化为零而不用整变零则全变为整而不用零其数则同【谓自一至九之数】
　　其等则异【谓如零陞为单单陞为十之类】详见零除条
　　凡通分化整为零以便乘除不必更书其母若列位本法以整零当以母数子数并而书之曰几分之几【若分下有小分则曰几分之几又几分分之几】
　　假如有整数二十五有零分为整数十二分之七又仍零秒为分数三十分之十四
　　【此如歴法一周十二宫一宫三十度今得星行二十五周又七宫十四度也】
　　假如有整数十六又零数为整数七分之五
　　【此以一整数剖为七分而所零分适得其五也七为分母五为分子】
　　假如有零数为整数三十分之十四又有小分为分数六之五
　　【此原无整数但有分又有小分其分以三十为母十四为子是一整数剖为三十而得其
　　十四也小分以六为母五为子是一大分又剖为六而得其五也小分母古谓之秒母】
　　右以整零
　　凡母数必大于子数其常也乗除之后有子数反多者法当以母数收之为整而其零
　　假如有零分十六其分母九【此以子数反大当以母数收为整】
　　【九之十六】　收得一【九之　十六分内除九分收为整余七七　　分是为整一又九分之七也】
　　假如方田之法以方五尺为步其积二十五尺今有积七十尺
　　【步法二十五尺而积有七十尺子数反多法当收整】
　　【七十尺内除五十尺收为二步剩二十尺不能成步是为整二步又二十五分步之二十】
　　假如古厯法以十九年为一章四章为一蔀今距元中积一百年问在第几蔀第几章
　　畣曰第二蔀第二章之第六年
　　【法先以章法十九收九十五年成五章剰五年　次以蔀法四收四章成一蔀剩一章
　　通列之成一蔀一章零五年是为已过之数今正在交第二蔀第二章之第六年也】
　　右收零为整【凡欲乗除必化整为零既乘除矣仍必收零为整此二者相须为用也】此外仍有除零附整之法其法以分母为法分子为实实如法而一得零数为整数十分之几或百分千分万分之几所谓退除为分秒也见除法命分
　　通分并子法
　　通分并子其类有三曰母同者曰母不同者曰大分又小分者而所以并之之法有七曰径并法曰变分母法曰互乗法曰连乘法曰维乘法曰截并法曰通母纳子法
　　径并法
　　凡分母数同者径并其子并满母数收为整【数在三宗以上而母同者皆可径并其子或大分之下有小分而分母同者并用此法】
　　假如有丝五分斤之四又五分斤之三并之若干畣曰整一斤【又五分斤之二】
　　【此因两母同为五故径并其子子数七母数五是子满母数而且
　　有余也当以母数收之得整一零五之二】

　　以上分母同者径并其子为通分并法之一类
　　变分母法
　　凡分母不同而有比例可求者变而同之可省互乘假如有数【六之三】又加【四之一】共若干
　　畣曰共四之三
　　【法以六之三母子各损三之一变为四之二则两母同为四而其子可并矣
　　所以然者四与六是倍半比例故去三分之一即相同也】

　　假如有金【八分两之五】又【四分两之三】并之若干
　　答曰一两又八分两之三
　　【八与四为折半比例然不以八折半者其子奇数不可半也故以四之三
　　加倍即母数齐同可相并矣】

　　互乘法
　　凡分母不同而无比例可求者先互乘以同其母再以母互乘其子而并之【数在三宗以上而母不同者皆可用此法】
　　假如有物【四分石之三】又【七分石之四】共若干　答曰整一石又【卄八分石之九
　　先以右母四互乘左母七得卄八又互乘子四得十六变七之四为
　　卄八之十六　次以左母七互乘右母四及子三变四之二为卄八
　　之卄一　两母既同遂并其子为二十八之三十七
　　以满共母二十八収为整一仍余九】
　　凡三母内有两母相乘与余一母同者只用一互乘即可相并假如有甲乙丙丁四数乙得甲【七之六】丙得甲【五之四】丁得甲【卅五之二十三】若合乙丙丁三数得甲数若干　答曰得甲数二【又三十五之十一
　　法以乙丙两母相乘三十五与丁母同数即用乙母七互乘丙五之
　　四得三十五之卄八丙母五互乘乙七之六得三十五之三十以并
　　丁三十五之二十三共得卅五之八十一以满母卅五成整数合问
　　归整】得甲数二【又卅五之十一】
　　连乘法
　　凡数三宗以上者用母连乘为共母又以各母除之得数以乘其子为子而并之并满共母收为整
　　假如有数六【之四】又加三【之一】又加五【之四】并之若干
　　答曰整一【又九十之　　法以六乘三得一十八又以五七十二　　　乘之得九十为连乘之共母
　　即六除共母得数以乘之四之数
　　即三乘共母得数以乘之一之数
　　即五除共母得数以乘之四之数】
　　归整得一又【九十之七十二】
　　觧曰【此即互乘也试以五互乘六之四得三十之二十　又以三互乗之即成九十之六十　以六互乗三之一得十八之六又以五互乘之即成九十之三十　以六互乗五之四得三十之二十四又以三互乗之即成九十之七十二】维乘法【此古维乘法也与母除共母以乘子之法所得同】



　　假如钱粮一次完过【九分之一】又完【四分之一】又完【六分之一】又完【六分之一】又完【七分之一】问共完若干　答曰五百○四之四百零一【约为十分之八稍弱】法【以八乘六得四十八再以七乘之得三百卅六又以九乘之得三千○卄四又以四乘之即得一万二千○九十六】






　　约为五百○四之四百○一【卄四约之】
　　解曰【此即连乘法也但因分子皆为之一故即以母除共母之数为子相并而省一乗】
　　试用维乘所得亦同






　　截并法
　　凡数件中有分母同者先取出并之然后与各件并列则五件可作四件用【六件以上仿论】而共母亦简
　　如前图有八之一四之一为加倍比例可先取并之【用变分母法】


　　乃重列之【原数五宗今作四宗入余并同前】
　　【解曰共母原系一万二千
　　○九十六今只三千○二
　　十四简四之三故所得之
　　子皆于前式为四之一】

　　凡宗数繁多而分母又各不同者可分作几次并之假如有物四宗甲数【五分斤之三】乙数【六分斤之一】丙数【三分斤之二】丁数【七分斤之四】并之若干
　　答曰整二斤又六百三十分斤之三


　　如上图依法互乘以四宗并作两宗乃重列之



　　以上分母不同者为通分并子之又一类
　　大分小分并法
　　凡大分之下有小分而母相同者如法并之自小分起满小分之母进为大分满大分之母进为整
　　若大分之母同而小分母不同者用互乘法使其同【余如上法】若大分母不同者即通大分为小分再用互乘以同之假如西厯以一日分二十四小时一时又析为六十分今得中防二十九日十七时三十六分实防该加七时四十分依法并之得三十日零一时一十六分
　　原二九　【卄四之　六十之　时为大分大分之母二十四一七　　三六　　时下为小分小分之母六十】加　　　【卄四之　六十之　先并小分得七十六以满六丨丨○□　　四十　　十进为一时仍余十六分】
　　并得三○日○一时十六分　【次并大分得二十五时以满二十四进为一日仍余一时】假如修筑河堤新修七里○六十六歩一尺旧堤原存一十二里二百九十三步四尺问堤长若干答曰长二十里新修○七　○六六　一　　【里法三百六十步法五先并尺一四共五进一步次并步】原存□□　□□□　四　　【共三百六十进一里次并里二七及所进之一共十里并】共长二○里○○○步○尺　【原十里是为堤长二十里合问】
　　假如有硃砂八斤十两○九铢又有三斤五两十八铢共若干答曰十二斤○三铢
　　八　一○　○九　　　【铢满二十四进一两余三两满十六进一】□　○□　□八　　　【斤斤共十二是为一十二斤○三铢合问】
　　共一二斤○○两○三铢
　　右大小分母俱同故径以子并
　　假如甲数九【之四】又小分【五之四】乙数九【之八】又小分【八之三】并之若干答曰整一又九之四又小分四十之七
　　先同其小分之母
　　【先以小分母相乘得四十为共母　又互乘其子变
　　五之四为四十之三十二变八之三为四十之十五】
　　小分母既同乃重列而并之【余同上】


　　【并之】得九之十二又四十之四十七
　　归整一又【九之四】又小分四十之七　【小分满四卜收为大分一大分满九收为整一】右系大分母同而小分之母不同故互乘之使其同
　　假如有田二坵甲坵二亩【又四分亩之三】又小分【五之一】丙坵一亩【又三分亩之二】又小分【四之三】并之若干
　　答曰整四亩【又六十分亩之四十三】
　　先以甲小分母五通大分四之三为小分二十之十五加入原小分一共二十之一十六为甲数
　　又以丙小分四通大分三之二为小分十二之八加入原小分三共十二之十一为丙数
　　解曰【此即古通分纳子之法也以大分尽通为小分而纳小分焉实则以小分陞为大分也】


　　【并得】三又　　　　　二百四十之四百一十二归整四又【二百四十之一百七十二】约为六十之四十三
　　右系大分母不同故尽通为小分而并之
　　以上大分小分法为通分并子之又一类
　　凡通分并法以通分减法还原【互见后除】
　　通分子母减法
　　通分减法亦有三类曰母同者曰母不同者曰大分小分者而其减之之法有五曰径减法曰变分母法曰互乘法曰子乘母除法曰通母纳子法【并之与减犹乘之与除可以互相还原相反而适相成也故所用之法皆同】径减法【数在三宗以上而母同者并用此法】
　　凡分母同者径以相减不足减者以分母通整数减之假如有纻丝一疋零【五分疋之三】用过五分疋之三问仍存若干答曰五分疋之四
　　原一　五之二　　【此以之三减之二则减数反大于原数不足减以借法作】减　　五之三　　【防于疋位借原数一疋通作五分并之二共成五之七内】存○　五之四　　【减去五之三仍存五之四合问】以上分母同者径以对减为通分减法之一类
　　变分母法
　　凡分母有可以比例言者以比例同之可省互乘假如有数六之三又有数四之三其较若干
　　答曰四之一


　　较　　　　四　之一
　　假如有整数一零八之三减去四之三该存若干答曰八之五
　　整数一　八　【之　通三　为】八　之【十一】
　　减数　　四　【之三】　变八　之六
　　存数　　　　　　八　之五
　　互乘法
　　凡分母不同者先互乘以同其母以母互乗其子而减之假如有两数甲五之三乙七之四不知谁多
　　【法以两分母五七相乘得三十五为共母又互乘其
　　子变甲数为三十五之二十一变乙数为三十五之
　　二十以相减则乙不及甲者其较为三十五分之一】
　　甲多　　三十五之　　一
　　凡分母同者视其子为大小【子数大者即大小者即小】若子同而母不同者反是【母数大者子数反小】亦以互乘见之如后图
　　【甲六之四乙五之四】互得三十【之二十　丙四之三之卄四　丁五之三】互得二十之【十五十二】
　　乙多　　　三十分之四　丙多　　　　二十分之三右二则以分相较而辨其多寡即古课分之法也
　　凡三母内有两母相乘与余一母同者只用一互乘即可相减假如有甲数二又【三十五之十一】乙得甲【七之六】丙得甲【五之四】余为丁数该若干
　　答曰丁得甲三十五之二十三
　　【先以分母通整数为分而纳入分子
　　次以减数分母相乘为共母又互乘
　　其子而并之是为三十五之五十八】
　　丁存　　　　　　三十五之卄三　【以减甲数仍余三十五之卄三合问】子乘母除法
　　凡分母有可以相除者以分母除其分母得数转以乘子而减之其余数仍以分母除之即得约分之数若原系两分母互乘而并者用此法可知原母【数在三宗以上而母不同者并用此法可代维乘】
　　假如有沉香一石零【二十八分石之九】用去七分石之四该余若干



　　存　　卄八　之　　二十一　约为四之三【法以分母通共数一为二十八并子之九共三十七变共数为二十八之三十七　又以减分母七除共数之分母二十八得存数原母四以乘减分子四得十六变减数为二十八之十六两相减得所存数为二十一于是仍以减分母七除之得存数原子三变存数为四之三】
　　【论曰此亦变分母法也其数与互乘所得无异但用互乘则数益烦故用子乘母除之法变七之四为二十八之十六母既相同即可以相减矣若互用异乘同除则成三率之比例如后图】
　　一率【分母七】　法以子之四乘所变分母二十八得一百二率【分子四】　十二为实分母七为法除之得所变分子三率【分母卄八】　为十六其比例为七与四若二十八与十四率【分子十六】　六也
　　又论曰存数不用约分法而竟以分母七除何也曰约分之法以对减而得纽数今分母七既可以除其母二十八又可以除其子二十一即纽数也又何事于对减之烦乎况用之互乘还原尤为亲切盖互乘之共母既以原母相乘而得即无不可以原母除之而尽也
　　假如有整数一又【九十之七十二】甲得六【之四】乙得三【之一】余为丙数该若干
　　答曰丙得五之四



　　丙存　　五　之四　　　九十　之七十二法曰【先以分母通整一为九十并分子七十二是为九十之一百六十二　次以甲分母六除原母九十得十五以甲分子四乘之得六十为甲数　又以乙分母三除原母九十得三十以乙分子一乘之仍三十为乙数合甲乙两数得九十以减原数一百六十二仍余七十二为丙数以法约之为五之四　约分法详后条】约分防法　置丙存数【九十之七十二】为实以甲乙分母【六三】相乘得
　　数【十八】为法除之得五之四为丙存数【以十八除九十得五十八除七十二得四约分本法用子数七十二减母数九十得十八以转减子数得五十四再递减之亦余十八是为纽数乃用为法以除子母数得约分五之四今改用甲乙两母相乘亦得十八为法何也以原数九十可以六除亦可以三除知其为三数维乘而得者也故于还原最切】
　　论曰此有分母三宜用维乘然其数益繁故改用子乘母除之法则三母齐同可用相减而法与数俱简矣
　　试先减乙丙数则所存者即甲数【法同上】



　　甲存　【约为】六　之四　　即九十　之六十
　　若先减甲丙数则所存者必乙数其法并同兹不悉具按如此互求即知无误可无假他法还原矣
　　假如有数五百○四之四百○一甲得【八之一】乙得【六之一】丙得【七之一】丁得【九之一】余者为戊数该若干　答曰戊得四之一
　　原数　五百○四　　　　　　　　　　之四百○　一
　　甲减　八　之一　　　　　　　　　　　　　六十三
　　乙减　六　之一　以各减母除原母得　　　　八十四
　　丙减　七　之一　　　　　　　　　　　　　七十二
　　丁减　九　之一　　　　　　　　　　　　　五十六
　　共减　　　　　　　　　　　　　　　　二百七十五
　　戊存　五百○四　　　　　　　　　　之一百二十六约为　四　之一【以所存之数除原母即得】
　　解曰此因分子俱系之一故即以除数为得数也以上分母不同者为通分减法之又一类
　　大分小分减法
　　凡大小分母并同者【谓原数之大小分母与减数之大小分母也下仿此】竟以对减不足减者借整数以分母通为分【小分不足减亦以小分之母通大分为小分　其借上位皆作防志之】若大分母本同而小分母不同者用互乘以同之余如上法若大小分母俱不同者用通分法尽通大分为小分而纳小分焉余如上法
　　假如西厯得某月平朔三十日○一时一十六分其实距时七时四十分为减号问实朔在某甲子某时刻
　　答曰壬辰日酉初二刻○六分【以二十九日命为壬辰日以十七时命为酉初其小余三十六分以三十分收为二刻尚余六分命为壬辰日酉初二刻○六分】
　　日　时　分【时为大分大分以二十四为母时下为小分小分之母六十】
　　平朔三□○□一□【先减小分四十原数只十六不足减作直号于大分位借一分通为小分实距时】　　七四□　【六十并原小分共七十六减四十余三十六　次减大分七原数一已借】实朔二□一□三□【去亦借整一通为二十四减七余十七　原数三十因借减一余二十九】凡大小分母不同者【谓大分之母与小分之母不同也】须作防以别之故借整化零之防改为直号
　　右系大小分母并同故竟以对减
　　假如有整数一又【九之四】又小分【四十之七】甲得九【之四】又小分五【之四】余为乙数该若干
　　答曰乙得九之八又八之三


　　乃重列之【小分既同即可相减】


　　乙存　　九　之八　二百之七十五　约为八之三法曰【先减小分减数大原数小不足减乃作直号于大分位借一分通为小分纳原数共二百三十五减一百六十余七十五　次减大分原数四因借减一变三亦借整数一通为九共十二减四余八整数借减尽】
　　试先减乙【用变分母法以代互乘余并同上】
　　原数一　九　之□又　　　　　四十　之七减乙　　九　之八又八　之三变四十　之一十五存甲　　九　之四又五　之四即四十　之三十二解曰【四十与八是五倍比例故以乙小分八之三母子各五倍之即变为四十之一十五则两母齐同可以对减矣】右系大分母同而小分母不同故用互乘以同之
　　假如甲丙两坵田共四亩又六十分亩之四十三甲坵二亩又四分亩之三又小分五之一余为丙坵该若干
　　答曰一亩又十二分亩之十一【即六十之五十五母子各五约之为十二之十一】法先以甲小分母五通大分四之三为二十之十五加入原小分一共二十之十六乃列而减之【如此则大分小分合而为一与原数无小分者类矣】


　　存丙一又　　　　　　　　六十　之五十五用变分母法以甲子母各加三倍变二十之十六为六十之四十八以减原数四十三不及减乃作直号于整数位借一数通为六十分纳原数共一百○三减甲数四十八余五十五次减整数整数四因借减一成三减甲二仍余一是为整数一又六十之五十五即丙存数也
　　右系大分母不同故通为小分而减之
　　以上大分小分法为通分减法之又一类通分子母乘法
　　假如有田三十六亩六分毎亩征银三分钱之二问该银若干答曰二两四钱四分
　　法以分子之二乘田三十六亩六分得
　　七十三分二以分母三收之得二两四
　　钱四分合问
　　何以知其为七十三分也曰原问毎亩
　　徴银三分钱之二分故于右行实数内
　　寻毎亩之位为定位之根以横对左行
　　得数即命为分则上下俱定矣
　　假如有银六十四两毎两买铜八斤十二两该铜若干答曰五百六十斤
　　先以斤法【十六】收十二两为斤下之七分
　　五厘加八斤共八七五为法以乘银六
　　十四两得五六○○○即于右行实数
　　内寻毎两位以横对左行得数命法尾
　　厘推而上之定为五百六十斤

　　假如有米五石【又三分石之二】毎石价银九分两之八该银若干答曰五两又二十七分两之一
　　法以分母三通五石为十五分纳子二
　　共十七分以价之八乘之得一百三十
　　六又以两分母【三九】相乘得二十七收之
　　合问
　　通分子母除法
　　假如毎田一亩徴银三分钱之二今完编银二两四钱四分该田若干
　　答曰三十六亩六分
　　法以分母【三】通二两四钱四分为七十
　　三分二为实以分子之二为法除之即
　　得三十六亩六分合问【原所设三分之二以钱为主故
　　四分所通为小分】
　　假如有米五石又三分石之二共价银五两又二十七分两之一问毎石该价若干
　　答曰九分两之八
　　法先以米分母【三】通五石为十五分纳子二共十七分为法又以价分母【卄七】通五两为一百三十五纳子一共一百三十六分为实法除实得八为毎石三分一之价以分母三乘之得二十四分为毎石价命为二十七分两之二十四约为九之八
　　又防法【以米分母三除银分母二十七得九为毎石价之母即以除出之数为子即九之八】
　　假如有丝一斤又六分斤之四共价一两又四十二分两之二十问毎斤价若干　答曰七分两之六又十之二法先通丝一斤为六分纳子四共一十为法又通银一两为四十二分纳子二十共六十二退一位【即一十除也】命为单六又小分二即毎斤六分一之丝价也于是以分母六乘之得三十六又小分十二为毎斤价是为四十二分两之三十六又小分十二也子母并六约之为七分两之六又小分十之二防法【以丝分母六除价分母四十二得七为毎斤丝价之母即命为七分两之六又十之七】通分子母三率法【即异乘同除】
　　假如西厯太阳毎日平行【五十九分零八秒二十微】今有二刻半该行若干分答曰一分三十二秒卄四微【又九十六分微之卄六】






　　法【先通五十九分为三千五百四十秒加原帯八秒共三千五百四十八秒又通为二十一万二千八百八十微加原二十微共二十一万二千九百微在位以二刻半乘之得五十三万二千二百五十微为实以一日化九十六刻为法除之得五千五百四十四微不尽除满三千六百微收为一分又一千九百二十微收为三十二秒仍余二十四微　不尽者以法命之是为一分三十二秒二十四微又九十六分微之二十六】
　　论曰此小数法也何则二十一万二千九百者是每日九十六刻之数今以二刻半乘之于刻下多一位故截去得数尾一位命为百
　　假如以粟易布毎粟六分石之二易布五分疋之三今有粟一石又三分石之二该布若干　答曰三疋
　　一　粟六分石之二【母子各减一倍】变为三之一


　　四　布五分疋之【十五】　　　收为整三疋【两粟母同为三省不用只以布分母收之】用变分母法变一率六之二为三之一则两粟母相同可省互乘而子变为之一又可省除只以三率一石用分母通为三纳子二共五以乘二率布分子之三得十五再以布分母五收之即得三疋合问
　　假如以银换金毎银二两又三分两之二换金九分两之二今有银六分两之四该金若干
　　答曰十八分两之一



　　四　金【十八】分两之一
　　法以一率分母【三】互乘三率六之四为十八之十二与二率之二相乘得二十四为实又用一率分母三通二两为六分纳子二共八是为三之八复以三率分母【六】互乘之为十八之四十八以乘金母【九】得四百三十二为法法大实小以法命之为四百三十二之二十四母子各二十四约之即十八分两之一合问
　　若用变分母法则如后式
　　一　银二两【又三之二】　　通为三之八乘得【七十二】为法【以金母九乘之八也】


　　四　金【七十二分】两之四　约为【十八】之一【子母各四约之】
　　解曰十八分两之一即五分五牦五五不尽畸零分子母乘法
　　假如以八之五乗四之三该若干
　　答曰三十二之十五
　　法以母乘母得三十二子乘子得十五即三
　　十二之十五为乗得数也
　　又法以除代乗则倒位互除之
　　法以五除四得八为母数以八除三得三七
　　五为子数是为八之三七五与乗得之数同
　　解曰四除三十二得八四除十五得三七五若四因八得三十二四因三七五亦得十五
　　用法
　　假如谷一石价二十七分两之十六今有谷四分石之三价若干
　　答曰九分两之四
　　一　谷一石


　　四　价九分两之四【因首率是一故省除即以九之四为得数】
　　解曰二十七分两之十六即五钱九分二牦六毫弱也谷四分石之三即七斗五升也价九分两之四即四钱四分四四不尽也
　　若用倒位除以代乘则径得九之四
　　法用母四除十六得四为子用子三除二
　　十七得九为母是为九之四也
　　畸零分子母除法
　　假如以五之四除四之三该若干
　　答曰八之七五
　　法以母除母得八子除子得七五是为八之
　　七半即除得数也
　　又法以乘代除则倒位互乗之
　　法以母五乘子三得【十五】为子以子四乗母四
　　得【十六】为母是十六之十五与除得之数同
　　解曰十六即八之倍数十五即七五之倍数故其数同用法
　　假如以绢易縀绢五分丈之四换縀七分丈之四问绢毎丈该縀若干
　　答曰该换縀七分丈之五
　　一　绢五分丈之四　法以母除母得一四子除子得一○是二　縀七分丈之四　为一十四之一十子母各半之为七分
　　三　绢一丈　　　　之五【三率是一省乘即用縀七之四为实】
　　四　縀七分丈之五
　　解曰五分丈之四者八尺也七分丈之四者五尺七寸一分强也七分丈之五者七尺一寸四分强也
　　若用倒位乘以代除所得亦同
　　法用子四乘母七得卄八为母用母互乘子
　　四得卄为子子母各取四之一即七之五也
　　论曰同文筭指有畸零乘除之法甚为简妙然莫适所用今以三率列之则实数可稽而用法亦明矣
　　畸零乘除定位
　　凡乘法得数必大于原问之数若畸零乗则其数反降凡除法得数必降若畸零除则其数反陞盖即异乘同除之理诸家术皆未经说破故定位多讹兹以三率明之如左假如换珠每珠一两值银二十四两今有珠三分五厘该若干答曰八钱四分
　　此首率是单两
　　而三率有分厘
　　是单下有三位
　　零也故截去得
　　数尾三位命法
　　尾两两位空定所得为八钱四分
　　论曰此即以乘出之数为四率者以首率是单一两故省除耳试即以三率实尾位厘为单而定所得为八百四十两为实亦陞首率单两为千厘为法除实【即以实数降三位】亦仍得八钱四分合问【此条已详二巻乘法中兹以三率列之于定位之理益明】
　　又论曰乘除之难在于定位而畸零为尤难所以者何凡定位以单数为根而畸零无单位可言故也前于乘法中立本数大数小数三法以寻每位可以御畸零矣于除法犹未有以处也今皆归之三率惟视三率中所有之数即命为单数【如金银之类本以两为单今视三率中有分即以分为单而两则为其百数又如米谷之类本以石为单今三率中有斗即以斗为单而石则为其十数他仿此】则虽畸零皆可作整数筭无论乗除一以贯之矣【是为以零变整而乗除之后得数无异此所以别于通分化整为零之法也】
　　假如有珠三分五厘价银八钱四分问每两珠价若干答曰二十四两
　　【此一率首位是分即以分为单数以二率
　　陞两位作八十四两为实以法三分五厘
　　对实分位列之除毕于法上一位命
　　为单分推而上之定得数为二十四两合
　　问】
　　解曰二率陞二位为实者即百分乘也分原在单两下二位今既陞为单则单两亦陞二位成百分也
　　假如银二钱四分买稻九十六斤毎两该若干
　　答曰四百斤
　　【此以钱为单数则三率单两成十钱而二率亦陞一
　　位成九百六十○斤为实于是以法二钱对实○位
　　列之以单钱对单斤也除毕于法上一位命为单
　　斤即得数为四百斤合问】

　　假如以豆换油豆四斗八升换油十二斤今豆十石该油若干答曰二百五十斤
　　【此以斗为单数则三
　　率十石成百斗故二率亦陞两位作一千
　　二百斤为实以法四斗对实○斤位列之
　　亦以单斗对单斤也余亦同】

　　假如芝麻六斗四升四合换豆一石今芝麻四石八斗三升该豆若干
　　答曰七石五斗





　　若以斗为单则命实为四十八石三斗【以二率十斗乘之也】而以法首六斗对实三斗列之除毕于法上位定为斗亦得七石五斗或以升为单以合为单得数亦无不同也【以升为单法上即命为升以合为单法上即命为合】
　　假如钱六百五十文价四钱八分七厘半每千该价若干

　　【此问毎千钱价是以千为单也今法首只有百
　　即以百为单而陞单千为十百则二率亦陞一
　　位作四两八钱七分五厘为实四两列之以单
　　百对单两也除毕于法上位命为单两两位空
　　定得数为七钱五分】















　　歴筭全书卷三十七
　　钦定四库全书
　　厯算全书巻三十八
　　宣城梅文鼎撰
　　笔算巻五
　　开平方法
　　测量句股全恃开方开方有平有立而平之用博以其有实无法故别为一术以佐乘除之所穷
　　平方者面羃也其形正方故亦为自乘之积开平方者以自乘之积求正方之邉故西法谓之测面其邉谓之方根法先列实　依除法作两直线以所用方积列于右直线之右自上而下至单位止无单作○
　　次作防定位　自单位作一防起毎隔一位防之有一防则商一位【如有二防则商数有十有三防则商数有百】
　　次定初商　皆自原实最上一防截定为初商之实【如防在首位即以一位为初商实防在次位即合两位为初商实】以自乘数约而商之皆以防处为本位防上一位为进位【本位者单数也如一商一四商二九商三其自乘皆本位不论百与万以上皆作单数用进位者十数也如一六商四二五商五以至八一商九其自乘皆有进位不论千与万以上上皆作十数用】
　　又法　以初商实入表皆视初商实有与表同数或稍大于表数者用之以命初商【如一商一四商二此与表数相同也如二三亦商一五六七八皆商二此比表数稍大也若至九则商三又为相同之数矣十至十五皆商三皆比表数稍大至十六商四又为相同之数他皆仿此】初商表【凡初商三以下减积在本位四以上减积合两位此表明之】


　　用表防法【但视初商实不满表上自乘积者退一格即商数如不满○四即商一不满○九即商二他仿此】既得商数即书于左直线之右皆对初防之进位书之【凡商得一二三四书于防之上一位】五以上又进一位【凡商得五六七八九书于防之上两位】次减实　以初商数自乘书于左直线之左皆以本位对初防【如初商一二三自乘一四九皆本位即对初防书之如初商四五六七八九其自乘皆有进位则以下一字对初防】就以此命为减数以对减右直线所列方积如减积不尽则有次商次商之法　倍初商得数为次商亷法对原实位书于右直线之左【视实冇二防则初商是十有三防初商是百四防初商是千各取倍数对原列方积千百十零之位书之倍而言十者亦进位对之】截原实第二防为次商之实【次商减积至此防止】以廉法约实为次商数【并依除法约之】挨书于初商之下即用次商数为隅法亦书于廉法之下为次商廉隅共法【省曰次商法】以与次商数相乘书其数于左直线之左【皆以法首位所乘之进位对次商数书之若言如之数亦以○位对之法有几位徧乘而挨书之　至次防止　又法先以法尾位隅法乘次商数以本位对次防书之进位上一字书之依乘法例自下而上法有几位皆徧乘而迭进书之至次商数止亦同】命为次商减积数以对减右直线余积而定次商【皆减积至次防止】如减数大于余积则改次商【亦改隅法】如上乘减及减而止次商减积不尽则有三商
　　三商之法　合初商次商数倍之为廉法【简法只以隅法加倍増入次商法内即三商廉法】截原实第三防为三商之实【三商减积至三防而止】余并同次商如减积不尽则有四商
　　四商以上并同三商法
　　审○位之法　若次商廉法大于苐二防以上余积或数适相同是商得○位也【凡商得一数者其减积必与廉法同而多一数以为隅故仅同者无隅积也即不能商一数而成○位】则书○于初商之下以当次商亦增○于亷法之下为三商亷法三商以上有○并同【若应商几位而于初商或次商即已减积至尽是末几位皆商得○也俱补作○】命分之法　若已商得单数而仍有余积当以法命之【以商得方根倍之加隅一为分母不尽之数为分子命为几分之几】虽未商得单数而余积甚少不能成单一数亦以法命之【前审○位云亷法大于余积者但取第二防以上相较不论千百十零其所谓不能商一数者或是一千或是一百不拘定是单一也故商○之后仍有所商与此不同】
　　还原法以商得方根自之有不尽者以不尽之数加入之即得原实又简法作直线于左方以应减之积依并法并之必合原实有不尽数亦加入之并同除法还原
　　初商本位式【凡初商一二三者减积言如在本位　初商一二三四者书商数于防之上一位然以书商数之位言之亦本位也两本位法此一式中皆可明之】
　　假如有方田积二百五十六步问每面方若干
　　答曰每面方十六步

　　列实【作两直线列方积于右直线之右】作防定位【自单位起毎隔一位作一防共两防宜商两次　初商是十】


　　初商【防在实首位即以实首位○二为初商实以自乘数约之得一为初商初商是一宜对防上一位书于左直线之右有两防初商是一十自乘一百为减数书左线之左遥对右行初防○二百书之就以对减初商实于二百内减一百仍余余一百改书之初商减积未尽有次商】
　　次商【倍初商一十作二十对原列方积十步位书于右线之左为亷法　以第二防余实一五六为次商实用亷法约实可商七步因无隅积只约六步为次商以书于初商之下即用六步为隅法以书于亷法之下合亷隅共二十六步为次商法以乘次商六步得亷积一百二十步隅积三十六步皆对次商位书起每挨一位书之至次防止共得次商减数一百五十六以对减余实恰尽】共开得平方根一十六步合问
　　甲乙丙丁四形合为正方形【四面皆一十六步】甲分形正方【四而皆十步积一百步即初商积】丙丁二分形皆长方【广六步长十步积六十步两形共积
　　一百二十步即次商廉积】
　　乙小分形亦正方【面皆六步积三十六步即次商隅积】自乘还原法置方一十六步为实即以
　　十六步为法乘之得二百五十六步合
　　原数
　　初商进位式【凡初商四五六七八九减积言十在进位初商五六七八九书商数于防之上两位凡书商数以防上一位为本位则此其进位也两进位法此一式中皆有之】
　　假如方积三十五万八千八百零一尺问方若干答曰方五百九十九步

　　列位【同前】
　　作防定位【有三防宜商三次初商是百】

　　初商【防在实次位即合两位三五为初商实入表表中有小于三五者是二五其方根五即以五为初商数对实初防上两位书左直线之右又即以表中自乘数二五遥对实三五书于左直线之左就以对减初商实余一○改书之以待次商】
　　次商【倍初商五百作一千○百对实千百位书于右直线之左为亷法　以第二防上余实一○八八为次商实用亷法约之得九为次商续书于初商之下即以次商九为隅法书亷法之下合亷隅共一○九为次商法以乘次商九得亷积九隅积八一对次商位书起至次防止共得减数九万八千一百以减次商实余一○七改书之以待三商】三商【以次商隅法九十倍作一百八十于次商法一千之下抹去○九改书一八共一一入为亷法　以第三防上余积一○七○一为三商实用亷法约之得九为三商续书于次商下即以三商九为隅法书于亷法之下合亷隅共一一八九为三商法以乘三商九步得亷积一万○六百二十隅积八十一对三商位书起至第三防止共得减数一万○七百○一以对减三商实恰尽】凡开得方根五百九十九尺
　　初商甲【方五百尺积二十五万尺】次商【丁戊】二亷【各长五百尺濶九十尺共积九万尺】隅乙【方九十尺积八千一百尺】
　　三商【已庚】二亷【各长五百九十尺濶九尺共积一万○六
　　百二十尺】隅丙【方九尺积八十一尺】七形合成正方共积【三十五万八千八百○一○】
　　商○位式
　　假如方积八十二万六千二百八十一尺问方若干答曰九百○九尺

　　列位
　　作防定位【并同前条】


　　初商【防在次位合两位八二为初商实表入表得八一小于八二其方根九即为初商在五以上对初防上两位书之亦以表数八一对实八二书于左线之左以减初商实余○一改书之以待次商】
　　次商【倍初商九百作一千八百对原实位书之为亷法以第三防上余实○一六二为次商实以亷法约之法大实小不能商一数是商得○位也纪○于初商之下即于实首位销去一○余俟三商】
　　三商【因次商是○增○于廉法之下共一八○为亷法以第三防上余实一六二八一为三商实用亷法约实得九尺为三商书于次商○之下即以九为隅法书于亷法之下共亷隅法一八○九以乘三商九得亷积一万六千二百隅积八十一减三商实恰尽】凡开得方根九百○九尺
　　计开
　　初商方九百尺　积八十一万尺
　　续商亷【各濶九尺长九百尺】共积【一万六千二百尺】　隅方九尺积【八十一尺】通共八十二万六千二百八十一尺
　　假如方积二十五亿○七百○○万四千九百尺问方若干答曰五万○七十尺
　　列位【原积尾位是百补作两○列之】作定位【有五防当商五次　初商是万】

　　初商【以实首两位二五为初商实入表得五为初商书于防上两位次以自乘数对实列之相减尽】次商【倍初商五万尺得一十○万为亷法对原实位书之以第二防上余实○○○七为次商实实有三○无可商是次商○也书○于初商五之下亦于实首销去一○以待三商】
　　三商【因次商○增○于亷法下得一○○为亷法　以第三防上余实○○七○○为三商实实仍有两○位是三商亦○也又书○于次商○之下于实首复销去一○以待四商】
　　四商【因三商亦○又增○于亷法之下得一○○○为亷法以第四防上○七○○四九为四商实用亷法约之得七十尺书于三商○之下即以七为隅法增于亷法下共亷隅法一○○○七以乘四商七得亷积七百万隅积四千九百以对减四商实恰尽】
　　五商【五防宜有五商而四商已减实尽无可商作○于四商】
　　凡开得方根五万○○七十○尺
　　命分式
　　假如方积五百七十六万四千八百尺问方根若干答曰二千四百尺【又四千八百○一分尺之四千八百】
　　列位【实尽于百位如前法补作两圏列之】作防定位【有四防宜商四次初商是千】

　　初商【以实首○五为初商实入表得二为初商以自乘数○四减实○五改书余一以待次商】次商【倍初商二千得四千为亷法　以第二防上余实一七六为次商实用廉法约之得四为次商即以为隅法书廉法下共亷隅法四四以乘次商四得亷积一百六十万隅积一十六万共减积一百七十六万次商实减尽】
　　三商【倍次商隅法四作八增入次商法共四八为三商亷法以第三防上余实○○四八为三商实有两○无可商作○于三商位消去实首一○以待四商】
　　四商【三商○亦增○于亷法下共四八○为亷法以第四防上余实○四八○○为四商实仅与亷法相同是无隅积也不能商一数作○于四商位其不尽之数以法命之法以亷法四千八百○加隅一共四千八百○一为命分之母以不尽之数四千八百为分子命为四千八百○一分尺之四千八百即一尺弱也】
　　共开得平方二千四百尺又四千八百○一之四千八百
　　此虽未开至单尺之位而余实甚少不能成一单尺故即以法命之若余实是四千八百○一尺则商得平方二千四百○一尺矣今止四千八百尺是少一尺故不能成一单尺也





　　开方分秒【凡开方欲知分秒法于余实下毎増两○位则多开一位为分秒之数　平方之积尺有百寸寸有百分皆以百为母故增两○】
　　假如有平方积二十四尺平方开之得方四尺不尽八尺问分秒若干　答曰方四尺零八寸九分八厘九毫有竒
　　如常列位作防防在次位即以
　　二四两位合商得方四尺减其
　　自乘一十六尺余八尺用命分
　　法以商四尺倍作八尺又加隅
　　一得九为命分母不尽为分子
　　命为方四尺又九分尺之八

　　今欲知其寸【九分尺之八者是以尺作九分而今有其八言毎方四尺之外仍此畸零是其中有寸】法于余实下加两○化八尺为八百寸【毎尺纵横十寸故其积百寸】用为次商实以初商四尺倍之得八尺亦化八十寸【商数是毎邉之数故尺只十寸】对余实十寸位书之【即第一○位】为亷法用廉法约实可商九寸因恐无隅积只商八寸书于初商四尺之下亦即以次商八寸为隅法书于廉法八十寸之下共亷隅八十八寸以乘次商八寸得亷积六百四十寸隅积六十四寸共亷隅积七百○四寸自次商位书起至第二○位止以对减余实仍余九十六寸命为竒数
　　凡商得毎方四尺八寸有奇
　　再求其分
　　法于实下又加两○以余九十六寸化九千六百分【解见上】为三商实　商数四尺八寸亦化四百八十分倍之为九百六十分移对余实百分十分之位书之为亷法以亷法约实商得九分为三商书次商之下亦即以三商九分为隅法书于亷法九百六十分之下共亷隅九百六十九分以乘三商九分得亷积八千六百四十分隅积八十一分共积八千七百二十一分自三商位书起至第四○位止以对减余实仍余八百七十九分命为竒数
　　凡商得每方四尺八寸九分有竒
　　再求其厘
　　法于余实下又加两○以余八百七十九分化八万七千九百厘为四商实　次倍商数四尺八寸九分作九尺七寸八分化为九千七百八十厘移对余实依千百十之位书之为亷法　用亷法约实得八厘为四商书于三商之下即以四商八为隅法增于亷法末共亷隅法九千七百八十八厘以乘四商八厘得亷积七万八千二百四十厘隅积六十四厘自四商位书起至第六○位止以减余实仍余九千五百九十六厘
　　凡商得每方四尺八寸九分八厘有竒
　　再求其毫
　　如法于余实下又加两○化余实为九十五万九千六百毫为五商实　次倍商数四八九八作九尺七寸九分六厘化为九万七千九百六十毫为亷法移对余实万千百十之位书之用亷法约实得九毫为五商书四商下亦即以五商九为隅法增入亷法下共亷隅九万七千九百六十九毫以乘五商九毫得亷积八十八万一千六百四十毫隅积八十一毫对五商位书起至第八○位止以减余实仍余七万七千八百七十九毫
　　凡商得方四尺八寸九分八厘九毫又九万七千九百七十九之七万七千八百七十九即竒数也
　　右单数下已开四位【尺为单位析为寸分厘毫凡四位】其不尽者是不满一毫之数于单数为十万分之一【如欲再求忽微亦如上法】








　　开方纵【纵者长方形也以方为濶加纵数为长其法与方无异但须以商得数乘纵数为纵积并入方积以减原积不及减者改商之其次商亦倍初商加纵为亷法但倍方而不倍纵　三商以上并同】
　　假如有长田积六百二十四步濶不及长二步问长濶各若干答曰长二十六步濶二十四步




　　列位【以实列右线之右　以纵二步列右线之左对实步位列之】
　　如常作防定位
　　初商【以○六为初商实商得二十步自乘应减方积四百步又以商数乘纵二步得纵积四十步如法列之以减原实仍余一百八十四步】
　　次商【倍初商二十步作四十步加纵二步共四十二歩为亷法以约余实得商四步即以为隅法合亷隅纵共四十六用乘次商四得亷积一百六十步隅积十六步纵积八步共减积一百八十四步恰尽】命为濶二十四步　　加纵二步为长二十六步
　　合问
　　以图明之
　　甲为初商方形【长濶各二十步积四十步】已初商纵形【濶二步　长亦二十步积四十步】戊丙并次商廉【长各二十步　濶四步　积八十步】乙次商隅【方四步　积一十六步】丁次商纵亷【长四步　濶二步　积八步
　　以上五者合之为一长方形共长二十六步　濶二十四步
　　积六百二十四步合原数】
　　若纵数有比例可求者先以比例分其积平方开之得濶因以知长
　　假如有直田积四百五十步但云长多濶一倍问长濶若干
　　答曰濶十五步　长三十步
　　法平分其积得二百二十五步平方开之得濶十五步
　　置濶十五步倍之得长三十步合问
　　假如有长田积二百五十二步但云长比濶多四分之三问长若干
　　答曰　濶一十二步长二十一步
　　法以多三分加分母四共七为法以分母四乘积为实法除实得一百四十四步开方得濶一十二步置濶一十二步七因四除之得二十一步为长【长比濶多九步于十二步为四分之三】

　　开立方法
　　平方者方田之属也但取面羃之积立方者方仓之属也必求其内容之积故平方曰面立方曰体有面而后有体有线而后有面故皆以线为根
　　假如长二尺者线数也线有长短而无广狭若以此线横展之长亦二尺濶亦二尺则其积四尺为面面者平方形也面有濶狭而无厚薄又以此面层累而厚之长濶皆二尺高亦二尺则其积八尺为体体者立方形也立方有虚有实如筑方台则实凿方池作方窖则虚然其立方之积数一也
　　法先立位【同平方】　作防【自单位起每隔二位防之以最上一防为初商实】　定位【视有若干防则商几位如有二防则商数有十有五防则商数有百并同平方】
　　初商法　以自乘再乘数约而商之【如一商一八商二二七商三之类】书商数于左线之右【凡商得一数者书于防上一位商得二三四五者书于防上两位商得六七八九者书于防上三位】即以自乘再乘数书于左线之左以对减初商实【初商减积至初防止】
　　次商法　以初商自乘而三之为平亷法【亦曰方法】　以初商三之为长亷法【亦曰亷法】皆对原实千百位书之　截第二防上余实为次商实【次商减积至次防止】以平亷法约实得次商【列初商下】即以次商为隅法列长亷次【亦按千百位列之】乃以次商乘平亷法为平亷积又以次商自乘以乘长亷及隅法为长亷小隅积俱挨书之以减余积不及减者改商
　　三商法　以余实另列之　合初商次商自乘而三之为平亷法　合初商次商三之为长亷法　截第三防上余实为三商实【三商减积至此防止】　亦即以三商为隅法【余并同前】
　　四商以上并同三商
　　命分法　合平亷长亷法再加隅一为命分母不尽之数为命分子【并同平方】
　　还原法　置商数自乘得数再以商数乘之即合原实【有不尽者以不尽之数加入之】
　　初商表【用法与平方表同】










　　假如立方积五千八百三十二尺问方若干
　　答曰方一十八尺


　　列实
　　作防定位【有两防初商是十】


　　初商【以五千为初商实约商一十自乘再乘得一千为应减积减原实余四千】
　　次商【以初商自乘而三之得三百为平亷法　又以初商三之得三十为长亷法　以平亷法约第二防上余实得八尺为次商即以为隅法并如法列之乃以次商乘平亷法得二千四百为平亷积又以次商自乘得六十四以乘长亷及隅法得长廉一千九百二十隅积五百一十二共减积四千八百三十二恰尽】




　　以图明之
　　甲为初商方形【长濶皆十尺积一千尺】乙为次商平亷凡三以辅于
　　方之三面【长濶皆十尺厚八尺积八百尺共积
　　二千四百尺】
　　丙为次商长亷亦三以辅三
　　平亷之隙【长十尺濶与厚皆八尺积六百四十
　　尺共积一千九百二十尺】
　　丁为次商隅如小立方以补三长亷之隙【长濶高皆八尺积五百一十二尺】
　　假如立方积二千二百五十九亿七千七百八十一万一千五百七十尺问方根若干答曰方六千零九十尺【又一亿一千一百二十八万二千五百七十一之一亿一千一百二十八万二千五百七十】
　　列实【实尾无单位补作○】作防定位【有四防初
　　商是】
　　千
　　初商【合实三位约之商六千对初防上三位列之以六千自乘再乘得减积二千一百六十亿其余积改书以待次商】
　　次商【日乘初商而三之得一亿○八百万为平亷法以初商三之得一万八千为长亷法各对原实位列之　以第二防上余实为次商实实首有两○无可商是次商○也作○于初商之下即于实首消去两○余俟三商】
　　三商【次商○即以次商法为三商法　以第三防上余实为三商实以平亷法约之商九十尺即以为隅法对实十位列之乃以九十乘平亷法得平亷积九十七亿二千万又以九十自乘得八千一百以乘长亷及隅法得长亷积一亿四千五百八十万隅积七十二万九千共减积九十八亿六千六百五十二万九千】
　　四商【以第四防上余实另列之　合三次商数六○九自乘而三之得一亿一千一百二十六万四千三百为平亷
　　法　又以六○九三之得一万八千二百
　　七十为长亷法　以法约实仅与两亷法
　　之数相同无隅积不能成一单数以法命
　　之合平廉长亷数加隅一为命分母余实
　　为命分子】
　　命为立方六千○九十尺又【一亿一千一百二十八万二千五百七十一尺之一亿一千一百二十八万二千五百七十】
　　自乘　　　　　　再乘






　　厯算全书卷三十八
<子部,天文算法类,推步之属,历算全书>
　　比例规用法假如原序
　　康熙癸未季弟尔素有比例规用法假如之作又五年丁亥重加挍録示予属为序序曰形而上者不可得而数有数可数即有象可见故算法量法理本相通而尺可为算器也厯书中有书一卷耑明尺算谓之比例规觧比例云者谓以尺中原有之两数求今所问之两数以例相比如古者异乗同除及西人三率之法而有尺以着其象则不烦言説乃作者之意也规云者谓以铜铁为规器两髀翕张用其末鋭分指两尺上同数以得横距而命得数则用尺之法也规本画圆之器于尺为借用故仍其名曰规本觧有作法用法惜无设例罕能用者携李陈献可荩谟补作例祗平分一线而已龙舒方位白中通作数度衍以横尺取数而不用规亦惟平分一线夫平分用止乘除聊足以明异乗同除之理而尺算之善不尽于是若乃平方立方分圆轻重诸术其求法多不以异乗同除为用而数变为线爰生比例即尽归于异乗同除此其所长也又规端取数毫牦可辨而防移进退简快灵妙横距虽无数而取诸本尺其则不逺固胜横尺矣吾弟此书仍其用规本法自平分以下十线一一为之用例以明之原书谬误稍为刋正然后其书可得而用为功于度数之学不小也忆嵗乙夘余始购得厯书抄本于吴门姚氏偶缺是觧至戊午秋介亡友黄俞邰太史虞稷借到皖江刘潜柱先生本抄补之葢逾时而后能通其条贯以是正其讹阙又次年己未始为山隂友人何奕美作尺亦稍以己意増损推广之而未暇为立假如今得尔素是书可以无作矣勿庵兄文鼎序
　　【方尔素撰此书时安溪相国以冢宰开府上谷公子世得钟伦鋭意厯算之学余兄弟及儿以燕下榻芝轩与诸同学晨夕问难甚相得也无何尔素挈儿燕南归相国入参密勿而世得亡儿相继化去余亦大病滨死然犹能偷视息至今日为尔素序此书不可谓非不幸中幸也忆尔素六十时余有句云如稼观登塲如行将百里何以収桑榆无为所生耻今当相与念兹弗替尔勿庵又识】

　　凡例
　　按西士罗雅谷自序谓译书草创润色之増补之必有其时今之释例不嫌小有同异所以相成当亦作书者之所欲得也
　　比例规觧原列十线为十种比例之法今仍之比例既有十种可各为一尺今总归一尺者便携也一尺中列十线则一尺而有十尺之用恐其不清故各线之端书某线以别之
　　各线并从心起数惟立方线初防最大割线亦然又五金线之用近尺末故俱不到心以便他线之书字然其实并从心起算用者详之【尺心即尺端也两尺端聫于枢心成一防故从兹起算】




　　钦定四库全书
　　厯算全书卷三十九
　　宣城梅文鼎撰
　　目録
　　第一平分线
　　第二平方线【原名分面】
　　第三更面线【原名变面】
　　第四立方线【原名分体】
　　第五更体线【原名变体】
　　第六割圆线
　　第七正线【旧名节气】
　　第八切线【旧名时刻】
　　第九割线【旧名表心】
　　第十五金线【附三线比例】
　　以上十线并如旧式惟平方立方改从古名取其易晓又正改附割圆切线分为时刻取其便用割线去表心之目以正其名免悮用也説见各条之下
　　又按罗序言此器百种技艺无不赖之功倍用防为造玛得玛第嘉之津梁然则彼中借此制器如工师之用矩尺则日晷等制并其恒业乃书中图説反有参错非故为靳秘也良由仿造者众未必深知法意爰致承讹抑或译书时语言不能尽解而强以意通遂多笔误耳今于其似是而非之处彻底厘清以合测量正理起立法之人于九京必当莫逆






　　比例尺式【即度数尺也原名比例规以两尺可开可合有似作圆之器故亦可云规】





　　用薄铜板或厚纸或坚木【黄杨木等】作两长股如图任长一尺上下广如长八之一两股等长等广股首上角为枢以枢心为心从心出各直线以尺大小定线数今折中作五线两股两面共十线可用十种比例之法线行相距之地取足书字而止尺首半规余地以固枢也用时张翕防移




　　比例尺又式





　　前式两股相叠此式两股相并股上两用之际以为心规余地以安枢其一规面与尺面平而空其中其一剡规而入于彼尺之空令宻无罅也枢欲其无偏也两尺并欲其无罅也枢心为心与两尺之合线欲其中绳也张尽令两首相就成一直线可作长尺或以两尺横直相得成一方角可作矩尺




　　规式【此本为画圆之器尺算赖之以取底数葢相湏为用者也】






　　用铜或鐡亦如尺作两股但尺式扁方此可圆也首为枢可张可翕末鋭以便于尺上取数也当其半腰缀一铜条横贯之势曲而长如割圆象限之弧与枢相应得数后用螺钉固之
　　凡算例假如有言取某数为底线者并以规之两鋭于平分线上量而得之其用底线为得数者并以规取两尺上线相等之距于平分线上量而命之故规之两鋭可当横尺数度衍以横尺比量反不如用规之便利而得数且真也
　　第一平分线




　　此线为诸线之根取数贵多尺大可作一千然过宻又恐其不清也故以二百为率
　　分法　如设一直线欲作百分先平分之为二又平分之为四又于每一分内各五分之则已成二十分矣于是用更分法取元分四改为五分【如甲乙丙有丙戊丁三防是元分之四也今复匀作五分加己庚辛壬四防】则元分与次分之较【如壬丙及巳戊】皆元分五之一亦即设线百分之一分凖此为度而周布之即百分以成
　　解曰元分为设线百分为二十分之一即每一分内函五分也今壬丙己戊既皆五分之一则甲壬己乙皆五分之四亦即百分之四也又丙辛庚戊皆三而辛丁丁庚皆二也任用一度参差作防互相攷订即成百分匀度矣【每数至十至百皆作字记之】　或取元分六复五分之亦同何则元分一内函五分则元分四共函二十分故可以五分之若元分六即共函三十分故亦可五分之其理一也
　　用法一　凡设一直线任欲作几分假如四分即以规量设线为度而数两尺之各一百以为乃张尺以就度令设线度为两之底置尺【置尺者置不复动故亦可云定尺下仿此】数两尺之各二十五以为敛规取二十五两防间之底以为度即所求分数【即四分中一分也以此为度而分其线即成四分】　若求极微分如一百之一如上以一百为设线为底置尺次以九十九为取底比设线其较为百之一　若欲设线内取零数如七之三即以七十为设线为底置尺次以三十为敛规取底即设线七之三
　　谨按尺筭上两等边三角形分之即两句股也两句聫为一线而在下直谓之底宜也若两尺上数原系斜改而称腰于义无取今直正其名曰
　　用法二　凡有线求几倍之以十为设线为底置尺如求七倍以七十为取底即元线之七倍若求十四倍则倍得线或先取十倍更取四倍并之
　　用法三　有两直线欲定其比例以大线为尺末之数【尺百即百千即千】置尺敛规取小线度于尺上进退就其两等数如大线为一百小线为三十七即两线之比例若一百与三十七可约者约之【约法以两大数约为两小数其比例不异如一百与三十约为十与三】
　　用法四　有两数求相乗假如以七乗十三先以十防为取十三防为底置尺次检七十之等取其底得九十一为所求乗数【若以十为七为底置尺而检一百三十防之底得数亦同】
　　【论曰乗法与倍法相通故以七乗十三是以十三之数七倍之是七个十三也以十三乗七是以七数十三倍之是十三个七也故得数并同】
　　用法五　有两数求相除假如有数九十一七人分之即以本线七十为取九十一为底置尺次检十防之取底必得十三为所求
　　又法以九十一为用规取七十为底置尺敛规取一十为底进退求其等亦得十三如所求
　　【论曰筭家最重法实今当以七人为法所分九十一数为实乃前法以法数七为实数九十一为底又法反之而所得并同何也曰异乗同除以先有之两率为比例筭今有之两率虽曰三率实四率也徴之于尺则大与大底小与小底两两相比明明四率较若列睂故先有之两率当则今所求者在底是以之比例例底也若先有之率当底则今所求者在是以底之例例也但四率中原缺一率比而得之固不必先审法实殊为简易矣】
　　【然则乗除一法乎曰凡四率中所缺之一率求而得之谓之得数乗则先缺者必大数也故得亦大数除则先缺者必小数也故得亦小数所不同者此耳是故乗除皆有四率得尺筭而其理愈明亦诸家所未发也】
　　假如有银九十六两四人分之法以人数取四十分为底置银数九十六两为定尺敛规取一十分为底进退求其等得二十四两为每人得数
　　又法取银数九十六两为底置一百分为定尺敛规于二十五分等取其底亦得二十四两为每人数
　　又如有数一百二十三欲折取三分之一法以规取三十分为底置一百二十三等数为两定尺敛规取一十数为底进退求其等数为必得四十一命为三分之一如所求
　　用法六　凡所求数大尺所不能具则退位取之假如有数一百二十欲加五倍即退一位取一十二为底以尺之一十防为两定尺取两五十防之底【即五倍】得六十进一位命所得为六百【以一十二当一百二十是一而当十故进位命之也凡用尺筭湏得此通融之法】
　　又法以规取一十数为底于尺之一十二防为两【一十二以当一百二十是一当十也或二十四亦可为一当五】定尺展规取五十数【以当五倍】为底进退求其等数之必得六十进位成六百
　　假如有银十三两每两换钱一千二百文法退二位以规取十二分【当一千二百以尺上一数当一百】为底置一十防【即每两之位】为定尺然后寻一百三十防【即十三两之位】为展规取其底得一百五十六分进二位命之得共钱一十五千六百
　　又如有银四两每两换钱九百六十文法作两次乗先乗六十取六数为底置一十防为定尺展规取四十防之底得二十四次乗九百取九数为底置一十防为定尺展规取四十防之底得三十六进一位并之得三八四末増一○为进位得三千八百四十文
　　【二四三六】　　因每两是九百六十故末位増○
　　【三八四○千百十文】
　　假如有数一百二十欲折取三分之一法以规取六十【折半法也】为底置九十分为定尺然后寻两之三十分防【即三之一】取其底于本线比之必二十命所得为四十【加倍法也先折半故得数加倍】凡所用数在一十防以内近心难用则进位取之如前条所设宜用六数九数为底其防近心取数难清即进位作六十取数用之是进一位也但先进一位者得数后即退一位命其数此可于前假如中详之【用尺时有退位得数后进位命其数用尺时有进位得数后退位命其数其理相通故不另立假如】或先进二位者得数亦退二位或先加倍者得数折半并同一法
　　用法七　　　　　　凡四率法有中两率同数者谓
　　之连比例假如有大数【三十六】小
　　数【二十四】再求一小数与此两数
　　为连比例法以大数为【如辛甲】小数为底【如辛巳】定尺再以辛巳
　　底为【如甲丁】而取其底【如丁戊】其
　　数必【十六】则三十六与念四之比
　　例若念四与十六也【其比例为三分损一】若先有小数【十六】大数【二十四】而求连比例之大数则以小数为底【如丁戊】大数为【如丁甲】定尺再以丁甲为底【如辛巳】取其【如辛甲】其数必三十六则十六与念四若念四与三十六也【其比例为三分増一】他皆仿此【原书有断比例法今按断比例即古法之异乗同除西法谓之三率前各条中用尺取数皆异乗同除之法故不更立例】



　　用法八　　　　　　　凡句股形有句有股有共
　　三件先有两件而求其不知
　　之一件法以尺作正角取之
　　假如有句【八尺】股【十五尺】欲知其
　　法以规量取八十防为底
　　一端指尺上之六十四防一
　　端指又一尺之四十八防以
　　定尺则尺成正角乃于尺上
　　取八十防为句又于一尺上
　　取一百五十防为股张规以就所识句股之两防必一百七十退一位得十七尺如所求【取句股数时原进一位故所得数退一位命之説见前】
　　若先有【十七尺】股【十五尺】求其句则以规取一百七十防为句股之乃以规端指一百五十防以余一端又于一尺上寻所指之防必八十也如上退位得句八尺或先有【十七尺】句【八尺】求其股亦以规取【一百七十】而一端指【八十】寻又一端之所指必得【一百五十】命【一十五尺】为股如所求
　　凡杂三角形内无正角不可以句股
　　算法先作角假如先有一角及角
　　旁之两边求余一边法于平分线
　　【任用一笾如甲乙】取数为底分圆线【六十】度为
　　两定尺以规取所设角之底【为平分线上任用甲乙边等度之底】定尺则尺间角如所设【如乙角】乃于两尺上依所设取角旁两边之数于两尺各作识【如甲乙丙乙】遂用规取斜距之底【如甲丙】即得余一边如所求
　　又法　假如乙甲丙三角
　　形有甲角【五十三度○七分】甲乙
　　边【五十六尺】甲丙边【七十五尺】而求
　　乙丙边法以规取一百分
　　为分圆线上六十度之底敛规取五十三度强之底移于平分线上作百分之底定尺乃于尺上取五十六防【如甲乙】又一尺上取七十五防【如甲丙】乃以规取两防斜距之底于尺上较之即得六十一尺【如乙丙】命为所求邉【分圆线见后】
　　用法十　有小图欲改作大几倍之图用前倍法假如有小图濶一尺二寸今欲展作五倍即取十二为十防之底定尺展规取五十防之底必得六十命为六尺如所求
　　用法十一　平圆形周径相求法于平分线上作两识以一百八十八半弱上为周六十为径各书其号假如有径【七十一】求周法以规取七十一加于径防为底定尺展规取周防之底即得周二百二十三如所求【以周求径反此用之】
　　用法十二　求理分中末线法于线上定三防于九十
　　六定全分五十九又三之一
　　为大分三十六又三之二为
　　小分假如有一直线【一百四十四】欲分中末线即以设线加于
　　全分防为底取其大小分防之底即得【八十九强】为大分【五十五弱】为小分
　　【按平线上既作周径之号若又作此则太繁不如另作一线其上可寄五金线也　又按原书全分七十二大分四十二又三之一小分二十七又三之二大有讹错今改定】
　　以上十二用法姑举其概其实平分线之用不止于是善用者自知之耳



　　第二平方线【旧名分面线凡平方形有积有邉积谓之幂亦谓之面边线亦谓之根即开平方法也】



　　原为一百不平分今按若尺小欲其清则但为五十分亦可假如有积六千四百则以平分线之二十自乗得四百于积为十六倍之一若置二十分于一防为底求十六防之底则得方根八十或置于二防为底则求三十二防之底或置于三防为底则求四十八防之底皆同
　　分法有二　以算一以量
　　以算分



　　算法者自枢心【甲】任定一度命为十分【如甲乙】即平方积一百分之根今求加倍平方二百分之根为十四又念九之四即于甲乙线上加四分强【如丙】命甲丙为倍积之根求三倍则开平方三百分之根得十七又三十五之十一即又于甲乙线上加十分半弱【如丁】即甲丁为三倍积之根求四倍则平方四百之根二十即以甲乙倍之得甲戊为四倍积之根五六七以上并同【按用方根表甚简易】
　　以量分
　　以任取之甲乙度作正方形【如丙乙甲】乃于乙甲横边引长之以当积数丙乙直边引长之作垂线以当根数如求倍
　　积之根即于横
　　线上截丁乙为
　　甲乙之倍次平
　　分甲丁于戊戊为心甲为界作半圈截垂线于巳即己乙为二百分之边求三倍则乙丁三倍于甲乙四倍以上并同又防法　如前作句股形法定两尺间成正方角如甲乃任于尺上取甲乙命为一防而又于一尺取甲丙度与甲乙相等即皆为一百之根次取乙丙底加于甲乙
　　尺上为二百之根甲丁又自丁至丙作
　　斜以加于甲乙尺上为三百之根甲
　　戊又自戊至丙作以加于甲乙尺上
　　为四百之根甲已如此递加即得各方
　　之根其加法俱从尺心起【如求得丙乙即以丙加甲乙加丁成甲丁他皆仿此】
　　试法　甲乙为一正方形之边倍其度即四倍方积之边否即不合三倍得九倍方积之边四倍得十六五倍得二十五又取三倍之边倍之即十二倍之边【四其三也】再加一倍得二十七倍之边【九其三也】再加倍得四十八倍之边【十六其三也】再加倍得七十五倍之边【二十五其三也】若以五倍之边倍之得二十倍之边【四其五也】再加倍得四十五倍之边【九其五也】再加倍得八十倍之边【十六其五也　凡言倍其度者线上度也如正方四百分之边二十分甲乙正方一百分之边十分其大为一倍也言几倍方积者积数也如边二十者积四百即尺上所书】
　　用法一　有平方积求其边【即开平方】法先其设数与某数能相为比例得几倍如法求之假如有平方积一千二百
　　二十五尺欲求其根以约分法求得
　　二十五为设数四十九之一即以规
　　于平分线取五防为平方线上一防
　　之底定尺展规于四十九防取其底
　　即得一边三十五尺为平方根【积二十五方根五加四十九倍为积一千二百二十五方根三十五】　或用四十九为设数【一千二百二十五尺】二十五之一即以规取七防为平方一防之底而取平方二十五防之底亦得方根三十五如所求【积四十九方根七加二十五倍为积一千二百二十五则其方根三十五又法若无比例可求者但以十分为一防之底定尺有假如在用法七】
　　用法二　凡同类之平面形可并为一大形【或方或圆或三角多边等形但形相似即为同类】假如有平面正方四形求作一大正方形与之等积其第一形之幂积为二第二形之积为三第三形之积四有半第四形之积六又四之三法先并其积得【十六叉四之一】乃任取第一小形之边为
　　底二防为定尺【若用第二形之边为底定尺即用三防为】而于十六防又四之一取其底为大形边其面积与四形总数等
　　若但有同类之形而不知面积亦
　　不知边数则先求其积之比例如
　　甲乙丙丁方形四法以小形甲之
　　边为底平方线第一防为定尺
　　次以乙形边为底进退求等数得
　　第二防外又五分之一即命其积
　　为二又五之一【此与小形一之比例不拘丈尺】次
　　丙形边为底求得【二又四之三】丁形边
　　得【四又六之五】并诸数及甲形一得【十又
　　六十分之四十七】约为【五之四弱】向元定尺上
　　寻十防外十一防内之距取其五
　　之四为等数之两【即十一弱】用其底
　　为大方形边其面积与四形并数
　　等
　　【此加形法也圆面及三角等面凡相似之形并可相并其法同上】

　　用法三　平面形求作一同类之他形大于设形几倍
　　【以设形之邉为一防之底定尺】　假如有正方形面
　　积四百其邉二十今求别作一方形
　　其容积大九倍法以设形邉【二十】为平
　　方线一防之底定尺而取平方九防等数之底得【六十】如所求【邉六十其方积三千六百以比设形积为大九倍】
　　用法四　平面形求别作一同类之形为设形几分之几【以设形之邉为命分定尺而于得分取数】　假如有平方形积三千六百其邉六十今求作小形为设形九之四法以设形邉【六十】为平方第九防之底定尺而取第四防之底得【四十】如所求【邉四十其积一千六百以比设形积为九之四也九为命分四为得分】此减积法也圆面三角等俱同一法
　　用法五　有两数求中比例【即三率连比例之第二率】
　　假如有二与八两数求其中比例法先以大数为平方线八防之底而取二防之底得四如所求
　　二与四如四与八皆加倍之比例故四为二与八之中率
　　用法六　有长方形求作正方形　假如长方形横二尺直八尺如上图求得中比例之数为四尺以作正方形之边则其面积与直形等
　　直八尺横二尺　其积一十六尺
　　方形各边并四尺其积亦十六尺
　　用法七　有设积求其方根而不能与他数为比例则以一十数为比例
　　假如平积二百五十五用十数比之为二十五倍半即取十数为平方线一防之底而取二十五防半之底得十六弱为方根【十六自乗积二百五十六今只欠一小数故命之为十六弱】




　　第三更面线













　　【凡平面形方必中矩圆必中规其余各形并等边等角故皆为有法之形而可以相求】
　　分法
　　置公积四三二九六四以开方得正方形之根六五八三边形之根一千五边形之根五○二六边形之根四○八七边形之根三四五八边形之根二九九九边形之根二六○十边形之根二三七十一边形之根二一四十二边形之根一九七圜径七四二以本线为千平分而取各类之数从心至末取各数加本类之号
　　用法一　有平面积求各类之根【凡三角及多边各平面形其边既等故并以形之一边为根圆形则以径为根】法先以设数于平方线上求其正方根以此为度于更面线之正方号为底定尺次于各形之号取底即得所求各形边
　　假如有平面三等边形积二千七百七十一寸欲求其边法以设积于平方线上如法开其平方根【依前卷用法七以设数为十数之二百七十七倍强各降一位命为一数之二十七倍又十之七强乃以一数为平方一防之底定尺而于其二十七防十之七强取底数得五寸二六进一位作五尺二寸半强】以所得方根为更面线正方号之底定尺而取三等边号之底得八尺为三等边形根如所求
　　用法二　有平面形不同类欲相并为一大形法先以各形边为更面线上各本号之底定尺而取其正方号之底作线为所变正方形之边次以所变方边于分面线上求其积数而并之为总积
　　假如有甲【三角】乙【五边】丙三形欲相并先以甲边为三角号之底定尺而取其正方号之底作线于甲形内【如此则甲形已变为正方下同】书其数曰十次以乙边为五边号之底如前取其平方底向平方线求之得二十一半【其法以甲
　　邉为平方十防之底定尺而以乙所变方边进退求等度之命之】即
　　于乙形作方底线书之次以丙圆径
　　为平圆号之底如前求得十六弱并
　　三数得四十七半弱为总积【此因三形之邉
　　无数姑以小形命十数定尺而所得各方积并小形十数之比例】若三形内先知一形之面积即用其
　　所变方邉定尺则所得皆真数如上
　　三形但知丙形之积十六【或十六尺或十六寸】
　　【等】如法以丙形邉变方边于平方线十六防为底定尺余如上法求之亦必得甲为十数乙为二十一半总积四十七半但前条所得是比例之数比例虽同而尺有大小故以此所得为真数也
　　末以总数于原定尺上寻平方线四十七防半处取其底度为平方邉则此大平方形与三形面积等若欲以总积为五邉形则以所得大平方邉为更面线正方号之底定尺而于五邉形之号取其底即所求五边形之一邉【若欲作三角或圆形并同一法】
　　用法三　有平面形欲变为他形如上法以本形邉为本号之底定尺而取所求他形号之底
　　假如有三角形欲改平圆则以所设三角形之邉加于本尺三角形之号为底定尺而取平圆号之底求其数命为平圆径所作平圆必与所设三角形同积
　　用法四　有两平面形不同类欲定其相较之比例如前法各以所设形变为平方
　　假如有六邉形有圆形相较即如法各变为平方求其数平圆数二十六邉数三十六即平员为六邉形三十六之二十以二十减三十六得十六为两形之较












　　第四立方线【旧名分体线　凡平方形如棊局其四邉横直相等而无高与厚之数立方则如方柜有横有直又有髙而皆相等平方之积曰平积亦曰面积亦曰幂积如棊局中之细分方罫立方之积曰体积亦曰立积并如骰子之积累成方】




　　【旧图误以尺枢心甲书于一防上今改正甲乙一亦即一十则其内细数亦不平分旧图作十平分亦误今删去】
　　分法有二一以算一以量
　　以算分　从尺心甲任定一防为乙则甲乙之度当十分邉之积为一千【十分自乗之再乗之即成一千假如立方一尺其积必千寸】纪其号曰一次加一倍为立积二千开立方求其根得十二又三之一即于甲乙上加二又三之一为甲丙纪其号曰二再加一倍立积三千开立方得数纪三以上并同
　　防法　取甲乙邉四分之一加甲乙成甲丙即倍体邉又取甲丙七分之一加甲丙成甲丁即三倍体邉又取甲丁十之一加甲丁成甲戊即四倍体邉再加如图


　　【右加法与开立方数所差不逺然尾数不清难为定率姑存其意】
　　又防法用立方表
　　以量分　如后图作四率连比例而求其第二盖元体之邉与倍体之邉为三加之比例也【假如邉为一倍之则二若求平方面则复倍之为四是再加之比例也今求立方体必再倍之为八故曰三加　三加者即四率连比例也】
　　几何法曰第二线上之体与第一线上之体若四率连比例之第四与第一【第一为元邉线第二为加倍之邉线第三以邉线自乗为加倍线上之面第四以邉线再自乗为加倍线上之体今开立方是以体积求邉线即是以第四率求第二率也】
　　假如有立方体积又有加倍之积
　　法以两积变为线【元积如辛庚倍积如辛巳】作
　　壬巳辛庚长方形次于壬巳壬庚
　　两各引长之以形心【戊】为心作圈
　　分截引长线于子于午作子午直
　　线切辛角【如不切辛角必渐试之令正相切乃止】即辛庚【一率】午庚【二率】子巳【三率】己辛【四率】为四率连比例末用第二率午庚为倍积之一边其体倍大于元积
　　若辛巳为辛庚之三倍四倍则午庚邉上体积亦大于元积三倍四倍【以上仿此】
　　解四率连比例之理
　　试于辛防作卯辛为子午之垂线次
　　用子壬度从午作卯午直线截卯辛
　　线于卯又从卯作直线至子又从辛
　　防引辛庚邉至辰引辛巳邉至丑成
　　各句股形皆相似而比例等
　　【卯辛午句股形从辛正角作垂线至丑分为两句股形则形相似而比例
　　等为午丑辛形以午丑为句丑辛为股辛丑卯形以丑辛为句丑卯为股
　　则午丑与丑辛若丑辛与丑卯为连比例也　卯辛子句股形从辛正角
　　作垂线至辰分两句股形亦形相似而比例等　卯辰辛形卯辰为句辰
　　辛为股辛辰子形辰辛为句辰子为股则卯辰与辰辛若辰辛与辰子
　　亦连比例也而辰辛即丑卯故合之成四率连比例】
　　一率　辛庚　即午丑
　　二率　午庚　即丑辛　亦即辰卯
　　三率　子巳　即辛辰　亦即丑卯
　　四率　己辛　即辰子
　　试法　元体边倍之即八倍体积之邉若三之即二十七倍之邉四之即六十四倍体积之邉五之即一百二十五倍体积之邉
　　又取二倍邉倍之得十六【八其二也】再倍之得一二八倍体积之邉【六十四其二也】
　　三加比例表【平方立方同理即连比例】
　　第一率　　第二率　　第三率　　第四率





　　按第一率为元数第二率为线即根数也第三率为面平方幂积也第四率为体立方积也开平方开立方并以积求根故所用者皆二率也【比例规觧乃云本线上量体任用其邉其根其面其对角线其轴皆可其説殊不可晓今删去】
　　用法一　有立积求其根【即开立方】
　　假如有立方积四万法先求其与一千之比例则四万与一千若四十与一即取十数为分体线上一防之底定尺而取四十防之底得三十四强即立方之根【説见平方】
　　用法二　有两数求其双中率【谓有连比例之第一与第四而求其第二第三】法以小数为一率用作本线一防之底而取大数之底为二率既有二率可求三率
　　假如有两数为三与二十四欲求其双中率法约两数之比例为一与八即以小数三为本线一防之底定尺而于八防取底得六为第二率末以二率四率依法求中率得十二为三率
　　一率三　二率六　三率十二　四率二十四
　　用法三　设一体求作同类之体大于设体为几倍【此乗体之法】
　　假如设立方体八千其邉二十求作加八倍之体为六万四千问邉若干法以设体根二十为本线一防之底定尺而取八防之底得四十即大体邉如所求
　　用法四　有同类之体欲并为一法累计其积而并之为总积求其根即得
　　假如有三立方体甲容一十乙容十三又四之三丙容十七又四之一并得四十一即以甲容一十为本线一防之底定尺而取四十一防之底为总体邉如所求　若设体无积数则以小体命为一十而求其比例然后并之

　　用法五　有两同类之体求其比例与其较【此分体之法】假如甲丙两立方体欲求其较而不知容积之数法以甲小体邉为一防之底定尺而以丙邉为底进退求其等数如所得为九即其比例为九与一以一减九其较八即于八防取底为较形之邉
　　用法六　有立方体欲别作一体为其几分之几假如有立方体欲另作一体为其八之五则以设体邉为本线八防之底定尺而于五防取底为邉作立方体即其容为设体八之五


　　第五更体线【旧名变体线】




　　体之有法者曰立方曰立圆曰四等面曰八等面曰十二等面曰二十等面凡六种外此皆不能为有法之体
　　六等面体各面皆正方即立方也有
　　十二棱八角测量全义曰设边一百
　　求其容为一○○○○○○


　　浑圆体亦曰球体即立圆也几何补
　　编曰同径之立方积与立圆积若六
　　○○○○○○与三一四一五九二
　　设径一百求其容为五二三五九八
　　此三角平面形相合而成有六棱四
　　角测量全义曰设边一百求其容为
　　一一七四七二半




　　此体各面亦皆三等边形有十二棱
　　六角测量全义曰设边一百求其容
　　为四七一四二五有竒





　　此体各面皆五等边有三十棱二十
　　角测量全义曰设边一百求其容为
　　七六八六三八九





　　此体各面亦皆三等边有三十棱十
　　二角按几何补编二十等面体设边
　　一百其积二百一十八万一八二八
　　测量全义作边一百容五二三八○
　　九相差四倍故今不用

　　分法
　　置公积百万依算法开各类之根则立方六等面体之根为一百四等面体之根为二○四八等面体之根为一二八半十二等面体之根为五○半强二十等面体之根为七七圆球之径为一二四【原本十二等面根五○二十等面根七六圆径一二六今并依几何补编改定】　因诸体中独四等面体之根最大故本线用二○四平分之从心数各类之根至本数加字
　　用法一　有各类之立体以积求根【即开各类有法体之方】法皆以设积于立方线求其根乃移置更体线求本号之根即得
　　假如有十二等面体其积八千问邉若干法以一千之根十为立方一防之底定尺而取八防之底得二十为所变立方之根次以二十为本线上立方号之底而取十二等面号之底得一十○强即十二等面之一邉【他仿此】
　　用法二　有各类之立体以根求积　法先以所设根变为正方根乃于立方线求其积
　　假如有二十等面体其邉三十一弱问积法以根三十一弱为本线二十等面号之底定尺而取立方号之底得四十弱为所变立方之邉次于立方线以一十为一防之底而以四十进退求等数得【十六】防命其积【一万六千】如所求【邉一十其积一千则邉四十积一万六千】
　　用法三　有不同类之体欲相并为一【此以体相加之法并变为正方体积即可相并】
　　假如有三立体甲浑圆体【径一百二十四】乙二十等面体【邉七十七】丙十二等面体【邉五十○半】欲相并用前条法各以积变为立方积则三体之积皆一百万并之得三百万如所求
　　用法四　有不同类之两体求其比例与其较【此以体相减之法】法各变为立方体即可相较以得其比例并同更面线法


　　第六分圆线【即各弧度之通也旧名分线亦曰分圈】






　　分法有二一以量一以算
　　以量分　法作半方形如甲乙丙令甲丙斜与本线
　　等长以乙方角为心甲为界作象限
　　弧如甲丁丙乃匀分之为九十度各
　　识之次从甲防作直线至各度移入
　　尺上识其号　若尺小可作六十度
　　即本线之长为六十度号　若尺大可作一百八十度即本线之半为六十度号
　　以算分　法用正表倍之为倍度之通　假如求六十度通即以三十度之正【五○○○○】倍之得【一○○○○○】即六十度之通他皆若是
　　试法十八为半周十之一【即全圈二十之一也】三十六为半周五之一【即全圈十之一】四十五为半周四之一【即全圈八之】七十二为半周五之二【即全圈五之一】九十为半周之半【即全圈四之一谓之象限】百二十度为半周三之二【即全圈三之一】
　　用法一　有圆径求若干度之弧以半径当六十度取之
　　假如有甲乙丙全圈有甲丙径求五十度之弧即以甲丙径半之于丁以甲丁半径为本线六十度之底定尺而取五十
　　度之底如甲乙直线以切圆分即得甲戊乙弧为五十度如所求
　　用法二　若以弧问径则反之
　　如先有弧分如甲戊乙为五十度而问全径法从弧两端聫之作直线如【甲乙】用为本线五十度之底定尺而取六十度之底为半径【甲丁】倍之得全径【甲丙】
　　用法三　直线三角形求量角度
　　法以角为心任用规截角旁两线作通如法得角度
　　假如甲丙乙三角形不知角法任用甲丁度以甲为心作虚圈截甲丙线于丁截甲乙线于戊次作丁戊直线次即用甲丁原度以乙为心如法截甲乙于辛截丙乙于庚
　　作辛庚直线末以甲丁为六十度之底定尺乃用丁戊为底进退求其等度之号得甲角之度用辛庚为底亦得乙角之度合两角减半周得丙角度
　　如甲角六十五乙角四十则丙角必七十五
　　用法四　平面等邉形求其径
　　假如有五等邉平面形欲求径作图【即对角辏心直线】法以设邉为分圆线七十二度之底而取其六十度之底为半径以作平圆末以原设边为度分其周为五平分即成五等面如所求【他等邉形并同】
　　五等邉形有一邉如丙乙如法求
　　得乙甲半径以甲为心乙为界作
　　平圆而以丙乙邉度分其圆得丁
　　戊己等防作线聫之即成五等邉形而所作圆即外切之圆










　　第七正线【旧名节气线以其造平仪时有分节气之用也然正在三角法中为用甚多不止一事不如直言正以免挂漏】




　　正线不平分亦近枢心大而渐小与分圆同
　　分法　全尺为一百平分尺大可作一千于正表取数从枢心至各度分之每十度加号
　　简法　第一平分线可当此线其线两傍一书平分号一书正号
　　又法　分圆线可当此线以分圆线两度当正一度纪其号
　　假如分圆六十度齘即纪正三十但分圆之号直书则正横书以别之

　　解曰凡正皆倍度分圆之半故其比例等然则分圆之一度即正之半度而半度亦可取用为尤便也

　　如图甲乙为通甲丙乙丙皆正

　　用法一　有设弧求其正法以九十度当半径假如有七十五度之弧求正即以本圈半径为正线九十度之底定尺而取七十五之底为正如所求
　　用法二　有弧度之正数求径数则以前条反用之假如有七十五度之正数即用为本线七十五度之底定尺而取其九十度之底得半径数
　　用法三　句股形有角度有求句求股法以当半径正当句与股
　　假如句股形之二丈有对句之角
　　三十度即取平分线之二十当数
　　为正线九十度之底而取三十度
　　之底得一十即其句一丈
　　又于其角之余【即六十度正】取底得【一十七又三之二弱】即其股为【一丈七尺三寸二分】
　　若以句求则反之如句一丈其句与所作之角为六十度其余角三十度即取一十数为三十度之底定尺而取九十度之底得二十命其二丈
　　用法四　三角形以邉求角　假如三角形有乙甲邉甲丙邉及丙角度而求乙角法以乙甲邉数为丙角正之底定尺而以甲丙
　　邉为底进退求其等度取正线上号为乙角度如所求
　　用法五　三角形以角求邉
　　假如三角形有戊角度己角度及庚己邉而求庚戊邉法以庚己邉为戊角正之底定尺而取己角正之底得数即为庚戊邉如所求　余详三角法举要
　　用法六　作平仪求太阳二至日离赤道纬度
　　如图以十字分大圆直者为两
　　极横者为赤道横直交于圆心
　　即地心也赤道即春秋分日行
　　之道也地心至两极半径为正
　　线九十度之底定尺取二十
　　三度半之底于地心上下各作防于直线于此防作横线与赤道平行为二至日道近北极者夏至近南极者冬至也
　　又求作各节气日道
　　法先求黄道线
　　法于夏至之一端作斜线过地心至冬至之又一端即成黄道日行其上一嵗一周天者也以黄道半径为九十度之底定尺每十五度正取底移至黄道半径上【并从地心起度】






　　于地心上下各识之即各节气日躔黄道上度也【或三十度取底则所得皆中气】
　　乃自黄道上各防作直线并与赤道平行即各节气日行之道此与分至日道皆东升西没一日一周者
　　也其各线两端
　　抵大圆处即各
　　节气赤道纬度
　　也春分以后在
　　赤道北秋分以
　　后在赤道南
　　试法于二至日道两端作横线聫之【如甲乙】次以此横线之半为度【如丙乙】过赤道处【如丙】为心作半圈于大圆之上【如乙戊甲半圆】亦如法作半圈于下两半圈各匀分十二分作识【若但求中气可分六分】上下相向作直线聫之即必与先所作日行道合为一线　又以甲丙为正九十度之底定尺而于其各正取底亦即与原定日道纬度线合【如丙辛三十度之正也与赤道旁第一纬线合丙丁六十度之正也与第二纬线合左右上下考之并同】
　　用法七　定时刻【仍用平仪】
　　法以平仪上赤道半径为正线九十度之底定尺而于各时刻距卯酉之度取其正于赤道作识【过两极轴线处即夘正酉正也距此而上三十度午前为辰正午后为申正距此而下三十度子前为戌正子后为寅正距此而上六十度午前为巳正午后为未正距此而下六十度子前为亥正子后为丑正至圆周处上为午正下为子正】即春秋分之时刻也欲作各时初正及刻凖此求之并以正为用【每时分初正各加距十五度初正又各分四刻每刻加距三度又四分之三并取正如前法】又以二至日道之半径为正
　　九十度之底定尺如
　　法取各正作识即二
　　至之时刻也　末以分
　　至线上时刻作弧线聫
　　之即得各节气之时刻

　　凖此论之平仪作时刻亦用正比例规觧以正名节气线切线名时刻线区而别之非是








　　第八切线【旧名时刻线今按平仪时刻原用正惟以日景取髙度定时刻斯用切线耳又如浑盖通宪等法亦皆切线其用甚多故不如直名切线】




　　切线不平分先小渐大至九十度竟平行无界故只用八十度或只作六十度亦可
　　分法　简切线本表八十度之切线五六七即于尺上作五六七平分次简各度数分之逢十加识
　　用法一　三角形求角
　　假如乙甲丁三角形求乙角任截角
　　旁线于丙得乙丙十寸自丙作垂线
　　戊丙量得七寸次用十数为切线四十五度之底定尺而以戊丙七数为底进退求等度得三十五度为乙角
　　用法二　求太阳地平上髙度【用直表】
　　法曰凡地平上直立之物皆可当表以表高数为切线四十五度之底定尺而取表影数为底进退求等度得日髙度之余切线
　　假如表髙一丈影长一丈五尺法以丈尺变为数用一十数当表髙为切线四十五度之底定尺次以一十五数当影长为底进退求等度得五十六度十九分为日髙之余度以减九十度得日髙三十三度四十一分
　　癸丙地平上日高度与壬辛
　　等其余度癸丁为日距天顶
　　与戊辛等甲戊为表长其影
　　戊已乃日距天顶之切线在
　　日高癸丙为余切线也
　　用法三　求太阳髙度用横表
　　植横木于墙以候日影即得倒影为正切线之度假如横表长一尺倒影在墙壁者长一尺五寸法用十数当横表为四十五度之底定尺次以十五数当影长进退求等度得五十六度十九分即命为日高之度
　　凡亭台之内日影可到者量其檐际之深可当横表
　　卯寅墙　子甲为横表
　　太阳光从丁过表端甲射丑成子丑倒影丁丙为





　　日在地平上髙度与午子度等故以子丑倒影为日髙度之正切线也
　　按直表之影低度则影长髙度则渐短日度益髙则影极短故以余切线当直影【前图是也】横表之影低度则影短髙度则渐长日度益髙则影极长故以正切线当倒影【后图是也】比例规觧乃俱倒説今正之
　　用法四　求北极出地度分　假如江宁府立夏后九
　　日午正立表一丈测得影长为
　　二尺四寸法以一百数当表髙
　　为切线四十五度之底定尺而
　　以二十四数为底进退求等数
　　得一十三度半如法以减九十度得七十六度半为日出地平上髙度简黄赤距度表是日太阳北纬一十九度以减日髙度得赤道髙五十七度半转减九十度得北极髙三十二度半防法以直表所得一十三度半加太阳北纬十九度即得三十二度半为北极髙度
　　解曰直表所得太阳距天顶度也加北纬即赤道距天顶度亦即北极出地度
　　又如顺天府立春后四日如法
　　用横表三尺得倒影二尺一寸
　　依切线法求得日髙三十五度
　　简表得本日太阳南纬一十五
　　度以加日髙度得赤道髙五十
　　度以减九十度得北极髙四十度










　　第九割线【旧名表心线今按割线非表心又割线之用甚多非只作日晷一事故直名割线为是】




　　割线不平分先小后大并与切线略同故亦只作八十度或只作六十度亦可
　　分法　用割线本表八十度之割线五七五平分之其初防与切线四十五度等次依表作度加识
　　用法一　三角形以割线求角
　　假如有甲乙丙三角形求甲角法任
　　于甲角旁之一邉截戊甲十寸作垂
　　线如戊丁截又一邉于丁得丁甲十
　　九寸次以十数为割线初防之底定尺而以十九数为底进退求等数得五十八度一十七分为甲角之度
　　用法二　作平面日晷【兼用割切二线】
　　法曰先作子午直线卯酉横线十字相交于甲以甲为正午时从甲左右尽横线尽处为度于切线八十二度半为底定尺次于本线七度半取底向卯酉横线上识之自甲防起为第一时如甲丙甲乙次每加七度半取底如前作识为各时分【如七度半加之成十五度即第二时又逓加如二十二度半三十度三十七度半四十五度五十二度半六十度六十七度半七十五度至八
　　八十二度半合线末元定之防】若逓加三
　　度四十五分而取底作识
　　即每时四刻全矣【按每七度半加
　　防乃二刻也今每三度四十五分则一刻加防】订定法曰横线上定时刻
　　讫次取甲交防左右各十
　　二刻之度【即元定四十五度之切线亦即】
　　【半径全数】为割线上北极髙度之底定尺而取割线初防之底为表长【如壬庚】　次以表长当半径为切线四十五之底定尺而检北极髙度之正切取底自甲防向
　　南截之如甲壬以壬为表位
　　又于北极髙度之余切线取底
　　自表位壬向南截之如壬辛以
　　辛为晷心　末自晷心辛向横
　　线上原定时刻作斜直线引长
　　之得时刻　时刻在子午线西
　　者乙为午初丁为巳正癸为巳初又加之即辰正又加之即辰初在子午线东者丙为未初戊为未正巳为申初又加之即申正又加之即酉初并逓加四刻谨按卯酉线即赤道线也二分之日日躔赤道日影终日行其上庚甲割线正
　　对赤道正午时日影从庚射甲成庚甲影若已末午初则庚防之影不射甲而射乙而庚甲影如半径乙甲如切线矣以庚甲为切线上半径而递取各七度半之切线以定左右各时刻之防并日影从庚所射也然此时庚甲之度无所取故即用赤道线四十五度之切线代之用切线实用庚甲也【庚甲既为切线之半径则必与四十五度之切线同长】
　　以四十五度当半径而取切线以定时刻此天下所同也然赤道髙度随各方北极之髙而变庚甲割线何以能常指赤道则必于表之长短及表位之逺近别之故以庚甲当北极髙度之割线而取其初防为表长初防者半径也本宜以半径求割线今先有割线故转以割线求半径也既以庚壬表长为半径庚甲为割线则自有壬甲切线而表位亦定矣表位既定则庚甲影能指赤道矣何以言之表端壬庚甲角既为极髙度则庚角必赤道髙度而庚甲能指赤道也故北极度髙则庚角大甲角小而庚壬表短壬甲之距逺北极度低则赤道髙甲角大而庚壬表长壬甲之距近比例规觧乃以表位定于甲防失其理矣遂复误以割线为表长余割线为晷心而强以割线名为表心线名实尽乖贻误来学此皆习其业者原未深谙强为作觧而即有毫厘千里之差立法者之精意亡矣故特为阐明之
　　庚壬表上指天顶下指地心为半径
　　壬表位壬甲为正切线辛晷心辛壬
　　为余切线甲角即赤道髙度壬庚甲
　　角即北极髙度与辛角等
　　用法三　先有表求作日晷【借用前图可解】
　　法先作子午直线任于线中定一防为表位如壬乃以表长数壬庚为切线四十五度之底定尺而取本方北极出地度之底得壬甲正切度于表位北作防【如甲】次于甲防作卯酉横线与子午线十字相交即赤道线春秋分日影所到也又取极髙余度之底得壬辛余切线于表位南作防【如辛】即晷心也若自表端庚作直线至晷心辛即为两极轴线辛指南极庚指北极也次以表长【庚壬】与壬甲正切相连作正方角则庚壬如句壬甲如股而取其线庚甲即极出地正割线也次以庚甲为切线四十五度之底定尺而各取七度半之底累加之于甲防左右作识于卯酉横线上末自晷心辛作线向所识防即得午前后时刻并如前法
　　用法四　有立面向正南作日晷并同平面法但以北极髙度之余切线定表位以正切线定晷心则自晷心作线至表端能上指北极为两极轴线又立晷书时刻并逆旋与平面反然以立晷正立于北与平晷相连成垂线则其时刻一一相符
　　用法五　用横表作向东向西日晷
　　假如立面向正东法于近南作直线上指天顶下指地心近上作横线与地平相应两线相交于甲以甲为心于两线间作象限弧自下起数至本方北极出地度止自此向甲心作斜直线以分弧度
　　此线即为赤道次以甲为表
　　位用横表乙甲之长取数为
　　切线四十五度之底定尺递
　　取十五度切线从心向赤道
　　线累加之作识定时即春秋
　　分日影所到也【若分二刻则逓取七度半】
　　【细分每刻则逓取三度四十五分】次于甲心作横斜线如丁戊为赤道之垂线其余时刻防各作线与丁戊平行【亦并与赤道十字相交】次于元定尺上【即以表长为四十五度所定】取二十三度半之切线为度于甲左右截之为界【如丁甲如戊甲】即二至卯正时日影所到也【二分日卯正则乙甲表正对日光无影分前后则有纬度而影亦渐生日日不同然不离丁戊线至二至而极冬至影在北如丁夏至影在南如戊以此为界向西酉正时亦然】仍用元尺取【每十五度之黄赤距纬】切线作于丁戊线内从甲防左右作识得各节气卯正日影【或取三十度切线则所得每月中气酉正亦然】
　　次以乙甲表长为割线初防之底定尺而取十五度之割线为二分日在辰初刻之影如乙辛即天元赤道上日离午线十五度其光过乙至辛所成也就
　　以乙辛割线为切
　　线四十五度之底
　　而取二十三度半
　　之底自辛防左右
　　截横线并如辛壬
　　为冬夏至辰初刻日影所到之界【辛壬在南为夏至其在北为冬至亦然】又逓取【每三十度之黄赤距纬】切线从辛至壬作防为各中气界【此向南日影界乃赤道北半周节气其辛防向北作界为南半周亦然】自此而辰正而巳初而巳正以至午初并同乃于节气界作线聫之即成正东日晷其面正西立晷作法并同但其时刻逆书自下而上最下为未初次未正次申初次申正次酉初而至酉正则横表正对日光而无影矣此亦二分日酉正也其余节气亦有短影而不出本线与卯正同
　　新增时刻线【以切线分时刻本亦非误但切线无半度取度难清今另作一线得数既易时刻尤真】



　　分法　依尺长短作直线【如后图乙丙】于线端作横垂线【如乙甲为乙丙垂线】又作直线略短与设线平行交横线如十字【如甲巳线交横线于甲】以甲为心作象限弧六平分之为时限各一分内四平之为刻限次于甲心出直线过各时限至直线成六时过各刻限者成刻乃作识纪之【并如后图】
　　尺短移直线近甲心取之【移进线并与原直线平行以遇第六时第二刻为度如已戊虚线遇丁戊线于戊即戊为第六时之二刻】



　　用法　凡作日晷并以所设半径置第三时为底定尺而取各时刻之底移于赤道线上午前午后并起午正左右为第一时依次加识即各得午正前后时刻【并如前法】












　　第十五金线【即轻重之学】




　　物有轻重以此权之独言五金者以其有定质也五金之性情有与七政相类者因以为识
　　金【太阳】水银【水星】铅【土星】银【太隂】铜【太白】铁【火星】锡【木星】
　　分法　用各分率及立方线
　　比例率　【先取诸色金造成立方体其大小一般无二乃权其轻重以为比例】
　　黄金一
　　水银一又七十五分之三十八【仪象志作九十五分之三十八】
　　铅一又二十三分之一十五
　　银一又三十一分之二十六
　　铜二又九分之一
　　铁二又八分之三
　　锡二又三十七分之二十一【比例规觧原作三十七分之一则锡率反小于铜铁而轻重之序今依仪象志】
　　金体最重故以为凖自尺心向外任定一度为金之根率自此依各率増之并以金度为立方线上十分之底定尺次依各率为底进退求等数取以为各色五金之根率自心向金率防外作识
　　解曰此同重异积之率也于立方线上求得方根作识于尺则同重异根之率也金体重则其积最少【谓立方体积】各色之金【谓银铅等】体并轻于金故必体积多而后能与之同重然立积虽有多少非开方不得其根之大小故必于立方线求之也
　　又解曰先以同大之立方权之得各率者同根异重之率也而即列之为同重异根之率何也盖以根求重则金最重而他色轻以重求根则金最小而他色大其事相反然其比例则皆等假如金与铜之比例为一与二强若体同大则金倍重于铜矣若其重同者则铜之体必倍大于金其理一也
　　又法　用立方根比例率
　　黄金一六六弱
　　水银一九一弱
　　铅二○二
　　银二○四
　　铜二一三
　　铁二二二
　　锡二二八
　　用法一　有某色金之立方体求作他色金之立方体与之同重【或立圆及各种等面体并同】
　　假如有金球之径又有其重今作银球与之等重求径若干法以金球径数置本线太阳号为底定尺而取太隂号之底数作银球之径即其重与金球等
　　用法二　若同类之体其根同大求其重
　　假如有金银两印章体俱正方而其大等既知银重而求金重法以银图章之根数置太隂号为底定尺而取太阳号底数次于分体线上以银章重数为两太阳号底定尺而转以太隂底数【即银章根数】进退求等得数即金章之重












　　轻重比例三线法【附】
　　重学为西法一种其起重运重诸法以人巧补天工实宇宙有用之学五金轻重又重学中一种盖他物难为定率可定者独五金耳然比例规觧虽载其术而数多抵牾未可全据愚参以灵台仪象志其义始确因广之为三线曰重比例曰重之容比例曰重之根比例既列之矩算复为之表若论以发其凡康熙壬戌长夏勿葊梅文鼎谨述
　　重比例【异色之物　体积同轻重异】







　　解曰重比例者同积也积同而求其重则重者数多轻者数少若反其率则为容积比例矣
　　用法　假如有金一件不知重法以水盛器中令满权其重乃入金其中则水溢溢定出金乃复权之则水之重必减于原数矣乃以所减之重变为线于比例尺置于水防为底乃于金防取大底即金重也　又如有玉刻辟邪今欲作铜者与之同大问用铜几何法如前以玉器入水取水减重之数置水防为底取铜防大底即得所求【若作诸器用蜡为模亦同或以蜡轻难入水者竟以蜡重于蜡防为底而取铜防大底更妙也】
　　重之容比例【轻重同则容积异亦谓异色之物】





　　解曰容比例者同重也同重而求其积则重者积数少轻者积数多反其率亦即为轻重之比例矣
　　又觧曰容积比例以立方求其根则为根比例矣故轻重当为三线也
　　用法　假如有水若干重盛器中满十分有澒与水同重盛此器中问几何满法以水满十分之数作水防之底而取澒防小底则知澒在器中得几分
　　用法二　有同重之两色物欲知其立方根法以容比例求其同重之积再于分体线求其根
　　用法三　有金或铜锡等不知重法如前入水求得水溢所减之重变为线乃以水重置金防为底【若铜锡亦置铜锡防】于水防取大底【此借容比例求重故反用其率】若用蜡模铸铜器亦以蜡重置铜防为底【而于蜡防取大底即得合用铜斤】
　　觧曰有二法三法则只须容比例一线足矣盖反用之可以求重既得容可以求根【用三线者取其便用一线者取其简可任意为之也】
　　又容比例【附】







　　又客比例







　　解曰容比例有三率也其实一率而已第一率以水为主取其便用也第二率以金为主取其便擕也第三率平列乃立方之积数也其作线于尺则皆一率而已矣
　　此外仍有通分之法亦愚所演然其理皆具原表中故仍载表而附之故后
　　轻重原表









　　右表灵台仪象志所引重学一则也其法同重者以直推见容积同积者以横推见重重比例容比例皆在其中矣既得容可以求根则根之比例亦在其中矣比例规觧五金线盖原于此原书金与蜡之比例讹卄一为廾九今改定
　　通分法【亦容比例之率】
　　分母
　　澒九五
　　铅廾三乗得二一八五
　　银卅一又乗得六七七三五
　　铜○九又乗得六○九六一五
　　铁○八又乘得四八七六九二○
　　锡卅七又乗得一八○四四六○四○为金率
　　以澒分母九十五除金率得一八九九四三二以乗分子卅八得七二一七八四一六加金率得二五二六二四四五六为澒率
　　以铅母卄三除金率得七八四五四八○以乗子十五得一一七六八二二○○加金率得二九八一二八二四○为铅率
　　以银母卅一除金率得五八二○八四○以乗子廾六得一五一三四一八四○加金率得三三一七八七八八○为银率
　　以铜母九除金率得二○○四九五六○以乗子一得如原数加金率二得三八○九四一六四○为铜率
　　以铁母八除金率得二二五五五七五五以乘子三得六七六六七二六五加金率二得四二八五五九三四五为铁率
　　以锡母卅七除金率得四八七六九二○以乗子廾一得一○二四一五三二○加金率二得四六三三○七四○○为锡率







　　按自古厯算诸家于尾数不能尽者多不入算故曰半已上収为秒巳下弃之其有不欲弃者则以大半少强弱収之
　　假如一百分则成一整数【九十为一弱一十为一强】百二十五为少即四分之一也【若二十为少弱三十为少强】五十为半【四十为半弱六十为半强】七十五为太即四分之三也【七十为太弱八十为太强】重之根比例【异色同重之立方】





<子部,天文算法类,推步之属,历算全书,卷三十九>
　　附求重心法
　　乙甲癸子形求重心先作乙甲线分为【乙子甲乙癸甲】两三角
　　形次用三角形求心术求【乙子甲乙
　　癸甲】之形心在【丙丁】作丙丁线聫之
　　又作子癸线分为【癸乙子癸甲子】两
　　三角形求【癸乙子癸甲子】形之心在【庚辛】作庚辛线聫之　此二线相交
　　于壬则壬为本形心即重心也　试作乙巳正角线至子癸线上又作甲戊线至子癸线上此两线之比例即两形大小之比例也【法为癸乙子形与癸甲子形之比例若乙巳与甲戊也】以此比例于庚辛两心距线上求得壬防为全形之重心【法为乙巳线与甲戊若辛壬与庚壬】
　　如图子巳与癸戊之比例
　　若丁壬与丙壬也余并同
　　前图

　　一率　子巳与癸戊二线并
　　二率　子巳
　　三率　丁丙
　　四率　丁壬











　　歴算全书卷三十九
<子部,天文算法类,推步之属,历算全书>
　　方程论自叙
　　方程于数九之一也何独于方程乎论曰方程犹句股也数学之极致故二以殿乎九今之为数学往往覃思勾股而略方程不宁惟略抑多沿误佹于阙矣数九而阙其一可以无论乎议者谓勾股测量用以知道里之修城邑之广山之髙水之深天地日月之行度若方程筭术多取近用米盐凌杂非其精且大是不然精觕小大人则分之而自一至九之数无分也且数何兆欤当其未始有物之初混沌鸿蒙杳防恍惚无始无终无声无形无理可名无数可纪乃数之根也是谓真一真一者无一也一且非一而况其分及其自无之有无一而忽然有一有一则有万万者一之万也万各其一一各其万即万即一环应无端又孰从而精麄之小大之乎故果蓏之有理而星度齐观理实同源数亦防防苟未达此而侈言髙逺遗乎目睫将日用之酬酢有外乎理数以自立者哉而二之也古者数学大司徒以备乡之三物教万民而賔兴之其属保氏掌之以教国子具曰九数未尝右勾股于方程也虽然古之人以其进乎数者治数故用之简易而言之约今欲于古学既湮之日出独是以信众疑使方程之沿误皆正而九数阙而复全则意取共明固不敢谬托简古以自文其疎愚之论乃不觉其复矣凡六卷论成于壬子之冬写而成帙则甲寅之夏勿庵梅文鼎自识









　　余论
　　数学有九要之则二支一者筭术一者量法量法者长短逺近以求其距西法谓之测线方圆弧矢幂积周径以相求西法谓之测面立方浑圆堆垜之形以求容积西法之测体在古九章则为方田为少广为商功为句股筭术者消息盈虚乘除进退以差多寡騐往以测来西法谓之比例通分子母整齐画一不尽者以法命之西法谓之畸零若夫隠杂重复参错难稽即显騐幽探赜穷深无例可比故西法别立借衰互徴以为用亦比例也在古九章则为粟布为衰分为均输为盈朒为方程此二者相需不可偏废虽然筭术可以济量法之穷而量法不可以尽筭术之变何也可量者其可见也天下之不可见者多矣非筭术何以御之故量法有穷而筭术不穷也夫既量之而得其率矣所量者一欲知者百西法之用比例亦以筭术佐量法也然以例相比非量法而有量法之理吾友桐城方位伯谓九章出于句股葢以此也然吾观方程正负同异减并之用非句股所能御而能生比例愚故以筭术必不可废也
　　言数学者亦有二家一古法一泰西泰西之説详明晓畅古人之法径捷简易可互明也然古书仅存筭术而略于测量泰西详于测量而或遗在筭术吾观泰西家言矩度三角八线割圆几何原本备矣谓其善用句股能有新意出于古率之外未为过也若所译同文筭指者大约用三率以变古法至于盈朒方程则其术不复可行于是取古人之法以传之非利氏之所传也算术之妙莫盈朒方程若而泰西皆无之是九章阙其二也尚谓之贤于古法乎且泰西家欲以其説易天下故必宛转笺疏以达其意以取信于学者若盈朒方程立法之意殊不能言也不能言盈朒故别立借衰之法以代之自谓超妙可废古法矣而终不能废盈朒若方程一章不但不能言之亦不能用之不过取古人之仅存者具数而已不能别立术以代之也诸书之谬误皆沿之而不能察其必非知之而不用能言之而不悉亦可见矣夫古人之略于量法者非不能言也言之略耳言之详者别有専书而人不能习不传于世耳学士大夫既苦其难竟又无与进取弋获之利遂一切弃置不道浅猎焉者率得少以自多无所发明遂使古人之精意若存若亡不复可见今诸书所载方程法残缺错乱视盈朒尤甚其所仅存又多为后之不得其説者参以臆解而其防益晦非古人旧也使古之方程仅仅如此何必别立一章列于盈朒之后乎然以好变古率如泰西而不能变方程勤于言筭如泰西而不能言方程不能尽其用不能正其沿误可见古人立法之深逺而决不可易向使习古法者尽见古人之书又能如泰西家羣萃州处穷年累月研精覃思以为之引伸而推广又岂止如斯而已乎言之三叹


　　方程论发凡
　　一方程立法之始
　　按周礼九数一曰方田以御田畴界域一曰粟米【一作粟布】以御交质变易一曰差分【一名衰分】以御贵贱廪税一曰少广以御积方程一曰商功以御功程积实一曰均输以御逺近劳费一曰盈朒【一云赢不足】以御隠襍互见一曰方程以御错糅正负一曰句股【一云旁要】以御髙深广逺是则方程者九数之一乃九章中之第八章也通雅以九数为周公之法盖自隶首作筭数以来有九章即有方程渊源逺矣
　　一方程命名之义
　　方者比方也程者法程也程课也数有难知者据现在之数以比方而程课者则不可知而可知即互乗减并之用
　　一方程残缺之故
　　按七十子身通六艺则九数在其中自汉以后史称卓茂刘歆马融郑何休张衡皆明筭术唐宋取士有明筭科六典筭学十经博士弟子五年而学成宋大儒若邵康节司马文正朱文公蔡西山元则许文正王文肃莫不精筭然则筭学之疎乃近代耳夫数学一也分之则有度有数度者量法数者筭术是两者皆由浅入深是故量法最浅者方田稍进为少广为商功而极于句股筭术最浅者粟布稍进为衰分为均输为盈朒而极于方程【详见末卷方程能御襍法】方程于筭术犹句股之于量法皆其最精之事不易明也而筭学无闗进取皆视为贾人胥史之事而不屑从事又其用近小但于方田粟布取之亦无不足故近代诸刻多不具九章其列九章者不过寥寥备数学者虽欲推明古法孰从而求之此方程残缺之由也
　　一方程谬误之故
　　方程句股皆不为近用所需然句股测望自昔恒有専书近者西学骤兴其言句股尤备故九章所载虽简而不至大谬至若方程别无専书可证所存诸例又为俗本所乱妄増歌诀立为胶固之法印定后贤耳目而方程不复可用竟如赘疣周官九数几缺其一愚不自揆辄以管闚之见反覆推论以明之务求其理众晓而不疑于用庶不致谬种流传以乱古法云尔【详第四卷刋误】
　　一方程条件与旧不同之故
　　旧传方程分二色为一法三色为一法四色五色以上为一法头绪纷然而和较之分疑未清法无画一所立假如仅可施之本例不可移之他处然如此则为无用之法而方程一章为徒设矣窃以古人立法决不如此今按方程有和有较有兼用和较有和较交变约法四端巳尽方程之用不论二色三色四色五色乃至多色其法尽同正不必每色立法反滋纷扰也然惟如此则有定法而方程为有用且其用甚多窃以古人立法必当如此夫古人往矣愚生千载之下蓬户山居耳目局隘不能尽见古人之书亦何以防其然哉夫亦惟是反之心而无疑措之事而可用则此心此理之同庶可共信非敢好为新奇以自也天下大矣邺架藏书岂无足攷尚冀博雅好古君子恵示古本庶有以证明其説而广其所未知则所深望巳【详见第一卷及第四卷刋误】
　　一方程以论名篇之故
　　算学书有例无论则不知作法根原一再传而多误盖由于此本书欲明筭理故论多于例每卷之首皆有总论以为之提网然后举例以实其説【即假如也】而例中或有疑似之端仍各有説以反覆申明之令覧者彻底澄清无纎毫之凝滞凡为论者十之七而例居其三以论名篇着其实也
　　一方程例有详略可以互明
　　既欲推明其理则无取夸多故首卷和较襍变四端不过数例意在假此例以发吾论但求大义晓畅更不繁引多例以乱人思其后数卷举例稍繁然每设一例即明一义务求委曲尽变庶令用者不疑前详者后必略前略者后乃详更无重复细观自见
　　一方程著论校刻縁起
　　鼎性耽苦思书之难读者恒废寝食以求之必得其解乃巳有未能通则耿耿胸中虽厯嵗时未敢忘也算数诸书尤性所嗜虽只字片言亦不敢忽必一一求其所以然了然于心而后快窃以方程算术古人既特立一章于诸章之后必有精理而中西各书所载皆未能慊然于懐疑之殆将二纪嵗壬子拙荆见背閍户养疴子以燕偶有所问忽触胸中之意连类旁通若干门之乍啓亟取楮墨次第录之得书六卷于是二十年之疑涣然冰释然后知古人立法之精深必非后世所能易书虽残缺全理具存苟能精思必将我吿管敬仲之言不余欺也
　　论成后冀得古书为征而不可得不敢出以示人惟亡友温陵黄俞邰太史桐城方位伯广文豫章王若先明府金陵蔡玑先上舍曾钞副墨而昆山徐扬贡明府檇李曹秋岳侍郎姚江黄黎洲征君颇加鍳赏厥后吴江潘稼堂太史尤深击节嵗丁夘薄逰钱塘同里阮于岳鸿胪付赀授梓属以理装北上未遂杀青续遇无锡顾景范北直刘继庄二隠君嘉禾徐敬可先軰朱竹垞供奉淮南阎百诗宁波万季野两征士于京师并印可又得中州孔林宗学博杜端甫孝亷钱塘袁恵子文学共相质正乃重加缮录以为定本谬辱安溪李大中丞厚庵先生下询厯算命之论撰以质同人获与介弟安卿孝亷晨夕酬对承其谬赏兹编录副以归手挍欹劂视余稿本倍觉清明向使湖上匆剧雕版反不能如是之精良矣感书成之非偶惊嵗月之易流而良朋好我之殷受益宏多更仆难数爰兹略纪以志不忘

　　数学存古序【附录】
　　六艺古圣人用也所以开物成务垂泽将来虽然器久则毁声传而失彼其初非不穷神尽变而后稍湮没古圣人无如何也今不尽亡者数学耳数之为物不借器而存稽实待虚其道如易故礼乐代更而方圆不易书契形名世殊方别而竒偶自如数之不亡不能亡也顾不能亡者数仅存者数之学尝稽汉艺文志许商算术二十六卷杜忠算术十六卷唐博士肄习具有十经今略不一覩又古人制浑仪往往有书説详徴其故又凡作厯皆有测验诸书与厯术并垂如史所载晋姜岌刘宋祖冲之隋刘焯唐李淳风一行宋沈括元郭守敬着撰皆富今其存逸皆不可得攷自汉赵氏周髀一经外无可广证他纬书占候傅防难信然则今九章者果周官旧邪周官之旧既以不可知近世儒者又略之弗讲九数之学益以荒芜于是泰西氏者乃始孤行其测圜三角诸术以矜奇创学其学者至以大衍填写九执未尽授时阴用回回法子云康节之书皆为臆説而隶首之术必有所穷嘻其果然邪夫谓西厯能兼古法之长是也而反谓古人阴用乎西法此其説非也不观之书御乎御用于骑书用于楷楷与骑日以习而古书御亡或者未考舆轮而辄以古御不如今骑未窥籕篆而谓古书不及今楷遂欲驾王武子于造父尊钟元常于苍颉过矣愚生晚不及见古人僻处山陬闻见固陋闲尝于世传九章者稍稍论列补葺遗缺而昰正其纰缪使读者晓然知九数之学果不尽于今所传而其仅存者犹能与泰西氏并行而不得以相废虽不知于古人万一有当然天下之大不乏其人尚其共出枕秘以昭明而光大之使古人之绪晦而复显或由是以发其端欤是愚之所望矣



　　钦定四库全书
　　厯算全书卷四十
　　宣城梅文鼎撰
　　方程论卷一
　　正名
　　名不正则言不顺诸本方程皆以二色三色四色等分欵立法而不分和较宜其端绪纷纠而説之滋谬也故先正其名
　　正名有四一和数二较数三和较杂四和较交变和者无正负如只云某物如干某物如干共价如干以问每物各价者是也较者有正负如云以某物如干与某物如干相较多价如干或少价如干或相当适足者是也杂者半有正负半无正负如一行云某物某物各如干共价如干而其一行则又云以某物如干较某物如干差价如干或价相当适足者是也变者或先无正负而变为有正负或先有正负变而无正负三色以往重列减余兼用两行者是也
　　总论曰万筭皆生于和较和较可以御万分合之义也万物之未形一而已矣一且未有况万乎及其有也有一则有二有二则有三自此以至于无穷而数生焉矣和者诸数之合也较者诸数之分也分则有差故谓之较较与和相求而法立焉矣故一与一和则二也一与二和则三也一与二之较一也一与三之较二也万算虽多凖此矣故和较者万算之纲也算之用至于句股方程至矣尽矣窥髙致逺探赜穷幽无所不备然其用不出于和较且以方程言之凡方程列位皆以下位为之端如所列下一位为上中两位之总价则和也若下一位为上中两位相差之价则较也较故分正负和故不分正负虽不立正负然必以两和互乘对减以得其差然后其数可得而知矣故三色以往先无正负者有时而正负立焉故方程之法以和求较而已矣较者易知和者难知和之中有较较之中又有较此万数之所由生万法之所由起
　　和数方程例
　　方程用互乘对减与差分章贵贱相和法同但贵贱相和有总物总价又有每物每价不过以带分之故难用匿价分身而变为换影之术耳方程则有总物总价而无每数又有三色四色以至多色头绪纷然自非逓减何取之此古人别立一章之意也
　　用法曰二色者任以一色列于上以一色列于中以总价列于下于是以列上者为乘法左右互乘又互遍乘中下得数左右对减其上一色必两相若而减尽其中一色对减必有相差之数下价对减亦必有相差之数数相差则减不能尽于是取其余数以为用一为法一为实以法除实而得中一色每价乃以中价乘原列中物得中物总价以中物总价减原列两色之总价得上物总价以原列上物除之得上一色每价【若更以中一色列于上依法求之亦先得上一色价矣故上中之位可以互更也详见后】
　　假如有山田三亩塲地六亩共折输粮实田五亩七分又有山田五亩塲地三亩共折实田五亩五分问田地每亩折实科则各如干
　　畣曰每山田一亩折实田九分每地一亩折实田三分亩之一
　　法各列位
　　上　　　　　中　　　　　下


　　先以右上田三亩为法遍乗左行得数
　　次以左上田五亩为法遍乗右行得数　上位各得田十五亩对减尽　中位左得地九亩去减右行三十亩余地二十一亩为法下位左折田得十六亩五分去减右行二十三亩五分余折田七亩为实　以法除实不满法约为三之一为地每亩折实田之数【地一亩折田三分三厘三毫不尽即地三亩折田一亩也】　就以右行折实田共四亩七分内除原地六亩折实田二亩余二亩七分以右上田三亩除之得九分为田每亩折实之数【或以左行折田内减左原地三亩该折实田一亩余四亩五分以左上田五亩除之亦得九分为田每亩折实之数】
　　论曰以右上田三亩遍乘左行得数是各三之也为五亩田者三亩三亩地者三则为田地共折实五亩五分者亦三也
　　以左上田五亩遍乘右行得数是各五之也为三亩田者五为六亩地者五则为田地折实共四亩七分者亦五也
　　于以对减而上位田各十五亩减而尽则其数同也惟中位地余二十一亩在右行则是右行之地多于左行之地二十一亩也
　　而下位折实数亦余七亩在右行则是右行折实之数亦多于左行折实之数七亩也
　　合而观之此所余折实七亩者正是余地二十一亩之所折也
　　此以田地问折数故以地二十一亩为法折七亩为实也若以折数问原田地则以折七亩为法地二十一亩为实法除实得每折一亩原地三亩于是以右地六亩折二亩减折四亩七分余二亩七分为法除右田三亩得每折一亩原田一亩又九分亩之一即一分一厘一毫一一不尽也
　　若更置以地列于上则先得田折数如后图
　　上　　　　　中　　　　下


　　先以左上地三亩遍乗右行得数
　　次以右上地六亩遍乗左行得数　上位各得地十八亩对减尽　中位左得田三十亩内减去右得九亩余二十一亩为法　下位折田左得三十三亩内减去右得十四亩一分余十八亩九分为实　以法除实得九分为田每亩折实数
　　就以右田三亩折二亩七分减右折实共四亩七分余二亩以右上地六亩除之不满法命为三分亩之一为地每亩折实数【或于左行折实五亩五分内减去左田五亩该折四亩五分余一亩以左地三亩除之亦得地折实每亩三之一】
　　论曰以右上地六亩遍乗左行是各六之也为三亩地者六为五亩田者六为地三亩田五亩之折实田共五亩五分者亦六也以左上地三亩遍乗右行是各三之也为地六亩者三为田三亩者三为地六亩田三亩之折实共四亩七分者亦三也以之对减而地在上位者各十八亩既对减而尽则其各十八亩之折实在折实共数中者亦必对减而尽也田在中位者既对减去九亩而仅余左行之二十一亩则其各九亩之折实在共数中者亦必对减而尽也由是以观则其所余之左下折田十八亩九分正是左中余田二十一亩之所折也故以余田二十一亩为法而以余折田十八亩九分为实即田之折数可知知田数知地亩矣
　　若以折问田亩则一十八亩九分折为法二十一亩田为实实如法而一得每折一亩原田一亩又九分之一于是以分母九通右行田三亩得二十七分而以一亩又九分之一共一十分为法除之得二亩七分以减共折四亩七分余折二亩以除右地六亩得每折一亩原地三亩【以上二色例也三色四色以至多色凡和数者皆同但须重例减余以求之今不悉具于后诸条中详之】
　　较数方程例
　　凡较数方程分正负之价与盈朒畧同但盈朒章有盈朒又有出率方程则但有总物与盈朒而无每出之率又兼数色所以不同又盈朒者是有每率而不知总所言盈朒适足是总计所出以与原立总价相较之数也方程正负则是两总物自相较之数若不立正负则下价之与上物不知其孰为同异矣此正负之法异于盈朒也【负与正对所以分别同异盖对数之所余即正数之所欠故谓之负与负责之负畧相似老子言万物负阴而抱阳盖正即正面负即反面也开方法有负隅言隅之空隙也郭太史厯经三差法有负减言反减也本于平差内减去立差今立差反多于平差故于立差内反减平差是为负减兼此数端而正负之义可见矣】
　　法曰任以一色为正则以相当之一色为负【此据二色者言之三色以上或以一色与多色相当或以多色与多色相当其法皆同二色】正物之价多为正价负物之价多为负价正与负为异名异名相并正与正负与负为同名同名相减
　　首位同名者仍其正负不变【首位同数同名即可减去此正法也】首位异名变其一一以相从【首位亦同数但不同名故变而同之则亦同数同名而可减尽矣首位既变则其行内皆从而变此通法也盖必如是则同减异加始归画一而于和较交变之用尤便也】
　　其法皆于互乗时以得数变之盖减并只用得数也只变一行其相对之行不必再变二色三色以至多色并同何也三色以上行数虽多而乘并之用皆以各相对之一行论同异即同二色之理
　　论曰和数方程有减无并皆同名故也较数方程有减有并或同名或异名也减并者方程之纲要正负淆则同异之名混而并减皆失矣今诸本所言正负同异誃离舛错虽加减得数皆偶合耳西人论句股三角八线割圜几何原本可谓详矣矣至方程增立诸率亦复草草未穷其故也
　　用法曰以一色列于上以相当之一色列于中任以一色为主而分正负【此亦以二色为例三色以上皆以两相当者主其一以分正负皆与二色法同】
　　以两色相较之价列于下以正物为主而分同异或正物所多之价命之为正或正物所少之价命之为负【正物之所少即负物之所多】或正物负物之价两相若命之适足则空位列之亦以列上位者为乘法左右互乘遍乘中下以首位为主而变正负得数对减其上一色必数相若且又同名而减尽中一色与下价或同名或异名异名者并之同名者对减取其减并之数以为用一为法一为实以法除实得中一色每价以原列中物乗之得中物总价以与原列下价同名相减异名相并得数以原列上物除之得上一色每价【其上中亦可互求】
　　假如以研七枚换笔三矢研多价四百八十文若以笔九矢换研三枚笔多价一百八十文问笔研价各如干
　　畣曰笔每矢价五十文　研每枚价九十文
　　法各列位
　　上　　　　中　　　　下


　　先以左行研负三遍乗右行得数【首位异名须变一行以相从故研正变为负笔负变为正价正变为负皆于得数变之】
　　次以右行研正七遍乗左行得数【右行既变则左行不必再变故研负笔正价正皆仍旧】
　　于是以上研各负二十一同名相减尽　次以中笔两正同名相减余五十四为法　再以下价左正右负异名相并得二千七百为实　以法除实得五十文为笔价　以左行笔正九乘笔价得四百五十内减同名价一百八十余二百七十以左研负三除之得九十为研价或以右笔负三共价一百五十加异名价正四百八十共六百三十以右研七除之亦得研价九十
　　论曰左行原是九笔多于三研一百八十文乘后得数则是六十三笔多于二十一研共一千二百六十文也右行原是七研多于三笔四百八十文乘后得数则是九笔少于二十一研一千四百四十文也于是以两行得数较之上位研负二十一两行尽同研之数同则其价亦同惟中位笔数左行多五十四枝则是左行笔多价一千二百六十文者以多此五十四笔而右行笔少价一千四百四十文者以少此五十四笔也夫右行笔价原少于二十一研者一千四百四十文以左行多五十四笔而反多于二十一研者一千二百六十文是此五十四笔既补却右行之所少而仍多此数也故并右行之所多共此二千七百以为五十四笔之价知笔价知研价矣
　　若先求研价者以研列中为除法以笔列上为乗法如后图
　　问者或云笔三矢换研七枚少价四百八十文又有研三枚以换笔九矢少价一百八十文则其下价为两负【四百八十是笔少于研之价一百八十是研少于笔之价】


　　先以左行笔负九徧乗右行得数【首位异名宜变一行故其正负皆更之】
　　次以右行笔正三徧乗左得数【右变则左不变故正负皆仍之】于是以得数较其同异而为之减并　笔各负二十七同名减尽研正同名相减余五十四为法　价正负异名并得四千八百六十为实　实如法而一得九十为研价　以研价乗左正研三得二百七十异加价负一百八十共四百五十以左负笔九除之得五十为笔价或以右研七价六百三十与价四百八十同减余一百五十以笔三除之亦得笔价五十
　　论曰左行原是研三少于笔九者一百八十文乗后得数则是九研少于二十七笔者五百四十文也　右行原是三笔少于七研者四百八十文乗后得数则是六十三研多于二十七笔者四千三百二十文也夫两行笔皆二十七则其价同也而右行研价多于笔四千三百二十文左行研价反少于笔五百四十文是两行研价相差者共四千八百六十文也推求其説则只是两行中相差五十四研之故也故减去相同之笔用此相差之研以除此相差之研价而每研之价可知矣
　　若如难题所列以研为正笔为负问者当云以七研换三笔研多价四百八十以三研换九笔研少价一百八十文则价右正左负【难题系书名】


　　左右研正徧乗得数【首位本同名故其正负皆不变】研减尽笔余五十四为法价异并二千七百为实法除实得笔价以次得研价如前若以笔为正研为负则其价右负左正


　　依法先得研价如第一图
　　以前四图或以笔为正或以笔为负或以研为正或以研为负或以价为两正或以价为两负或以价为一正一负其所呼正负之名无一同者要其为同异加减之用则一也
　　试以一行中同异言之其左行之价必与笔同名何也左行之价乃笔多于研之数也故与笔同名而与研异名也　其右行之价必与研同名何也右行之价乃研多于笔之数也故与研同名而与笔异名也试以两行中同异言之其上位皆减尽其中位皆相减为法其下价皆相并为实其减也皆以同名其研也皆以异名　此下价异并例也
　　假如有大小余句不知数但云倍小余句以当三大余句则不及一丈五尺三寸若倍大余句则如七小余句
　　畣曰大余句六尺三寸　小余句一尺八寸
　　法以正负列位


　　先以左小余句负七徧乗右得数【首位异名宜变以相从故小句变负大句下负数皆变正】
　　次以右小余句正二徧乗左得数【右行既变则此行不变下适足无乗亦无正负】　乗讫乃较之　小余句各十四同减尽　大余句同减余一十七为法　下正数十丈零七尺一分无对不减就为实　以法除实得六尺三寸为大余句　乃置左行二大句该一丈二尺六寸以左行相当适足之七小句除之得一尺八寸为小余句【或用右行三大句该一丈八尺九寸以同名负一丈五尺三寸减之余三尺六寸以右行二小句除之亦得一尺八寸】合问
　　论曰以左小句徧乗右是各七之也为小句二大句三者七其相较之数亦七也　以右小句徧乗左是各二之也为小句七大句二者二其相当适足者亦二也但以首位必同名然后可减故以右小句正变而为负以从左名也小句变为负则所与相较之大句不得不变而正矣　于是小句同减尽大句同名减去四余右行正十七下较数无减仍余十丈○七尺一寸然则此所余者正是减余大句之数矣何也小句十四左右皆同若只如左行四大句则与小句相当适足矣而今右行独余此较数者非以右多十七大句之故乎
　　试以大句列于上则先得小句如后图


　　如法左乗右更其正负　右乗左仍其正负　大句同减尽　小句同减余正一十七在左行为法　下较数负三丈○六寸在右行无对不减就用为实以法除实得一尺八寸为小句　就以左行小句七该一丈二尺六寸以左相当适足之大句二除之得六尺三寸为大句【或于右行正一丈五尺三寸加异名小句负二该三尺六寸共一丈八尺九寸以右大句三除之亦得六尺三寸】
　　论曰左行原是小句七以当大句二适足今以右大句乗而各三之则是小句二十一以当大句六而亦适足也　右行原是大句三以当小句二而大句多一丈五尺三寸今以左大句乗而各二之则是大句六以当小句四而多三丈○六寸也　以两行之得数较之大句既减尽惟左行之小句余一十七则是左行得数所以相当适足者以多此十七小句之故而右行小句得数小于大句三丈○六寸者以少此十七小句之故也然则此三丈○六寸者正是十七小句之数也【依此论可见左行之所多即右行之所少故左行名正者用于右行即为负而隔行之异名即为同名】
　　此下较无减例也
　　假如有大小方积不知数但云一大方积以当二小方积多数八十九若以三大方积当七小方积仍多二百五十一
　　畣曰大方积一百二十一　小方积一十六
　　法以正负列位
　　上　　　　　　中　　　下


　　先以右大积一徧乗左行皆如原数　次以左大积三徧乗右行得数【首位同名故两行正负皆不变】　大积同减尽小积同减余一为法较数同减余一十六为实　法除实仍得一十六为小积　以右行小积负二该三十二加异名正八十九共一百二十一为大积【或以左行小积负七该一百一十二加异名正二百五十一共三百六十三以左大积三除之亦得一百二十一为大积】
　　论曰左行原是大积三多于七小积者二百五十一乗后得数亦同　右行原是大积一多于二小积者八十九乗后得数则是大积三多于六小积者二百六十七也　于是以两行对勘其大积既减尽惟小积左行余负一其下较数则右行余正十六夫此十六数者与大积同名是右行大积之数也右行少一小积而大积之盈数多十六左行多一小积而大积之盈数少十六然则此十六数者正是此一小积之数矣若以小方积为正则其下较数为两负【皆小积所少之数也故皆为负】
　　上　　　　　中　　　　下


　　依法徧乗对减余大积一为法　余负一百二十一为实　法除实不动就以一百二十一为大积　右大积一该一百二十一同名减负八十九余三十二以小积二除之得一十六为小积
　　此是右行多一大方积故多一同名之数一百二十一同在一行易知不须重论
　　以上二图正负所呼迥异然所同者两行之较数皆与大方积同名何也皆大方积多于小方积之数故与大方积同名而与小方积异名也
　　此下较同减例也
　　总论曰凡较数方程原列较数是本行中正与负之较也其乗后得数同减异加而得者则是两行中正与正之较或负与负之较也故本行中以异名相较而两行对减或加是以两行之同名相较
　　假如原列较数与正物同名是正多于负之较也若列较与负同名是负多于正之较也故曰本行中异名相较也
　　假如乗后得数而两行之较数皆与正物同名则两较亦自同名乃以之对减而余在一行则知此一行正物必多于对行之正物而其所多之数即如此所余之较数矣
　　假如两行较数皆与负物同名则两较亦自同名以之对减而余在一行则知此一行负物必多于对行之负物而其所多之数正是此所余之较数矣此同名相减之理也
　　假如右行较数与正同名而左行较数却与负同名则一是正多于负之数而一是负多于正之数也夫正与负原相待负多于正之数即正少于负之数也于是用异名相加法以左行负多于正之数变为正少于负之数以相并则知右行之正数必多于左行之正物而其所多几何正是此两较之并数矣此异名相加之理也
　　合同减异并而观之总是两行中同名相较也
　　又论曰较数方程以两相较而为用虽有三色四色乃至多色其相较也必两此正负所由立也立正负以别同异犹彼我也夫彼我者岂有一定之称哉以此为正则以彼为负若以彼为正则此反为负矣正负之相呼犹彼我之相视也故曰无定虽然无定者正负有定者同异其无定者在未立正负之先其有定者在既立正负之后既以一为主则同乎此者皆同名异乎此者皆异名矣是故无定而实有定也
　　今试以所列方程最下位观之其言正负者必上物之较数也不言正负者必上物之和数也较数有盈有朒有适足和则否
　　假如下价盈则为正正与正同名试于正物价之中减去下同名正价之盈则所余之价必与负物之价相当矣　正与负异名试又取上负物之价以加下异名正价则又必与正物之价相当矣
　　假如下价朒则为负【正物之朒负物之盈也】负与负同名试于负物价之中减去下同名负价则所余之价必与正物之价相当矣　负与正异名试又取上正物之何以加下异名负价又必与负物之价相当矣
　　假如下价适足空位无盈朒则其上正负物价必自相当
　　又论曰正负之术分别同异全在有交变之法以通其穷要其为用惟在使两行之首位同名而已何也方程以互乗递减立法每乗一次即减去一色然惟和数则一乗之后即可对减若较数则有同数而不同名之时若不减首位即不成方程若径以异名而减势必以同名而并法不画一而于后条和较交变之时益混淆而难用故以法变之使首位之同数者无不同名而仍为同名利减焉首位既以同名减则凡减者皆同名凡并者皆异名而其法画一矣故首位既变则行内之正负皆变何也从首位也行内之正负既皆从首位而变由是而原与首位同名者皆与隔行之首位同名也原与首位异名者即与隔行之首位异名也如此则隔行之同减异并亦清矣正负犹阴阳也牝牡也各行中各有正负犹两仪之生四象也乗而交变犹刚柔相推而生变化也隔行之正本行以为负隔行之负本行以为正真阴真阳互居其宅也同名相减者阴阳之偏不得其配也异名相并者阴阳得类雌雄相食也是皆有自然之理焉可以思古人立法之原矣
　　【以上亦以二色者举例三色以上乃至多色正负之用尤显详具诸卷中兹不赘列然其理着矣】和较相襍方程例
　　方程之用以御隠襍妙在襍与变知其襍则襍而不用矣知其变则变而不失其常矣诸书所论胥未及此故求之甚详去之愈逺也
　　用法曰凡方程和较襍者和较从和法列之不立正负较数从较法列之明立正负　其偏乗得数后在
　　较数行中者仍其正负之名在和较行中者皆变从乗法之名【和数原无正负则无可变但乗后得数取其与较数之首位同名而已首位既同名下不得不同名矣】
　　凡两较者下价或有减有并而中物只同减若一和一较者下价亦有减有并而中物皆异并此以两色言之三色以上随数通变皆以同异名御之
　　假如有大小句不知数但云三其大句倍其小句共三丈三尺若倍大句则如六小句问若干
　　畣曰大句九尺　小句三尺
　　法以一和一变列位【适足者以相较而得名即同较义】


　　右行和数也不立正负　左行较数也明立正负右乗左而三之和乗较也故其正负皆如故
　　左乗右而二之较乗和也故得数皆为正从乗法之名也　如法遍乗讫以两行对勘　大句同名相减尽　小句异名相并得二十二为法　正数六丈六尺无减就为实　法除实得三尺为小句　以左行小句六共一丈八尺为实以大句二为法除之得九尺为大句【或于右行共三丈三尺内同减小句二共六尺余二丈七尺以大句三除之亦得九尺】
　　论曰右行大句三小句二共三丈三尺乗后得数则是六大句四小句共六丈六尺也　左行大句二小句六其数相当乗后得数则是六大句十八小句亦相当适足也　于以对减而两大句同减尽则其数同也而右行正数犹有六丈六尺左则无有其故何也右行正数中有小句四而左则无且不惟无之而已其相对之负数反有十八小句焉是左行正数又自除却十八小句之数也右行正数多四小句左行正数又自除却十八小句则是右行正数之多于左行正数者二十二小句也故并此二十二小句为右行所多之正物其六丈六尺则右行之正数也以正物除正数而小句可知知小句知大句矣
　　又细攷之六大句合四小句共六丈六尺则以与六大句相当之十八小句合四小句亦必六丈六尺也此亦西儒比例之理而以同异名尽之可见古人用法之简快试更列之以小句居上则先得大句亦同
　　上　　　　　　中　　　　　下


　　先以右小句二徧乗左行得数【和乗较也故仍其正负】
　　次以左小句六徧乗右行得数【较乗和也故皆命为负与乗法同名】两小句同减尽　两大句异并二十二为法　负数十九丈八尺无减就为实法除实得大句九尺　以右行大句三该二丈七尺减共三丈三尺余六尺以小二句除之得小句三尺
　　论曰小句互乗之后则其数同也小句数同则负数亦同而右行之负数独有十九丈八尺左则无有者以右之负数中有大句十八而左则无不惟无也其所对之正数中反有大句四是左行负数中又原少四大句也右负数多十八大句左负数少四大句是右之负数多于左之负数者共二十二大句也然则右之负数独有此十九丈八尺者正是此二十二大句之数也
　　此和数与适足偕也
　　假如有江湖两色船载物不知数但云江船五以较湖船一则江多二千八百石江船三湖船五则共载二千八百石问船力若干　畣曰江船六百石　湖船二百石
　　法以一和一较列位


　　如法左右徧乗得数
　　江船同减尽　湖船异并二十八为法　载物同减余五千六百石为实　法除实得二百石为湖船数以湖船数加右行异名正二千八百共三千石以
　　右江船五除之得江船数六百石【或以湖船五共一千石同减左行二千八百石余一千八百石以左江船三除之亦得六百石】
　　论曰徧乗后江船数同则其载数亦同今以两正数相减而左多五千六百者以左正数中有湖船二十五而右则无不惟无也其所对之负数中反有湖船三是右行正数中又自少三湖船也左多二十五右少三是左正数多于右数者共二十八湖船也然则左之正数独多五千六百者正此二十八湖船之数也此和数偕一正也负亦同
　　和变交变方程例
　　凡方程三色以上以减余重列则有和变较较变和者不可不察也　若非和较之襍则二色方程之中物有减无并矣若非和较之变则三色四色方程和数者有减无倂矣夫和数较数非自我命之名也其下价之为和为较不可诬也
　　用法曰和变较者但和数减余有分在两行者兼而用之即变较数也　和既变较即以较数法列之其法以一行之余数命为正以一行之余数命为负　其下余价以与中位余物同在一行者即为同名从其正负而命之　若下价减尽无余者命为适足若减余只在一行者无变也只用和数法
　　较变和者但视较数减余或有一行内皆正或皆负者即变和数也即如和数法列之不立正负【其较数异并者以一行为主而以隔行之之异名从本行为同名】
　　若减余行内有正负者无变也只用较数法
　　若有两异并而一位左正右负一位右正左负亦仍为较数不变虽减余分在两行而一行余正物一行余负物亦和数也何也隔行之异名乃同名也若减余同名而分余于两行即仍为较数不变何也隔行之同名乃异名也
　　若两异并皆左正右负或皆左负右正亦和数也和较重列有俱变为较者有只变一行为较而余行如故者较数重列有俱变为和者有只变一行为和而其余如故者皆如上法以和较襍列之
　　若四色以上有和变较较复变和者有较变和和复变较者皆以前法御之
　　假如以衡校弓弩之力但云大神臂弓二弩九小弓二共重七百一十斤又有神臂弓三弩二小弓八共五百二十五斤又有神臂弓五弩三小弓二共五百一十五斤问各力
　　畣曰大神臂弓力五十五斤　弩力六十斤　小弓力三十斤
　　法先以和较列位【凡三色者可任以一行为主与余二行数相乗而减并之故前后之行可互更也详见第三卷】



　　先以中行神臂弓二为法徧乗左右得数【此以中行为主与左右互乗取其行间易为减并之用也】
　　次以右行神臂三徧乗中行得数与中行对减　神臂弓中右各六对减尽　中弩二十七内减去右弩四余二十三【中行余也】　中小弓六去减右小弓十六余十【右行余也】　中力二千一百三十内减去右一千○五十余一千○八十斤【中行余也】
　　以上减余分在两行已变较数矣即用较数之法分正负列之而以弩与力命为同名【弩与力同在中行故也】次以左行神臂五徧乗中行得数而以中左两行对减　神臂弓各十减而尽　中弩得四十五内减去左行弩六余三十九
　　中行小弓得十内减去左小弓四余六　中力得三千五百五十内减去左一千○三十余二千五百二十斤
　　以上减余俱在中行仍为和数也不分正负
　　论曰此和数方程变为一和一较也何也中右得数两大弓减尽则其力相若也弩数相减而余在中行是中行之弩力多于右行也小弓相减而余在右行是右行小弓之力多于中行也弩力中多于右小弓力右多于中而今共力相减惟中多一千○八十斤则是此一千○八十斤者非余弩余弓之共数而余弩所多于余弓之较数也虽欲不分正负不可得也如中左对减而余弩余小弓俱在中行则中行之余力二千五百二十斤者仍为余弩余小弓共数无正负之可分也故以此两减余者依和较杂法重列而求之
　　如前对减既于共力中清出首一色大神臂弓不与弩小弓杂矣然所余之力尚为弩小弓共数与其较数而未能分别此二色之每数也故必重测


　　依和较杂法以左右余弩互徧乗得数【左乗右和乗较也故仍其正负右乗左较乗和也故变从乗法之名皆曰正】
　　弩同减尽　小弓异并五百二十八为法　力同减余一万五千八百四十为实　法除实得三十斤为小弓力　以小弓力乗右行余小弓十得三百斤异如力正一千○八十斤共一千三百八十斤以余弩二十三除之得六十斤为弩力【或于左行共力二千五百二十斤内同减小弓六该一百八十斤余二千三百四十斤以余弩三千九除之得六十斤亦同即此可见两减余之为一和一较】乃于原列任取右行八小弓力二百四十斤二弩力一百二十斤以减共力五百二十五斤余一百六十五斤以大神臂弓三除之得五十五斤为大神臂弓力
　　论曰两弩正数同而其力不同者小弓之故也左行和数也是弩偕小弓之力也右行较数也是弩力中减去小弓之力而余者也合而观之则是左行之弩力有小弓一百三十八以为之益而右行之弩力反减去小弓三百九十然则左行正数之多于右行者凡共差小弓五百二十八而左行正数所以多于右行一万五千八百四十斤者正是此小弓五百二十八之力也
　　凡此减余之数亦可互求若更置之以小弓列上则先得弩力如后图
　　上　　　　中　　　　下


　　依法右左徧乗得数【左乗右和乗较也故仍其正负右乗左较乗和也故变从乗法之名皆名之曰负】
　　小弓同减尽　弩异并得五百二十八为法　力异并得三万一千六百八十为实　法除实得六十斤为弩力　以弩力乗右行弩二十三得一千三百八十斤同减正一千○八十斤余三百斤以小弓十除之得小弓力
　　论曰两小弓同名负其数既同而左行负数之力有若干右则无之而且反小于正数之力若干者何也以左行负数中有弩三百九十右则无之而其所对之正数反有弩一百三十八以为之除算则是左负数之多于右者共五百二十八弩也右负数少此五百二十八弩而正数力遂多六千四百八十斤左负数多此五百二十八弩则不但补却右行之所少而又自有力二万五千二百斤然则左行共多于右三万一千六百八十斤者正是此五百二十八弩之力也此三色和变较例也【四色以上襍见诸卷中】
　　问有甲乙丙三数甲加七十三得为乙丙数者倍乙加七十三得为甲丙数者三丙加七十三得为甲乙数者四其本数各几何　畣曰甲七　乙十七　丙廿三
　　法先以较数列位



　　先以中行甲正一遍乗右左得数皆如故【只变中行故两行之正负俱不变又是一数为乗法故数亦不变】
　　次以右行甲负三徧乗中行次以左行甲负四徧乗中行各得数【左右既省不变故变中行以从之首位变负下三位俱变正】
　　次以中右得数相减并　甲同减尽　中乙得正六同减左得正一余正五　中丙得正六异并右得负三共得正九中较数得正二百一十九异并右负七十三共得正二百九十二
　　次以中左得数相减并　甲同减尽　中乙得正八异并左得负四共得正十二　中丙得正八同减左得正一余七正　中较数得正二百九十二异并左负七十三共得正三百六十五以上减并之数皆同名又皆在一行知已变为和数重列之不分正负【依此显虽同名而或乙正在中丙正在左即不得变和数也何也左行之正中行之负也】
　　论曰此较数变为和数也以中右之得数言之中行六个乙六个丙共多于三个甲者二百一十九右行一个乙少于三个甲三个丙者七十三于是两相对较则两行之甲皆三个其数本同而中行之乙丙多于甲二百一十九者因中行之乙多于右行之乙者五个又有同名之丙六个以益之而中行之甲又非若右行之甲与三个丙同名是又少三个丙也夫甲股内少则乙丙股内多合而观之则是中行之乙丙股内共多五个乙九个丙而右行之乙股内共少此五个乙九个丙也夫中行之乙丙股内多五个乙九个丙便多于三个甲者二百一十九右行之乙股内少五个乙九个丙则不惟不多而反少于三个甲者七十三然则并此多二百一十九少七十三共二百九十二者正是此五个乙九个丙之共数而非其较数也故不分正负
　　又以中左之得数言之中行正数是八个乙八个丙负数是四个甲而正数多者二百九十二左行正数是一个丙负数是四个甲四个乙而正数少者七十三于是两相对勘则两行负数之甲皆四个其数本同惟中行之正数内比左正数多七个丙又加八个乙而中行之负数又比左负数少四个乙合而观之是中行之正数比左行共多十二个乙与七个丙而左行之正数比中行共少十二个乙七个丙也然则中行正数之多于负数二百九十二者以多此十二个乙七个丙而左行正数之反少于负数七十三者以少此十二个乙七个丙也则是并此多二百九十二少七十三之数共三百六十五者正是此十二个乙七个丙之共数而非其较数也故亦不分正负


　　如法以乙数左右互徧乗得数相减【无正负故有减无并】乙减尽　丙减余七十三为法　下位余一千六百七十九为实　法除实得二十三为丙数以丙数乗左行　丙七得一百六十一以减共三百六十五余二百○四以左乙十二除之得一十七为乙数又以乙数异加原列右行负七十三共九十内减原右行丙三该六十九余二十一以原右行甲三除之得七为甲数
　　论曰此同文算指所立叠借互征设问之一也原法繁重今改用方程简易如此
　　此所设问三色方程耳以西术求之已不胜其难况四色以往乃至多色乎此亦足见方程之不可废而古人别立一章之诚有实用也
　　此三色较变和例也　四色以往至于多色则其变益多要不出于和较例具后诸卷中兹不详列












　　厯算全书卷四十
　　钦定四库全书
　　厯算全书卷四十一
　　宣城梅文鼎撰
　　方程论卷二
　　极数
　　吾论方程至和较之杂之变尽矣虽然不知带分叠脚重审之法无以穷其致故极数次之
　　极数有三一带分二叠脚三重审皆不离乎和较之四术带分方程例
　　法曰视原问中有云防分之防者则以分母通其全数而列之或云有物防数又防分之防者以分母通其全数而纳其子如法列位遍乗减并以求一法一实既得法以除实而得者即所求物之一分也以所得一分之数分母乗之则为物之全数矣
　　或云防分之防又防分之防者以两分母相乗为全数而列之又以两分母互乗其子为所用之分而列之所用之分同在一行者并而列之分用于两行者不并也并之而所用之分反大于全数者以全数除之命为几全数又几分之几其入算乗除仍用所并之分得数后则只以全数之分乗之为全数【以上两法皆化整为零乗除竟用零分故先得一分之数】
　　又法
　　凡较数有以此之全数当彼之防分之防者则通其一行之内皆以分母乗之而后列焉则其所得即为全数而非其一分也【如云乙得甲三分之二则以分母三乗乙全数得全乙者三乗甲之二分得六分是为全甲者二则以三乙当二甲而列之骤视之如倒列其子母其实皆全数耳】若有正负之数亦以分母乗而列之【亦全数非零分也是为以零变整与化整为零之法不同故径得其全数所用乗除皆整数非分故也】得即为整【其所用分母只在本一行中如一物有两分母又分用于各行则各以其行中分母为用】凡和数中有一位带分而余只全数者亦可以分母通乗而列之其所得亦为全数而非分【如甲三乙二又三之一共十六则以分母三乗甲得九乗一二得六乗乙之一得三亦整一也并得整七乗共十六得四十八是为甲九乙七共四十八变零为整径以整数乗除所得即为整数】
　　又法
　　凡带分之法或化整为零或变零为整取其画一也此外又有杂用零整之法亦所当知【如行中有几位或原带有零分者以化整为零法列之其原未带分者只以整数列之但乗除得数后整列者所得即为整数零分列者所得只为零分之数仍须以分母乗之为全数】
　　又法
　　视所带之分有可以分母除之而尽者则以所除分秒附于整数而列之则其乗除后得数亦为所求之全数【若分母除其子不能尽者则不用此法】
　　今有甲字库贮金丁字库贮银各不知总但云取甲四之三加丁五之二则一百一十万若以甲加丁之倍数则四百四十万问各若干
　　畣曰甲库金四十万　丁库银二百万
　　法以分子甲之三分丁之二分列右
　　以分母四通甲整一得四分以分母五通丁整二得十分列左


　　依和数法互乗对减余丁之分二十二为法余八百八十万为实
　　法除实得四十万为丁之一分以丁之分母五乗丁之一分得二百万为丁库银数　乃以丁库数倍之得四百万减四百四十万余四十万为甲库金数此化整从零法也【原列零分故得亦零分之数】
　　又法以丁分母五互甲之三得十五以甲分母四互丁之二得八列右乂以两分母【五四】相乗得二十为甲丁共母以乗一甲得二十乗倍丁得四十列左　乃以甲丁共母乗一百一十万得二千二百万列右乗四百四十万得八千八百万列左【分母相乗为母母互乗子只是通分之法妙在以分共母乗其和数而零数皆为整用矣此用法之妙】
　　上　　　中　　　下


　　依法乗减余丁四百四十为法　八亿八千万为实以法除实得二百万为丁数以丁四十计八千万减八千八百万余八百万以甲二十除之得四十万为甲数此变零为整法也【原列整数故所得即为整数】
　　又法以甲分母四除之三得七分五秒以丁分母五除之二得四分列之则其余数皆不变


　　左甲一乗右行皆如原数　右甲○七分五秒乗左行各得四分之三甲各○七分五秒尽减　丁余一一【上一整数下一一分乃十分之一】为法共数减余二百二十万为实　法除实得二百万为丁数　以丁数倍之减共数余四十万即为甲数
　　此除零附整法也【零分既除为分秒则乗除之际皆以整数为主故所得亦即为整数】
　　今有甲乙二数不知总但云取乙五之三又取乙四之一以益甲则甲之数倍取甲三之二又取甲七之二以与乙较则乙多数二百四十问甲乙本数各防何畣曰甲本数一千○七十一　乙本数一千二百六十
　　法以较数带分取之　本二色也却有三位以分母通之仍二位也　先以乙分母【五四】相乗得二十以当乙之全数　又以分母五互乗分子一得五以分母四互乗分子三得十二并之得十七以当乙所益甲之分　是为乙二十分之十七以益甲也
　　次以甲分母【三七】相乗得二十一以当甲之全数　又以分母三互乗分子二得六以分母七互乗分子二得十四并之共二十以当甲所与乙较之分　是为甲二十一分之二十以与乙较也
　　于是分正负列位


　　依较数法乗减　乙余八十分为法　负数无减就以五千○四十为实　法除实得六十三为乙之一分　以乙全分二十乗之得一千二百六十为乙本数　乙本数同减负二百四十余一千○二十即甲与乙较之分也以左行甲之二十分除之得五十一为甲之一分以甲全分二十一乗之得一千○七十一为甲本数
　　乃细攷之　置乙本数【三】因【五】除之得七百五十六为五之三　又置一本数【四】除之得三百一十五为四之一　并两数共一千○七十一则与甲数同故以此益甲而甲倍也　置甲本数【二】因【三】除之得七百一十四为三之二　又置甲本数【二】因【七】除之得三百○六为七之二　并两数共一千○二十以此较乙则不及二百四十
　　此只是以乙之分与甲较又以甲之分与乙较也末卷所列诸率则是以乙之分益甲而转与乙所存之分相较又以甲之分益乙而转与甲所存之数相较故自不同合而观之则见
　　今有寳泉寳源二局铸钱不知总但云取寳源五之四又四之三以益寳泉则寳泉之数倍　若取寳泉三之二以与寳源较则多于寳源四十二贯
　　畣曰寳泉原数一千九百五十三贯　寳源原数一千二百六十贯
　　法先以寳源分母【五四】相乗得二十分为全数　又以分母五互乗分子【三】得十五分母【四】互乗分子【四】得十六并之共三十一分为寳源所以益寳泉之分　全数二十分所用以益寳泉者反有三十一分是为以寳源全数又二十分之十一以益寳泉也　其寳泉只一分母故不用乗并
　　乃列位


　　如法乗减　中位余二分为法　下位余一百二十六贯为实
　　法除实得六十三贯为寳源局二十分之一分　以分母二十乗之得一千二百六十贯为寳源数　以寳源数异加正四十二贯共一千三百○二贯即寳泉局三分之二也于是以分子之二除以分母三乗得一千九百五十三贯为宝泉数【置寳源数四因五除之得一千○八为五分之四又置宝源数三因四除之得九百四十五为四之三并两数亦恰得一千九百五十三贯如寳泉数以加寳泉是为宝泉者倍也】
　　论曰乗得数后宝泉分数同惟右行之寳源多于左行者二分而遂能与寳泉等若左行之寳源少此二分而其少于寳泉者遂一百二十六贯然则此一百二十六贯者正是寳源之二分矣【知分数即知全数知寳源即知寳泉】此二则皆化整为零而分母不同也
　　今有货泉刀贝四种之币各不知数但云泉八之一兼刀布七之二则如货数也　若刀布七之三兼贝六之四则其数如泉也若贝六之五又外加数八千九百七十则如刀布也　若货数自加九之一则其数如贝也问本数各防何
　　畣曰货五千一百三十　泉九千六百八十
　　刀布一万三千七百二十　贝五千七百
　　法以各分母通其原数然后以正负列之　货分母九泉分母八　刀布分母七　贝分母六　【丁行货合数一】
　　【又九分之一共十是为九分之十凡全数帯分者准此】




　　先以甲行货正九分为法徧乗丁行得数　又以丁行货负十分为法徧乗甲行得数【因首位异名故变一行以相从而以丁从甲】乃以甲丁两行得数相减　货同减尽　甲行泉负十分刀布负二十分皆无对不减　丁行贝负五十四分亦无对不减　下适足无乗无减仍为适足
　　乃以泉刀同名在甲行者为一类　贝同名在丁行者为一类分正负重列而求之【丁行之负甲行之正也】
　　因余行已无货位当以泉为乗法寻乙行中有泉径用与减余相对


　　如法徧乗得数乃相减并　泉同减尽　刀布异并得【正】一百九十分　贝同减余负三百九十二分以减余为主命其正负而重列之
　　因余行又已无泉当以刀布为乗法寻丙行有刀布径用与减余相对
　　上　　　　　　中　　　　　　下


　　如法徧乗得数　刀布同减尽贝同减余一千七百九十四分为法正一百七十万四千三百无减就为实　法除实得九百五十为负之一分　以丙行贝之五分该四千七百五十异加正八千九百七十共一万三千七百二十为刀布原数　以刀布分母七除原数得一千九百六十为刀布之一分　以刀布之三分该五千八百八十贝之四分该三千八百并之得九千六百八十为泉数【用乙行也】以泉分母八除泉数得一千二百一十为泉之一分　以泉之一分加刀布之二分三千九百二十共五千一百三十为货数【用甲行也】以货分母九除货数得五百七十为货之一分以货数加一分共五千七百为贝数【用丁行也】
　　甲丁两行乗减论曰既互乗则甲丁之货等而甲行之泉若刀布及丁行之贝又各与其首位之货等则甲之泉若刀布必与丁之贝等也故对减去货而径以甲之泉若刀布与丁之贝分正负而命之适足也此即西学中比例之理然方程中自有之且简快如此
　　乙行减并论曰左右两行之正负皆适足若于右正数内减左正右负数内减左负其所余者亦必适足也今右正内既减去同名之泉右负内又减去同名之贝而左负内有刀布不与右同名不能相减故反用以加加则正数多正数多则负数少而其数亦必适足矣
　　又论曰隔行之异名乃同名也今两行之正与负既皆适足若以左之正【泉】益右之负【贝】而共为负以左之负【刀布贝】益右之正【泉刀布】而共为正则亦适足也于是以两者【右泉刀布左刀布贝为一类左泉右贝为一类】对减其相同之物【泉各减八十分贝各减四十分】则其所余之物必亦适足也【左右刀布为正右贝减余为负】
　　又论曰右行刀布正数也正多于负之数也左行刀布负数也正少于负之数也合此二数则是右正之多于左正者此两行之刀布也然刀布之数右正虽多于左正而贝之数右负亦多于左负故两行皆适足也然则右正之所多与右负之所多亦必相当适足矣
　　丙行乗减论曰刀布本同惟右之贝多于左右之贝多则左之贝少左之贝少则刀布多矣然则左之刀布布独有盈数者正是此相差之贝也
　　此亦化整为零而又有整帯零【四色有空之例也】
　　问品官月俸六品为五品八之五七品为六品四之三八品为七品十五之十三九品为七品十五之十一倍九品加八品六品七品各一则如五品之倍数而多三石各若干
　　法以分母各通其原数而正负列之　五品通为八六品通为四　七品通为十五　八品九品以全数原无分母故也【五品倍则为十六】





　　先以甲行五品十六分遍乗乙行五品六品得数【余空位无乗】　次以乙行五品五分遍乗甲行得数　乃对减　五品各八十分同名对减尽　六品同名对减余四十四分乙行之负物也为乙类
　　七品八品九品并禄米较数皆无对不减皆甲行之负物负数也为一类　分正负列之与丙行相对


　　如法以减余六品分遍乗丙行六品七品分得数【余空无乗】
　　又以丙行六品分遍乗减余得数　乃以对减　六品得数各一百三十二分同名减尽　七品同名减余四百三十五分丙行之负物也自为一类　其余三位无减皆减余之负物负数也共为一类　分正负列之与丁行相对
　　又因丁戊两行皆有七品是多一算也乃更置之以八品列首位
　　上　　　　　中　　　　下


　　如法以丁行八品负一遍乗减余皆如故【首行同名故两行之正负亦皆不变】又以减余八品负十五分遍乗丁行八品七品得数　乃对减　八品同减尽　七品同减余二百四十分右行之正物也为一类　九品三十无减禄米四十五石亦无减皆右行之负物负数也同
　　名共为一类　乃分正负重列之与戊行相对


　　如法以左右七品分互遍乗得数【首行同名故两行之正负皆不变】七品同减尽　九品同减余九十为法　禄米四
　　百九十五石无减就为实　法除实得五石五斗为九品月俸　置九品俸以相当之七品之十一分除之得五斗为七品月俸十五分之一而以与八品相当之十三乗之得六石五斗为八品月俸　又以七品之分母十五乗其一分得七石五斗为七品月俸又置七品俸以相当之六品之三分除之得二石
　　五斗为六品四之一而以其分母四乗之得十石为六品月俸　置六品俸以相当之五品之五分除之得二石为五品八之一而以其分母八乗之得十六石为五品月俸
　　计开　五品毎月十六石　六品毎月十石　七品毎月七石五斗　八品毎月六石五斗　九品毎月五石五斗
　　论曰此所列有二种　六品通为四分者问原云四之三是可以四分者也七品通为十五分者原云十五之十三之十一是可以十五分者也五品通为十六分者原云八之五是可以八分者也又倍之而十六则为八分者二矣此皆以分立算化整从零之法也八品则只是原数九品亦是原数而又有倍数然
　　只是原数之倍非如五品倍其分也此两者皆不用分只用整　合而言之乃零整杂用之法也　零与整杂似不伦矣然乗除得数则同　但用分者所得数亦为一分之数故必以分母乗之乃合原数而其原不用分者得即原数更不湏乗能知此理则用分无误矣
　　甲乙两行论曰两行正数内五品本同而甲有负多于正之较乙则无有是此较数乃甲负多于乙负之较也于是以两负相减以去其同之分而观其所不同之处则甲有诸品而乙惟六品之减余然则甲负之独多此较者乃甲诸品多于乙六品减余之较矣
　　丙行乗减论曰两得数对减而六品减尽是其数同也其与六品为正负者又减去相同之七品分而左仍余七品之余分右仍余诸品之全分则是两行诸数皆同而惟此二者有差也然则右之独有盈于六品之较者正此二者之差数也
　　丁行论曰两行对减而于负数内减去相同之八品惟余九品于正数内减去相同之七品分惟余七品之余分然则右行负数独有盈于正数者正是右行九品与其七品余分之较也何也与之对减者乃左行适足之数故于较数无闗也【重列三次皆然】
　　戊行论曰右行内减去左行适足数惟余九品数则其下盈数必所余九品之数也　此条逓减归一其理较明学者翫之
　　此零整杂列也亦五色方程有空例也有减无并可悟偶加竒减之非
　　问有物一百七十四以三人分之乙所分如甲七之三仍不足单六丙所分如乙七之三而多二数各几何畣曰甲数一百一十二　乙数四十二　丙数二十【甲数三因七除得四十八多于乙数六乙数三因七除之得十八少于丙数二】
　　法列位　以甲乙分母七化整为零　丙无分仍用整


　　【○】　　　乙之三分【正】　丙一【负】负二【此行无甲数存与减余重列】
　　此三色有空先以和较杂法用两行甲互遍乗之和数甲全分七乗较行得数【依其正负】以较数甲正三分乗和行得数【从乗法皆命为正】　甲各二十一分同减尽乙异并七十分【正】丙三无减【正】下数同减余四百八十【正】皆同名不分正负以和数重列与第三行较数求之
　　上　　　　　　中　　　下


　　如法互乗减并　乙同减尽　丙异并七十九为法下数异并一千五百八十为实　法除实得二十
　　为丙数　丙数同减负二得一十八为乙七之三乃以三分除之得六为乙七之一以分母七乗之得四十二为乙数　乙数异加正六共四十八当甲七之三乃以三分除之得十六为甲七之一以甲分母七乗之得一百一十二为甲数　此亦零整杂用之法也
　　若依变零从整法则以分子母倒位列之其正负以分母乗之乃与和数列而求之
　　论曰倒位何也非倒位也分母遍乗则然也以分母七乗子三而皆七之则为三分者七为三分七是为全全数者三矣而其所当者全数也七之则为全数者七矣是乙以全数当甲七之三者七乗之则七乙当三甲也故如倒位然皆全数也非分也故非倒位正负亦分母乗何也乙一当甲七之三而少六则七乙当三甲而共少七个六为四十二也丙一当乙七之三而多二则七丙当三乙而共多七个二为十四也




　　如法以前两行遍乗减并又重列之与第三行遍乗减并　乙减尽丙异并七十九为法　下数异并一千五百八十为实　法除实得二十为丙数
　　七因丙数得一百四十同减负十四余一百二十六以乙三除之得四十二为乙数
　　七因乙数得二百九十四异加正四十二共三百三十六以甲三除之得一百一十二为甲数
　　此变零从整而分母同者也亦有分母不同但取其本一行中所用之分母遍乗本行以为用不必齐同如后条
　　问有数不知总以三人分之亦不知各所分之数但云甲如乙丙共数二之一乙如甲丙三之二丙如甲乙四之三而不足四又四分之一总数分数各几何畣曰总数十五　甲五　乙六　丙四　乙丙共十其二之一则五如甲　甲丙共九其三之二则六如乙　甲乙共十一其四之三则八义四之一以丙相较不足四又四之一也
　　法曰此各行分母不同【如甲有三之二又有四之三乙有二之一又有四之三丙有二之一又有三之二皆有两分母】宜用变零从整之法以不同同之【用分则不同变而用整则不同而同矣】以分母各遍乗其本行而列之右行分母二　中行三左行四



　　如法互乗减并以三色较数变为二色而重列之【虽减并不同皆仍为较数不变宜翫】


　　如法互乗　乙同减尽　丙同减余负三十四为法正一百三十六无减就为实　法除实得四为丙
　　数　六乗丙数得二十四以相当适足之四乙除之得六为乙数　以原列右行乙丙各一共十以相当适足之甲二除之得五为甲数
　　论曰甲为乙丙二之一则是二甲当一乙一丙也皆二因之也　乙为甲丙三之二则是三乙当二甲二丙也皆三因之也　丙为甲乙四之三而不足四又四之一则是四丙以当三甲三乙而不足十七也皆四因之也【甲乙丙各有两分母若化整为零当以分母相乗为原数母互乗子为所用之分殊多事矣】二因甲得二二因乙丙二之一得乙丙各一
　　三因乙得三三因甲丙三之二得甲丙各二
　　四因丙得四四因甲乙四之三得甲乙各三四因正四又四之一得正十七【以一丙与甲乙四之三较不足四又四之一若以四丙与四个甲乙四之三较亦不足四个四又四个四之一是为十七】
　　问有数九百六十以四人差等分之乙与甲如二与八丙与乙如三与七丁与丙如四与六各几何
　　畣曰甲六百七十二　乙一百六十八　丙七十二丁四十八
　　法以共数命为和相当数命为较依和较襍法列之乙二而甲八是乙得甲八之二故八乙可当二甲也丙三而乙七是丙得乙七之三故七丙可当三乙也丁四而丙六是丁得丙六之四故六丁可当四丙也【推此知二八三七四六各种差分皆可以方程御之】




　　首次两行如法互乗减并讫重列之取出第三行与之为耦


　　如法减并讫又重列之【两次减余皆和数可见立负之非】
　　又取末行与之为耦而列之


　　如法乗　丙减尽　丁并得四百八十为法　正二万三千○四十无减就为实　法除实得四十八为丁数　六因丁数得二百八十八以相当之四丙除之得七十二为丙数　七因丙数得五百○四以相当之三乙除之得一百六十八为乙数　八因乙数得一千三百四十四以相当之二甲除之得六百七十二为甲数
　　试以甲并乙共八百四十以八因之得甲数若二因亦得乙数是乙数甲二八差分也　试以丙并乙共二百四十以七因之得乙数若三因亦得丙数是丙与乙三七差分也　并丙丁共一百二十以六因之得丙数若四因亦得丁数是丁与丙四六差分也
　　又试以八除甲数得八十四以二除乙数亦得八十四若以八十四除甲数必得八以八十四除乙数必得二也　又试以七除乙数以三除丙数皆得二十四若以二十四除乙数必得七除丙数必得三也　以六除丙数以四除丁数皆得十二若以十二除丙数必得六除丁数必得四也
　　问有数七百四十一以四人分之乙于甲为三之二丙于乙为五之三丁于丙为七之五各防何
　　畣曰甲三百一十五　乙二百一十　丙一百二十六　丁九十
　　法曰乙得甲三之二是三乙当二甲也丙得乙五之三是五丙当三乙也丁得丙七之五是七丁当五丙也故皆命以适足而列之




　　先以孟仲两行如法互乗减并讫列其余数取出叔行相对


　　如法减并又列其余与季行相较


　　如法减并　丁二百四十七为法　正二万二千二百三十为实　法除实得九十为丁数
　　七因丁数五除之得一百二十六为丙数　五因丙数三除之得二百一十为乙数　三因乙数二除之得三百一十五为甲数
　　问有数七百四十一以四人分之乙如甲三之二丙如甲五之二丁如甲七之二各几何
　　因前问中有疉数故作此问以互明之
　　乙三当甲二而丙五又当乙三是丙五亦当甲二也丙五当甲二而丁七又当丙五是丁七亦当甲二也【又丁七亦当乙三今云两者以甲为主也】
　　在西法谓之连比例
　　上　　　　　　中　　　　下




　　首行互乗次行如故　次行乗首行皆二之甲减尽乙异并得五【正】丙二【正】丁二【正】正一千四百八十
　　二皆无减【皆仍为和同名在一行故也】
　　次行乗三行因两首位同不用乗竟以对减　甲减尽乙三【次行负也】丙五【三行负也】皆无减命为正负适足【同名在两行故为较数】三行末行首位亦同亦径减　甲减尽　乙空　丙五【三行负也】丁七【末行负也】皆亦无减命为正负适足【亦同名在两行】乃以减余重列之如三色有空之法




　　如法减并得二百四十七为法二万二千二百三十为实　法除实得丁数以次求得甲乙丙数皆如前问之数
　　问有米三百八十五石五斗二升令二等人户以四六差分出之甲上等二十六户乙下等四十户下户出率则如上户六之四
　　畣曰上户各七百三斗二升　二十六户共一百九十石○三斗二升　下户各四石八斗八升　四十户共一百九十五石二斗
　　法以和较列位


　　如法互乗得四　甲同减尽　乙异并三百一十六户为法　米一千五百四十二石○八升无减就为实　法除实得四石八斗八升为下等戸则例　以下等六户乗其则例得二十九石二斗八升以相当之上等四户除之得七石三斗二升为上等户则例
　　问有米三百一十七石给与四色人户甲二十户乙三十户丙四十户丁五十户丁每户如丙户七之三丙每户如乙户六之四乙毎户如甲户八之二各几何畣曰甲每户八石四斗　二十户共一百六十八石乙每户二石一斗　三十户共六十三石丙每户一石四斗　四十户共五十六石丁每户六斗　　　五十户共三十石
　　法列位




　　首行甲二十户十倍于次行甲正二但以首行甲退一位作二则齐同矣甲退十为单其下各位皆退十为单即如互遍乗而可以对减矣
　　乃以减并之余重与第三行列之


　　又以减并之余重与第四行列之


　　依法求得六百三十四为法　三百八十石○四斗为实　法除实得六斗为丁户则例　七因丁则得四石二斗丙三除之得一石四斗为丙则　六因丙则四除之得二石一斗为乙则　四因乙则得八石四斗为甲则
　　【此条有省算法说见后卷】
　　此上数条皆变零从整法也
　　有两数相较而为十之八十之七者即非二八三七差分也有二例见末卷
　　璎珞方程例
　　璎珞者言其聨缀而垂象璎珞也谓之疉脚
　　凡算方程皆以多色逓减至一法一实以先知一色之数然此所先求之一色却原带有不同之数则法一而实非一故以一总法而除多实非疉脚之法不可也【亦有以下为法上为实者则实一而法有多名在合问者之所求而定之详刋误条】
　　今有大江南北两处粮艘载米不同因氷程逺近给耗米亦不等但云南船三只北船两只共运米一千九百七十石外给耗米共六百六十八石又南船一只北船四只共运米一千九百九十石外给耗米五百五十六石问各船正耗米数以便稽核
　　畣曰北船每只正运米四百石　给耗米一百石共正耗米五百石　每正米一石耗米二斗五升南船每只正运米三百九十石　给耗米一百五十六石　共正耗米五百四十六石
　　每正米一石给耗米四斗
　　法各列位



　　先以左行南船一遍乗右行各得原数
　　次以右行南船三遍乗左行得数　南船三与右减尽　北船十二减去右二余十只为总法
　　正运米五千九百七十石减去右一千九百七十石余四千石为运米实
　　耗米一千六百六十八石减去六百六十八石余一千石为耗米实
　　以总法除正运米实得四百石为北船每只运数以总法除耗米实得一百石为北船每只耗米数【总计正耗得北船毎只米五百石】
　　任于左行总运米一千九百九十石内减北船四只该运米一千六百石余三百九十石为南船一只运数【一故不除　或于右行运一千九百七十石内减北船二只运八百石余一千一百七十石以南船三只除之亦得三百九十石】
　　于左行总耗米五百五十六名内减北船四只该耗四百石余一百五十六石为南船一只运数【或于右行耗六百六十八石内减北船二只耗二百石余四百六十八石以南船三只除之亦得一百五十六石】总计正耗得南船每只米五百四十六石
　　以北船四百石除其耗米一百石得每石给耗米二斗五升以南船三百九十石除其耗米一百五十六石得每石给耗四斗
　　此问每船米数故以船为法米为实
　　若问每米一万石该用几船则以减余船十只用异乗同除以一万乗得十万为总船实　以运米减余四千石为法　法除实得二十五为每运米一万石用北船之数　于是任以右行北船二只亦用异乗同除以一万石乗之二十五船除之得八百石以减共米一千九百七十石余一千一百七十石又用为法以右行原列南船三乗一万石得三万石为实法除实得二十五只又三十九分之二十五为每米一万石用南船之数
　　若问耗米给过五千石该得几船者则亦用异乘同除以五千石乘减余十只为北船实　以减余耗米一千石为法除实得五十只为每耗米五千石给北船之数　任以右行北船二只五千石乘之五十只除之得二百石以减共耗六百六十八石余四百六十八石又用为法以原列南船三乘五千石为实法除实得三十二只又三十九分之二为每耗米五千石给南船之数
　　假如有南运艘二只以比北三只则南船运米不及北四百二十石其南船带耗米反多于北一十二石若以南船三当北船五则南船运米不及北八百三十石其耗米亦不及北三十二石问各几何
　　法以正负列位
　　上　　中　　　下


　　如法乗减余北船一只为总法
　　运米同减余四百石为运米实即为北船每只运数【总法一故不除下同】耗米异并得一百石为耗米实即为北船每只耗数
　　任以右行北船三乗其运数得一千二百石同减负四百二十石余七百八十石以南船二除之得三百九十石为南船运数
　　以右行北船三乗其耗数得三百石异加正十二石共三百一十二石以南船二除之得一百五十六石为南船耗数
　　若问毎米一万石须几船运者则以减余北船一以一万石乘之为船实　以减余四百石为运米法法除实得二十五只为北船每运一万石之数　又以一万石任乗右行北船三以二十五只除之得一千二百石同减负四百二十石余七百八十石又为法以一万石乘南船二为实法除实得二十五只又三十九分船之二十五为南船毎运一万石之数
　　若问耗米五千石该给几船者则亦以五千石乘减余北船一只为船实　以减余一百石为耗米法法除实得五十只为北船耗米五千石之船数　又以五千石乗右行北船三以五十只除之得三百石异加正十二石共三百一十二石又为法以五千石乗南船二为实实如法而一得三十二只又三十九分船之二为南船耗米五千石之船数
　　此因耗米与正运不同故也若耗米亦以一万石为问则北船之实皆同
　　今有墨一百二十七锭研六十六枚给与修史局六十人校书局六十三人又有墨五十八锭研三十二枚给与修史局二十四人校书局四十二人问各防何畣曰史局每人墨一锭又六分之四【六人十锭也】研四分之三【四人共三研】校书局毎人墨七分之三【七人共三锭】研三分之一【三人共一研】
　　法各列位


　　如法乗减余校书一千○○八人为总法
　　墨余四百三十二为墨实
　　研余三百三十六为研实
　　以总法除墨实得七分之三为校书局给墨数【七人得墨三锭】　就以七人除右行校书六十三人以墨三锭乘之得二十七锭以减总给一百二十七锭余一百锭以史局六十人除之得一锭又六分之四【六人得四锭并整数为六人十锭】为史局给墨数
　　又以总法除研实得三分之一为校书局给研数【三人共一】　就以三除校书六十三人得二十一研以减总给研六十六余四十五研以史局六十人除之得四分之三【四人三研】为史局给研数
　　问修艌船只内有旧船二只新船一只共用桐油二百六十斤麻一百三十斤钉十七斤石灰二百一十斤计工两月有半又旧船一只新船三只共用桐油二百八十斤麻一百四十斤钉十六斤灰二百三十斤工两月有半其新旧船各防何
　　畣曰每新船一只　用桐油六十斤　麻三十斤钉三斤　灰五十斤　每工一月修两只
　　每旧船一只　用桐油一百斤　麻五十斤　钉七斤　灰八十斤　每工一月修一只
　　法各列位


　　先以左旧船一遍乗右行如故
　　次以右旧船二遍乗左行得数　乃相减　上位旧船对减尽中位新船减余五为总法
　　下位油相减余三百斤为新船油实【以总法除之得六十斤为新船油数】麻相减余一百五十斤为新船麻实【以总法除之得三十斤为新船麻数】钉相减余一十五斤为新船钉实【以总法除之得三斤为新船钉数】灰相减余二百五十斤为新船灰实【以总法除之得五十斤为新船灰数】
　　任以左行新船三只乗其油数得一百八十斤以减总油二百八十斤余一百斤为旧船一只油数
　　以新船三只乗其麻数得九十斤以减总麻一百四十斤余五十斤为旧船一只麻数
　　以新船三只乘其钉数得九斤以减总钉一十六斤余七斤为旧船一只钉数
　　以新船三只乘灰数得一百五十斤以减总灰二百三十斤余八十斤为旧船一只灰数
　　此为以船求油麻等故以船为法以麻油等为实
　　乃以减余新船五只为总实
　　以减余工两月半为法　法除实得二只为每工一月修新船之数就以二只除左行新船三只得一月有半以减总工两月半余一月以除旧船一只如故得每工一月修旧船一只
　　此以工求船故以工为法船为实与前相反
　　重审方程例
　　凡算方程皆以有总数无各数故逓减以求之然有并其总数亦隠者此当用两次求之故曰重审
　　假如品官禄米不知数但云甲支三品俸四个月又带支四品俸五个月乙支三品俸六个月又带支四品俸五个月亦不知甲乙各得数但云以甲十三分之一益乙则三百五十石若以乙十一分之三益甲亦三百五十石问两品禄米各几何
　　荅曰三品毎月俸三十五石
　　四品每月俸二十四石
　　法曰此当先求出甲乙两家支过禄米再求各品月俸谓之重审先以带分法列位
　　上　　　　中　　　　　下


　　左甲之一分遍乗右行如故
　　右甲之十三分遍乗左行得数
　　甲减尽　乙减余一百四十分为法　余俸四千二百石为实　法除实得三十石为乙之一分　以乙分母十一乗其一分得三百三十石为乙支过米数以乙支过米数减总三百五十石余二十石为甲之一分　以甲分母十三乗其一分得二百六十石为甲支过米数
　　既得两家支过米数乃重列之以求品俸


　　如法左右乗减　余四品十月为法　余俸米二百四十石为实　法除实得二十四石为四品每月俸以四品五月计一百二十石减甲支二百六十石
　　余一百四十石以甲支三品四月除之得三十五石为三品每月俸
　　假如品官支俸本折兼支不知数但云甲支一品俸四个月又带支二品俸五个月乙支一品俸六个月又带支二品俸十个月亦不知甲乙支过数但云取乙本色三分之一以益甲共五百六十六石若取甲本色三分之二以益乙则八百六十五石　取乙折色五分之二以益甲共四百九十八石若取甲四分之一以益乙则五百七十九石问各几何
　　畣曰一品月俸八十七石
　　内实支本色一半四十三石五斗　折色钞一半数同二品月俸六十一石
　　内实支本色六分三十六石六斗　折钞四分二十四石四斗
　　法当重审　先求本色依带分法列位
　　上　　　中　　　下


　　如法乗减　余乙之七分为法　余本色一千四百六十三石为实实如法而一得二百○九石为乙本色之一分以减右行共本色五百六十六石余三百五十七石为甲支过本色数　又以乙分母三乗其一分得六百二十七石为乙支过本色数
　　计开
　　甲支过本色三百五十七石【内一品俸四个月二品俸五个月】乙支过本色六百二十七石【内一品俸六个月二品俸十个月】
　　次求折色　亦依带分列位


　　如法左右乗减　乙余十八分为法　余折色一千八百一十八石为实　法除实得一百○一石为乙折色之一分以乙分母五乗之得五百○五石为乙支过折色数　以乙之二分乗其一分得二百○二石以减共折色四百九十八石余二百九十六石为甲支过折色数
　　计开　甲支过折色二百九十六石【内亦一品俸四个月二品
　　俸五个月】
　　乙支过折色五百○五石【内亦一品俸六个月二品俸十个月】
　　既得甲乙两家支过本折然后乃求各品月俸
　　依叠脚法列其所得本折而重测之


　　如法遍乗得数　上位一品减尽　中位二品余十个月为总法　下位本色余三百六十六石为本色实
　　折色余二百四十四石为折色实
　　乃以总法除本色实得三十六石六斗为二品毎月俸本色数　以乙二品十个月计三百六十六石减乙共本色六百二十七石余二百六十一石以乙一品六个月除之得四十三石五斗为一品月俸本色
　　又以总法除折色实得二十四石四斗为二品月俸折色　以乙二品十个月计二百四十四石减乙共折色五百○五石余二百六十一石以乙一品六个月除之亦得四十三石五斗为一品月俸折色【其右行亦可互求则先得甲数也】
　　于是以一品本色折色并之得每月俸八十七石【本折各半支】
　　以二品本折并之得毎月俸六十一石【四六支本色六分折色四分】











　　厯算全书卷四十一
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书卷四十二
　　宣城梅文鼎撰
　　方程论卷三
　　致用
　　笇之用惟防其説惟详详説之斯能捷用省笇列位诸法由是以生也故致用次之
　　致用有二一者省笇一者列位【例襍见诸卷中故不具列而备论其理】省算法亦有二一者行有空则省算一者数偶同则省乗
　　凡方程之法去繁就简同者去之异者存之归于一法一实而已矣故三色以上有空位则可径求
　　若三色方程无空位者必湏乗减得数变为二色以求之此常法也若内有一行中空一位则以所空之位列于首而先以其余两行不空者如法乗减得数即重列之与原有空位者相对如二色方程也【以两行无空者相乗对减则减去一色惟余二色其有空者原只二色故可相对如二色也】则省一笇【原法乗减三次今只两次故曰省一笇】
　　凡三色方程不论一行有空或两行各有空或三行各有空皆只省一算何也其各行中虽有空位而不相对故也何以知其不相对若两行有空而又相对则径可以二色算之矣即不成三色方程　三色有空例襍见前卷
　　凡四色五色以至多色有几行空位者如上省算径求最为简防若中行无空则必如法乗减以五色变四色四色变三色三色又变二色渐次求之不可径求而省算也今诸书所载皆其各位之有空者耳非通法也而欲以此尽方程可乎
　　凡四色方程有乗减六次者常也　若有一位空则省一算　一行中空两位或两行各空一位而相对则省二算　若一行空两位又一行空一位则省三算止矣　或有四行中各空一位而不相对亦只省一算而已何也惟首位空乃能省算若首位不空而空在下数位则乗减之后自然补实不能省矣　亦有两行各空两位而只省二算者亦以空位相左乗后补实耳故虽四行中各空两位亦只省三算也
　　假如四色中有一行空两位则将此无空之三行如法乗减变为两行又将此两行如法乗并变为一行此减余一行却有二位恰兴空两位之行相对矣便以重列如二色方程取之此最方程中要法而诸书未及也故详论之
　　若四色方程有两行各空一位而又相对则将其无空之两行如法互乗而减去此不空之位变为一行与空位之两行同列如三色法而之尤为易见
　　其四色各行空两位而省三算即今诸书中所载是也可无更赘然但欲知其为省算方程而非常法耳
　　其四色无空乗减六次者竟无其式故误以省算为常然既明其理亦不必一一为式矣
　　凡五色方程无空则有乗减十次者常法也【五色变四色则有四算四色又变三色则有三算三色又变二色则有二算二色又一算乃得法实合之为十算】故五色而为四图者亦常法也【原列一图以减余重列为四色而三色而二色又各一图合之为四图】
　　若有空一位则省一算　或空两位而省二算【湏两位空在一行或两行俱空首位乃可】　空三位而省三算【湏空在一行或三行同空首位或一行首位空一行首次两空则可】　空四位而省四算【湏一行空三位而一行又空一位恰与空三位者同或二行俱空首位而一行又空首次两位乃可或两行俱空首次亦可】　空五位而省五算【湏两行空首位而一行空首次三位或两行空首次而一行空首位或一行空首次而一行空首次三之位乃可】　空六位而省六算【湏一行空首位一行空首次一行空首次三行位乃可】
　　省至六算止矣六算以上虽多空位无闗省算也
　　今诸书有载五色方程者皆其各行空三位者耳总计之有空十五位而其为法亦必用四算然后得数则所省者亦只六算而竟不知其为省算之法则习而不察也
　　假如五色方程内只有行空三位法当以有空之三色列于上而先以其无空之四行如法乗减变为四色者三行又以乗减变为三色者二行又以乗减变为二色者一行则恰与空位之行相对矣再乗减一次得所求矣故曰省三算也【变四色时省一算变三色时省一算变二色时省一算共省三算】
　　假如五色方程内有两行各空二位而相对法当以有空之二色列于首次而先以其无空之三行如法乗减变为四色者二行又以乗减变为三色者一行则恰与空位之两行相对矣于是以三色法取之得所求矣故曰省四算也【变四色时省二算变三色时亦省二算】
　　假如五色方程内有两行空首位又一行空首次三之三位法当以无空之两行如法乗减变为四色者一行则恰与空首位之两行相对矣　乃以原数两行减余一行相并列之用相乗减变为三色者两行又相乗减变为二色者一行则又恰与空三位者相对矣　乃以原空三位者与减余列而求之即得之矣故曰省五算也【变四色时省三算变三色与二色又各省一算】
　　若五色方程内有两行各空三位者即如一行空两位一行空三位也法以无空之三行先用乗减变为四色者两行又以乗减变为三色者一行则恰与空首位次位者对矣取出原空两位者与减余列而求之变为二色者一行又恰与空三位者相对矣又取出与减余列而求之即得所问故亦省五算也【变四色三色时各省二算变二色时又省一算共五】其两行虽各空三位而不相对故也【若各空三位而相对即成二色方程矣】
　　若五色方程各行俱有空位不等要之省六算止矣省六算者必一行空首位而省一算一行空首次而省二算一行空首次三之位而省三算其余空位必不相对不能省算与无空同也
　　其法先以不空之两行乗减得数变为四色与空首位者相对又乗减变为三色与空首次者相对又乗减变为二色与空三位者相对再乗减即得所求诸列不能悉具智者反隅可也
　　论曰常与变相待而成告方方程省算而特详其不省之算者欲穷其变先得其常也
　　以上所论虽止五色引而伸之若六色七色八色九色乃至多色其理一也
　　以常言之　二色者一算　三色者三算　四色者六算　五色者十算　六色者十五算　七色者二十一算　八色者二十八算　九色者三十六算十色者四十五算　十一色五十五算　十二色者六十六算
　　以空位言之　三色者有省一算　四色者有省一算至三算　五色者有省至六算　六色者有省至十算　七色者省十五算　八色有省二十一算九色有省二十八算　十色有省三十六算　十一色有省四十五算　十二色有省五十五算
　　以省算所用而言之　三色者有只用二算　四色者有只用三算　五色有只用四算　六色有只五算　七色有只六算　八色有只七算　九色有只八算　十色有只用九算　十一色有只十算　十二色有只十一算
　　总而言之　二色则只一算　三色则有二算或三算　四色则有三算以至六算　五色则有四算以至于十算　六色则有五算至十五算　七色则自六算至二十一算　八算则自七算至二十八算九色则自八算至三十六算　十色则自九算至四十五算　十一色自十算至五十五算　十二色则自十一算至六十六算
　　扩而充之犹举一隅耳然其法不外于和较与和较之襍与变愚故不欲以四色五色等分为之目也　必如此则方程之法乃为通法若诸书所列四色者必各行空二位五色必各空三位非通法也方程者所以御襍糅正负也而必逓空相等乃可用算是法有所不及而穷于问也岂古人立法之意哉
　　此以上论空位省算省算者乗减并俱省之也非若省乗者但省互乗而不省减乗
　　凡方程互遍乘者取其首位齐同耳故乘减一次则少一色以首位之齐同必减而尽也然亦有其首位之数偶尔相同者法当径以对减而省其互乗此虽省其乗而不省其减并故与前论省算同而微异也
　　假如和数方程首位同则径减矣　若较数者又湏论其正负之名　同数矣而又同名径对减矣　同数而不同名则更其一行之正负以相较而后减并焉此要诀也不则首位虽减去而其下之同异淆则加减皆误矣
　　若和较襍者首位之数同亦必以较数首位之名名其和数之一行而后减并之但省其互乗可也
　　以上论同数省乗
　　亦有首位数虽不同而可以分数相命者则以其分数改其一行之数以从一行则首位齐同而可以对减省其互乗焉可矣
　　若较数或和较襍皆如前法齐同其首位之名斯减并无误耳【较数首位同名则仍之异名者改一行以相从和较襍者以较首位之名名其和数之一行】
　　假如两首位为五与十是倍数也则半之盖五与十互乗各得五十而其下诸数从之而溢矣今但以首位十半之为五而其下诸数皆半之以相减并则五之之行可无乗而数亦简明殊散人怀也
　　若两首位为二十与二是十之一也则以退位之法乗之使二十之一行皆为十之一　若为八为四亦倍数也　若为八与二是四之一也四除其八之行则得矣　若九与三则三之一也以三除九则亦三而其一行皆三除之则可减倂矣然三除多有不尽不如只以三因其三之行也　若为五与三则六因其五之行而退位　五与二则四因退位　五与四则八因退位皆同　若六十四与八则八之一也八除其六十四之行犹互乗也　若此类者不可枚举得其意者酌而用之可也尤要在首位之必同名亦有不可强齐者如七与二九与四之类只用互乗为无弊也省乗者为省事而设也强齐之反多事矣此以上论分数省乗
　　此外又有不拘首位者但数同则径以对减施之二色为宜盖二色方程只湏减去一色其所余即一法一实矣然亦湏同名方可减去若异名者改而齐之可也
　　假如较数方程其中一色同名而又同数径减去矣若但同数而不同名则更其一行之正负乃减去之
　　假如和较杂其中一色同数则以之为主使和数一行皆与此一色同名乃减去之
　　若和较则不湏尔但同数者即减去之此二色捷法
　　合此三者省算之理备矣
　　问田粮七则起科甲有上田一亩上次田一亩输粮七斗乙有上田一亩上次四亩上中一亩粮一石八斗丙有上次上中田各一亩粮五斗丁有上中田中田各二亩粮五斗戊有中田三亩中次五亩中下五亩已有中下八亩下田十三亩庚有中下田下田各十亩皆粮五斗问各则若何
　　法曰此方程防续法也以甲乙丙借作三色己庚借作二色各如法求得田则则其中两色自知







　　先以甲乙两行徧互乗减去上田　余上次田三亩上中田一亩　粮一石一斗　用与丙行乗减　上次田减尽　余上中田二亩为法　粮四斗为实法除实得二斗为上中田则例
　　就以上中田则减丙粮五斗余三斗为上次田则例以上次田则减甲粮七斗余四斗为上田则例【以上三色法也】
　　又以上中田则例乗丁田二亩得四斗以减丁粮五斗余一斗以二亩除之得五升为中田则例
　　又以戊中田三亩乗其则例得一斗五升以减戊粮五斗余三斗五升为戊田中次中下各五亩之共数因此处防而不属故又先求末两行
　　再以二色法用己庚两行如法遍乗减去中下田余下田五亩为法粮一斗为实法除实得二升为下田则例【以八因庚行而退位省乗法也】
　　以庚下田十亩乗其则例得二斗以减庚粮五斗余三斗以中下田十亩除之得三升为中下田则例【以上二色法也】
　　乃以戊中下田五亩乗其则例得一斗五升以减戊中下中次共三斗五升余二斗以戊中次五亩除之得四升为中次田则例
　　计开　上田每亩粮四斗　　上次田每亩粮三斗上中田每亩粮二斗　中田每亩粮五升中次田每亩粮四升　中下田每亩粮三升下田每亩粮二升
　　论曰此虽七色因行中防续即非七色借三色二色之法知其首尾而中行亦见焉所省良多然非省乗其势则然也以其疑于省算也故附之其末
　　又有数偶相同不论三色四色但一减之后即得一法一实者非省算也然亦省算之类故亦附録一条以见其例
　　假如縀纱绢不知价但云以縀一匹纱五匹易绢九匹余价二两六钱又以縀二匹绢八匹易纱四匹余价六两八钱又以縀三匹易纱六匹绢七匹少价一两二钱
　　畣曰縀每匹价银三两纱每匹一两　绢每匹六钱
　　法列位






　　因中左纱减尽只余一色即以绢十九为法　除十一两四钱得绢价每匹六钱　以绢余二十六匹乗价得十五两六钱同减负一两六钱余十四两纱价也以纱余十四匹除之得纱价每匹一两【用中右减余得之】以原左行纱六匹【价六两】绢七匹【价四两二钱】共价十两
　　二钱同减负一两二钱余九两縀三匹价也三除之得縀价每匹三两
　　论曰此方程之变例也一减之后即得其数　若多色方程除首位外有减尽者先虽无空而减余重列即成有空方程矣【例见本卷齐军列陈条】
　　若三色俱减尽则不能成算　或三色方程中左三色俱减尽中右只减一色则所余者二色而无相较乗减无因不能别其二色亦不能成算也
　　假有问水银三斤硃砂二斤共价四两四钱又水银九斤硃砂六斤共价十三两二钱问各价若干
　　畣曰此不可以方程算何也彼虽两宗而其后一宗之物价皆三倍于先一宗互乗之后必湏减尽故也
　　凡左行之物俱倍于右行或俱半俱四之一等互乗之后得数齐同不能分核具如前论方程立法正以诸物襍糅多寡错居同异参伍而得其端倪也
　　又或三色方程而问只二宗则减余仍有二色不能分别故问三色必有三宗问四色必有四宗五色六色以上悉同何也方乗立法乗减一次始能分去一色若少一行则少一次乗减而不能得其一法一实矣故行中可有空位而不可有空行
　　行中有空者分一行言之也若总列为图则位皆无空凡此皆治方程者所当知
　　知其有不可算斯无疑于算知其有必不可省斯善为省矣
　　列位之法亦有二
　　一者更其上下之位以互求也　或为省算之计
　　凡方程立法务湏首位齐同以便减去故每遍乗一次则减去一色逓减之则一法一实矣今行中有空则是不待遍乗而其一色已先减去也故取而列之于上位则能省算不则上位不空而下反空则对位无减补成不空而不能省算矣
　　其法于列位时覆视之有横列中空位多者取作首位首位空一行则省一算矣
　　若首位原有空位而欲更定次位者不必改列但于重列减余时检防更定之可也
　　又横列中有数偶相同或可以分相命者取作首位亦省遍乗或横列中有单一数多者取作首位省乗【单一数则不湏乗故也】
　　以上论上下之位
　　一者更其前后之行也
　　凡首位多空而其不空者隔逺则更而聨之便乗减也其各行空位不等者不必更列但以与减余相对
　　者取出对列而乗减之【例见前诸卷】
　　若各行首位有可以分相命或数偶相同而为他行所隔亦可更置使之相接
　　又多色方程有各行中对位总空者取出另列而先乗其他行之不空者乃于重列之时渐次添入可免细书局蹐【例见后卷】
　　以上论前后之行
　　法曰凡多色方程先任意列位竟乃覆视之若首位有空而下则无之此不必更置也或首位多空而下则少亦不必更置也
　　惟首位不空而下反有或首位空少而下反多则更而置之故上下可以互居前后亦可易位或云以末行为主者非也
　　问古今厯术屡更其所用日法无一同者如以汉太初厯日法十有一外加四十九则如殷厯日法也若以太初日法二殷厯日法三再加五十八则如唐大衍厯日法也若太初日法十有四大衍日法二相并以比宋纪元厯日法仍少七十六若太初日法九十倍之即纪元日法其各数若干
　　法以正负列位
　　甲太初十一【正】殷七一【负】○　　○　　　负四十九乙太初二【正】殷六三【正】大衍一【负】○　　　负五十八丙太初十四【正】　○　　大衍二【正】　纪元一【负】　负七十六丁太初九十【正】　○　　　○　　纪元一【负】　适足如右图太初厯横列皆满须用遍乗对减者三而后能减去太初之一色其余虽多空位自然有无减之对位相补不能省算
　　如法改列
　　以最多不空之太初列下爲第四位则殷厯居上而成有空位之方程矣




　　先如法以甲乙两行互乗减并殷厯各正十五对减尽大衍负一无减太初异并负三十五下数异并正二百○五【因异并故并从甲行之名而大衍在乙行与下数同名亦改负为正】
　　乃重列之【取出丙行与减余相对】


　　如法互乗减倂　大衍各正二对减尽　纪元负一无减　太初异倂得正八十四下数异并得负四百八十六
　　又重列之【以减余与丁行相对】


　　首位同名同数省互乗　纪元各负一对减尽　太初同减余六为法　负四百八十六无减为实法除实得八十一分为太初日法　以丁行太初九十乗其日法【八十一分】得七千二百九十分为纪元日法　以甲行太初十一乗其日法【八十一分】得八百九十一异加负四十九得九百四十分为殷厯日法　以乙行殷厯三乗日法【九百四十】得二千八百二十又太初二乗日法得【一百六十二】又异加负【五十八】共得三千○四十分为大衍日法
　　计开
　　殷厯日法　九百四十分
　　汉太初厯日法　八十一分
　　唐大衍厯日法　三千○四十分
　　宋纪元厯日法　七千二百九十分
　　又按列位之法原与省乗省算之法相生故共为一卷合观之可也今以六色无空者为例如后
　　问齐军千乗其陈有先驱申驱为前军有启与胠为两翼有戎车贰广为中军有大殿为后军各不知数但以前军居余陈七之三合两翼二广与殿多余陈四十乗合前军两翼与中后较则多二十乗前军合殿与翼中军较则少二十乗先驱大殿居与陈二之一而少五乗各若干
　　畣曰前军共三乗
　　内先驱一百四十乗
　　申驱一百六十乗
　　两翼共二百一十乗
　　内启与胠各一百○五乗
　　中军共三百乗
　　内戎车一百八十乗【帅】
　　贰广一百二十乗【副】
　　后军一百九十乗是为大殿
　　法以和较襍列位
　　有七之三二之一依变零为整以分母各乗而后列之






　　如法互乗减倂变为五色有空而重列之
　　空者偶也若不空亦俨然变为五色矣





　　前三行减余首位申驱皆空故不湏乗减但以末二行乗而减之减去申驱即变四色矣又以申驱数本同故不湏乗而竟以对减乃以四色法重列之四色无空法也虽有空而非首位不能省算与无空同




　　因首末两行之翼数皆倍于中两行故省互乗但以首末两行皆半之使其翼数齐同乃原数对减而变为三色又重列之



　　因次行末行戎车同但首行多于次行二之一故省互乗但以次行二分加一与首行对减其次行与末行竟以原数对减变为二色而重列之


　　贰广同故省互乗竟以对减尽　大殿异名并得五为法　车同名减余九百五十乗为实　法除实得一百九十乗为大殿车数　以大殿车数异加正五十乗共二百四十乗以贰广二除之得一百二十乗为二广车数【用末次右行数】　二乗大殿车数同减负二十乗戎车二除之得一百八十乗为戎车公卒数【用第四次三色中行数也】　二乗戎车异加正六十乗两翼二除之得二百一十乗为两翼共数【用第三次所列四色之次行】又半之即启与胠数　合计两翼【二百一十】戎车【一百八十】贰广【一百二十】共数【五百一十】同减负三十乗余【四百八十】以申驱三除之得一百六十乗为申驱数【用第二次所列五色之第四行】　合计申驱【一百六十】两翼【二百一十】戎车【一百八十】贰广【一百二十】共【六百七十】同减负十乗余【六百六十】又减去大殿二计【三百八十】余【二百八十】以先驱二除之得一百四十乗为先驱之数【用原列六色之第五行数】
　　试细攷之合计两翼【二百一十】戎路【一百八十】贰广【一百二十】大殿【一百九十】共七百乗合计先驱【一百四十】申驱【一百六十】共三百乗三七差分也故曰前军为余阵七之三
　　合计两翼【二百一十】贰广【一百二十】大殿【一百九十】共五百二十乗其余前军【共三百】戎路【一百八十】共四百八十乗故曰翼广殿多余阵四十乗
　　合计前军【共三百】两翼【二百一十】共五百一十乗以较中军【共三百】后殿【一百九十】共四百九十乗则多二十乗故正二十乗与前军翼同名
　　合计前军【三百】大殿【一百九十】共四百九十乗以较两翼【二百一十】中军【三百】共五百一十乗则少二十乗故负二十乗与前军殿异名合计先驱【一百四十】后殿【一百九十】共三百三十乗又合计申驱【一百六十】中军【三百】两翼【二百一十】共六百七十乗其二之一为三百三十五乗故曰先驱大殿居余阵二之一而少五乗【以全当其半而少五乗则以倍当其全而少十乗矣此与第一行皆变零为整详见带分条】总计之则千乗矣故以和数参焉
　　论曰此一例中能兼数法皆省算之捷诀也
　　其第二图五色变四色当有互乗减并者四次今以申驱空位省其三次此空位径求省算之法也其申驱偶尔数同径以对减与第五图二色之贰广数同径以对减皆省乗定法也但皆和较之襍故虽不乗必以较行首位之正负补于和数之行不然则减并误矣此要诀也
　　其第三图四色之首位偶有倍数故半其倍者以相从此亦省乗法也
　　其第四图三色之首位为三与二故加二为三是二加一也故其下皆二分加一则如遍乗矣然亦首位正负偶同也若不同者湏更其一行以同之首位虽同数又必同名然后可减而去之尤省乗之要诀
　　又论曰方程无空者常法也如第一图六色是也若不减并五次何以求之亦偶而多有首位相同者故亦能省乗然虽省乗不能省减并矣其有空位者偶然也如第二图五色有空是也空位多若更置列之所省尤多虽不更置而减倂之余自然能补其空亦可见方程之有常法矣
　　若更置之则自五色起如后图
　　因五色始有空也如此图则省六算　戎翼不空故更之下位后行不空者更之前行以先乗
　　正负列位





　　甲乙行如法减去申驱以其余四位重列之与丙行相对【一和一较也】
　　重列


　　如法减去贰广又重列之与丁行相对【皆较数也如后】


　　如法半减余数以从丁行乃对减而重列之与戊行相对【又以翼同故更置之】
　　上　　　　　中　　　下


　　如法径以对减余戎路五为法
　　倂得正负九百乗为实
　　法除实得戎路数
　　既得戎路数以次得余重之数
　　合问
　　又术以一图而为减并如后所列






　　依法先得戎路亦同但其间和较交变错然襍陈非深知猝不能了不如前术之为安穏明白也















　　歴算全书卷四十二
　　钦定四库全书
　　厯算全书卷四十三
　　宣城梅文鼎撰
　　方程论卷四
　　刋误
　　古之为学也精故其立法也简而语焉不详阙所疑而敬存其旧无臆参焉斯善学也已不得其理而强为之解以乱其真古人之意乃不可见矣意不可见而讹谬相仍如金在沙淘之汰之沙尽而金以出故刋误次之方程之误厥有数端
　　一曰立负之误【立负误也四色五色期于立负以为法误之误也自骡马逓借一问诸书沿讹而加减之误因之矣】
　　一曰加减之误
　　同加异减一误也【误沿于牛羊豕相易之一问由不知正负之有更也】
　　竒减偶加二误也【误沿于桃梨问价以不知和较之交变也】
　　一曰法实之误【以上为法下为实拘也以法必少实必多亦谬也】
　　一曰倂分母之误
　　一曰设问之误【如井不知深而以除法为井深问中先已大误】
　　立负辨
　　立负非古人法也何以知之有负则有正今立负而不言正非正负之本防也或曰有正则有负则言负可不言正矣是又不然凡和之变而较也有减其和数而尽者亦有减其和数而余者其减而尽者命为适足而无较数则但言此之为负以见彼之为正可矣若减而余者是有较数也而但言负不言正何以知其较数必与正物同名乎即使同名而竟不明言其为正何以分别同异而为加减乎至于以有空位而立之负则又不可何也和之或变而较也固不必以空位也但减余分在两行而兼用之即变较数矣今必以有空位者而立之负则无空位者即不立负乎然则和数之无空位者终于同减而无异并乎将进退失据矣故曰非古人法也
　　凡言正负者分其物以相较也不言正负者合其物以言数也皆自然而有之名非立之也而立负乎哉夫不知正负之出于自然而强立之负则同异之防淆而加减之用失种种谬误縁之以生故谨为之辨今以诸书所载立负例攷定如左
　　假如米四石二斗以马一骡二驴三载之皆不能上坡若马借骡一骡借驴一驴借马一则各能上坡问马骡驴力各几何
　　畣曰马力二石四斗　骡力一石八斗　驴力六斗
　　法各以和数列位【马借骡一则一马一驴也骡借驴一则二骡一驴也驴借马一则三驴一马也各以其本数加借数而列之干方程法则和数而已】



　　此三色有空法也中行无马原只二色故不湏乗减但先以左右两行首位不空者对乗　又因两行马数皆一乗皆如故故径以对减马减尽　右骡一左驴三皆无对不减　米各四石二斗亦对减而尽乃视减余骡一在右行驴三在左行分在两行是有正负也　米亦减尽是正负适足也重列之
　　论曰此和数变为较数也何以言之两行之马相若而其载物又相若则其所偕以共载之骡一与驴三其力亦自相若矣故命之适足适足者以两相较而成故曰变为较数也然谓之适足可也谓一行俱减尽则不可也减尽者同类之物而其数又同故物与数俱减尽也适足者物非同类而其物之积数则同故其物不能减尽而数则减尽也物不同而数同故曰适足也适足者存之为用也物数俱减尽者清出其一色而不复用也如此三色中虽不能遽知各力然已知驴三骡一之适相当矣则已清出马之一色而变为二色矣此逓减立法之意也
　　又论曰减余适足则有正负矣其原列只是和数无正负也诸书以逓借一匹之故而列之曰借又别其本数曰正不知正与负对非与借对也虽逓借一匹其实是本有之头匹与所借之头匹共载此米故曰和数逮减余乃变为较耳故减余适足宜言正负也而诸书但立负原列和数无正负也而忽分正借又不立负于减之后而立于其先正也借也立负也三者相乱而靡有指实古人之法固如是乎哉
　　次以中行原数与减余对列　因中行马空故径求也


　　此和较杂也　减余分正负　中行原无正负
　　以减余骡负一遍乗中行如故【较乗和也数虽如故但皆以乗法之名名之为负】又以中行骡二遍乗减余得数【和乗较也故仍其正负之名】骡同减尽　驴异并得七为法　四石二斗无减就为实　法除实得六斗为一驴之力　三因驴力得一石八斗为一骡之力【适足故也】以骡力一石八斗减四石二斗余二石四斗为一马之力【原右行数】
　　论曰减余原是骡一与驴三力等乗后得数则骡二与驴六亦等也然则于中行共力中减去二骡而以相等之六驴益之其共之四石二斗亦必与原载等也故并此六驴与原列一驴共七为法以除此四石二斗而驴力可知也　驴三与骡一既等则三驴之所载即骡力也　骡与马各一共四石二斗则减骡力即马力也
　　又论曰此因中行有空故径求也使其不空自当与左行或右行遍乗而减去其马与其数乃列两减余如二色求之此常法也今中行马空原只二色恰与减余之二色相对故径相乗减是省一算也诸书皆言因左行骡空故立负骡一与中行对乗不知左行骡空而右之骡一无减犹右之驴空而左之驴三无减也其与中行相对乃用此两色之减余非独用左行也盖左行有马中行无马原无对乗之理亦犹之右与中不可对乗惟减余是二色可以对乗虽云径求实自然之理势也而强立之负以用左行乎
　　有正斯有负立负骡于左行为与何物相对耶以马一为正耶驴三为正耶其马一驴三皆正耶既无所指则负为徒立矣
　　凡言正负者其下数必为正与负之较今所用左行之四石二斗者为是骡一与驴三相较之数耶骡一与马一相较之数耶将合马一驴三与骡一相较之数耶则皆无一合矣
　　凡物有正负者其较数亦有正负此四石二斗者正耶负耶若无正负即是和数不应立负骡矣
　　若以四石二斗为和数则更非理夫以马一驴三之共数加一骡力而其数如故理所无也若去一马用一骡而与驴三共此米抑又不能马与骡之力原不同乃去一马加一骡而其数如故理所无也然则此四石二斗安属耶彼惟不知四石二斗之减尽即为适足故误至此也
　　又谓右行俱减尽不知减尽必两行数同如马一与米四石二斗也若骡一驴三固未尝有减也况尽乎方程立法原以对减有尽不尽而得其朕兆若三色俱减而尽其算不立矣惟不知有空位者可以径求而误以所用之减余为是左行之原数故也
　　凡减尽者两俱减尽不应右减尽而左行独存若谓复用左行之原数何以不用原列之马一而加一负骡以为马一减去故不用则四石二斗何既减而复存耶故以立负骡减马一为用减余之法则四石二斗不宜存四石二斗为用原列之法则马一不宜减负骡不宜立破两法而叅用之一不成矣承譌者迁就多岐抑奚足怪
　　今试以减余更置则先得骡力如后图


　　如前法以一和一较遍乗得数　驴同名减尽　骡异并得七为法　正十二石六斗无减就为实　实如法而一得一石八斗为骡力以驴三除相当一骡之力得六斗为驴力【任于原列左行或右行如法减驴力或骡力得马力】
　　论曰凡减余重列之数皆可更置互求何则皆实数也三色减去一色即二色法矣若干减余之适足加以四石二斗则不可以互求故知其误
　　又试以原列更置之先减去骡如后图




　　如法先以右中遍乗　骡减尽　中行驴一　右行马二皆无减分正负列之　载米余四石二斗在右行与马同名　左行骡空故径与减余相对　依和较杂法乗之　驴同减尽马异并七为法　载米异倂十六石八斗为实　法除实得二石四斗为马力以马力减四石二斗余一石八斗得骡力　以马
　　力倍之同减四石二斗余六斗得驴力
　　试又更之如后图




　　如前法先以右中两行遍乗减去驴余马一骡六皆无减分正负载米余八石四斗在右与骡同名乃重列之如前法径与左行相对遍乗　马同减尽骡异并七为法　载米异并十二石六斗为实实
　　如法而一得骡力以次得驴马力皆如前
　　论曰凡诸色方程其上下皆可互更如上二图以空位径求之法求之无所不合也
　　又试以原列无空而减余适足者为例如后
　　假如有三车三槖驼七牛各欲载物六十四石而皆不能胜若车借驼牛各一驼借车牛各一牛借车驼各一则皆能载问三者力若干
　　畣曰车二十四石　槖驼十二石　牛四石
　　法以和数列位



　　如法乗　车皆减尽　甲乙两行减余皆在乙行和数也　乙丙相减余乙驼二丙牛六是有正负也载物减尽适足也【乙丙载物减尽则不但对减去之物适相当而其减余之驼二牛六其力亦适相当也虽欲不命之适足不可得矣】
　　乃以和较杂重列之


　　依一和一较法求得牛三十二为法　载物一百二十八石为实　法除实得四石为牛力　牛六共力二十四石以相当之驼二除之得十二石为驼力以牛力驼力减六十四石余四十八石车二除之得二十四石为车力【用右行原数】
　　论曰此亦以和变较而有适足之数也岂以有空位而立之负乎可以悟其非矣
　　试更以较数求之
　　假如运粮以象马牛车三种但云接运时以三象所载与四牛车二十四马载之则余三十六石以八牛车所载与二象十二马载之亦余三十六石以七十八马所载与二象二牛车载之亦余三十六石问各若干畣曰象七十二石　牛车二十七石　马三石
　　法以较数列位



　　如法互乗减并重列其余【中行每加二分一则首位象与右齐同可对减矣其中左象本同径以对减皆省算法也】


　　依省算法求得马三十载九十石以马除载得三石为马力　马九十载二百七十石牛车十除之得二十七石为牛车力　合计牛车四马二十四共载一百八十石异加正三十六石象三除之得七十二石为象力【用右行原数】
　　论曰此原列较数也而其较数亦有减而适足者然则先无适足减之而成适足者往往有之矣
　　惟适足故分正负非以空位而立负也故知减余之亦有适足而复用左行者非矣知用减余而非用左行则立负之非不攻而破矣
　　同加异减辨
　　同名相减则异名相加矣诸书所载忽而同减者忽而异减忽而异加者忽而同加岂不谬哉又为之説曰以正为主则同减而异加以负为主则异减而同加又为之説曰同名相乗则其下同减而异并异名相乗则其下异减而同并言之缕然用之纷然而要之非是也夫同名相减即如盈朒章两盈两朒相减也异名相并即如盈不足相并也岂有同加异减之理乎所以误者不知正负交变之法也正负宜变而不变则首位之异名者何以能对减而尽乎不得不迁就其法同加异减矣苟知其变则首位必同名首位既同名则凡减皆同名凡加皆异名较若画一何必纷纷强为之説乎
　　凡减余重列有仍其负正如故者亦有更其正负絶非其故者且有先无正负及其重列而有正负者有先分正负及其重列之而反不分者若但以初名为定则加减皆舛矣
　　假如同减之余分在两行而为同名【或左余正右亦余正或左余负右亦余负】则重列必为异名矣必变其一行之名而列之而其下所余数必是此二异名物之较数也若无余数必是此二异名物相当适足也【此以三色言之若四色以上减余位数多者皆仿此论之】
　　若同减之余分在两行而为异名【或左余正而右余负或左余负而右余正】则重列必为同名矣而其下所余数必是此二同名物之和数也【此亦以三色言之其减余只二色故也】则其原列正负之名皆不用矣
　　若异倂者尤为易见何也凡异并者正与负并也正与负并则如一物矣故重列之际必以一行为主而定其名【或为正或为负或变和数则无正负】若但守初名而不知所变将一物而名之正又名之负乎必不然矣兼此数端知正负之交变出于自然非强名也【不知正负之变亦不知和较之变矣故又有竒减偶加之误也】
　　今以诸书所载同加异减例考定如左
　　假如以牛二羊五作价易猪十三剰价五两以牛一猪一易羊三适足以羊六猪八易牛五不足三两问价各若干
　　畣曰牛价六两　羊价二两五钱　猪价一两五钱
　　列所问数



　　先以右行牛正二遍乗中左两行得数【中右首位同名故正负不变右左首位异名故变左行之正负以从右亦为以少从多】
　　次以中行牛正一遍乗右行皆得原数　乃以中右两得数对减　牛各正二同名减尽　羊异名【右正五中负六】并得十一猪异名【右负十三中正二】并得十五　价无减【右正五两中适足】仍得五两　于是分正负以价与羊为同名而重列之【羊右正中负猪右负中正故仍为较数价与羊同为正于右行故仍为同名】次以左行牛负五遍乗右行得数【左行既变以从右则右行不变仍其正负】乃以左右两得数对减　牛各正十同名减尽羊异名【右正廿五左负十二】并得三十七　猪同名【右负六十五左负一十六】减余四十九【在右】　价同名减【右正二十五两左正六两】余十九两【亦在右】　于是亦分正负亦以价与羊同名而重列之　羊与余猪原分正负于右故仍为较数价与羊同为正于右故同名
　　列两减余


　　如法以两正羊遍乗得数　乃对减　羊同减尽猪同减余十六为法　价同减余二十四两为实法除实得一两五钱为猪价　以猪十五价二十二两五钱异加正价五两【共二十七两五钱】羊十一除之得二两五钱为羊价　任于原列中行羊三价七两五钱内减猪价一两五钱余六两为牛价
　　论曰凡列正负可以任意呼之要在知下价之于正负孰为同名耳若乗后得数则其首列一位必以同名而相减故正负有时变而其价之正负从之变矣故同异加减必以乗后得数而定也如此所列左右行先为一正一负异名之价而乗后得数必为同名之价何也两价皆与牛同名而牛在首列得数必同名故也若以羊更置首列则两价得数必异名何也价与羊于右同名而于左异名也
　　试更列之于后
　　上　　　　中上　　　中下　　　下



　　如法以中行羊与左右两行互遍乗得数相减　羊同减皆尽　右中牛异并三十七　猪异并一百十八　价异并四十五两【价与牛同名】中左牛同减余九猪异并三十　价九两无减【与牛同名】
　　乃以两减余各分正负而重列之


　　如法以牛互遍乗而变左行之正负以相从　牛同减尽　猪同减余四十八为法　价同减余七十二两为实　法除实得猪价以次得牛羊价合问　试又更之



　　如法以中行猪与左右两行互遍乗得数相减　猪同减皆尽右中羊异并一百十八【右负中正】　牛同减余四十九【余负在中】　价同减余一两【余负在右】　分正负【以价与羊同名】　左中羊异并三十【中正而左负】　牛异并十三【中负左正】　价三两无减【中之负数】亦分正负【以价与牛同名】　皆重列之


　　如法互乗羊同减尽牛同减余六十四两为法价异并三百八十四两为实法除实得牛价六两以次得羊价猪价
　　论曰反覆求之皆同减异加别无他术可见古人立法之简快竒减偶加辨
　　方程立法只同名相减异名相加尽之【和数有减无并皆同名也较数有减有倂或同名或异名也和较交变故减并相生】不论二色三色四色乃至多色皆一法也今诸书不察偶见瓜梨一例有竒减偶加之形不得其觧遂执为四色之定法而不知通变使方程一章之法为徒法而莫可施用深可惜也故覼缕辨之今将梨一问考定如后
　　假如有二梨四共价四十文又梨二榴七共价四十文榴四桃七共价三十文一桃八共二十四文问各价几何畣曰八文　梨六文　榴四文　桃二文
　　法以和数列位　依四色有空以省算法求之




　　惟甲丁两行有如四色故先以相乗　减尽甲梨四丁桃十六皆无减　价余八文　分正负【梨甲桃丁故也】以价与桃同名【同在丁行故也】　减尽矣而余行皆无则只三色故径以减余之数与乙行相对


　　如法互乗　梨同减尽　榴二十八【左正】桃三十二【右负】皆无减价异并一百七十六文【右负左正】
　　隔行之异名乃同名也以和数列之不分正负又以余行无梨则只二色径以减余与丙行列之【于后】


　　如法乗减榴减尽余桃六十八为法价一百三十六文为实法除实得桃价二文　以丙行桃七价十四文减共三十文余十六文悉榴价也榴四除之得榴价四文　以乙行榴七价二十八文减共四十二文悉梨价也梨二除之得梨价六文　以甲行梨四共二十四文减共四十文除十六文悉价也二除之得价八文
　　论曰此和数变为较数而较数复变和数也何以言之初次减余价八文乃桃多于梨之价故曰变为较数也【桃十六价三十二文梨四价二十四文差八文】何以知之余数分在两行也【桃十六在丁行梨四在甲行】何以知桃多于梨桃与价同在丁行故同名也然所用分正负者是甲丁两行之减余非但以丁行空位而立负也又因乙丙位皆空故用此减余径与乙行相对是省二算也乃径求也非专用丁行为主也减余较也乙行和也一和一较故有异名相并而非以偶行故加也
　　若第二次减余则复是和数何也其相并一百七十六文乃桃榴之共价【桃三十二价六十四文榴二十八价一百十二文共此数】而非其较数故曰复变和数也何以知之桃与榴虽分余于两行而异名然隔行之异名乃同名也【乙行榴正价亦正减余桃负价亦负兼而用之变为同名矣】至于立负之非此尤易见盖既变和数无正负矣虽两遇空而无减岂得谓之立负乎又因丙行梨亦空故径用减余与之对减是又省一算非以丁行对丙行也而顾曰立负榴于丁行误之误矣减余变和丙行相对是两和也故有减而无并也而岂以竒行之故而减也乎哉　今试以甲丁之行易之则加减全非矣




　　如法以甲丁行对乗减尽　桃十六【甲】梨四【丁】皆无减　价相减余八文【甲】　乃分正负以价与桃同名而重列之与乙行相对


　　如法乗　桃同减尽　榴六十四【左正】梨二十八【右负】皆无减　价同减余四百二十四文　依前论隔行之异名即同名也不分正负而重列之与丙行相对


　　如法减榴　余梨六十八为法　四百○八文为实法除实得梨价六文以次得诸物价皆如前
　　论曰此但更其前后之行耳而价皆同减无异并可见竒减偶加之非通法矣　又试以上下之位而更之




　　如法以甲丁先乗减去梨尽　余榴二十八【甲】四【丁】皆无减　价相减余八十文【甲】依前论分正负以价与榴同名而重列之与乙行相对


　　如法乗减榴尽　余桃一百九十六【左正】一十六【右负】皆无减　价相减余五百二十文【左正】依前论复变和数不分正负而径与丙行重列之


　　如法减桃　余六十八为法　价五百四十四文为实　法除实得价八文以次得诸物价皆如前
　　论曰此亦有同减无异加固不以竒偶之行而有别也若以甲丁减余更置之则亦有异并之用如后图


　　论曰此下价何以倂异名故也何以异名凡一和一较方程在和数行者其得必与较首位同名故其较数之价与首位同名者则亦与和价同名也其与首位异名者与和价亦异名也
　　先用丙行何也以有故可与余相减亦可见行次之非定也　理之不定乃其一定凡事尽然泥一端以定之转不定矣
　　又论曰此亦复变为和数也何以知之正榴正价皆右负桃负价皆左以之并为一行则无正负矣盖隔行



　　如法减桃　余榴六十八为法　价二百七十二文为实　法除实得榴价四文以次得诸物价皆如前
　　论曰兼此数端知加减非闗行数矣
　　统宗歌曰四色方程实可夸湏存末位作根芽若遇竒行湏减价偶行之价要相加诸书仍讹又推而至于五色六色皆云以末位为主而自首行以往皆与之加减至其所以加减者又皆以行之竒偶如一行三行五行竒数也则价与末行减二行四行偶数也则价与末行加而不言同异名将竒行者皆同名乎偶行者皆异名乎未可必也不知彼所设问各行逓空两位势必挨列虽云四色乃四色之有空者耳非四色之本法也【省算卷辨之极详可以互发】既挨列矣余行之首一色皆空不湏乗减惟末行首行相对可以互乗非用末行乃用上一色相对之行耳使上一色不空者在中二行而末行反空又当以中行先用矣虽欲以末行为主得乎
　　至于第二次重列而乗减者乃用首行末行相减之余也非専用末行也葢两行相减乃生余数若谓之用末行亦可云用首行矣
　　又因各行多空故径以减余与次行乗减得数又径以减余与三行乗减乃省算之法于末行毫不相渉也
　　且方程之行次非有定也其前后可以互居左右中可以相易亦何从而定之为末行乎末行无定矣又安有竒偶之可言乎而以是为加减之定法乎
　　然则恶乎定曰详和较以列减余别同异以定加减苟其和数也虽空无减不立正负也苟其较数也虽无空位分正负也此列减余之法也但同名者不论何行皆减但异名者不论何位皆加此定加减之法也如是而已
　　法实辨
　　算家法实皆生于问者之所求如有总物若干总价若干而问每物若干价则是以物为法价为实也或问每银一两得若干物则是以价为法以物为实也诸算尽然则方程可知矣算海説详曰中余为法除下实盖本统宗然其説非也同文算指曰以少除多其説亦非也何以明之曰方程法实犹诸算之法实也故必于问者之所求详之中下多少非可执也
　　假如和数方程有物若干又物若干共价若干是物之位在上中而价之位在下也若问每物之价而以物为法银为实是中除下也固也或问每银一两之物而以银为法物为实又当以下除中矣不知问者之所求以物求价乎以价求物乎愚故曰中下难执也
　　又物之价值莫可等计有贱于银之物以一两而得数千百斤有贵于银之物以数十百金而得一物假如有贵物若干又若干共价若干是物之数少而银之数多也而问每物之价谓之以少除多似也若问每银之物不又当以多除少乎又如有贱物若干又若干共价若干是物之数多而银之数少也而问每银物若干谓以少除多可也若问每物价若干不且以多除少乎惟以多除少故有不满法之实实不满法故有以法命之如云每银一两于物得几分之几者是也其物多除银少者则有退除为钱若分厘故曰多少难拘也
　　多少中下既不足以定法实则法实安定曰亦惟于问意详之而已　今具例如后
　　论曰方程法实只是以下一位与上中数位相湏为用耳故有实一而法二其三色者则有实一而法三若以下除中者则有法一而实二或法一而实三故用互乗之法以减之及其用也则只是一法一实而已二色者互乗而对减其一则一法一实也三色者对减其一又对减其一亦一法一实也四色五色其法悉同此方程立法之原也
　　问河工方九百尺以当筑城八百尺城多一工以河工七百二十尺当城工七百尺城多二工问每工一日若干尺
　　畣曰河工每日六十尺　城工每日五十尺


　　如法乗减　余城工五万四千尺为实　工一千○八十为法法除实得每工五十尺为城工每日之数以城工五十尺除右行八百尺得十六工同减负一工余十五工以除河工九百尺得每工六十尺为河工每日之数
　　论曰此以下除中也縁所问每工一日土若干尺以工求土也故以工为法土为实若拘中法下实则法实反矣
　　若问每土千尺该用几工则当以五万四千尺为法一千○八十工为实法除实得百分工之二是为每城工一尺之数以所问每千尺乗之得二十工是为城工每千尺用工二十日也　若用异同除则以土千尺乗一千○八十工得一百○八万工为实以法五万四千尺除之得二十工为城工每千尺之数亦同
　　于是以二十工乗八百尺【用右行原列】千尺除之得十六工减负一工余十五工河工九百尺数也以九百尺除十五工得百分工之一又三分之二河工每尺数也以问千尺乗之得十六工又三分工之二为河工千尺之数　用异乗同除以千尺乗十五工得一万五千工九百尺除之得十六工又九之六约为三之二亦同
　　问开渠十七工筑堡二十工共以立方计者一千六百八十尺又渠三十工堡四十工共三千二百尺今欲计土续工则每百尺得几工
　　畣曰开渠每土一百尺【二工半】筑堡每土一百尺二工


　　如法乗减　余堡工八十为实　土四千尺为法法除实得每尺百分工之二以百尺乗之得二工为筑堡每百尺之工【或异乗同除以百尺乗八十工得八千为实以法四千尺除之亦得每百工二工】　以左行堡工四十乗百尺二工除之得二千尺以减共三千二百尺余一千二百尺渠土数也用除渠工三十得百分工之二半以百尺乗之得二工半为开渠每百尺之工【或异乗同除以百尺乗三十工得三千以一千二百尺除之亦得每百尺二工半】
　　论曰此亦以下法除中实也縁所问以土求工故也又为以多除少盖土之数原多于工也故退除而得其分秒而所问者每百故又有异乗同除之用也并分母辨
　　自方程笇失传有可以方程立算亦可以差分诸法立算者则皆收入诸法而不知用方程如愚末卷所载方程御襍法是也有实非方程法而列于方程如同文算指所収菽麦畦工诸互乗之法是也有可以方程算而不用方程漫以他法强合而漫谓之方程如并分母之法是也诸互乗法非方程易知不必辨故専辨分母
　　问甲乙二窖不知数但云取乙三之一益甲取甲二之一益乙则各足二千石
　　畣曰甲窖一千六百石　乙窖一千二百石


　　原法曰列位互乗甲得六千石乙得四千石相减余二千石为实并两分母共五为法除之得四百石以乙分母三乗之得一千二百石为乙窖以乙窖减二千石余八百石以甲分母二乗之得一千六百石为甲窖
　　论曰此法不然乃偶合耳若分母为三与四即不可用或分子为之二之三亦不可用况方程法原无平列两色物之理而此独平列既平列矣又何以先得乙窖皆不合也今以方程本法御之则无所不合
　　依带分化整为零法列位


　　如法乗减　甲减尽　余乙五分为法　余二千石为实　法除实得四百石为乙之一分以乙分母三乗其一分得一千二百石为乙窖　以乙之一分减二千石余一千六百石为甲窖
　　论曰此亦用五分为法也然为得数相减之余非并分母也所用之实亦二千石然为甲分互乗之数相减非甲乙两分母互乗相减也
　　亦先得四百石为乙三分之一然以乙列于中甲列于上故先减去甲而余乙为法以先得乙之分若列乙于上则亦先得甲分矣试更列之以先求甲窖


　　如法乗减　乙减尽　甲余五分为法　余四千石为实　法除实得八百石为甲之一分以甲分母二乗之得一千六百石为甲窖
　　以甲之一分减二千石余一千二百石为乙窖
　　论曰凡方程有各色皆可更列其上下以互求而任先得其一色何也其互乗而对减者皆实数也若并分母为法则无实数可言故不可以互求
　　愚于带分言之备矣或化整为零【如上所列二例是也】或变零从整或除零附整共有三法凡带分者皆可施用若并分母为法则多所不通矣　凡此皆诸书沿误而同文算指亦皆收入未尝驳正也
　　试以分母非三与二者求之
　　假如有句股不知数但云以股四之一益句以句三之一益股则皆二丈二尺问句股各若干
　　畣曰句一丈八尺　股一丈六尺
　　依化整法列位
　　上　　　　中　　　　　下


　　如法乗减　余股十一分为法　四丈四尺为实法除实得四尺为股之一分以股分母四乗其一分得一丈六尺为股
　　以股之一分减共二丈二尺余一丈八尺为句
　　论曰此十一为法也若以股列于上则亦十一分为法也如并分母将以七为法其能合乎
　　又试以分子非之一者求之
　　假如有股与不知数但云若取六分之二以益股则五丈五尺若取股三分之二以当则少五丈五尺问若干
　　畣曰股三丈　七丈五尺
　　法以一和一较依化整法列位


　　如法互乗　股同名减尽　异名并得二十二分为法　数异名并得二十七丈五尺为实　法除实得一丈二尺五寸为之一分以分母六乗其一分得七丈五尺为　以之二分二丈五尺减共五丈五尺余三丈为股
　　论曰此以二十二为法也若以列于上则亦二十二为法也而并分母是将以九为法矣岂不毫厘千里乎
　　以上数则皆不可并分母为法
　　问者或云甲乙仓粟不知数但知共二千石其甲二之一与乙三之一等各若干
　　畣曰甲八百石　乙一千二百石
　　法以和较襍列位亦用化整为零


　　徧乗甲同减尽　乙异并五分为法　二千石无减为实　法除实为乙之一分　以乙分母三乗其一分得一千二百石为乙仓　因适足故乙之一分犹甲之一分也以甲分母二乗之得八百石为甲仓
　　论曰惟此有似于并母然实非并分母乃并得数之异名者也又按并母法与方程不同
　　假如有仓粟取三之一又二之一共计二千石问原数若干
　　畣曰原数二千四百石


　　法以两母互乗其子而并之得五为法　以两母相乗得六以乗二千石得一万二千石为实　法除实得二千四百石为原仓之粟
　　论曰此即并母法也因两分子皆一故并母用之实并两分母互乗其子之数也盖既曰三分二分其原数必可以三分之又二分之者也故以两分母相乗得六借为原数之衰原数六则三之一即二也二之一即三也并而用之借为所取之分如云取原数六分之五而二千石也六分之五为二千石则其全数必二千四百石矣此通分法非方程
　　设问之误辨
　　算家设问以为规式意虽引而不发数则实而可稽苟其稽之而无有真实可言之数则其意不能自明而何以为式乎至其立法之多违于古皆以不深知算理而臆见横生又相因而必至也故以设问为之目
　　今将同文算指所载井不知深例考定如后余如此者尚多不能一一为辨也【钱塘吴信民九章比类亦载是例非同文创立也盖方程之沿误久矣】
　　问井不知深以五等绳度之用甲绳二不及泉借乙绳一补之及泉用乙绳三则借丙一用丙绳四则借丁一用丁绳五则借戊一用戊绳六借甲一乃俱及泉其井深若干五等绳各若干
　　原法曰列五行以五绳之数为母借绳一为子先取甲二乗乙三得六以乗丙得二十四以乗丁得一百二十以乗戊得七百二十并入子一共七百二十一为井深积列位
　　一甲二　乙一　　○　　○　　　○　七百二十一二○　　乙三　　丙一　○　　　○　七百二十一三○　　○　　　丙四　丁一　　○　七百二十一四○　　○　　　○　　丁五　　戊一　七百二十一五甲一　○负一　○负一　○负一　戊六　七百二十一乃取五行为主而以一二三四俱与相乗
　　先以一行甲二遍乗五甲【甲一得二戊六得十二积七百二十一得一千四百四十二】
　　五行甲一亦遍乗一行对减【甲得二减尽乙得一因五行乙空立负一积七七百二十一本数以减五行仍余七百二十一】
　　次以二行乙三乗五行【乙负一得负三戊正十二得三十六积七百二十一得二千一百六十三】
　　五行乙负一亦乗二行【乙三得三对减尽丙一得一因五行丙空立负一积七百二十一得本数并入五行积共二千八百八十四】
　　再以三行丙四乗五行【丙负一得四戊正三十六得一百四十四积二千八百八十四得一万一千五百三十六】
　　五行丙负一亦乗三行【丙四得四减尽丁一得一因五行丁空立负一积得本数与五行对减余一万○八百一十五】
　　又以四行丁五乗五行【丁负一得五戊正一百四十四得七百二十积一万○八百一十五得五万四千○七十五】
　　五行丁负一亦乗四行【丁五得五减尽戊一得一并入五行戊正七百二十共七百二十一积得本数并入五行积五万四千○七十五共五万四千七百九十六】
　　乃以最后所得求之以积五万四千七百九十六为实戊七百二十一为法除之得戊绳七尺六寸以减四行总积【七百二十一】余六百四十五以丁五除之得丁绳一丈二尺九寸以减三行积【七百二十一后同】余五百九十二以丙四除之得丙绳一丈四尺八寸以减二行积余五百七十三以乙三除之得乙绳一丈九尺一寸以减一行积余五百三十以甲二除之得甲绳二丈六尺五寸
　　论曰此一例中有数误　一者以末行为主而以一二三四与之相乗此由不知和较交变而沿竒减偶加之失误一　一者谓末行有空故立负由不知有空径求而沿立负之非误二　一者以除法命为井深而设问不明言丈尺误三　又辄立母逓相乗加借子一之法误四　一例中误至数端将令学者何所措意乎
　　前之两误【谓以未行为主而竒减偶加反立负之法】业于梨诸例辨之綦详可以互见今特明后两误之非具如后论
　　凡言百十者皆虚位也其实数以单位为端故单位为寸则十者尺百者丈若单位为尺则十者丈百者十丈若单位为丈则十者十丈百者百丈七百二十一以为井深不知其所谓一者尺乎寸乎丈乎若七百二十一尺七百二十一寸七百二十一丈相去甚悬然其为七百二十一者不殊也先不明言尺寸虽得数何以命之
　　详观问意乃借井深以知各绳故井深者和数也在各行中皆所列诸绳之共数必先知此共数然后以乗减之法求之而各数乃见矣而不先言井深转借各绳以求之方程中无此法也故其所得但为七百二十一之虚率而不能防其为丈尺何等亦固然耳
　　七百二十一亦非井深定率何也倍七百二十一则一千四百四十二若三其七百二十一则二千一百六十三推之以至于无穷凡可以七百二十一除之而尽者皆可以五等绳相借而及泉也故使其井为一丈四尺四寸二分之深则戊绳必一尺五寸二分丁绳必二尺五寸八分丙绳必二尺九寸六分乙绳必三尺八寸二分甲绳必五尺三寸矣使其井为二十一丈六尺三寸之深则戊绳二丈二尺八寸丁绳三丈八尺七寸丙绳四丈四尺四寸乙绳五丈七尺三寸甲绳七丈九尺五寸矣皆甲二偕乙一若乙三则偕丙一若丙四则偕丁一若丁五则偕戊一若戊六则偕甲一而及泉故曰七百二十一非井深之定率也
　　七百二十一者除法也以此为法除井深乗并之数而得一绳因以知各绳即不得以此命为井深
　　除法法也井深实也而以法为实乎
　　以七百二十一为除法乃绳也如所求先得戊绳之数则此七百二十一者即是戊绳也其五万四千七百九十六者乃七百二十一戊绳之共数也以戊绳七百二十一为法除其共数而得七十六则是一戊绳之数也故七百二十一者绳也五万四千七百九十六者井深也【假如一井深七丈二尺一寸则七十六井共深五百四十七丈九尺六寸井无此深乗并而有也数犹戊绳之七百二十一亦以乗并而得也】而顾以绳之积为井深之积乎
　　假如井深一丈四尺四寸二分依法求之其为戊绳之共数必一百○九丈五尺九寸二分而其戊绳亦必七百二十一以七百二十一为法除一百○九丈五尺九寸二分得一尺五寸二分则一戊绳之数矣故曰七百二十一者非井深也乃除法也绳也绳之为除法者有定而其所除之井深无定也
　　又辄立母子乗并之法夫以各绳为母而借绳为子未大失也盖于三绳中取一即是三之一于四绳取一亦即四之一也乃谓七百二十一为母相乗而加借子则非也盖位既迭空除首位减去外皆母与相乗乗子与相乗而不相遇至第四次乃相遇而又适当其变为一和一较之时异名相并故得此数以为除法耳固不得立此以为通法也
　　假如问五色方程而各行不空则和较之变多端岂预知其减并即使各行有空如所列而或为较数则有减而无并亦将以借子加之乎
　　又所加之一乃子相乗之数若遇借子为之二之三则皆不能径用其原借之子数也故曰非通法也今试以井深一丈四尺四寸二分者举例如后
　　假如有井深一丈四尺四寸二分以甲乙丙丁戊五等绳汲之皆不及泉若甲借乙三之一乙借丙四之一丙借丁五之一丁借戊六之一戊借甲二之一皆及泉问绳各长若干
　　法以带分和数列位
　　上上　上下　中上　中下　下上　　下下






　　依空位省算先以一行与五行对乗　甲减尽　乙一戊十二皆无对不减　和数余一丈四尺四寸二分　乙在首行　戊与一丈四尺四寸二分在五行分正负列之　和变较也　余行无甲绳不湏减
　　径以减余与次行相对


　　依和较相襍法互乗　乙绳同减尽　丙一【左正】戊三十六【右负】皆无减　和较数异并五丈七尺六寸八分【右负左正】　复变和数不分正负【隔行异名并故也】



　　依和数乗　丙绳减尽　丁绳一【左】戊绳一百四十四【右】皆无减　和数减余二十一丈六尺三寸【右】又复变和数也分正负列之
　　余行又无丙绳径以减余与第四行相对
　　上　　　　　中　　　　下


　　依和较相襍乗　丁同减尽　戊异并七百二十一为法　和较数异并一百○九丈五尺九寸二分为实　法除实得一尺五寸二分为戊绳六之一　以减共一丈四尺四寸二分得一丈二尺九寸为丁绳五除丁绳得二尺五寸八分为丁绳五之一　以
　　减共一丈四尺四寸二分余一丈一尺八寸四分为丙绳　四除丙绳得二尺九寸六分为丙绳四之一以减共一丈四尺四寸二分余一丈一尺四寸六
　　分为乙绳　三除之得三尺八寸二分为乙绳三之一　以减共一丈四尺四寸二分得一丈○六寸为甲绳　二除之得五尺三寸爲甲绳二之一　以减共一丈四尺四寸二分得九尺一寸二分爲戊绳
　　计开





　　论曰此亦七百二十一为除法也减并之用与前无异而井深既别绳数迥殊不先言丈尺何以定之试又以较数明之
　　今有数不知总其五人所分亦不知各数但云取乙三之一以当甲取丙四之一以当乙取丁五之一以当丙取戊六之一以当丁取甲二之一以当戊皆不足七百一十九问若干
　　畣曰甲一千○三十四　乙九百四十五　丙九百○四　丁九百二十五　戊一千二百三十六
　　法以较数列位
　　依带分法化整爲零





　　如法乗　甲同减尽　乙一【左负】戊十二【右负】皆无减同名在隔行仍分正负　较数异并与戊同名　余行无甲径以减余对第三行


　　如法乗　乙同减尽　丙一【左负】戊三十六【右负】皆无减以隔行同名分正负　较数异并与戊同名　余
　　行无乙径以减余对第四行


　　如法乗　丙同减尽　丁一【左负】戊一百四十四【右负】皆无减　以隔行同名分正负　较数异并仍与戊同名　余行无丙径以减余对末行


　　如法乗　丁同减尽　戊同减余七百一十九为法较数异并一十四万八千一百一十四为实　法
　　除实得二百○五为戊之一分加正七百一十九共九百二十五为丁数　五除丁数得一百八十五为丁之一分加正七百一十九共九百○四为丙数四除丙数得二百二十六为丙之一分加正七百一十九共九百四十五为乙数　三除乙数得三百一十五为乙之一分加正七百一十九共一千○三十四为甲数　二除甲数得五百一十七加负七百一十九共一千二百三十六为戊数　六除戊数仍得二百○六为戊之一分
　　计开





　　论曰此其母与母相乗子与子相乗与前略同但末后相遇为同减故不以七百二十一为法而以七百一十九为法无他较数也若依母相乗而并子岂不误哉
　　且四次乗减其下较皆异倂亦足见竒减偶并之非又以法同而得数迥异者明之
　　今有数五宗不知其总但云以乙三之一当甲以丙四之一当乙以丁五之一当丙以戊六之一当丁皆适足若以甲二之一偕戊则共数七百二十一问各若干
　　法以和较带分列位　化整为零





　　甲同减尽　乙一【左负】戊一十二【右正】皆无减　一千四百四十一亦无减　隔行异名即同名也变为和数重列之与次行对


　　乙同减尽　丙一【左负】戊三十六【右正】四千三百二十六【右正】皆无减　皆隔行异名亦变和数重列与第三行对


　　丙同减尽　丁一【左负】戊三十六【右正】一万七千三百○四【右正】皆无减隔行异名仍变和数重列与第四行对


　　丁同减尽　戊异并七百二十一为法　八万六千五百二十无减就为实　法除实得一百二十为戊六之一即丁数　五除之得二十四为丁五之一即丙数　四除之得六为丙四之一即乙数　三除之得二为乙三之一即甲数　半之得一为甲二之一以减共七百二十一余七百二十为戊数
　　计开
　　甲二　乙六　丙二十四　丁一百二十　戊七百二十论曰此亦以七百二十一为法而其各数迥不相类则以下数之为和为较迥不相同也然则井深者即和数也而不先言其丈尺顾以除法命之可乎
　　又试以分子逓借而非之一者明之
　　今有甲乙丙丁船各十只以载盐九千七百七十六引俱不足若甲借乙一乙借丙二丙借丁三丁借甲四则各能载问各船若干
　　法以和数列位
　　列后




　　甲减尽　乙四【右】丁一百【左】皆无减　以两行故分正负　载盐余五万九千八百五十六【左】与丁同名甲空与减余对次行


　　乙同减尽　丙八【左正】丁一千【右负】俱无减　引异并六十三万八千四百六十四【右负左正】异名在隔行复变和数无正负　乙空以减余对三行


　　丙减尽　丁余九千九百七十六为法　引余六百三十万○四千八百三十二为实　法除实得六百三十二引为丁船数　以丙借丁船三乗丁数得一千八百九十六以减共九千九百七十六引余八千○八十丙所载也以丙十除之得八百○八引为丙船数　以乙借丙船二乗丙数得一千六百一十六以减共九千九百七十六引余八千三百六十乙所载也以乙十除之得八百三十六引为乙船数以乙船数减共九千九百七十六余九千一百四十甲所载也以甲十除之得九百一十四引为甲船数计开各船每只载数
　　甲船九百一十四引
　　乙船八百三十六引
　　丙船八百○八引
　　丁船六百三十二引
　　论曰此四色方程逓借法与诸书所载马骡载米同亦与同文算指井不知深同但彼误以除法为井深又误立各母逓乗加借子法故设此问以显其理
　　此所用除法丁船九千九百七十六犹彼所用除法戊绳七百二十一也乃除法也非井深也除法有定而井深无定即如此问九千九百七十六之除法有定而盐之数无定也何言乎无定假如以九千九百七十六引而倍之则各船之所载亦倍矣以引数半之船所载亦半矣然其除法之九千九百七十六如故也若不先言引数何知之
　　共载九千九百七十六引者盐数也以九千九百七十六为法而除者船数也船为法者算家虚立之率盐列位者问者现据之实数数虽偶同为用逈别
　　以各原数为母借数为子是也如甲借乙船一而乙船原有十即十分之一也谓母相乗而加借子一则非法也如此所用除法九千九百七十六何以处之又如后条马歩舟师各借二分者又何以处之数虽似不可施之他数非通法矣
　　又试以三色例亦用异加得除法者观之
　　假如有马歩舟师不知数但云取骑兵五分之二益歩取歩卒三分之二益舟取舟师七分之二益骑则皆得六千七百八十名
　　畣曰歩卒四千五百名　骑兵五千七百名
　　舟师三千七百八十名
　　法以和数带分列位



　　依省笇以左行加二分之一　步卒减尽　骑二分【右】舟师十分○半【左】皆无减　共数减余三千三百九十【左】分余两行变较数也　以较数与舟师同名中行步卒原空径以减余作二色列之


　　依省算四因左行而退位　骑同减尽　舟师异并十一分三厘为法　和较数异并六千一百○二为实　法除实得五百四十为舟师之一分　以分母七乗之得三千七百八十名为舟师数
　　以舟师数减共数六千七百八十余三千所借步卒之二分也　二除之分母三乗之得四千五百为歩卒数
　　以歩卒数减共数六千七百八十余二千二百八十所借骑兵之二分也　二除之分母五乗之得五千七百名为骑兵数
　　论曰此虽以异加而得除法然不得竟以子之二加也故以分子一加者非通法也








　　厯算全书卷四十三
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书卷四十四
　　宣城梅文鼎撰
　　方程论卷五
　　测量
　　测量非方程事也方程者算术算术恃计测量恃目实惟两途测量之不能兼算术犹算术之不能兼测量虽曰能兼非其粹矣今略具其所兼其不能兼者有句股诸法在
　　测量在方程有二
　　一曰隂云测量
　　隂云者不见宿度而云影微薄之处犹能见五纬若见二星则有其相距之度而可以方程取之矣
　　一曰宿度测量
　　宿度者虽无隂翳而无仪器故借宿距一定之度以取之必有二星同见或星与太隂同见则成方程之算矣
　　隂云测法
　　假如隂云不见宿次但于云隙测得辰星在太白后一度又二日荧惑与二星同在一度又二日太白在荧惑前三度而辰星云翳又一日辰星在房初度余不可见又十二日荧惑始至房初问各行率若干畣曰辰星每日行二度　太白每日行一度有半荧惑每日行半度
　　解曰此辰星行二日太白亦二日而辰星多一度荧惑与太白同行三日而太白多三度　辰星行四日荧惑十六日而行度相当也
　　法曰以较数列位



　　依省算以左行半之与右相减辰星同减尽太白二日【右负】荧惑八日【左负】皆无减分正负【同名在隔行即异名也】正　一度亦无减【与荧惑同名】
　　重列减余与中行


　　依省算以左行减三之一乃对减　太白同减尽荧惑同减余六日为法　行度异并三度为实　法除实得半度为荧惑每日行率　以右减余八日乗之得四度同减负一度余三度以太白二日除之得一度半为太白日行率　以右行太白二日行三度异加正一度共四度以辰星二日除之得二度为辰星每日行率
　　假如测得辰星在金星后二度隂云不知宿次但于四日后见二星同行在一度亦未知宿次又三日辰星行至房初度而金星云翳至第四日金星亦至房初而水星未见问两星每日行率若干
　　解曰此两星各行四日而辰星多二度　辰星行三日金星行四日而其度相当
　　法以较数列位


　　二色者有一色偶同依省算径以对减　金星同减尽　辰星同减余一日为法　正二度无减为实法一省除径以二度为辰星每日行率　以辰星三日行六度金星四日除之得每日行一度半
　　若欲知前两测某宿度者以金星四日行六度为二星同度距房初之数　又加金星同行四日六度共十二度为前测金星距房之度　又加辰星在金星后二度为辰星前测距房之度　各以距度与房初度相求得前两测星躔宿度
　　如顺行者前所测之宿在房后也氐宿亢宿也各置距度以氐宿亢宿度迭减之不尽者以转减前宿之度得星所在宿度　如逆行者前所测之度在房前也心宿尾宿也各置距度以房度心度逓减之减不及者即命为后宿星所在之度
　　假如甲子日金星夕见乙丑日水星夕见至丁卯日水星行及金星但不及半度至戊辰日二星同度皆以阴晦不能细知宿次问各率若干
　　解曰此金星行四日水星三日相当
　　金星行三日水星二日则水星不及半度
　　法以较数列位


　　依省算左行二分加一　水同减尽　金同减余半日为法空度七分半为实　法除实得金星日行一度半　金三日行四度半同减负半度余四度以水星二日除之得日行二度
　　假如广福二船哨海福船先发行五日广船行三日遇于中途其泛地相距二千五百里遂又同往一岛广船行四日先至候六日福船始至问各船每日行率解曰此广船疾福船迟也　广船三日福船五日共行水面二千五百里　广船四日福船十日而水程相当
　　畣曰广船日行五百里
　　福船日行二百里
　　法以一和一较列位


　　如法遍乗　广船同减尽　福船异并五十日为法正一万里无减为实　法除实得二百里为福船
　　毎日行率　福船十日行二千里以广船四日除之得五百里为广船每日行率
　　又如自东徂西共二千里先乗车行五日换舟行八日至其国其舟与车复同往一处车先行六日舟乃发行四日逐及问舟车行率
　　畣曰舟每日二百里　车每日八十里
　　解曰舟疾车迟　舟八日车五日共行二千里　舟四日车十日行适相当


　　依省算半右行数　舟同减尽　车异并十二日半为法　正一千里无减为实　法除实得八十里为车率　以舟四日除车十日所行八百里得二百里为舟行率
　　假如甲乙二船哨海同泊一山同用正卯酉字风东行但甲船先发解防七日乙船后行解防五日追及于一岛又自此岛用正子午字风南行但甲又先发解防九日泊于南洋乙后发解防七日泊于又南洋其二洋相距二百里问道里各数
　　法以较数列位


　　甲船同减尽　乙船余四日为法　负一千四百里为实　法除实得三百五十里为乙船每日率　以甲船七日除乙船五日所行一千七百五十里得二百五十里为甲船率　其一千七百五十里即山岛相去之程　以甲船九日行二千二百五十里为岛去南洋之程　又加二百里为又南洋之程合问计开
　　甲船每日行二百五十里
　　乙船毎日行三百五十里
　　山岛之距一千七百五十里
　　岛距南洋二千二百五十里
　　距又南洋二千四百五十里
　　自山至又南洋共水程四千二百里
　　又假如二人同往西番公干一人车一人骑车自某山西行九日骑自某河西行十日及之于一城其河在山之东相距三百里又自此城西行八日骑先至一国驻劄候一日车至问道里各如干
　　法以较数列位


　　如法径减　余骑二日为法　三百里为实　法除实得一百五十里为骑行率　并骑前后共十八日行二千七百里为所驻西国距河之程骑所行也减河距山三百里余二千四百里为西国距山之程车所行也　并前后车行十八日除之得一百三十三里又三分里之一【即一百二十步也】为车行每日里率用车行里率乗九日得一千二百为城距山之程以减总距余亦一千二百里为西国距城之程计开
　　骑日行一百五十里　前后共行二千七百里车日行一百三十三里又三分里之一　前后共行一千四百里
　　城距山一千二百里　距河一千五百里
　　国距城一千二百里　距山二千四百里　距河二千七百里
　　此上数则近事易知用明测量之理
　　宿度测法
　　凡测量之法有测器又有水漏则虽阴云可以所见者得其度若但有测器而无水漏可以所见两星之距度取之如前所列隂云不知宿度之法是也乃又无测器而但据目见则当以宿度取之盖宿有一定之度借以为两星之和度较度因所知以求不知此则方程之法可为测量者助也至于诸星行率古今厯术不同学者通其意无拘其数焉其可
　　若一星单行非仪器比量莫知其迟疾之度然晴雨难期则亦有因所见以测所不见之时故算术不可废也
　　五星错行多有相遇则和度较度可施若太隂毎月经行廿八宿一次与五星相遇亦每月有之精于推步者虽非假此定星然用与厯术相参有不借仪器而知迟疾使看者引騐见効亦算家之乐也
　　其五星各有迟疾留逆故测量比例当于相近日数内求之则所差亦不多也
　　其迟疾变行湏查七政厯以约其日则一星单行亦自可考其进退之数
　　两星相较例
　　假如两宿原有定距【如房距心】若干度有一纬星在其间【如金在房心间】以旁星记之越若干日纬星行至东宿【如心】又别一纬星【如火星】在西宿【如房】越若干日行至先所记旁星之处
　　此因无仪细测故借宿度用之如上所举乃以宿距为二星和度也一纬星若干日【如金】一纬星若干日【如火】共行天若干度【如房度】故曰和度
　　又如以一宿为主【如心】有纬星在其西【如木】以旁星记之越若干日纬星行过宿东至后一宿【如尾】又或异日别一纬星【如土】亦在前记纬星处所越若干日行至所借为主之宿【如心】
　　此则以宿距为二星较度也一纬星若干日【如木】一纬星若干日【如土】相差若干度也【如心度】故曰较度
　　凡此皆可以方程御之
　　若得两较度或两和度或一和一较即二色方程术也若三星四星以上各得三两宗测数以三色四色等方程求之无不可见
　　如木星在一宿之西【如井鬼之间】越若干日行至其宿【如鬼】火星原在木星之西越若干日行至木星原处金星又在火星之西而恰当西宿【如井】越若干日行至火星原处又若干日亦至木星原处
　　此亦借宿度为用而中有二和一较如云金星若干日火星若干日木星若干日共行若干度也【如井度】　又金星若干日木星若干日共行若干【亦用井度】　此二者和度也　又金星若干日火星若干日而其行适等【用火星至木星元处之日及金星自火星元处至木星元处之日】此则较度也【适足即较数也度无较其日则有较】
　　又如火星在房宿之西越若干日行过房抵心宿而木星自火星元处越若干日至房宿又有金星或先或后亦自火星元处越若干日行至房又若干日逐及木星于房心之间
　　此以宿距为较度者三　如云以火星若干日较木星若干日而火星之行多一房度也　以火星若干日较金星若干日而火星亦多一房度　以金星若干日较木星若干日而行度相等【用两星逐及于房心之间日数】
　　此上二则以三色取之　凡所测不必两星同在一度但欲有旁星可记异日有他星复至所记旁星之处即成同度之算右皆顺行星例
　　又如一星顺行自房行几日一星逆行自心行几日相遇同度于房心间自此分行又几日其逆行星至氐此用一较度一和度也顺行星几日逆行星几日共行房宿度此为和度　顺行星几日逆行星几日而逆行星多一氐宿度此为较度【用逆行星相遇后至氐宿之日数】
　　又如一星自建星顺行至几日遇逆行星又几日至牛宿其逆行星自相遇处行几日至建星又几日至斗宿距星
　　此亦一和一较　顺行星几日逆行星几日而行度相当【用二星两相遇处至建星之日数】此较度也　顺行星几日逆行星几日而共行斗宿度【用两相遇后顺行星至牛逆行星至斗之日数】此和度也
　　右逆行星例
　　问金火二星在房宿之西同度越九日金星行过房东至一处有星可记又一日金星行至心宿又八日火星始至房又九日火星始至前所记金星之处其二星行度各若干
　　解曰此金星行九日火星廿七日而行度相等金星行十日火星十八日而金星多六度【房宿六度故也】
　　法以较数列位


　　依省算以右行加九之一　乃对减　余火星一十二日为法　六度无减为实　法除实得半度为火星率　以金九日除火廿七日行十三度半得一度有半为金星率
　　假如太隂自尾宿初度行三日遇木星于斗牛间又三十日木星行至牛
　　此太隂三日木星三十日共行四十五度【借尾至牛之度约略其数后仿此】
　　木星自牛初行三十日与罗防遇于牛女间又一百二十日罗防退至牛
　　此木星行三十日罗防一百二十日而度等【罗防计都月孛有数无形借逆行之用】
　　罗防自牛初退行一百日遇土星于箕斗间又五十日土星行至牛
　　此罗防一百日土星五十日行度等
　　土星自牛初行三十日火星逐及遇于牛女间又三十日火星行至虚此土星三十日水星三十日而共行十八度
　　火星自虚初行五十日水星逐及遇于危室间又十日水星行至奎
　　此火星行五十日水星十日共行四十五度
　　水星自奎初行十五日逐及金星遇于昴毕间又十七日金星行至毕
　　此水星十五日金星十七日共行五十五度半
　　金星自毕初行二十日遇计都于井鬼间又四十日计都退至井此金星二十日计都四十日而金星多二十八日【借毕至井之距为两星之较】
　　计都自井初逆行二十日遇月孛于参井间又十日月孛行至井
　　此计都二十日月孛十日而行度等
　　月孛自井初行八十日太阴逐及遇于井鬼间又二日太阴行至栁
　　此月孛八十日太隂二日共行三十四度
　　问各行率若干【凡此所设不必其同日在一度谓之相遇但与宿值或有星可记即如同度之理】如法列位【九色和较之杂】









　　因九色行中挤廹既多空位取出其行次相对者列而先乗此捷法也
　　先以甲壬太隂对减【两行相对只三色余俱两空省不书俟重列时以次添入】


　　用省算法以甲行三之一壬行二之一列之【因甲行可三除壬行可二除而除之则太隂皆一日故除而列之】径对减太隂尽　余木星十日【右】月孛四十日【左】减余二度【左】分正负太隂减去寻原列中乙行有木星径与减余对列


　　用前法以左乙行三之一与减余列之　木星径同减　罗四十日【左负】孛四十日【右负】负二度【右负】皆无减【以隔行同名仍分正负】
　　木星减尽寻丙行有罗防径与减余重列


　　用前法以减余二之一丙行五之一列之　罗防同名径减　余三位无减　以隔行皆负分正负而孛与较同名
　　罗防减尽寻丁行有土星径对余数
　　和较列位


　　用前法以丁行三之一列之而命之为正　土同减尽　余无减　度异并七度　皆左正右负复变和数土星减去寻戊行有火星径对余数


　　用前法以戊行五之一列之　火径减　水　　　　　　　　　　　　　　　　　　　　　　【左】孛【右】
　　无减分正负复为较　余二度　　　　　　　　　　　　　　　　　【左】与水星同名火星减尽寻已行有水星以对余数【又因巳行不便省算改用辛行月孛相对】


　　用前法以减余半而列之　孛同减　余俱无减隔行同名仍为较
　　月孛减尽寻庚行有计都以对余数【水与较度皆右行负同名】


　　用前法以庚行半而列之
　　计同减　水【右负】金【左负】无减仍为较
　　余十三度【左负】与金同名
　　计都减尽寻巳行恰皆二色以相对


　　如法乗　水同减尽　金余异倂一百六十七日为法　度异并二百五十○半度为实　法除实得每日一度半为金星率
　　以巳行金星十七日行二十五度半减共五十五度半余三十度以水星十五日除之得每日二度为水星率
　　以戊行水星十日行二十度减共四十五度余二十五度以火星五十日除之得毎日半度为火星率
　　以丁行火星三十日行十五度减共十八度余三度以土星三十日除之得每日十分度之一为土星率
　　以丙行土星五十日行五度以罗防一百日除之得每日二十分度之一为罗防率
　　以乙行罗防一百二十日行六度以木星三十日除之得每日五分度之一为木星率
　　以甲行木星三十日行六度以减共四十五度余三十九度以太隂三日除之得每日十三度为太阴率
　　再以庚行金星二十日行三十度同减去正二十八度余二度以计都四十日除之得每日二十分度之一为计都率【与罗防同】
　　以辛行计都二十日行一度以月孛十日除之得每日十分度之一为月孛率
　　以壬行月孛八十日行八度减共三十四度余二十六度太阴二日除之仍得毎日十三度为太阴率
　　论曰各星迟疾留逆每叚不同然其各叚中行率大约相等故可以方程立算亦湏稍查时厯以知其变
　　若太近留叚行率甚微难见其在合伏左右行甚疾毎日不同难与他星相较则以一星迟疾之较取之具如后例
　　一星迟疾相较例
　　凡木火土三星虽有迟疾之行大约皆在一度以下而土木之变尤缓其数十日中行率仅差秒忽两星相较之法颇可施用惟金水二星迟疾之差悬逺其疾也有在一度以上而水星有二度其迟也不及一度迟之甚则留故可以其迟疾而自相较也
　　假如金星疾叚测得甲乙丙三日共行四度二十九分己庚两日共行二度有半问各日行率【此因前测以隂云用仪得其度分而不知宿次故虽后测能知宿次而中数日不可知是惟方程能御之也】
　　法以和数列所测以较数列中日【因挨日进退故倍中日为前后两日而命之适足盖已知测日同在一叚故也】







　　如法互乗逓减　余庚廿七日为法　三十三度廿一分为实　法除实得一度廿三分为末日行率【庚】以庚日行率减共二度五十分余一度廿七分为第六日行率【己】　倍己日行率减去庚日行率余一度三十一分为第五日行率【戊】　倍戊日行率减去己日行率余一度三十五分为第四日行率【丁】　倍丁日行率减去戊日行率余一度三十九分为第三日行率【丙】　倍丙日行率减去丁日行率余一度四十三分为次日行率【乙】　倍乙日行率减去丙日行率余一度四十七分为初日行率【甲】
　　累计甲乙丙日共四度廿九分己庚日共二度半合问或倍庚日行率共二度四十六分以减共二度半余○度○四分为日差以日差累加庚日得各日行率
　　总论曰凡步五星既得其叚日以为日率则以其盈缩之厯加减星行而得其叚所行之宿次以为度率以日率除度率而得其平行则又以初末日率相求使之陞降有等以为日差而加减之故日差者步五星之要事也
　　右例不拘日数但在迟疾本叚则可用此法
　　亦不拘定是宿次所见或仪器所测但有两宗宿度则其余日皆可倍中日以较其前后两日命为正负适足而求之何则其加减皆相挨而有序故知倍中日即同前后两日也
　　假如金星晨疾测得甲日之寅距地平一度至丙日之卯距地平三十度○七十五分至己日之卯距地平三十度问各日行率
　　解曰此是甲乙两日共行二度二十五分丙丁戊三日共行三度七十五分也
　　法以丙日距三十度○七十五分减寅至卯差三十度余○度七十五分与甲日距一度相减余○度二十五分为金星疾行过平行一度之数加甲乙两日太阳行二度是为两日内金星行二度二十五分又以己日距三十度与丙日距度相减余○度七十五分为金星疾于平行之度加丙丁戊三日太阳行三度是为三日金星行三度七十五分
　　论曰此因隂云不能细测每日之度故五日中仅有三测也或虽无隂云而仪器不具惟此三日有所当宿次可借以为行度之据则所得者皆为前两日后三日之和度也
　　如法以两和三较列位【因逓差补作三适足而列之】





　　如法乗减　得丁三日为法　共三度七十五分为实　法除实得一度二十五分为丁日行率【此因末两行减余三色减去二色只一法一实故径用以求也】
　　以丁减余七日行八度七十五分同减负二度二十五分余六度五十分以戊减余五日除之得一度三十分为戊日行率【此用三四两行减余】
　　以丁戊两日行率相减余○度○五分为日差以日差减丁日行率得丙日行率累减之得甲乙日行率
　　计开
　　甲日行一度十分
　　乙日行一度十五分
　　两日共行二度二十五分
　　丙日行一度二十分
　　丁日行一度二十五分
　　戊日行一度三十分
　　三日共行三度七十五分　合计之五日共行六度　此六度者乃金星行于黄道之度寔数也寔数者以宿度徴之如甲日之晨在某宿某度至己日之晨已进六度也　其距太阳之数则五日共差一度　此一度者乃金星渐近太阳之距亦即渐近于地平之距也目所见也谓之视差则以仪器度而知之如甲日之卯距地平三十一度至己日之晨卯刻则距地平三十度为较前相近一度也　今所测为甲日之寅寅与卯相差三十度故寅之星距地平一度者至卯则距三十一度也其时刻以水漏或中星得之　若寅正与卯初则只差十五度每刻则差三度太此以仪测星者所当知
　　论曰凡加减日差湏明进退之理如戊日之行率多于丁日则其疾为进也而先得末日则以日差累减之而得初日
　　若先得初日则当以日差累加之而得末日
　　如前一例庚日之率少于己日则其疾为退也而先得庚日则以日差累加之而得初日　若先得甲日则当以日差减之而得末日
　　其迟叚则皆反之　如末日多于初日其迟为退也则减末加初
　　若初日多于末日其迟为进也则减初加末
　　论曰凡七政盈缩古今厯术綦详所设立差平差之术尤宻至于太隂迟疾时刻逈异授时立法以三百三十六限更非逓加挨减所能定惟五星既得叚日定星其日差可以循次加减而方程测量之法可施也
　　又方程测量为草泽不能具仪器而偶有所见设此御之使独见者可以共晓若从事推步则有厯学诸书幸勿以管窥为诮



　　厯算全书卷四十四
　　钦定四库全书
　　厯算全书卷四十五
　　宣城梅文鼎撰
　　方程论卷六
　　方程御襍法
　　算术之有方程犹量法之有句股必深知诸算术而后能言方程犹之必深知诸量法而后能治句股故以是终
　　诸方田少广凡属量法者往往有可以句股立算而诸法不能治句股方程之于粟布差分也亦然故襍法不能御方程而方程能御襍法
　　例如后
　　假如有粮一万九千石与甲乙丙三县各以其人戸多少米价贵贱僦值逺近舟车险易而均输之　甲县戸三万米价毎石一两四钱逺输二百里用车载二十石行一里僦值一钱三分　乙县戸二万米价一两二钱逺输五百里用舟载二十五石行一里僦值三分　丙县戸一万米价一两二钱逺输二百里道险可用负担每负六斗行五十里顾值一钱八分
　　法曰各以其县米价并僦值之数命其户以方程较数列之　以甲县车载二十石除其僦值一钱三分得六厘五毫【每载一石行一里数也】以乗二百里得一两三钱并米价一两四钱共二两七钱　以乙县舟运二十五石除其僦值三分得一厘二毫以乗五百里得六钱倂米价一两二钱共一两八钱
　　以丙县负担六斗除其顾值一钱八分以乗一石得三钱又以五十里除之二百里乗之得一两二钱并米价共二两四钱
　　原法以各县米价并僦值之数以除其戸为衰列而并之并衰为法各衰乗总米为实法除实得各县米今用方程则不湏尔竟以二两七钱命甲县之衰为二十七戸以一两八钱命乙县之衰为一十八户以二两四钱命丙县之衰为二十四户以三县衰命为适足而列之




　　如三色有空法乗　余丙县异倂一百一十四戸为法　正三十四石二斗为实　法除实得丙县每戸粮三斗　以丙一戸三斗减共一石九斗余一石六斗乙县四戸除之得每戸粮四斗
　　以乙二戸八斗甲县三戸除之得每戸二斗又三分斗之二各以每户率乗其县之戸总得各县转
　　计开
　　甲县三万户　共粮八千石　共僦车值一万○四百两毎户粮二斗六升六合又三之二　每三户粮八斗每戸僦值三钱四分又三之二　每三户僦值一两○四分总计米价与其僦值每戸共银七钱二分
　　乙县二万户　共粮八十石　其僦船值四千八百两每户粮四斗　僦值二钱四分
　　总计米价僦值每户亦七钱二分
　　丙县一万户　共粮三千石　共顾担夫银三千六百两毎户粮三斗　僦值三钱六分
　　总计米价僦值每户亦七钱二分
　　以米言之



　　论曰此因米价不等加以僦值不同故以法均之粮虽不均而每户所出之银数则均若但均其米乃不均矣是故均之以不均斯谓能均
　　问官米二百六十五石令三等人户出之甲上等二十户每户多中等七斗乙中等五十戸每戸多下等五斗丙下等一百一十戸其则例各若干
　　法以和较列位【依省算以和数十之一列之】




　　如法乗减　得丙戸十八为法　二十一石六斗为实　法除实得一石二斗为下等每戸则例　加正五斗为中等则　又加七斗为上等则
　　计开
　　甲上等毎戸二石四斗　二十戸共四十八石
　　乙中等毎戸一石七斗　五十戸共八十五石
　　丙下等每戸一石二斗　一百一十戸共一百三十二石合计之共二百六十五石
　　问有米六百七十四石以四等里甲输纳乙为甲十之八丙为乙十之七丁为丙十之六其甲乙各八十戸丙丁各七十户问各若干
　　解曰十之八卽非二八差分十之七十之六卽非三七四六差分故与带分条所设不同合而观之可也
　　法以和较列位




　　如法乗减而重列其余与三行对


　　又以余数与四行平列
　　数益多用省算法四除减余然后列之


　　如法乗减余丁六百七十四爲法　五万六千六百一十六石无减爲实　法除实得八十四石爲丁共数　十因丁数六除之爲丙共数　十因丙数七除之爲乙共数　十因乙数八除之爲甲共数
　　计开
　　甲共数二百五十石以八十户除之得毎户三石一斗二升五合　乙共数二百石爲甲十之八以八十户除之得毎户二石五斗　丙共数一百四十石爲乙十之七以七十戸除之得每户二石　丁共数八十四石爲丙十之六以七十户除之得每户一石二斗总计之共六百七十四石
　　论曰此所问是总数相差非毎户相差也故原列者总户而得亦总户之米若云问毎户之差则当以毎户列之而所得者亦毎户米也如后例
　　假如共米六百七十四石以四色人户出之甲八十户乙亦八十户乙毎户如甲十之八丙丁各七十户丙毎户如乙十之七丁毎户如丙十之六
　　问各户则例
　　法以戸细数列位




　　依省算以首行退位十而一与次行对减而重列之又半其减余然后列之与三行对


　　又列减余以对末行


　　如法乗减异并一千二百九十二为法　一千四百一十五石四斗无减为实　法除实得一石○九升又三百二十三之一百七十八为丁毎戸则例【法实皆四约之】
　　十因丁则六除之得一石八斗二升又三百二十三之一百八十九为丙每户则例
　　十因丙则七除之得二石六斗○又三百二十三之二百七十为乙每户则例
　　十因乙则八除之得三石二斗六升又三百二十三之十四半为甲每戸则例
　　计开
　　甲每户三石二斗六升又三百二十三之十四半八十户共二百六十石○八斗三升又三百二十三之一百九十一
　　乙每户二石六斗○又三百二十三之二百七十　为甲每户十之八
　　八十户共二百○八石六斗六升又三百二十三之二百八十二
　　丙每户一石八斗二升又三百二十三之一百八十九
　　为乙每户十之七
　　七十戸共一百二十七石八斗　○　又三百二十三之三百一十
　　丁每户一石○九升又三百二十三之一百七十八为丙每户十之六
　　七十户共七十六石六斗八升又三百二十三之一百八十六
　　合计共六百七十四石【凡六百七十三石九斗七升又九百六十九分以三百二十三収之为升得此数】
　　问有均分两银庚以其五之二与甲则甲之数多于庚一百六十八两若以甲二十一之九与庚则庚之数多于甲一百八十两原数几何
　　法以所用益彼之分与此所存之余分相减而列之【庚与甲五之二庚自存五之三】相减余五之一【是为以庚五之一较甲全分而甲多一百六十八两也】
　　【甲与庚廿一之九　甲自存廿一之十二】相减余二十一之三【是为以甲二十一之三较庚全分而庚多】【一百八十两也】
　　庚虽自存五之三而甲股内有庚所与之二故以相减而余之一分与甲相较
　　甲虽自存二十一之一十二而庚股内有甲所与之九故以相减而余之三分与庚相较


　　甲一百○二分为法除实一千○二十两得十两为甲之一分　二十一分共二百一十两　减负一百六十八两余四十二两爲庚之一分　五分亦共二百一十两
　　计开
　　【庚甲】各原银二百一十两【庚五之二计八十四两其五之三仍一百二十六两　甲二十一之九计九十两其二十一之十二仍一百二十两】
　　庚以八十四与甲【甲共有二百九十四庚仍余一百二十六】相较甲多一百六十八
　　甲以九十与庚【庚共有三百　　甲仍余一百二十】相较庚多一百八十此设问之意也
　　以【庚之一分四十二甲全分二百一十】相较甲亦多一百六十八
　　以【甲之三分计三十庚全分二百一十】相较庚亦多一百八十
　　此列位之理也
　　论曰右例以此之分益彼而转与此之余分相较与帯分条所设不同　带分条此之分较彼全分其全分即是原数　今则一损一增以相较非原数也故曰不同
　　及其相减而列为较数也则亦是此之分较彼原数矣是之谓尾同而首异
　　相减列位亦有变为和数者如后所设
　　问有两银庚以其五之三与甲则甲之数多于庚二百五十二两若以甲廿一之十三与庚则庚之数多于甲二百六十两
　　法亦以所与彼之分与其余分相减列之
　　庚【与甲五之三自存五之二】相减余五之一【此为所用之分多于存分是变和数也庚五之一偕甲全分共二百五十二两也】
　　甲【与庚二十一之十三自存二十一之八】相减余二十一之五【此亦用分多存分少是变和数也　甲二十一之五偕庚全分共二百六十两也】
　　甲所以多如许者不惟其全数之故其所得于庚之分又多于庚之余分者一也故甲所多之数乃是甲全数偕庚之一分所共也
　　庚所以多如许者亦不惟其全数之故其所得甲之分又多于甲之存分者五也故庚所多数亦是庚全数偕甲之五分所共也


　　甲一百分为法除实一千而得十两为一分　以甲五分计五十两减共二百六十两余二百一十两为庚原银　五除之得四十二两为一分　以减共二百五十二两亦得二百一十两为甲原银
　　庚五之三计一百二十六两以加甲银共三百三十六两　内减去庚自存五之二计八十四两　仍多二百五十二两　即是甲全数偕庚一分之数也
　　甲二十一之十三计一百三十两以加庚银共三百四十两　内减去甲自存二十一之八计八十两　仍多二百六十两即是庚全数偕甲五分之数也
　　论曰右例以此之分偕彼全分而为和数亦与带分和数同然以相减而得之亦是尾同首异　带分条和数较数据问而分　今则设问只是较数相减列位乃有和较之分
　　依例推之亦有变为一和一较者皆以所用之分与所存分相减而得之　列位时巳变不待其重列减余也故又与寻常较变和者异
　　总论曰此二条者皆一损一益例也
　　问金九锭银十一锭其重适等若交易其一则银多十三两其原重若干
　　法以相差十三两半之得六两五钱为一锭之较解曰交易一锭而差是一多一少故半之为一锭之较　银得较而增重故与金同名


　　银二锭除实得银每锭重二十九两二钱半　加正六两五钱得金每锭三十五两七钱半
　　计开
　　金每锭三十五两七钱五分　金九锭【得三百二十一两七钱五分】银每锭二十九两二钱五分　银十一锭【亦得三百二十一两七钱五分】金八锭二百八十六两加银一锭共三百一十五两二钱半
　　银十锭二百九十二两半加金一锭共三百二十八两二钱半
　　共多一十三两　若交易二锭而差二十六两则以二锭倍作四锭除之亦得六两五钱为一锭之较余可类推【或半相差二十六两为一十三两命为金二锭银二锭之较尤为平穏】
　　论曰此条旧列差分同文算指改立借衰互徴之法皆不知宜入方程也
　　凡以两家之数相交易而差若干皆半其所差而列之为所交易之较何也一增一减而差若干则原所差者其半也
　　问甲有硃砂银七锭壬有鑛银九锭相较甲原多十五两今以甲二锭易壬三锭则甲多二十七两
　　法以原多十五两今多二十七两相减余十二两半之得六两为甲二锭壬三锭之较【甲得较而增重故与壬同名】


　　壬三锭除七十二两得壬每锭二十四两　以九锭乗得二百一十六两加正一十五两共二百三十一两甲七锭除之得每锭三十三两
　　计开


　　甲以二锭与壬余五锭一百六十五两加易得壬三锭七十二两共二百三十七两
　　壬以三锭与甲余六锭一百四十四两加易得甲二锭六十六两共二百一十两
　　相较甲多二十七两
　　此问意也


　　问甲银七锭壬九锭相较壬原少十五两今以一锭相交易壬多三两
　　法以原少十五两今多三两并得十八两而半之得九两为一锭之较【壬得之而变轻为重故与甲同名】


　　壬二锭除四十八两得每锭二十四两　加九两得甲每锭三十三两
　　计开
　　甲六锭一百九十八两加壬一锭二十四两共二百二十二两壬八锭一百九十二两加甲一锭三十三两共二百二十五两相较壬多三两　此交易一定之数　余同前问
　　论曰此三问皆同法第一问盈偕适足故即用原数第二问两盈故相减第三问盈偕不足故相并然皆半之为较故三法一法也
　　又按于七锭中取一即七之一同带分之理故又作问明之
　　问有金不知总任意分为二而较之则庚多八两湏令辛以金还庚如庚存数三之二庚亦以金还辛如辛存数四之三则其数适均
　　法以庚自存三分今添二分共五　以辛自存四分今添三分共七通为两家适足数之分
　　又以多八两半之四两命为庚所添二分辛所添三分之较【辛失之而减重故与辛同名】
　　解曰合而观之庚以五之二辛以七之三相交易则庚多八两若还其原数庚仍为五分辛仍为七分则适足也


　　辛一分得二十两　七分共一百四十两　五除之得庚之一分二十八两
　　计开




　　其相易【庚二分五十六两辛三分六十两】较之辛多四两即相易几锭之理
　　总论曰此皆两相交易也又与庚甲损一益一者不同凡损一益一者损庚之几分与甲则甲有增数而转以甲之既增者与庚之余数相较也　损庚益甲以相较是明有增损
　　今两相交易则损庚之分与辛亦损辛之分与庚然后以既损且增之庚与亦增之辛相较也
　　两相交易则末尝明有增损但以相易之数不同而增损隠寓于其中　以上四条皆同此论
　　问两数不知总但云取甲之九加乙则乙与甲等若取乙之九加甲则甲倍于乙其原数各若干
　　畣曰甲六十三　乙四十五
　　解曰云取甲之九加乙是损甲之九而益乙以九也取乙之九加甲是损乙之九而益甲以九也与刋误条所举甲乙二仓法不同彼是取甲仓几何以益乙而共得几何不言与甲仓较取乙仓几何以益甲而共得几何亦不言与乙仓较是所益者有増数而所取者
　　无损数如云以此之全数偕彼之几分而共得几何乃和数也今所列者乃较数也益此损彼则相较几何故不同也然又与带分条较数不同彼是取彼几分与此全数较今所列者是取彼几数加此而转与彼之余数较当细辨之
　　又此是以数相增损而得其相较之分
　　前数条则是以分相损增而得其相较之数
　　二者大异不但与带分条别也
　　法以所加之九数命甲乙所相当之数乗之为较数列位
　　甲倍乙是甲二乙一合之则三以乗九得二十七为较甲得此而当倍乙故与乙同名
　　甲乙等是各一也合之则二以乗九得十八为较乙得此而与甲等故与甲同名


　　余乙一为法
　　并四十五为实
　　法一即以四十五命为乙数
　　异加十八得六十三为甲数
　　试更列之


　　同减余甲一为法　异并六十三为实　法一即以六十三为甲原数　异加正二十七共九十乙二除之得四十五为乙原数
　　论曰此难题设问也算法统宗收入均输另有求法算海説详推论借银相当加半倍者不可通用因别立术然复未确不如用方程之为无弊
　　又论曰甲与乙九而相等是甲多于乙者二九也　乙与甲九而甲倍于乙是倍乙多于甲者三九也何也甲得乙九数而后当倍乙则倍乙中各除九数共二九而甲又添九数岂非三九乎
　　问甲乙银不知数但云甲借乙六钱五分则比乙一有半乙借甲六钱五分则乙与甲等各原银若干
　　法以甲一乙一有半并之共二半以乗六钱五分得一两六钱二分半为乙一有半多于甲之较
　　以甲乙相等各一并之共二以乗六钱五分得一两三钱为甲多于乙之较
　　乃列之


　　同减余半乙为法异并二两九钱二分半为实　法除实得五两八钱五分为乙银　异加正一两三钱共七两一钱五分为甲银
　　计开
　　甲原银七两一钱五分
　　乙原银五两八钱五分
　　相差一两三钱　若损甲之六钱五分以加乙则各得六两五钱是相等也
　　若损乙六钱五分余五两二钱　益甲六钱五分得七两八钱是甲之数如乙一有半也
　　若以乙原银加半得八两七钱七分半以与甲原甲原银相较则多一两六钱二分半
　　论曰甲以六钱五分借与乙而相等是甲原多乙两个六钱五分也乙以六钱五分借与甲而甲如乙一有半是一个半乙原多于甲两个半六钱五分也何也甲取乙六钱五分而后能当乙有半则此一个半乙共减去一个半六钱五分甲又加一个六钱五分岂非共差两个半六钱五分乎
　　又论曰此即算海説详所设之问以驳统宗者彼自立术以为当矣不知其宜用方程也
　　试更设问以明之
　　今有二数不知总但云丙与丁二数则相等若丁与丙二数则丙如三丁问原数各若于
　　依前术列位【合丙丁各一共二以乗二得四为丙多于丁之较　合丙一丁三共四以乗二得八为三丁多于一丙之较】


　　同减余丙二为法　异并二十为实　法除实得一十为丙数　同减负四余六为丁数
　　计开
　　丙原数十　原多于丁者四
　　丁原数六　三之则十八多于丙者八
　　若损丙之二以益丁则各得八故相等
　　若损丁之二以益丙则丙得十二丁得四故丙如三丁
　　论曰丙以二与丁而等是丙多于丁者两个二也　丁以二与丙而丙如三丁是三丁之数共多于丙者四个二也何也丙増一个二其三个丁各少一个二共四个二也
　　又论曰因算海説详立术未确故复设此以相攷用方程能合彼问而彼所立术殊不能通之此问
　　问戊己银不知数但戊以五十两与己则己如戊之倍己以五十两与戊如三己
　　依前术列位【并戊二己一共三以乗五十得一百五十为二戊多于一己之较　并戊一己三共四以乗五十得二百为三己多于一戊之较】


　　同减余己五为法　异并五百五十两为实　法除实得一百一十两为己银　异加正一百五十两共二百六十两戊二除之得一百三十两为戊银计开
　　戊原银一百三十两　倍之二百六十两多于己一百五十两
　　己原银一百一十两　三之得三百三十两多于戊二百两
　　此列位之理
　　戊加五十两得一百八十两己损五十两得六十两则戊如三己　己加五十两得一百六十两戊损五十两得八十两则己如戊之倍
　　此则问意
　　问香炉二座不知重有一葢重百两以加甲炉则甲多于乙两倍以加乙炉则乙多于甲一倍其炉各重若干
　　解曰多乙两倍是三倍也甲得葢如三乙也　多甲一倍是两倍也乙得葢如两甲也
　　法以葢重为较而列之　甲得葢如三乙是三乙之重于甲者如葢也故与乙同名　乙得葢如倍甲是两甲之重于乙者如葢也故与甲同名


　　炉同减余乙炉五为法　较异并三百两为实法除实得六十两为乙炉重
　　异加一百两共一百六十两甲二除之得八十两为甲炉重
　　计开
　　甲炉八十两　加葢共一百八十两则如乙炉重者三乙炉六十两　加葢共一百六十两则如甲炉重者倍论曰此与前所设戊己银数以五十两损戊益己而己倍于戊以五十两损己益戊而戊如二己异何也以五十两损彼益此虽亦相差一百两然非真有一百两之益乃因彼之所损而合成其数耳此之加葢则实增一百两矣而于彼又无所损因炉葢乃两家公物非若戊己之银必取诸彼以与此也故其法不同若改问各铸炉而均铸葢则必于鑪重各加半葢乃合原金得数与戊己银同矣
　　问调兵征倭内有南北西三处兵马南兵已知四万其北兵为南兵与西兵二之一西兵为南兵与北兵三之一各若干
　　法以南兵为西北之较而列之
　　西兵得南兵而数倍于北是倍北数而多于西兵者数如南兵也
　　北兵得南兵而数如三西兵是三其西兵而多于北者亦如南兵也


　　余北兵五为法　倂十六万为实　法除实得三万二千为北兵数异加正四万共七万二千西兵三除之得二万四千为西兵数
　　计开
　　南兵四万
　　西兵二万四千　偕南兵则六万四千其二之一则如北兵也北兵三万二千　偕南兵则七万二千其二之一则如西兵也论曰此与香炉借葢为较同　其所用较乃是南兵而非取于西北兵故得之有增而不得无损与借物于彼而转与其所借之余物相较者不同
　　问二人擕银不知数但减乙六两与甲则甲倍于乙减甲三两与乙则相等其原数若干
　　解曰此所损益又是不同之数然其理则一故亦依前术乗其较数而列之【合甲一乙二共三以乗六两得十八两为倍乙多于一甲之较合甲乙各一共二以乗三两得六两为甲多于乙之较】
　　列位


　　同减余乙一为法　异并二十四两为实　法一即以实为乙数　异加六两为甲数
　　计开
　　乙二十四两　倍之得四十八两多于甲一十八两甲三十两　原多于乙六两
　　若损乙六两得十八两加甲六两得三十六两是甲如乙之倍
　　若损甲三两加乙三两各得二十七两则相等
　　问二商各携母银但云取乙十二两与甲则乙有甲六之一取甲十五两与乙则甲有乙十之一
　　依前术列位【并六与一共七以乗十二两得八十四两为六乙多于一甲之较　并十与一共十一以乗十五两得一百六十五两为十甲多于一乙之较】


　　同减余甲五十九为法　异并一千○七十四两为实　法除实得一十八两又五十九之一十二为甲数　异加正八十四两共一百○二两【又五十九之一十二】乙六除之得一十七两【又五十九之二】为乙数
　　计开
　　甲银一十八两【又五十九之一十二】十之则一百八十二两【又五十九之二】多于乙者一百六十五两
　　乙银一十七两【又五十九之二】六之则一百○二两【又五十九之一十二】多于甲者八十四两
　　若损乙一十二两与甲则甲有三十两【又五十九之一十二】乙仅有五两【又五十九之二】而乙于甲为六之一
　　若损甲一十五两与乙则乙有三十二两【又五十九之二】甲仅三两【又五十九之一十二】而甲于乙为十之一【以五十九通二两得一百一十八加子二从之共一百二十是三十两又五十九之一百二十岂非十倍于甲乎】
　　论曰乙得甲六之一是六乙当一甲也然必损乙之十二两与甲而后成此数是于一甲中添十二两而于六乙中各减十二两也一添一减共七个十二两是为八十四两也
　　甲得乙十之一是十甲当一乙也然必损甲之十五两与乙而后成此数是于一乙中添十五两而其十甲中皆各减十五两也一添一减共十一个十五两是为一百六十五两也
　　损乙之十二两与甲而乙为甲六之一若其原数则以六乙当一甲而乙多八十四两矣
　　损甲之十五两与乙而甲为乙十之一若其原数则以十甲当一乙而甲多一百六十五两矣
　　问有两数不知总但损甲六数与己则甲如己四之三而多二数若以己之二十损与甲则己如甲四之三而少五数其原数各几何
　　法以四甲三己共七乗六得四十二又以四甲乗多二数得八而益之共五十为四甲多于三己之数【损甲六益己故较与甲同名其二数甲所多也故以之益数】
　　以四己三甲共七乗二十得一百四十又以四己乗少五数得二十以相减余一百二十为四己多于三甲之较【损己二十益甲故较与己同名其五数巳所少也故以之减较】


　　己同减余七为法　异并六百三十为实　法除实得九十为己原数四因己数同减一百二十余二百四十甲三除之得八十为甲原数
　　计开
　　甲八十
　　己九十
　　以列位之理言之
　　甲四共三百二十　己三共二百七十　是甲多五十甲三共二百四十　己四共三百六十　是己多一百二十
　　以问之意言之
　　甲损六数余七十四　己加六数共九十六　以九十六四分之而取其三得七十二　是为甲如己四之三而多二数
　　己损二十余七十　甲加二十共一百　以一百四分之而取其三得七十五　是为己如甲四之三而少五数
　　论曰以甲当己四之三是四甲当三己也然必以六数减甲增己而成则是四甲中各减六而三己中各增六共四十二也以甲当己四之三而多二数则以四甲当三己而共多八数也　合而观之此四十二者四甲多于三己之数也此八数者亦四甲多于三己之数也故皆与甲同名而列其较为五十也
　　以己当甲四之三是四己可当三甲也然必以二十减己增甲而成则是四己中各减二十而三甲中各增二十共一百四十也　以己当甲四之三而少五数则以四己当三甲而共少二十也　合而观之此一百四十者四己多于三甲之数也与己同名也而其二十者则四己少于三甲之数也与己异名也故以相减而余者列为己同名之较也
　　损甲六数与己而甲如己四之三仍多二数若其原数则以四甲当三己而共多五十矣
　　损己二十与甲而己如甲四之三却少五数若其原数则以四己当三甲而共多一百二十矣
　　问有三数损甲一百益乙则甲如乙六之二若损乙五十益丙则乙如丙十五之九若损丙三十益甲则甲如丙二之一而少五数各若干
　　法以甲六乙二共八以乗一百共八百为六甲当二乙之较【损甲益乙故与甲同名】
　　以乙十五丙九共二十四乗五十得一千二百为十五乙当九丙之较【损乙益丙故与乙同名】
　　以丙一甲二共三乗三十得九十又以甲二乗少五数共十而加之共一百为一丙当二甲之较【损丙益甲故与丙同名其甲所少五数即丙所多也故亦与丙同名】




　　如法逓减余丙五十四为法　异并三万七千八百为实　法除实得七百为丙数　丙数同减一百余六百甲二除之得三百为甲数　六因甲数一千八百同减八百余一千乙二除之得五百为乙数　十五乗乙数得七千五百同减一千二百余六千三百丙九除之仍得七百为丙数【反覆相求列位之理着矣】
　　计开
　　甲三百
　　乙五百
　　丙七百
　　甲损一百余二百乙增一百得六百是甲为乙六之二乙损五十余四百五十丙增五十得七百五十是乙为丙十五之九
　　丙损三十余六百七十其二之一则三百三十五甲增十得三百三十是甲为丙二之一而少五数
　　问二人共数一百原所得之数不均今以甲三之一与乙五之一相易则适均其原所得若干
　　法以三分通甲数损一与乙而存其二分　又以五分通乙数损一与甲而存其四分
　　乃以和数列之


　　乙七为法　余五十为实　法除实得七又七之一为乙之一分　以乙分母五乗之得三十五又七之五【为乙数】以减一百得六十四又七之二为甲数计开
　　甲六十四【又七之二】其三之一为二十一【又七之三】其三之二为四十二【又七之六】
　　乙三十五【又七之五】其五之四为二十八【又七之四】其五之一为七【又七之一】以甲三之一加乙五之四五十也　以乙五之一加甲三之二亦五十也
　　论曰此以分相增损而为和数亦与刋误条甲乙二仓异彼是以其全数偕彼防分此则以所存之余数偕彼几分也既云相易则实有增损非如甲乙仓虚借增率而无损也
　　问二人物数不均若于甲取三之一于乙取四之一以和合而平分之以凑原存数则各五十而适均其原数各若干
　　法以三分通甲数而倍之为六分损其一与乙余五分以四分通乙数而倍之为八分损其一与甲余七分以和数列位
　　解曰以四之一与三之一和合而平分之是各取其数之半也　于三之一取其半是六之一以与乙而甲余其五也于四之一取其半是八之一以与甲而乙余其七也


　　偏乗对减以得法实　法除实得五又十七分之十五为乙八之一　以乙分母八乗之得四十七又十七分之一为乙原数　以两五十共一百减乙原数余五十二又十七分之一十六为甲原数
　　计开
　　甲原数五十二【又十七分之十六】三除之得十七【又十七分之十一】为甲三之一　以三之一转减甲余三十五【又十七分之五】为甲所存三之二
　　乙原数四十七【又十七分之一】四除之得十一【又十七分之十三】为乙四之一以四之一转减乙余三十五【又十七分之五】为乙所存四之三
　　以甲三之一乙四之一和合之共二十九【又十七分之七】半之得十四【又十七分之十二】为和合平分之数以加甲乙存数各得五十
　　论曰甲去三之一乙去四之一所存之数已均矣故以平分之数加之而适均
　　又法
　　以甲分母三通甲为三分以乙分母四通乙为四分又总计各得五十六共一百为和数
　　以甲取三之一余三之二乙取四之一余四之三命为适足【甲取三之一乙取四之一以和合平分而等则其所存者亦等也故命之适足】乃以和较杂列位


　　如法乗甲同减尽　乙异并一十七分为法　正二百无减就为实　法除实得一十一又十七之十三为乙之一分以分母四乗之得四十七又十七分之一为乙原数　以乙原数减共数一百余五十二又十七分之十六
　　按此所得与前无异而较捷故并存之
　　问甲乙丙三人共博甲赢乙金二之一乙赢丙金三之一丙又赢甲金四之一事毕各剰金七百其原携金若干
　　法以各分母通其原数又各减其赢去之一而列之【以七百为和数】
　　和数列位




　　如法减并　丙七分为法　二千一百为实　法除实得三百为丙之一分　以丙分母三乗之得九百为丙原金　以丙之一分减乙剰七百余四百为乙所余二之一　二因之得八百为乙原金　以乙二之一减甲剰金七百余三百为甲自剰四之三　三除之得一百为甲三之一　四乗之得四百为甲原金
　　计开
　　甲原金四百　加赢乙四百【二之一也】共八百　除丙又赢去甲一百【四之一也】仍余七百
　　乙原金八百　加赢丙三百【三之一也】共一千一百　甲赢去四百【乙二之一也】仍余七百
　　丙原金九百　赢甲一百【四之一也】共一千　乙赢去三百【丙三之一也】亦仍余七百
　　论曰此与刋误条骡马逓借一匹同但马一骡二驴三即是原物偕所借之一而为和数今乙一丙二甲三却是各所存之余分偕所赢之一分而为和数也得数大异者马骡即是全数今则用分故丙之全数转多于乙若以一分计则乙之分自多于丙如马力之于骡矣
　　又论曰此三条皆是两相交易而又是和数与前数条金银交易几锭不同
　　难题歌曰一条竿子一条索索比竿子长一托双折索子去量竿却比竿子短一托
　　解曰一托者五尺也
　　法以零整襍列位　因双折是二之一故以二通索


　　法一即以实一丈命为绳之一分　分母二因之得绳长二丈　减负五尺余得竿长一丈五尺
　　假如有绳长不知数但云比竿长六尺若三折其绳则短于竿八尺


　　法二除实三丈得竿长一丈五尺　加正六尺得绳长二丈一尺
　　论曰原法别有求法然不如方程穏捷故作此问以明之若用难题法不能通矣故方程能御杂法而杂法不能御方程　此条统宗原入均输今改正
　　问井不知深先将绳折作三条入井汲永绳长四尺复将绳折作四条入井亦长一尺其井深绳长各若干
　　法以两母【三四】相乗得十二分为绳母数　以母【三四】互乗其子【之一之一】得【四三】是为以绳十二分之四汲水而长四尺以绳十二分之三汲水而长一尺也


　　余一分为法　即以实三尺命为绳十二分之一以十二分乗一分得三十六尺为绳长　以绳之三分计九尺同减负一尺得八尺为井深
　　计开
　　井深八尺
　　绳长三十六尺
　　三折之得一十二尺　比井多四尺
　　四折之得九尺　　　比井多一尺
　　论曰此条原属盈朒今以方程御之尤简易故曰方程能御杂法也
　　试更之则先得井深


　　法一省除即以八尺命为井深　加正四尺共十二尺绳之四分除之得三尺为一分　一十二分母乗之得绳长三十六尺
　　论曰此余八尺者即物实也前以余三尺为绳长实者即人实即此可悟盈朒章作法之原要之是二色方程法耳【人实物实不同而除法则同故皆可以互求】
　　今有绢一疋欲作帐幅先折成六幅比旧帐长六寸改折作七幅却又短四寸其绢并旧帐幅各长若干【折作六幅以较长即六之一七幅即七之一】
　　法如前以【六七】幅相乗得四十二分为总母　以【六七】互乗其【之一之一】得【之七分之六分】为所用之分而列之【以绢四十二之七则长于帐六寸　以绢四十二之六则短于帐四寸】为较数


　　法一　实一尺即为绢之一分　以分母四十二乗之得绢长四丈二尺　以绢之七分计七尺减负六寸余六尺四寸为旧帐之长
　　计开
　　旧帐幅六尺四寸
　　绢长四丈二尺
　　均作六幅得七尺　比帐长六寸
　　均作七幅得六尺　比帐短四寸
　　论曰此与井不知深皆是以一物之细分与一整物较皆零整杂用之法也
　　又以上三条盈朒章旧有求法然皆因所较之井深与旧帐幅皆为一数而不变故可用盈朒之法若亦有分数不同则非盈朒所能御此方程之用能包盈朒诸法而诸法不能御方程
　　今有台不知髙从上以绳缒而度之及台三之二而余六尺双折其绳度之及台之半而不足三尺问台之髙及绳之长若何
　　法以台【三二】之【二一】用母相乗为母之法通台为六分　又用母互乗子为子之法变台三之二为六之四台之半为六之三　又以双折通绳为二　皆以化整为零而列之


　　余绳二分为法　并三十尺为实　因二为分母与法同省除与乗径以实三十尺为绳长　减负六尺余二十四尺以台之四分除之母六乗之得三十六尺为台髙
　　计开
　　台髙三十六尺
　　绳长三十尺
　　台三之二髙二十四尺　以绳度之余六尺
　　台之半髙一十八尺　　以半绳一十五尺比之短三尺
　　今有井不知深以乙绳汲之余绳二尺以庚绳汲之亦余绳四尺双折庚绳三折乙绳以相续而汲之适足问井深及二绳各长若何
　　法以乙绳通为三　庚绳通为二
　　以三色列之　井整数乙庚用分



　　以隔行之同名仍为较数列之　余较皆与庚同名


　　余庚一分为法　即以实一丈命为庚二之一　倍之得庚绳二丈　减负二尺得乙绳一丈八尺【用减余之右行葢乙正三即全数也】
　　又减负二尺得井深一丈六尺【用原列之右行亦以乙负三即全数故】计开
　　井深一丈六尺
　　乙绳一丈八尺　比井多二尺
　　庚绳二丈　　　比井多四尺
　　三折乙绳六尺加双折庚绳一丈共一丈六尺即同井深
　　论曰此二条与前井深绢帐同理然即非盈朒所能御又按田之横直亦可以绳折比量水面亦然
　　今有直田欲截一段之积只云截长六歩不足积七步截长八步又多积九步问所截之积及原濶
　　法以较数列之【其原濶即截长每一步之积】
　　上　　　　　中　　　　　　下


　　长二步除积十六步得原濶八步　以截长六步乗濶得四十八步加不足七步得截积五十五步
　　论曰此盈朒中方田也然无闗于方田之实用故入盈朒然不知宜入方程也
　　试更作问
　　今有方田欲截横头之积改为直田但云截濶五步则不足十二步截濶九步则如所截之积一有半问所截直田积并原田之方
　　如法列位


　　濶一歩半为法　积十八歩为实　法除实得原方一十二歩　以濶五歩乗方得六十歩加不足十二歩得截直田七十二歩
　　计开
　　原方田方十二歩　积一百四十四歩
　　截直田七十二歩　宜截濶六歩
　　若此条则盈朒不能御
　　今有米换布七疋多四斗换九疋适足问原米若干及布价
　　法列位
　　上　　　中　　　下


　　布二疋为法　四斗为实　法除实得布价每疋二斗　以九疋适足乗布价得原米一石八斗
　　论曰此盈朒中粟布法也
　　试更设问
　　今有谷换绢十疋余三石以谷之半换绢六疋不足五斗问原谷若干及绢价
　　法列位


　　法一免除　得绢每疋价二石　以十疋乗价加余三石得原糓二十三石
　　若此条则非盈朒所能御
　　论曰直田截积及米换布盈朒本法也愚所设方田截积及糓换绢非盈朒本法也乃带分盈朒之变例也【如旧法芝蔴粜银是其例也】虽盈胸亦有求法颇多转折非其质矣不如用方程之省约
　　今有芝蔴不知总但云取麻八分之三粜银十两不足二石取麻三分之一粜银八两适足问原麻总数及每银一两之麻
　　法先以麻【八　之三三　之一】用母相乗得二十四为母母互乗子得【之九之八】为所用之分而列之　依省算左加九之一而径减


　　法一两省除即以麻二石命为银每两之麻　以银八两麻八分适足省乗除径以二石为麻之一分以二十四分乗得原麻四十八石
　　计开
　　原麻四十八石　　　　银毎两麻二石
　　其八之三计一十八石　银十两该二十石　故不足二石
　　其三之一计一十六石　银八两恰该一十六石　故适足
　　若问麻每石之银则以二石为法转除一两得每石价五钱
　　按此条宜入方程旧列带分盈胸之末
　　问者若云有银买麻以麻八之三与之则余二石以麻三之一与之适足问原麻及银所买




　　依法求得二石为麻之一分　以总母廿四分乗之得原麻四十八石　以九分乗二石减负二石得银所买麻十六石
　　论曰此所设问则盈朒带分本法也然不能知每价以方程法求之亦同　观此益见前条之宜入方程也
　　今有黄连木香不知数但云取连三之一换木香七之二则连多二斤取连四之三换木香五之四则连少一斤若于五之四内减去木香三斤则连多一斤
　　法先以通分齐其分


　　乃列位


　　如法乗减　余木香二十二分为法　异并黄连二十二斤为实　法除实得每木香一分【即三十五分之一】换黄连一斤　以木香十分换黄连十斤异加正二斤共十二斤以黄连正四分除之得黄连每三斤为一分　以分母十二乗之得总黄连三十六斤
　　另并黄连多一斤少一斤共二斤为法除减木香三斤得每黄连一斤换木香一斤半【原少连一斤减木香三斤而转多连一斤故知其数】
　　此连所换之木香一斤半即其三十五分之一分也以三十五分乗之得木香五十二斤半
　　计开
　　黄连三十六斤
　　木香五十二斤半
　　每黄连一斤换木香一斤半
　　三分三十六斤而取其一得一十二斤为黄连三之一七分五十二斤半而取其二得十五斤为木香七之二该换连十斤今连有十二斤是连多二斤也
　　四分三十六斤而取其三得二十七斤为黄连四之三五分五十二斤半而取其四得四十二斤为木香五之四该换连二十八斤今连只二十七斤是连少一斤也
　　若于木香五之四减三斤余三十九斤该换连二十六斤今连有二十七斤是连多一斤也
　　论曰凡较数方程有若干物共几色又有其所较之价银若钱之类今所用较数即用其物之斤两而无银若钱微有不同乃古者贸迁有无交易之术也专用银若钱以权物价后世事耳
　　问绫每尺多罗价三十六文今买绫六尺罗八尺其共价绫比罗少三十六文
　　畣曰绫每尺一百六十二文　罗每尺一百二十六文


　　罗二尺除二百五十六尺得罗价每尺一百二十六文　加多三十六文得绫价每尺一百六十二文
　　问银二千九百二十八两买绫一百五十疋罗三百疋绢四百五十疋只云绫每疋比罗多四钱七分罗每疋多绢一两三钱五分　畣曰绫每疋四两三钱二分　罗每疋三两八钱五分　绢每疋二两半




　　绢九百疋为法除实二千二百五十两得绢价二两五钱　加多一两三钱半得罗价三两八钱半　又加多四钱七分得绫价四两三钱二分
　　今有兄弟三人不知年小弟谓长兄曰我年比汝四之三次兄比汝六之五比我多八歳
　　法以带分别之　皆变零从整




　　季弟二　除一百四十四歳得年七十二歳　加八歳得仲兄年八十　六因仲年五除之得伯年九十六歳
　　计开
　　伯九十六歳　仲八十歳【为伯年六之五】　季七十二歳【为伯年四之三】今有四人分钱但云乙得甲六之五丙得甲四之三丁得甲二十四之十七其丁与丙差四文
　　甲正五　　乙负六　　　空　　空　　　适足【此行不用乙无对故也】




　　丁四除二百七十二得丁钱六十八文
　　加四文得丙钱七十二文
　　四乗丙钱三除之得甲钱九十六文
　　五乗甲钱六除之得乙钱八十文
　　计开
　　甲九十六文
　　乙八十文
　　丙七十二文
　　丁六十八文
　　甲六之一得一十六以五因得八十文为六之五乙数也甲四之一得二十四以三因得七十二为四之三丙数也甲二十四之一得四以一十七因得六十八为二十四之一十七丁数也
　　论曰此虽四色实三色也故径以三色取之
　　今有七人逓差分钱但知首二人共七十七文次二人共六十五文不知各数亦不知余人数
　　法以逓差故知倍乙当甲丙倍丙当乙丁而列之




　　重列减余与三行　减余变较


　　重列减余与四行


　　丁八为法除实二百四十八文得三十一文为丁数倍丁数与六十五文相减得逓差三文　以差逓
　　加得甲乙丙数以差逓减得戊己庚数　皆加减丁数得之
　　计开　甲四十文　乙三十七文　丙三十四文　丁三十一文戊二十八文　己二十五文　庚二十二文
　　今有银二百四十两以四人逓差分之只云甲多丁一十八两
　　如前法以倍乙当甲丙倍丙当乙丁　又依省算移甲于丁位
　　和较列位




　　重列两减余


　　又重列减余与末行


　　甲四除二百七十六两得甲数六十九两　甲数内减十八两得丁数五十一两　以甲数减二百四十两余一百七十一两丙三除之得丙数五十七两　并丙数甲数一百廿六两半之得乙数六十三两计开
　　甲六十九两　乙六十三两　丙五十七两　丁五十一两　逓差六两
　　今有米二百四十石五人逓差分之其甲乙二人与戊丁丙三人共数等
　　如前法列位　依省算倒甲位自下而上





　　重列减余与三行


　　又重列减余与四行


　　又重列减余与末行


　　甲十五除九百六十得甲数六十四石　倍甲数减一百廿石余得逓差八石　以差逓减各数得乙丙丁戊数
　　计开


　　细分之逓差八石
　　论曰凡差分章竹筒七节盛米之类皆可以此法求之兹不烦列




　　厯算全书卷四十五
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　歴算全书卷四十六
　　宣城梅文鼎撰
　　句股阐微卷一
　　句股正义
　　首题
　　句股者横曰句纵曰股【亦可云勾纵股横】斜曰三线相聨而成句股形也
　　如图甲乙丙形甲乙为股乙丙为句甲丙为亦可云【甲乙为句乙丙为股】也　凡三角形或三角俱鋭或两鋭一钝或两鋭一
　　正【鋭钝正説具三角形算法中】句股形者两鋭一正形也其句股两线纵横相遇而成者为正角如乙防句两线及股两线相遇而成者为鋭角如甲丙两防　此三线者或三线俱不等其最大者必或两线等其等者必句股而无三线等何者以句股形一角正故也
　　一题
　　句股求
　　法曰句股各自乘并之开方得
　　如图甲乙句自乘得乙丁方乙丙股自乗得乙戊方两方相并即甲巳方开之得甲丙
　　论曰试移庚实形补辛虚形移丑实形补卯虚形移壬实形补子虚形移卯午实形补壬辰虚形所移者恰尽所补者恰足得乙丁与乙戊两方并恰与甲巳方等又论曰更以句与股相等之形观之夫句与股既等则句股各自乗固方也即句股互相乗亦方也【凡句股不等则句股互相乗必是矩形】如丁戊大方平分方边于方形中纵横作线中分四
　　小方形必等又句与股既等则上方边为句股各自乗两方之对角线亦为句股互相乗两方之对角线如于四小方形中作四对角线相聨而成一中方形也此中方形者割小方形四之半即涵小方形二之全就此图观之尤为明显
　　又法曰句与股相乗倍之另以句股差自乗并入倍数开方得
　　论曰甲乙股乙丙句相乗得乙丁矩形中分为庚戊两形夫庚形即辛形也倍之者再加癸卯两形也乙丙为句丙巳
　　为股乙巳为句股差自乗得乙子方并入倍数共成甲壬方为甲丙上方也
　　又法曰句自乗倍股依长濶相差法求之得股差加股为
　　论曰甲乙丙句股形甲丙也丁已亦也丁戊上方也乙丙股也乙壬亦股也乙子股上方也余乙戊子磬折形即句自乗之数也而已壬矩与乙丑矩等即丙戊矩亦
　　句自乗之数也此丙戊矩形中乙丙为股加乙壬为倍股曰长濶相差者丙午为长午戊为濶与壬午等即壬丙倍股为长濶之差也依法求之得壬午为股差
　　二题
　　句求股
　　法曰自乗内减句自乗余开方得股
　　论曰一题句股求苐一法句股各自乗并之即自乗数则自乗数中有句股各自乗之数也今于自乗数中减去句自乗所存者即股自乗数矣就一题之图观之自见
　　又法曰句相并得数相减得数两数相乗得数开方得股
　　如图甲乙丙句股形乙丙句甲乙股甲丙与乙丙相并即乙丁线相减即乙巳线【乙巳与乙子等】两线【乙丁乙子】相乗得子丁矩即
　　甲乙股上方
　　论曰己午方者已丙线上方即甲丙上方也内减子午形为乙丙句上方所存卯巳未磬折形即甲乙股上方矣而巳未矩又与丁卯矩等则丁子矩形即卯巳未磬折形矣亦即甲乙股上方矣
　　又法曰句自乗倍依长濶相和法求之得股差用减得股
　　论曰甲乙丙句股形甲丙也丁己亦也丁戊上方也乙丙股也乙壬亦股也乙子股上方也余乙戊子磬折形
　　即甲乙句自乗之数也而己壬矩与乙丑矩等即丙戊矩亦甲乙句自乗之数也此丙戊矩形中乙午为乙丙并午戊为倍曰长濶相和者丙午为长午戊为濶即丙午午戊并为长濶相和也依法求之得壬午为股差
　　三题
　　股求句
　　法同二题句求股
　　附长濶相和法
　　如图丁乙矩形积九百七十二尺丁甲为长乙甲为濶两边之和共六十三尺求甲丁甲乙二边各若干　法以和数
　　自乗得三千九百六十九尺次以积四倍之得三千八百八十八尺与和自乗相减存八十一尺开方得九尺【即丁甲乙甲二边之较数】以与和【六十三尺】相并折半得三十六尺为甲丁长边又与和相减折半得二十七尺为甲乙矩边长濶相差法【图同上】
　　丁乙矩形积九百七十二尺甲乙为濶戊乙为长丙戊九尺【乙丙即甲乙】为长濶相差数甲乙戊乙二边各若干法以较数【九尺】自乗得八十一尺次以积四倍之得三千八百八十八尺与较自乗相并得三千九百六十九尺开方得六十三尺【即戊乙甲乙二边之和数】以与较九尺相并折半得三十六尺为戊乙长边又与较【九尺】相减折半得二十七尺为甲乙短边
　　解曰甲午矩形作乙丙对角线成甲乙丙句股形甲丙长句也甲乙濶股也丙丑长濶和也【甲丑即乙甲】自乗得丙
　　子大方四倍矩积也并大方内戊丁
　　庚辛四矩形之积【大方内所容四矩俱与元形等如丙
　　壬矩即甲午矩其八句股形亦俱等元形】相减存己壬小
　　方开方得巳未边即甲乙甲丙二边之较数也【卯亥即甲乙股卯壬即甲丙句则壬亥为两边较数即长濶相差也】既得较数与所有和数相加减得甲乙甲丙二边矣
　　若长濶相差法是先有巳未较数故以上法反用之求得丙丑和得丙丑亦得甲乙与甲丙矣
　　四题
　　与句股较求句股
　　法曰自乗倍之较自乗用减倍数余开方得句股和于是和加较半之得长股和减较半之得短句
　　论曰甲乙丙句股形甲乙句也乙丁句上方也乙丙股也丙戊股上方也两方并共为上方辛壬亦句上方
　　庚已亦股上方两方并亦共为上
　　方此即自乗倍之之数也而两句
　　方两股方并为丙己大方则中间重
　　叠庚戊方矣此何方乎曰戊子即句股较也庚戊方即较上方也减之而重叠者去矣所存者为句股和上方矣故开之得丙丑为句股和也
　　又法曰自乗内减较自乗余半之以较为长濶相差法求之得短句加较得长股
　　论曰甲乙丙句股形甲丙也甲丁上方也巳子较也己丑较上方也两方相减余壬辛午未四形半之余午未二
　　形而午形又即戊形则是余未戊二形也此未戊二形者句股矩内形也故以巳子较用长濶相差法求之得子丙短句句加较得巳丙长股
　　五题
　　股与句较求句
　　法曰股自乗内减较自乗余半之以较为法除之得句句加较得
　　论曰甲乙丙句股形甲丙也甲丁上方也甲巳较也甲戊较上方也庚甲辛磬折形股自乗数也内减甲戊较上
　　方所余丙戊戊壬两形即为句与句较矩内形者二矣取其一如丙戊形以戊己较除之得己丙句【或不用折半倍较为法除之亦同】
　　又法曰股自乗以较为法除之得句和于是加较折半得减较折半得句
　　论曰甲乙丙句股形甲丙也甲丁上方也丙己亦句也丁戊句上方也所余庚甲辛　折形即股自乗数也而壬辛形与戊丙形等即壬己矩形亦股自乗数也以甲巳较除之得甲壬为句和也
　　又法曰股自乗较自乗相并倍较为法除之得减较得句
　　论曰甲乙丙句股形甲丙也甲丁上方也丁己为句上方即戊甲辛磬折形为股上方矣又己丙矩与庚壬矩等
　　即甲辛子磬折形亦股上方也加甲子较上方共得辛丑矩形其庚辛边即是倍较
　　六题
　　句与股较求股
　　法同五题
　　七题
　　与句股和求句股
　　法曰自乗倍之内减句股和自乗余开方得句股较于是较加和半之得长股较减和半之得短句
　　论曰甲乙丙句股形丙丁句股和也丁子和上方也丁午未子两句上方丙丑壬巳两股上方此即自乗倍之之数
　　也以较丁子和上方则其中重叠一壬丑方矣而此方之边即是句股较
　　又法曰句股和自乗内减自乗余半之以句股和用长濶相和法求之得句股
　　论曰丙丁为句股和丁巳为和上方午乙壬磬折形即上方两方相减余午丑壬磬折形分为午丑及丑壬两形形
　　之两边即句股
　　八题
　　股与句和求句
　　法曰句和自乗内减股自乗余半之以句和除之得句用减句和得【或不用折半倍句和除之亦同】
　　论曰甲乙丙句股形甲丁为句和甲巳为和上方又甲午为上方甲子为句上方即未午壬磬折形为股自乗而子丙矩与午辛矩等即戊辛矩形亦股自乗也于和方中减之所存者为未丁及戊己两矩形矣形之一边如甲丁即句和其一邉如甲未即句
　　又法曰股自乗得数以句和除之得句较于是用加句和半之得用减句和半之得句
　　论曰甲乙丙句股形甲丁句和也甲戊上方也戊己句上方也即午甲未磬折形为股自乗矣而卯巳矩与午丁
　　矩等即甲子矩形亦股自乗矣形之甲丁边即句和丁子边即句较
　　又法曰句和自乗股自乗相并倍和为法除之得减和得句
　　论曰甲丁为句和甲戊为和自乗
　　戊丑为句今试依庚戊矩作丁卯矩
　　即卯甲丑磬折形亦和自乗矣又甲
　　巳为上方未壬为句上方即未己壬磬折形为股自乗矣而壬子矩与子丑矩等即未丑矩亦股自乗矣然此犹在和自乗数中也今另加一股自乗如丑卯矩并
　　前卯甲丑磬折形共成一庚癸矩形
　　即为两自乗相并之数形之甲癸邉
　　即句和之倍形之甲庚边即是
　　也
　　九题
　　句与股和求股
　　法同八题
　　十题
　　句较股较求句股
　　法曰先以两较相减得即为句股较次以两较各自乗相并内减句股较自乗余开方得和较【和句股和也】于是加股较得句加句较得股以句较加句或以股较加股得
　　论曰甲乙丙句股形甲丙也甲巳即股也巳丙股较也甲壬即句也壬丙句较也壬己句股较也今试引甲壬句至丁令甲丁为句股和即丙丁为和较也次作甲戊为和上方午未为句较上方午子为股较上方【即庚辰方】两较上方相并共为午未辰磬折形内减
　　未子句股较上方余辰午癸磬折形
　　即戊午和较上方何则试观丑午
　　已磬折形句上方也子戊形亦句上
　　方也今于丑午已磬折形中减丑申及辛巳两矩形即是于子戊形中减卯子亥磬折形也然则所余之辰午癸磬折形非即戊午方乎
　　又法曰两较相乗倍之开方亦得
　　和较以下同前法
　　论曰甲乙丙句股形试引甲丙至丁
　　得甲丁为句股和甲戊为和上方【甲未股未丁句】丁子己子句也丁辛己壬也子辛子壬句较也未子亥子股也未申亥卯也子申子卯股较也然则卯辛与申壬两矩形即是两较相乘倍之之数也此两矩形者即戊午和较上方【丙丁为和较】何则未申亥磬折形句实也子戊方形亦句实也今试于未午亥磬折形减辛丙庚亥两矩形【辛未及亥壬皆是和较】及子午方即是于戊子方中减癸子丑磬折形也然则卯辛与申壬两矩形非戊午方乎
　　十一题
　　句股较句较求句股【句短股长看此题】
　　法曰先以两较相减得即为股较次以两较各自乗相减余为实倍股较为法用长濶相差法求之得句句加句股较得股句加句较得
　　论曰甲乙丙句股形丙乙股丙戊句
　　丙巳戊乙句股较戊己句较乙
　　巳股较乙丁亦为句丙丁为句股
　　和丙庚为和上方辛壬为句股较上方辛子为句较上方两较上方相减余丑子午磬折形夫乙子卯磬折形句实也壬庚方亦句实也今于壬庚方中作未庚未申两矩形与己丑寅卯两矩形等即所余壬申形与丑
　　子午磬折形等矣于是依壬申形作
　　壬亥形此形壬酉为长壬癸为濶与
　　壬辰等即辰未未酉为股较之倍
　　为长濶之差
　　按此法句股较句较相减得股较即三较皆备矣十题第一法句较股较相减得句股较即三较亦皆备矣既皆备三较则法可互用特以就题立法则法固各有攸属耳
　　十二题
　　句股较股较求句股【股短句长看此题】
　　法同十一题
　　十三题
　　句和股和求句股
　　法曰两和各自乗相并两和相减即为句股较自乗用减相并数余开方为和和【和也句股和也和和与句股和相并也】于是内减句和得股内减股和得句内减句股得
　　论曰甲乙丙形甲乙股也丁乙股
　　和也乙午股和上方也乙丙
　　句也丙子句和也丙未句和
　　上方也甲丙也丙丑股也丑巳
　　句也甲己和和也甲壬和和
　　上方也乙午丙未两方并较甲壬
　　方则两方多一句股较自乗之数何则试观甲壬方中股句三方即乙午丙末两方中句股三方也甲壬方中股矩二句矩二即乙午丙未两方中股矩二句矩二也无或异也所异者惟甲壬方中余句股矩二与乙午丙未两方中余方一则方一与句股
　　矩二其较为句股较上方何则试
　　观另图甲丙也甲丁上方也
　　甲乙股也乙丙勾也甲乙丙形句
　　股矩形之半也而丙巳丁丁子丑
　　丑午甲三形皆与甲乙丙形等共
　　四形即得句股矩之二也中余乙巳子午方即句股较上方然则乙午丙未两方并较甲壬方不多一句股较上方乎故于两方中减之即得甲壬方也
　　又法曰两和相乗倍之开方得
　　和和以下同前法
　　论曰甲乙丙形乙丁股和也丁
　　午句和也乙午两和矩内形也丙子句和也丙辛股和也丙未两和矩内形也甲丙也丙丑股也丑
　　巳句也甲己和和也甲壬和
　　和上方也乙午丙未两矩形与甲
　　壬方形等者两矩形中有两方
　　甲壬形中有方一股方一句方
　　一亦即两方也两矩形中有股
　　矩二句矩二句股矩二甲壬形亦有股矩二句矩二句股矩二也然则乙午丙未两矩形不与甲壬方形等乎
　　十四题
　　句股和句和求句股
　　法曰先以两和相减得即为股较次以两和各自乗相减余为实倍股较为法依长濶相差法求之得句句减句股和得股句减句和得
　　论曰甲乙丙形甲丁句和也甲戊句和上方也巳丁句股和也子戊句股和上方也两和之较为甲巳两方之较
　　为壬甲丑磬折形此形中午甲未磬折形句实也癸戊方形亦句实也夫癸戊方形与壬甲丑磬折形其余为辛未午丁两矩形今试作癸寅寅申两矩形与之等即戊申矩形与壬甲丑磬折形等矣此戊申矩形戊庚为濶即句与庚癸等癸卯卯申为倍数为长濶之差
　　十五题
　　句股和股和求句股
　　法同十四题
　　十六题
　　句股形中求容方
　　先论曰凡于句股形中依句股两边作方形或矩形则作形之外所余之角形二自相似亦与元形相似如图甲乙丙元形作壬丁乙子方形则此形之外所余甲丁壬及壬子丙两角形自相似何则谓甲丁与壬子相似丁壬与子丙相似也若
　　作壬丁乙子矩形亦然又此两形之各两边与元形之两边相似何则谓甲丁壬子两边与甲乙边相似丁壬子丙两邉与乙丙边相似也于是遂生求容方之法如左【独不能生求容矩之法者以容方则甲丁丁壬两邉即甲乙邉壬子子丙两邉即乙丙邉也若容矩则否】
　　法曰句股相乗为实并句股为法除之得方边
　　论曰甲乙股乙丙句相乗得甲丙矩即未午矩矩之甲
　　午边甲乙股乙午即句乙子即方
　　边何则甲丙为甲丙矩形之对
　　角线亦为甲壬壬丙矩形之对角线则甲乙丙与甲丑丙甲丁壬与甲未壬壬子丙与壬亥丙各角形自相等今于甲乙丙甲丑丙相等之两形中各减去相等之角形所余之乙壬方与壬丑方必等次于两方各加一同用之子亥矩则乙亥矩与子丑矩亦必等而子午矩与乙亥矩等亦即与子丑矩等然则甲丙矩不与未午矩等乎
　　又法曰句自乗为实并句股为法除之得余句用减句余即方边
　　论曰甲乙丙句股形乙丙句自乗
　　得乙丁方即未已矩形形之戊丙
　　即股丙巳即句丙子即余句乙子即方边何则丑丁形即子巳形也壬乙形即壬戊形也然则乙丁方即未巳矩也
　　十七题
　　句股形中求容圆
　　法曰句股相乗倍之为实句股共为法除之得容圆径【或句股相乗为实句股共为法除之得容员之半径　或句股相乗半之为实句股并而半之为法除之得容圆之半径】
　　论曰试于形之三边截取己子未
　　三防令乙子与乙巳等甲巳与甲
　　未等丙未与丙子等次于已子未
　　三防各作己丁未丁子丁三线为
　　形三边之垂线必相遇于丁而相
　　等何则试先就己甲未丁四边形论之甲巳甲未两边等己未两角皆正即巳丁未丁两线必等依显未丁与子丁两线子丁与巳丁两线亦必各等然则丁即圆心三线即圆之半径矣果何术以求之乎曰试作甲丁丙丁乙丁三对角线平分甲乙丙三角及丁角因平分三个四边形为六个三边形各两相等次引乙丙至壬令丙壬与甲已等则乙壬线为甲乙丙三边之半何则乙子者乙子乙巳之半丙子者丙子丙未之半丙壬者甲未甲巳之半然则乙壬者甲乙丙三边之半矣次引长巳丁线至亥令己亥与乙壬等必相与为平行次作壬亥丙午两线与子丁线等而相与为平行末作丙亥对角线则乙亥矩形与甲乙丙元形等何则乙巳丁子方形在元形之内丙子丁角形亦在元形之内丁午丙角形虽不全在元形之内然即丙未丁形而倒置之凑合丙子丁形而成子午矩形者也至于壬午矩形全在元形之外然亦即甲巳丁甲未丁两形颠倒凑合而成者也然则乙亥矩形与甲乙丙元形等矣于是以句股相乗半之得甲乙丙元形即乙亥矩形以乙壬三边之半分之得子丁为圆半径或以三邉之全分元形之倍亦
　　得圆之半径或三边之全分元形
　　之四倍得全圆径也
　　又法曰句股三边半之内减
　　得圆之半径【或倍用减三邉之全得全圆径】论曰甲乙丙元形之乙角既是正
　　角乙子丁乙已丁两角又是正角即子丁己亦必正角然则子丁己乙形必是正角方形而四边等矣即乙巳乙子两边必与丁己丁子圆之两半径等矣此乙已乙子之两边果何术以求之乎依前论乙壬线为三边之半而丙壬即甲未也丙子即丙未也则子壬线即甲丙也于是子壬减乙壬三边之半得乙子即圆之半径若倍数用减三边之全得全圆径
　　又法曰句股并以减之得全圆径
　　论曰如前图乙丙句也丙壬与乙巳并即甲乙股也何则以丙壬与甲巳等故也壬子即甲丙也何则以丙壬与甲未等丙子与丙未等故也于是以子壬减壬己句股并得子巳为圆之全径何则以乙子与子丁等乙巳又与乙子等故也
　　巳上十七题除求方求圆二题余十五题已尽句股之蕴矣然论其题则不止于己上十五题也今反覆推之凡得一百四十四题虽究其归不出于己上十五题之法要亦不可不备使习者得以按题而索之逐类而通之也
　　勾股较勾股和　句股较句和　句股较股和句较句和　句较句股和　句较股和股较股和　股较句股和　股较句和已上共九题
　　【句】和和
　　较较　　　句较较　　　股较较
　　和较　　　句和较　　　股和较
　　较和　　　句较和　　　股较和
　　巳上十则各以　　　　　　　　　　　【股】三则配之得三十题
　　各以　　　　　　　　　　　　　【股和】三则配之得三十题
　　各以　　　　　　　　　　　　　【股较】三则配之得三十题
　　又巳上十则　　　　　　　　　　【股】和和为一则以下九则配之得九题较较为一则以下八则配之得八题句较较为一则以下七则配之得七题股较较为一则以下六则配之得六题和较为一则以下五则配之得五题句和较为一则以下四则配之得四题股和较为一则以下三则配之得三题较和为一则以下二则配之得二题句较和为一则以下一则配之得一题
　　已上共一百四十四题学者按题而索之逐类而通之要不出于前所列之十五题也
　　又一题【后十四题尽句股之变】
　　容方与余句求余股与余股求余句因得全句全股法曰方边自乗以余句除之得余股以余股除之得余句各以所得加方边因得全句全股
　　论曰乙丁方边也自乗得乙壬方
　　即壬丑矩【论详前十六题】故以己壬【即丙未余】
　　【句】除之得子壬【即甲丁余股】以子壬除之得己壬因以己壬加壬丁共已丁即句以子壬加壬未共子未即股又法曰以余句除方边【余句小于方邉】得数即用以乗方笾得余股或以方边除余股【余股大于方邉】得数即用以除方边得余句
　　论曰方边为余句余股连比例之中率以前率余句比中率方边则方边为几倍大即以中率方边比后率余股则余股亦必为几倍大又以后率余股比中率方邉
　　则方边为几倍小即以中率方边
　　比前率余句则余句亦必为几倍
　　小故得数者得其几倍大几倍小之数也大用乗小用除
　　又二题
　　余句余股求容方因得全句全股
　　法曰余句股相乗开方得方边各以余句股加之得全句股
　　论曰子壬即余股也己壬即余句
　　也丑壬矩即乙壬方也【论详前十六题】因
　　以甲丁【余股】丙未【余句】加之得全股【甲乙】全句【乙丙】
　　又法曰以余句除余股【以小除大】得数开方得中率之比例于是以中率之比例除余股得方边或以中率之比例乗余句亦得方邉
　　论曰余句余股之于方边为连比例之前后率今以己壬余句比子壬余股得子壬为几倍大即是以己壬线上方比己壬线与子壬线上矩得丑壬矩为几倍大也而丑壬矩又与乙壬方等开方得连比例之中率者以方则边等边等则比例连故也既得连比例之中率则方边可得而知矣
　　右两题宜附前十六题之后
　　又三题
　　句股形句股较求句股
　　法曰形四倍之另以较自乗相并开方得次依前四题法求句股
　　论曰甲乙丙形四倍之即丁已甲子午丁丙未子与甲乙丙四形也乙巳为句股较
　　乙午为较上方四形与一方相并成甲子方开方得甲丙
　　又法曰形八倍之另以较自乗相并开方得句股和于是和加较折半得股和减较折半得句论曰甲乙丙形八倍之即甲丙丙丁丁己己甲四矩形也乙子为句股较乙午
　　为较上方四矩形与一方并成丑未方开方得丑壬为句股和
　　又法曰形倍之以句股较用长濶相差法求之得句句加较得股
　　论曰甲乙丙句股形倍之得乙丁矩形甲乙股乙丙句已甲较即乙已与乙丙句等丙巳为句上方丁句为句与较矩内形今试商
　　得乙丙为句乙巳加已甲为股
　　又四题
　　句股形句股和求句股
　　法曰形四倍之另以句股和自乗相减开方得次依前七题法求句股
　　论曰甲乙丙形四倍之者甲乙丙丙戊丁丁己辛辛壬甲四形并也乙壬为句股和乙巳为和上方内减四形并余甲
　　辛丁丙方开方得甲丙
　　又法形八倍之另以句股和自乗相减开方得句股较于是用加和折半为股用减和折半为句
　　论曰甲乙丙形八倍之者即甲丙丙丁丁辛辛甲四矩形并也午戊为和戊壬为和上方内减四矩形并余子乙未丑
　　方开方得子乙为句股较
　　又法曰形倍之以句股和用长濶相和法求之得句句减和得股
　　论曰甲乙丙句股形倍之得乙巳
　　矩形甲乙股乙丙句并之为和今试
　　商得乙丙为句用减和余甲乙即股
　　又五题
　　句股形中求从直角【句股相联处】至作垂线【与相交为直角】分元形为两句股形
　　法曰上方句上方并之内减股上方余半之以除之得数为上作垂线之处于是以所得数与句依句求股法作垂线
　　论曰甲乙丙元形求从直角作乙午线为甲丙之垂线甲丙也甲丑上方也乙丙句也乙己句上方也
　　甲乙股也乙辛股上方也夫乙辛方中之子未方乙午
　　线上方也乙巳方中之丁申方亦
　　乙午线上方也即两方等矣又乙
　　辛方中之子辛未磬折形甲丑方
　　中之午壬方也今于甲丑乙巳两
　　方中减乙辛方即于两方中减丁申方与午壬方也两方中所存者为申巳丁磬折形午丑壬磬折形矣而申巳丁磬折形又与丑卯方等半之即得午丑矩故以丙丑除之得丙午【若乙辛方与甲丑方并内减乙巳方余半之以除之得甲午同上论按此法不但可施诸句股直角形凡鋭角钝角形俱可用此法求垂线】
　　又法曰句股相并得数相减得数两得数相乗以除之得数用减余半之得数为上作垂线之处
　　如图甲乙丙形甲乙股乙丙句相
　　加得甲丁相减得甲巳甲丁与甲
　　巳相乗得数以甲丙除之得甲
　　子用减余丙子半之于午即午防为上作垂线之处一论曰甲丁偕甲已矩内形及乙巳上方形并与甲乙上方形等如图壬丁矩甲丁偕甲巳矩内形也【甲壬与甲巳等】辛甲未磬折形即壬丁矩也【壬未矩与辛丁矩等】未辛方
　　乙巳上方也并之得甲戊方即甲乙上方
　　二论丁已甲线贯圜心于乙庚甲线切圜周于庚乙庚甲为直角夫丁甲偕巳甲矩内形与甲庚线上方形等何则乙庚庚甲两线上方形与乙甲线上方等而丁甲
　　偕巳甲矩内形及乙已上方并亦与
　　乙甲线上方等【一论之图可见】此两率者每
　　减一相等之乙庚乙巳两线上方则
　　甲丁偕甲巳矩内形与甲庚线上方形必等
　　三论曰丙甲线不贯圜心于乙庚甲
　　线切圜周于庚乙庚甲直角形乙午
　　甲亦直角形两形合一乙甲则乙
　　庚庚甲两线上方并与乙午午甲两线上方并必等又乙午子直角形则乙午午子两线上方并与乙子线上方等夫午甲上方形中原有【一论之图可见】丙甲偕子甲矩内
　　形及午子上方形今于乙甲上方形
　　中减乙庚上方形即减去同乙庚之
　　乙子上方同乙子之乙午午子两线
　　上方然则所余之丙甲偕子甲矩形与甲庚上方形必等四论曰前甲丁偕甲巳矩内形与庚甲上方等【二论之图】甲丙偕甲子矩内形与庚甲上方亦等【三论之图】则两矩形自
　　相等而等角防之各两边彼此互相
　　视何则试引戊子壬己两线相遇于
　　丑而成甲丑形夫甲戊与甲丑两形
　　同在戊丑丙己两平行线内等髙则两形之比例若其底甲丙与甲己之比例依显甲壬与甲丑两形之比例亦若其底甲丁与甲子之比例夫甲戊与甲壬两矩形元等则甲戊形与甲丑形即甲壬形与甲丑形也即甲丙与甲己之比例亦即甲丁与甲子之比例也更之则甲丙与甲丁之比例亦若甲己与甲子之比例
　　于是以甲丙为一率甲丁为二率
　　甲己为三率二三率相乗一率除
　　之得四率甲子也既得甲子用减
　　甲丙余丙子半之于午得午防为上作垂线之处何则试作乙子线与乙丙同为圜之半径即等而成乙丙子两边等角形则午点折丙子之半必是直角【此法不但可施诸句股形凡鋭角钝角形俱可用此法求垂线】
　　右既得乙午垂线即分甲乙丙原形为甲午乙乙午丙两句股形此两形者自相似亦与元形相似
　　又六题
　　句股形中求依一边容方
　　法曰先依又五题法求形中垂线次以与垂线相乗得数并与垂线为法除之得方边
　　论曰甲乙丙元形乙丁为垂线求依甲乙作方边如子丑而成子午方形夫甲乙丙元形与己乙午分形相似何则以己午与甲丙平行故也次观己午与未丁等即乙未
　　与己午并是乙丁垂线也然则乙丁偕甲丙并而与甲丙若乙未偕己午并【即乙丁垂线】而与己午
　　又法曰垂线自乗并与垂线为法除之得数用减垂线得方边
　　论曰乙丁偕甲丙并【一率】而与乙丁【二率】若乙未偕己午并【三率即乙丁】而与乙未【四率】于是以乙未减乙丁余未丁即方边【此法不但可施诸句股形凡鋭角钝角形俱可用】
　　又七题
　　句股形中求分作两边等三角形二
　　法曰半之即是两边等之一边
　　论曰甲乙丙形半于丁于是以丁为心甲丙为界作圜必切乙角得乙丁与
　　半等因成乙甲丁乙丙丁两形皆两边等三角形也
　　又八题
　　斜三角形中求作中垂线分元形为两句股形
　　法具又五题
　　又九题
　　斜三角形中求积
　　先分别是锐角形或是钝角形【若是正角形法以句股相乗半之即得】法曰大中小三边用小中两边依句股求法求之若求得数小于大边即是鋭角形大则是钝角形
　　鋭角形求积法曰任取一角依又五题求中垂线【鋭角形求中垂线任取一角皆在形内】分元形为两句股形次以两分形句与股各相乗半之得积
　　论曰甲乙丙鋭角形先求得乙丁中垂线分为甲丁乙乙丁丙两句股形次以
　　甲丁与丁乙丁乙与丁丙各相乗得丁戊与丁己两矩形各半之得甲乙丙形之积【或以乙丁因甲丙之半亦得或以甲丙因乙丁之半亦得】钝角形求积法【于钝角至对边作垂线则垂线在形内法同前】于鋭角至对边作垂线则垂线在形外而引对边出形外凑之曰大边上方内减中小两边上方余半之以中边除之得引凑数与小边为股求句得垂线【或以小邉除半数得引凑数与中邉为句求股亦得垂线】既得垂线则与引凑数凑成一小句股形又以垂线与引凑数偕元形之边凑成一大句股形大小两句股形相减得所求
　　论曰甲乙丙钝角形【乙为钝角】求从丙鋭角作丙丁垂线而引乙丁线以凑之【从甲角作垂线亦在形外兹不备述】夫甲丙上方元包
　　丙丁与甲丁两边上方今于甲丙上
　　大方中减乙甲乙丙上两方即是减
　　丙庚与子午两方为乙丙上方减甲
　　子方为甲乙上方也而所存者为丁
　　子子辛两矩形矣半之为子丁一矩
　　形以中边乙子除之得乙丁为引数
　　也丙丁乙为小句股形丙丁甲为大
　　句股形两形相减得甲乙丙斜三角形积
　　又法曰三边数并而半之以每边数各减之得三较数三较连乗【任以二较相乗得数又以一较乗之】得数又以半数乗之得数开方得积
　　如后图甲乙丙元形求其积
　　一图　　　　　　　　一论曰壬乙矩形与元形等
　　论同前十七题所论乙亥矩
　　形与甲乙丙元形等
　　二论曰丁心方与乙戊相乗又与乙戊相乗开方与乙
　　二图　　　　　　壬矩形等如图子壬二丑壬三相
　　乗得六为子丑矩形今以子壬二
　　自乗得四为子卯方即壬寅边以
　　丑壬三乗之得十二为丑寅矩形又以三乗之得三十六为辰寅矩形即午丑方形故开方得辰午六与子丑
　　三图　　　　矩形等
　　三论曰丁心偕戊庚矩形与乙丁相乗其所得数与丁心方偕乙戊相乗所得
　　数等何则乙丁心形与乙戊庚形相似之形也戊庚与丁心若乙戊与乙丁则戊庚偕丁心矩形【即庚未矩形】与丁心方【即己戊方形】亦若乙戊与乙丁也
　　四论曰丙丁偕丙戊矩形与丁心偕戊庚矩形等【就一图观之】何则心丁丙形与丙戊庚形相似之形也夫庚乙线平分丁乙甲角庚戊为丙戊之垂线则戊为直角次依丙戊线截取丙卯线作卯庚线为丙卯之垂线则卯为直角此庚乙庚戊庚卯三线必相交于庚防三线既相
　　交于庚点则丙庚线必平分
　　卯丙戊角而卯丙戊角又即
　　己心丁角因得心丁丙形与
　　丙戊庚形为相似之形也两形既相似则丁心与丁丙若丙戊与戊庚也
　　解庚乙庚卯庚戊三线必相交于庚点所以然之故庚心乙界作圈　次依甲乙丙形作丙丁辛形　次引乙丁线至癸引辛甲线至壬乙庚线平分丙乙甲角则
　　庚防必是圈心戊防折乙癸线之
　　半则戊防必直角　卯防折壬辛
　　线之半则卯防必直角　乙癸与
　　乙己等　乙丙辛丙为大边甲丙
　　丁丙为中边甲壬丁癸即小边
　　总论曰二论丁心方与乙戊相乗又与乙戊相乗所得数开方与乙壬矩形等夫乙戊半数也亦既得之矣次欲求丁心与乙戊相乗而丁心不可得　三论丁心戊庚矩形与乙丁相乗所得数与丁心方偕乙戊相乗所得数等夫乙丁三较之一也则又得之矣次欲求丁心与戊庚两线而两线又不可得　四论丁丙偕丙戊矩形与丁心偕戊庚矩形等夫丁丙丙戊三较之二也则尽得之矣　今法于四论用丁丙偕丙戊二较相乗于三论用乙丁一较乗之于二论用乙戊半数乗之开方得数与乙壬矩形等
　　又十题
　　斜三角形中求容圆
　　法曰先依又九题求积次取三边数并而半之用除积得员之半径【或置二较连乗数以半数除之得开方亦得圆半径】
　　论曰先依又九题求得乙壬矩
　　形为甲乙丙元形积次以乙戊
　　除之【即三边数之半也】得丁心即圆之半径【若以三边之全除元形之倍亦得圆半径若以三边之全除元形之四倍得圆全径】
　　又十一题
　　斜三角形中求容方
　　法同又六题
　　又十二题
　　斜三角形有三和数求三边
　　法曰三和数相减得三较数各置三较数各以非所较之边加减之各半之其加而半者得大边或中边减而半者得小边或中边
　　如图戊己庚为三和数【戊为大中两和数己为大小两和数庚为小中两和数】甲为戊庚两和之较乙为己庚两和之较丙为戊己两和之较于是置甲较数以己为非所较之边加而半之得大边减而半之得小边置乙较数以戊为非所较之边加而半之得大边减而
　　半之得中边置丙较数以庚为非所较之边加而半之得中边减而半之得小边
　　论曰戊者大中两和数也加减用乙者乙为己庚两和之较庚者小中两和数己者大小两和数此两和数中皆有相等之小数而余为大中两数矣此乙所以爲大中两数之较也余仿此
　　又十三题
　　句股测髙【测逺测广测深同法】
　　法曰先准地平【地平者必令所测地面自所测之处至髙之根如水之平也】次立表与地平为垂线退后立望竿令所测髙表尖竿头叅相直末自竿至髙根量得若干逺然后以表竿差与逺相乗而以表竿相去若干除之加竿长若干得所求之髙如图丙乙髙乙甲逺丁甲竿己戊表己子为表竿差戊甲为表竿相去夫丁子己形与丁辛丙形相似故丁子与己子若丁辛
　　与丙辛也
　　又十四题
　　句股重测髙逺【测广测深同法】
　　法曰若无髙根之可量者则用重测法谓一次立表竿令表竿与髙叅相直二次立表竿令表竿与髙防相直【两表两竿要各相等又要或前或后立成一直线】然后以表竿之较乗两表相去而以两表竿相去之较除之加表髙若干得所求之髙又以前表竿相去乗两表相去而以两表竿相去之较除之加前表竿相去得所求之逺
　　如图甲乙髙乙丙逺各不知数用重
　　表测之　丁子为前表己丙为望竿
　　子丙为表竿相去甲丁己三防叅相
　　直午壬为后表丑辛为望竿壬辛为
　　表竿相去甲午丑三防叅相直丁亥为表竿之较子壬为两表相去未辛为两表竿相去之较己上用以测髙借丁卯【元是表竿相去】为表竿相差借卯己【元是表竿相差】为表竿
　　相去辰戊亦借为表竿相差戊癸亦借为表竿相去甲辰癸三防亦叅相直丁辰亦借为两表相去与丁午等即庚癸亦为两表竿相去之较与辛未等以上用以测逺解庚癸线与辛未线必等所以然之故
　　如图甲乙矩内形甲乙为对角线丙丁及戊己两线与
　　矩形之边为平行而交角线
　　于庚　次任作辛壬线亦交
　　角线于庚　次截甲癸线与
　　甲辛线等作癸子线亦交角
　　线于庚则子乙线与壬乙线必等
　　论曰试作午丑及午未两线与甲辛及甲癸相线为平行夫庚甲辛及庚午丑两角形相似之形也则庚甲与庚午若甲辛与午丑依显庚甲与庚午若甲癸与午未然则甲辛与甲癸亦若午丑与午未夫午丑与午未如是则子乙与乙壬亦如是矣
　　先论甲乙矩形此形甲己为对角线寅卯申亥两线交于角线上之丁防则卯申矩形与亥寅矩形等
　　次论甲丑矩形此形甲丑为对角
　　线寅酉房壬两线交于角线之午
　　点则房酉矩形与寅心矩形等
　　末总论曰夫房酉矩形与寅心矩
　　形既等而午井形又与卯申形等即亦与亥寅形等然则房酉矩形中所余之井酉形与寅心矩形中所余之丁心形必等
　　于是以丁亥表竿相差乗丁午两表相去得丁心矩形即井酉形而以井女两表竿相去之较除之得女酉加酉辛表共女辛即甲乙髙
　　先论甲己矩形同前
　　次论甲癸矩形此形甲癸为对角线申氐戊亢两线交于角线之辰防则亢氐矩形与戊申矩形等
　　末总论曰夫亢氐矩形与戊申矩形既等而辰牛形又与亥寅形等即亦与卯申形等然则亢氐矩形中所余之牛氐形与戊申矩形中所余之丁戊形必等
　　于是以丁卯表竿相差乗丁辰两表相去得丁戊矩形即牛氐形而以牛危两表竿相去之较除之得危氐加氐癸表竿差共危癸即乙丙逺也
　　求髙又法　既得危氐线即以亢牛乗之得牛辰形此形即寅亥矩形亦即申卯矩形也故以丁卯除之得丁申髙
　　求逺又法　既得女酉线即以房井乗之得井午矩形此形即申夘矩形亦即寅亥矩形也故以丁亥除之得丁寅逺










　　歴算全书卷四十六
　　钦定四库全书
　　厯算全书卷四十七
　　宣城梅文鼎撰
　　句股阐微卷二
　　句股积求句股句股积与较较求诸数
　　第一法
　　假如句股积【一百二十】较较【十二】
　　法以积四之得【四百八十】较较自之【一百四十四】两数相减余【三百三十六】折半【一百六十八】为实较较【十二】为法除之得句股较【十四】以加较较【十二】共得【二十六】为【有有句股较即诸数可求】论曰甲乙丙丁合形为自乗大方幂甲小方为句股较幂幂内减句股较幂所余丙乙丁磬折形原与四
　　句股积等于中又减去乙小方
　　为较较自乗幂仍余丁丙二
　　长方并以句股较为其长以
　　较较为其濶故折半而用其一
　　为实以较较为法除之得句股较矣【是以濶求长】
　　第二法
　　置四句股积【四百八十】与较较自幂【一百四十四】相加得共【六百二十四】折半【三百十二】为实较较【十二】为法除之得【二十六】为内减去较【十二】得余【十四】为句股较
　　论曰乙丙丁磬折形原与四句股积等今加一小方形如己为较自乗幂与乙等又丁丙二长方原相等于是合丁己为一长方合乙丙为一长方必亦相等矣【并以
　　较较为濶以为长】故折半而用其一
　　为实以较较为法除之即得
　　矣【亦是以濶求长】

　　第三法
　　置四句股积【四百八十】为实较较【十二】为法除之得【四十】为较和以较较【十二】加较和四十得【五十二】折半【二十六】为以较较【十二】减较和【四十】得【二十八】折半【十四】为句股较于前图乙丙丁磬折形即四句股积移丁长方置于戊
　　为乙丙戊长方其长如
　　较和其阔如较较故以
　　较较除之得较和【若以
　　较和除之亦得较较】
　　又简法
　　置句股积【一百二十】为实以较较【十二】半之得【六】为法除之得【二十】为半较和以半较较【六】加半较和【二十】得【二十六】为又以半较【六】减半和【二十】得【十四】为句股较
　　论曰长方形濶【十二】如较较长【四十】如较和其积如四
　　句股今只用一句股积是四
　　之一也积四之一者其边必
　　半观图自明
　　句股积与较和求诸数
　　第一法
　　假如句股积【一百二十】较和【四十】
　　法以积四之得四百八十较和自之得【一千六百】两数相减余【一千一百二十】折半得【五百六十】为实较和【四十】为法除之得【十四】为句股较以减较和得【二十六】为自乗【六百七十六】加四句股积【四百八十】得【一千一百五十六】平方开之得【三十四】为句股和以与句股较【十四】相加得【四十八】折半【二十四】为股又相减得【二十】折半得【一十】为句
　　句【一十】　　　股【二十四】　　【二十六】
　　句股和【三十四】　句股较【十四】　较和【四十】
　　较较【十二】
　　论曰总方为较和【四十】自乗
　　之幂内分甲戊己方为自
　　乗幂乙小方为句股较自乗
　　幂于幂内减去戊己磬折
　　形即四句股积则所余者甲
　　小方即句股较幂与乙方等以甲小方合丁长方即与乙丙长方等【以丁丙小长方原相等故】此二长方并以句股较【十四】为濶以较和为长【四十】故折半而用其一为实较和【四十】为法除之即得句股较【是为以长求濶】
　　第二法
　　较和自乗【一千六百】与四句股积【四百八十】两数相加【二千○八十】折半【一千○四十】为实较和【四十】为法除之得【二十六】为以减较和得【十四】为句股较余如前【观后图自明】
　　第三法
　　置四句股积【四百八十】为实较和【四十】为法除之得【十二】为较较余同较较第三法
　　又简法
　　句股积【一百二十】为实较和【四十】半之得【二十】为法除之得【六】为较较之半余并同较较简法
　　论曰乙丁丙甲戊己合形为
　　较和【四十】自乗之大方外加一庚
　　辛长方为四句股积与戊己磬
　　折形等于是中分之为两长方
　　【乙丁庚辛合为左长方丙甲己戊合为右长方】并以为濶【二十六】较和【四十】为长故折半为实以较和除之得【亦为以长求濶】借此图可解第三法之理何则庚辛长方形既为四句股积而其濶【十二】如较较其长【四十】如较和是【十二】与【四十】相乗之积也故以较较除之得较和若以较和除之即复得较较
　　若庚辛长方横直皆均剖之成四小长方则其濶皆【六】加半较其长【二十】如半和而其积皆【一百二十】为一句股积矣此又简法之理也
　　句股积与和较求诸数
　　第一法
　　假如句股积【六千七百五十】和较【六十】
　　法以和较自之得【三千六百】与四句股积【二万七千】相减余【二万三千四百】折半【一万一千七百】为实和较【六十】为法除之得【一百九十五】为加较【六十】得句股和【二百五十五】幂内减四句股积开方得句股较以加句股和折半得股以减句股和折半得句
　　句【七十五】　　　股【一百八十】　　【一百九十五】句股和【二百五十五】　句股较【百○五】　和和【四百五十】较和【三百】　　和较【六十】　　较较【九十】第二法
　　以和较自乗【三千六百】与四句股积【二万七千】相加得【三万○六百】折半【一万五千三百】为实和较【六十】为法除之得【二百五十五】为句股和内减和较【六十】得【一百九十五】为
　　论曰丁丙方为句股和自乗方幂
　　内减甲戊方为自乗幂其余丁
　　戊丙磬折形四句股积也内减戊
　　乙小方为和较自乗积则所余
　　丁戊长方与戊丙长方等而并以
　　为长和较为濶故以和较除之得此第一法减四句股积之理也
　　若于丁戊丙乙磬折形外加一己丙小方与戊乙等乃并之为庚戊长方与辛乙等并以句股和为长和较为濶此第二法加四积之理也【两法并以濶求长】
　　第三法
　　置四句股积【二万七千】为实和较【六十】除之得【四百五十】为和和以与和较相加折半为句股和又相减折半为此如有句股积有容圆径而求句股乃还元之法也
　　论曰前图中辛乙长方并戊丙
　　长方是四句股积联之为辛丙
　　长方则其濶丁辛和较也其长丁丙和和也
　　又简法
　　置句股积【六千七百五十】为实半和较【三十】除之得【二百二十五】为半和和以与半和较相加得二百五十五为句股和又相减得【一百九十五】为　此如有容圆半径以除句股积而得半和和句股积与和和求诸数
　　第一法
　　假如句股积【六千七百五十】和和【四百五十】
　　法以积四之得【二万七千】和和自之得【二十○万二千五百】两数相减余【十七万五千五百】折半【八万七千七百五十】为实和和【四百五十】为法除之得【一百九十五】为以减和和得【二百五十五】为句股和
　　第二法
　　以四句股积与和和幂两数相加得【二十二万九千五百】折半得【十一万四千七百五十】为实和和【四百五十】为法除之得【二百五十五】为句股和以减和和得【一百九十五】为
　　论曰甲乙大方和和自乗也内分甲丁方自乗也
　　与丁丙方等丁乙方句股和
　　自乗也于丁乙内减去丁丙
　　幂则所余者四句股积即
　　壬乙丙戊二小长方也而己
　　辛小长方与丙戊等则己乙
　　长方亦四句股积也今于甲乙大方内减去己乙则所余者甲戊己戊二长方并以为濶和和为长故以和和除之而得此第一法减四句股积之理也是为以长求濶
　　又论曰若于甲乙大方外増一甲庚长方与己乙等而中分之于癸戊则癸乙与癸庚两长方等并以句股和为濶和和为长故以和和除之而先得句股和此苐二法加四句股积之理也亦是以长求濶
　　第三法
　　置四句股积【二万七千】为实和和【四百五十】除之得和较【六十】此如并句股除四倍积而得容员径
　　又简法
　　置句股积【六千七百五十】为实半和和【二百二十五】除之得半和较【三十】此如合半句半股半除积得容员半径欲明加减用四句股之理当观古图
　　甲乙丙句股形　甲丙句六
　　甲乙股八　乙丙十
　　甲丁句股和十四　壬辛句
　　股较二甲己大方句股和自
　　乗幂也其积一百九十六　丙戊次方自乗幂也其积一百　壬庚小方句股较自乗幂也其积四　甲己和幂内减幂所余者四句股也　幂内减较幂所余者亦四句股也　句股之积并二十四
　　甲丁句股和十四癸丁十子丁句股较二甲丙方爲句股和自乗幂【一百九十六】内减癸辛幂【一百】余【九十六】爲甲己丙磬折形【亦卽四句股积】内分甲己直形移置于丙戊成乙戊长方卽爲【和较乗和和】又壬丁小方爲句股较自乗其幂四以减幂一百余九十六爲癸壬辛巳磬折形【亦卽
　　四句股积】内分癸壬直
　　形移置于辛庚成
　　己庚长方卽爲
　　较较乗较和
　　假如方环田有积有田之濶问内外方各若干
　　法以积四之一爲实田濶除之得数爲内外二方半和与田濶相加得外方又相减得内方【葢田濶卽如半较】若但知外方及内小方及环田积法即并大小方边为和以除积得数为较较与和相加折半为外周大方又相减折半为小方以两方之较折半为环田濶
　　若方田内有方墩法同或方墩不居正中其法亦同但只可求大小方边不能知濶
　　总论曰较较乗较和之积与和较乗和和之积等为四句股乃立法之根也而其理皆具古图中学者所宜深玩
　　又如有辛庚壬圆池不知其径法于乙作甲乙直线切员池于庚又乙丙横线切圆池于壬乙为正方角又自
　　丙望甲作斜线切员池于辛
　　乃自丙取乙丙之度截斜线
　　于丁又自甲取甲乙之度截
　　斜线于戊末但量丁戊有若
　　干尺即圆池径
　　解曰此即句股容员法也丙乙句截甲丙于丁则丁甲为句较甲乙股截于戊则戊丙为股较而丁戊为和较故即为圆径　其句股不必问其丈尺但取三直线并切员而乙为方角足矣故为测员简法【凡城堢墩台锥塔员柱之类形正员者并同一法也】
　　句股容方【系鲍燕翌法】
　　句股形引股线法
　　即依正角作方形于形外　又即引小形成大形甲乙丙句股形今欲引甲乙股至丁甲丙至戊而令
　　乙丁与戊丁等
　　法曰以乙丙分甲乙得数减一余
　　用归甲乙得之
　　解曰乙丙与甲乙原若丁戊与甲
　　丁故以乙丙分甲乙与以丁戊分甲丁所得之分数等然则减一者虽似于甲乙分数内减乙丙之一分实于甲丁分数内减丁戊之一分也【即乙丁之一分】故以减余分甲乙而得
　　【勿庵又法句股相乗为实句股较为法除之亦即得所引乙丁与乙戊同数】
　　句股形截股法
　　即依正角作方形于形内　又即截大形成小形甲丁戊句股形内今欲截甲丁股于乙甲戊于丙而
　　令乙丁与乙丙等
　　法曰以丁戊分甲丁得数加一共
　　用归甲丁得之　【勿庵又法句股相乗为实句股
　　和为法除之亦即得所截乙丁与丁丙同数即句股容方法】
　　解曰丁戊与甲丁原若乙丙与甲乙故以丁戊分甲丁与以乙丙分甲乙所得之分数等然则加一者虽似于甲丁分数外加丁戊之一分实于甲乙分数外加乙丙之一分也【即乙丁之一分】故以加共分甲丁而得
　　若欲令丙戊与丁戊等或欲令乙丙与丙戊等依法推之按后一法即句股容方也原法简易今鲍燕翼先生所设殊新要其理亦相通耳【勿庵补例】
　　设甲乙股十六　乙丙句八　今引甲乙股长出至丁
　　而令引出之乙丁股分与所当之丁
　　戊句等问若干答曰乙丁十六
　　法以乙丙句【八】甲乙股【十六】相乗得【一百】
　　【廿八】为实句股相减得较【八】为法除之得乙丁引出一十六与丁戊句相等　若如鲍法以句【八】除股【十六】得【二】内减去一仍余一用为法以除股【十六】仍得【十六】为乙丁又设甲乙股【四十八】乙丙句【十二】依法引出乙丁股【十六】与丁戊句等
　　法以句十二乗股【四十八】得积【五百
　　七十六】为实　句减股得较【三十六】为
　　法除之得【十六】为乙丁
　　或以句【十二】除股【四十八】得数【四】内减【一】余【三】为法以除股【四十八】亦得【十六】为乙丁
　　又设甲乙股【六】乙丙句【四】依法引出乙丁股【十二】与丁戊句等法以句乗股得【二十四】为实　句股较【二】为法除之得【十二】为乙丁
　　或以句【四】除股【六】得【一半】内减一余【半】为法以除股【六】
　　亦得【十二】为乙丁
　　解曰半为除法则得倍数此畸零除
　　法也详别卷
　　又设甲乙股【三十】乙丙句【十二】依法引出乙丁股【二十】与丁戊句等
　　法以句乗股得【三百六十】为实句股较【十八】为法除之得乙丁【二十】
　　或以句【十二】除股【三十】得【二半】内减
　　一余【一半】为法以除股【三十】亦得乙
　　丁【二十】
　　解两法相同所以然之故　葢此是依句股正角【即乙角】作正方形于形之外也本法以句较为法除句股形倍积【即句股相乗】今不用句股较之本数而用其除过之句股较为法【以句除股则股内所原带句数及句股较数并为句所除而减去其一即减去除过之句也用减余为法即是用其除过之句股较为法也】故亦不用句股形之倍积而用其除过之倍积为实【倍即是句股相乗之数若以句除之必仍得股今径以股数受除即是用其除过之倍积为实也】法实并为除过之数则其理相同而得数亦同矣
　　以上补第一条之例
　　设甲丁戊形甲丁股【廿八】丁戊句【廿一】甲戊【三十五】欲截甲
　　丁股于乙截甲戊于丙而令所截
　　之乙丁与乙丙等问其数若干
　　答曰乙丁一十二
　　法以甲丁股【二十八】丁戊句【二十一】相乗得【五百八十八】为实并句股得和【四十九】为法除之得【一十二】为所截乙丁与乙丙截句等
　　如鲍法以句【二十一】除股【二十八】得一【又三之一】又外加一数共二【又三之一】为法【通作七】用以除股二十八【通作八十四】亦得【十二】为乙丁截股
　　设甲丁股【三百四十五】丁戊句【一百八十四】甲戊【三百九十一】欲截乙丁与乙丙等该若干　答曰一百二十
　　法以句【一百八十四】股【三百四十五】相乗得【六万三千四百八十】为实句股和【五百二十九】为法除之得所截乙丁【一百二十】与截句乙丙等
　　或以句【一百八十四】除股【三百四十五】得一【又八之七】又外加一共二【又八之七】通作【二十三】为法以股【三百四十五】通作【二千七百六十】为实法除实亦得【一百二十】为乙丁截股
　　解两法相同所以然之故　葢此是依句股形正角作方形于内【即句股容方】也本法以句股和为法除句股形倍积【即句股相乗】今不用句股和本数而用其除过之句股和为法【股被句除既变为除过之股而得数中之一其本数皆与句同今于得数又加一是又加一除过之句合之则共为除过之句股和矣】故即用股为实以当除过之倍积法与实并为除过之数则其理相同而得数亦同矣以上补第二条之例
　　按数度衍有在逺测正方形之算立破句名色不穏图亦不真今于此第一例中生二法补之
　　分角线至对边【亦系鲍法】
　　甲乙丙句股形　今平分乙方角作乙丁线至对边欲知丁防之所在
　　法曰先依句股求方求得己丁戊乙正方形
　　次用丁戊丙形或丁己甲形求得丁丙或甲丁即得
　　甲乙丙句股形　今平分乙鋭角作线至甲丙股欲知丁防所在
　　法以甲丙股乙丙句相乗得丙庚长方亦即乙辛长斜
　　方其辛戊小长斜方又即戊壬长斜
　　方取甲子癸小句股形补壬寅丑虚
　　句股形成甲寅长方此即句股相乗
　　实以句和除之也【甲乙为乙壬即句】得壬寅边
　　丙甲辛句股形中【即甲乙丙原设形】作甲卯垂线至丙辛【法另具】于是一率甲卯二率甲辛三率甲子四率甲癸【即丁己】成丁己乙戊四斜方形
　　次用丁戊丙形或丁己甲形依句求股求得丁丙或丁甲即得
　　按上鲍法此寅甲长方为句和除句股形倍积所得壬寅边必小于句股容方之边其内容丁己乙戊四斜方形之丁己边又必大于句股容方之边二者之间可以得容方边矣【容方邉除倍积得句股和以减句和得股较即其他可知】
　　求丁己线法　一率甲丙股　二率甲乙　三率壬寅　四率丁己【即壬丑】
　　甲乙丙鋭角形　求分乙角作线至甲丙边之丁防
　　法于形中求得辰丙垂线【丙辛甲形即甲乙丙
　　形故其垂线等】用丙长线乗乙丙所得即辛
　　乙长斜方形自此以下至成丁己乙
　　戊四斜方【并同前法】
　　次用比例法　一率甲乙　二率甲丙　三率丁戊四率得丁丙
　　或一率甲乙　二率甲丙　三率甲己　四率甲丁甲乙丙钝角形　法先从形外求得甲辰外垂线　引乙丙线与之相遇　次以甲辰垂线乗乙丙得乙辛长
　　斜方形　余同前法

　　甲乙丙钝角形　甲辰垂线在形外
　　与右图同法
　　鼎按若依几何六卷三题法甚防
　　句股容员
　　甲乙丙句股形　求容员径卯戌【即丁辛】
　　法于甲丙上截丁丙如句【乙丙】又截甲辛如股【乙甲】因得丁辛即容员之径
　　试依所截丁丙为句作戊丁丙句股形【自丁作之垂线至戊又引乙丙句遇于戊即成此形】又依所截甲辛为股作甲辛氐句股形【自辛作之垂线长出至氐引甲乙股遇于氐】又作戊戌房句股形【引戊丁股至房如之度自房作垂线至戌即成】乃自甲自戊各为分角线遇于己成十字则己即容员心也又引十字线透出而以甲己为度截之于癸于女乃自癸作线与丙戊平行至辰又自女作
　　辛氐及房戊之垂线穿而
　　过之与癸辰线遇于辰又
　　引氐辛线至癸引房戌线
　　至女得女辰女房癸辰癸
　　氐四线皆如甲丙女卯
　　女亢癸丑癸未四线皆如
　　甲乙股卯辰房亢丑氐辰未四线皆如乙丙句又成女卯辰女亢房癸未辰癸丑氐四句股形共八句股形纵横相叠并以容员心己防为心此同心八句股形各线相交成正方形二其一卯戌丑乙形依原形之句股而立其乙方角即原形之所有也其一丁辛亢未形依原形之而立即所谓和较也此两形者皆相等而其方边并与容员径等即容员径上之方幂也
　　然则何以又为和较试即以原论之甲丙上所截之丁丙即句也甲辛即股也句股相并即重叠此丁辛一边是句股和多于之数古人以和较为容员径葢谓此也八句股形即有相等之八每一上各有此重叠之线以成两四方形相等之八边可以观矣【因鲍图改作之彼原有八角形外小句股形辏成一等面八角形之论但图欠明显】
　　相似两句股并求简法
　　假如癸辛己大形癸壬乙小形其癸角等则为相似之两句股形今欲求两形之两句合线【两句者一为己辛大句一为壬乙小句即辛甲也则己甲为两句合线】
　　法以两【一癸己大一癸乙小】并之为三率以癸角之正【两癸
　　角等只用其一】为二率二三相
　　乗为实半径全数为法
　　实如法而一得四率己
　　甲即【己辛壬乙】两句之合
　　数
　　何以知之曰试引癸己
　　至丁截己丁如癸乙则丁癸即两合数也乃以癸角之正乗之半径【全】除之即得丁丙而丁戊即壬乙【以己丁即癸乙也亦即甲辛】戊丙即己辛【同在直线限内也】则所得丁丙亦即己甲矣
　　有句股和有求句求股【量法】乙甲句股和　丙甲
　　原法以甲为心作乙己卯
　　象限　又以丙甲半之
　　于丁以丁为心作甲戊丙
　　半圆
　　次于丙戊半员上任以辛为心丙为界作丙己小员屡试之令小员正切象限如己乃作己辛甲及辛丙二线则辛丙为句辛甲为股如所求按此法不误但己防正切处难真今别立法求己防
　　法曰自丁防作垂线分半圆于戊以戊为心用丙为界作丙己庚丑甲全员全员与象限相割于己从己向甲作直线割半员于辛乃作辛丙为句即辛甲为股合问如此则径得辛防不用屡试得数既易且真确矣论曰凡平员内作两通至员径两端必为句股而员径常为今既以丙甲为半员径则其辛丙与辛甲两通必句与股也而己辛甲线与乙甲等即句股和也今以辛为心作小员而其边正切己则己辛与丙辛等为小员之半径即等为句线矣于己甲句股和内截己辛为句则辛甲必为股故此法不误也
　　又论曰半员内所容句股形以半方形为最大【即甲戊丙也其余皆半长方形之句股故小】其句股和亦最大【丙戊句甲戊股相等其和甲戊庚为最大其余股长者句反甚小故其和皆小于甲戊庚】即上方幂之斜径也【甲未庚丙为上平方幂甲戊庚为其斜径】以此为象限之半径【如辰庚亥象限其半径辰甲及亥甲并与庚戊甲等】则能容上平方【如甲未庚丙平方必在辰庚亥象限内】又戊心所作平方外切之平圆亦能容上平方【此员以戊为心以平方四角为界其全径甲戊庚即平方之斜径也】三者相切于庚防惟相切不相割其余句股和并小【如乙甲和必小于辰丙】不能包平方之角即不能外切平员而与之相割矣【如乙甲和为半径作乙己卯象限不能包庚防即与平员相割如己】其自庚至丙并可为相割之己防而四十五度之句股具焉【八线表所列之句股只四十五度互相为正余句为正股即余也分言正则初度小而九十度最大也若合正余为和数则初度与九十度皆最小惟四十五度最大】己足以尽句股之变态矣【若过庚向末亦四十五度己防至此其和数反小而与前四十五度为正余】句股和之最大者以略小于上斜线而止【凡句股有和有较皆长方形之半非正半方也若半方形则有和无较可无用算非句股所设】其最小者以稍大于线而止【若同线即无句股】无有不割平圆故可以己防取之也
　　又论曰以方斜为半径作象限则能容平方以方斜为半径作半圆则能容方斜上平圆【如庚己丙甲未平圆其径甲戊庚方斜是即方斜上之平圆也若以甲戊庚半径作大半圆即能容之】凡半圆内所容之圆度每以两度当外周半圆之一度何则论度必以角惟在心之角一度为一度若在边之角则两度为一度【如辰庚亥半圆从甲心出两线一至庚一至辰作辰甲庚角其度辰庚四十五度是一度为一度也若庚己丙甲未圆从甲边出两线一遇戊至庚一至丙作庚甲丙角其度庚己丙象限只作四十五度是两度当一度以同用甲角故也】凖此论之则上半圆所作之戊甲丙角亦必四十五度矣【既同用甲角则戊辛丙象限亦两度当一度】若是则庚己丙之度与
　　戊辛丙等【并同用甲角以庚辰为度故也】而
　　己防所割之己丙弧及辛丙
　　弧亦必等度矣【己丙为方外切员之度辛
　　丙为方内切员之度大小不同而同用甲角以己乙为其
　　度角等者度亦等】
　　又引辛丙至寅则寅丑甲与辛戊甲两弧亦必等度【以同用丙角故也】而同为甲角之余【丙角原为甲角之余乃甲角减象限是以己甲乙减象限得己甲卯角与辛丙甲角等也其度则两度为一度乃甲角之倍度减半周是以寅庚减半周得寅丑甲以丙辛弧减半周得辛戊甲也】又己庚丑未弧原为己丙减半周之余即与寅丑甲等于此两弧内各减寅丑未则己庚寅与未癸甲亦等于是作己寅线与未甲等亦即与丙甲等而寅己丙与甲丙己又等【于寅己及甲己各加一己丙】则丙辛寅及己辛甲两直线亦等【皆句股和也】两和线相交于辛则交角等【皆十字正角】
　　又作己丙线成己辛丙三角形而己角丙角等【己甲丙三角形与己寅丙等则对丙甲之己角对己寅之丙角亦等】则角所对己辛边丙辛边亦等矣　凖上论己辛与丙辛必等故用己防以求辛防而和数中句股可分也
　　又论曰凡句股和所作象限与斜方上平员相割有二防其一为己其一为丑自丑作直线至甲心【象限心也】割半员于壬作丙壬线即成丙壬甲句股形与甲辛丙等【丑甲丙角为丙甲壬角之余与壬丙甲角等而其度丑卯与己乙等是丙甲辛角与壬丙甲等也辛壬又皆正角又同以丙甲为是两句股形等也】凖此论之凡半员内所作句股皆两两相似【句股之正角必负员周亦两两相对如辛防在戊丙象限内即有壬防在戊甲象限与之相对皆与象限上己防丑相应其所作句股形亦两相似】故四十五度能尽句股之变也【戊丙与戊甲两象限并两度当一度其真度在庚辰及庚亥两半象限中故皆四十五度】试以壬为心丑为界作员界必过丙是丙壬股即丑壬而丑甲为和也丑壬股大于戊丙而丑甲和小于庚甲以是知和数之大至庚甲而极也
　　凖上论又足以证己庚丑癸员能尽割员句股之理


　　句股和较
　　与句股较【相和即　加句即　减股即　内减存较和　股和　句较　句股较相较即　减句即　加股即　用减存较较　股较　句和　句股较】
　　与句股和【相和即　减即　减股即　减句即和和　句股和　句和　股和相较即　加句　加股　加句较股和较　较即股　较即句　较即】
　　与句较相和　　【加句即　减句即两　减即两　　句较　　句较】
　　相较【即句】
　　句与股较【相和即　加句股　　减股　加句较减句较和　较即　　较即句　股较即股相较即　加句股较股　加股　加句股较股句较较　较即股　　较即句　较较即】
　　句与股和【相和即　减即　减股即　减句即句和和　句股和　句和　股和
　　相较即　减股即　减即　加句即句和较　句较　句股较　股和】
　　句与句股较【相和即股】
　　相较　　【加句股　加两句股较即句　较即股】
　　句与句股和相和
　　相较【即　减股即　加股即两股　两句　　句股和】
　　句与句较相和【即】
　　相较　【加句　加两句较即句　较即】
　　句与句和相和
　　相较【即】
　　句股较句较【相较即股较】　　句股较股较【相较即句和内减两句又两股较
　　相和即股　　　　　　相和即和内减两句　　　　　　句较】
　　句较股较【相较即句股较】
　　【相和即两内减一句一股】
　　句股和句和【相较即股较】　　句股和股和【相较即句较
　　相和即两句　　　　　　　相和即两股一股一　　　　　　　　一句一】
　　句和股和【相较即句股较】
　　【相和即两一句一股】
　　句股较与【句股】和【相和即两股】　句股较与【句】和【相和即股和】　句股较与股和相和
　　【相较即　　　　　　　　　　　　　　　　　相较即两句　　　　　　　　　　　　　　　　　　句和】
　　句较句和【相和即两】　句较与【句股】和【相和即股和】　句较与股和相和
　　【相较即两句】　　　　　　　相较　　　　　　　　【相较即句股和】
　　和较和和【相和半之为句股和】　和较较和【相和半之为股
　　相较半　　　　　　　　相较半之之为　　　　　　　　为句较】
　　和较较较【相和半之为句】　　和较句较和【相和半之为句
　　相较半之　　　　　　　相较半之为股较　　　　　　　为股较】
　　和较句和较【相和半之为句】　　和较句较较【相和半之仍为和较
　　相较半之为股较】　　　　　　　相较即减尽
　　和和较和【相和半之为股和】　和和较较【相和半之为句和
　　相较半之为句】　　　　　　　　相较【半之为股】
　　和和句较和【相和半之为句和】　和和句和较【相和半之即股和
　　相较半之为股】　　　　　　　　相较【半之为句】
　　和和句较较【相和半之即句股和】　较和较较【相和半之为
　　相较半　　　　　　　　相较半之之为　　　　　　　　为句股较】
　　较和句较和【相和半之为】　　较和句和较【相和半之为股与句较或与句股较】
　　【相较半之为句股较】　　　　　　　相较恰尽
　　较和句较较【相和半之为股】　　较较句较和【相和半之为句与股较
　　相较半之为句较】　　　　　　　相较恰尽
　　较较句和较【相和半之为】　　较较句较较【相和半之为句
　　相较半之　　　　　　相较半之为句股较　　　　　　为股较】
　　句较和句和较【相和半之为】　句较和句较较【相和半之为句
　　相较半之　　　　　　相较半之为句股较　　　　　　为股较】
　　句和较句较较【相和半之为股】
　　【相较半之为句较】










　　厯算全书卷四十七
　　钦定四库全书
　　厯算全书卷四十八
　　宣城梅文鼎撰
　　句股阐微卷三
　　句股法解几何原本之根
　　句股羃与羃相等图
　　甲乙丙句股形　乙辛大方为羃　羃内兼有句股二羃
　　论曰试于羃作对角之乙
　　子线与甲丙股平行而等又
　　作丙丁对角线与甲乙句平
　　行与乙子线遇于子成十字
　　正角则丙子与甲乙句相等
　　成乙子丙句股形与甲乙丙句股形等又作辛癸及庚戊两线皆与丙丁等亦与乙子等而皆与甲丙股等又辛丁及癸庚及戊乙皆与丙子等即皆与甲乙句等则幂内所作四句股形皆与原设句股形等于是以丙丁辛形移作乙壬庚以癸庚辛形移作甲乙丙成甲丙
　　丁癸庚壬磬折形末引丁癸
　　至巳截成大小二方形则丙
　　巳方形即股幂癸壬小方即
　　句幂也
　　若先有丙巳股幂癸壬句幂
　　则联为磬折形而移乙壬庚
　　句股补于丙丁辛之位移甲乙丙句股补于癸庚辛之位即复成乙辛大方而为幂
　　又法
　　甲乙丙句股形　乙丙　其幂乙戊丁丙
　　甲丙股其幂甲壬辛丙　甲乙句其幂乙庚癸甲法于原形之甲正角作十字线分幂为两长方【一为丑子丁丙】凖股幂【一为丑子戊乙】凖句幂又引之至己又自庚癸自壬辛并引之至巳而成方角
　　次移甲丑丙句股补巳子丁虚形又移巳壬甲句股补丁辛丙虚形即成股幂而与丑子丁丙长方等积又移甲丑乙句股补己子戊虚形再移己卯戊句股补戊癸寅虚形又移戊卯甲癸形补癸寅乙庚虚形即成句幂而与丑子戊乙等积











　　解几何二卷第五题　第六题
　　甲丙为　丁丙为句
　　丁甲句和　乙丁句
　　较【丁甲同丁壬甲癸并同】
　　庚辛戊己幂也　己句
　　幂也　戊庚辛较乗和之
　　长方幂也
　　移戊补戊移庚辛补庚辛而幂内净多一己形即句幂也故幂内有和较相乗之长方又有句幂也论曰凡大小方形相减则其余必为两形边和较相乗之长方是故己形者句自乗之小方也戊庚辛句较乗句和之长方也合之成戊庚辛巳形即自乗之大方矣
　　几何二卷第五题以倍为甲乙原线以甲丙为平分之线以甲丁和乙丁较为任分之两线以丁丙句为分内线其理一也
　　第六题以子丁倍句为原线以丁丙句为平分线以句较乙丁【即子甲】为引増线以丁甲句和为全线其理亦同
　　以数明之　甲丙八　丁丙句五　乙丁较三　丁甲和十三　和较相乗三十九　句自乗二十五　以句幂加和较长方共六十四与甲丙幂等
　　又论曰用股和较亦同









　　解几何二卷第七题
　　甲丁股幂【即甲乙元线上方】子戊
　　句幂【即甲乙方内所作已辛方乃任分线甲丙
　　上方也】并之成癸寅幂【即所
　　谓两直角方形并也】
　　幂内有戊甲股【即甲乙原线】戊癸句【即任分之甲丙线】相乗长
　　方形二【即己甲长方及丁辛长方亦即甲乙偕甲丙矩形二也】及句股较乙丙上方一【即壬丙小方亦即所谓分余线上方也】
　　何以明之曰试于戊癸线引长至丑令丑癸如已丁较【即乙丙】遂作子丑小长方【与丁庚等】以益亥癸成亥丑长方【与丁辛等亦与已甲等】
　　次于癸寅内作甲酉寅辰午未癸卯四线皆与甲乙股等　自然有甲卯寅酉午辰癸未四线皆与戊癸句等又自有未卯卯酉等句股较与乙丙较等　即显
　　幂内有句股形四较幂一也
　　试于鼏内移午辰寅句股补癸戊甲之位成戊卯长方【与己甲等】又移癸未午句股补甲戌寅之位成戌酉长方【与亥丑等】而较幂未酉小方元与壬丙等又子丑小长方元与丁庚等
　　合而观之岂非丁甲股幂及子戊句幂并即与己甲亥丑两长方及壬丙小方等积乎










　　解几何二卷第八题
　　庚甲乙句股形　取丁乙如
　　庚甲句则丁甲为句股和
　　和之幂为丁己大方【即元线甲乙偕
　　初分线上直角方也】于大方周线取戊
　　丑己子皆与庚甲句等即丑
　　丁戊子己庚皆与甲乙股等【即甲乙元线也句线则初分线】
　　次作丑癸庚辛乙壬子卯四线皆与外周四股线平行而等
　　自有丑壬子癸庚卯乙辛四线皆与外周四句线平行而等
　　又有壬癸癸卯卯辛辛壬四句股较线自相等【即分余线也】丁已和幂内有长方形四皆句乗股之积【即元线偕初分线矩内形四也】又有句股较自乗幂一即分余线上方形也


　　解几何二卷第九题
　　甲丙为股　丁丙为句
　　丁甲句股和　乙丁句股
　　较　壬庚为句幂　辛丙
　　为股幂　丑丁较幂　丁
　　癸和幂　戊巳线上方为
　　句幂之倍　戊甲上方为
　　斜线上方倍于元方图　　股幂之倍并和较幂倍大于句幂股幂之并古法倍幂内减句股和幂开方得较若减较幂亦开方得和即其理也
　　论曰己丁较上方与丁
　　甲和上方并之即己甲
　　上方也戊巳线上方与
　　戊甲线上方并亦即巳
　　甲上方也　而戊巳为句幂斜线戊甲为股幂斜线凡斜线上方形倍于原方故较幂并和幂亦倍大于句幂股幂之并也而句幂股幂并之即幂古人所以用倍幂也
　　此第十题与前题同法　甲
　　丙即句　丁丙即股　丁甲
　　全线即和　丁乙引増线即
　　较
　　准前论丁庚【即丁乙】较上方幂与丁甲和上方幂并成庚甲线上幂而庚甲幂内原兼有丙丁股【即巳戊亦即己庚】及丙甲句二幂【己壬为股幂辛丙为句幂】之倍数【庚戊为股斜线其幂必倍于股幂戊甲为句斜线其幂必倍于句幂】故庚甲幂内能兼戊庚及戊甲二幂
　　丙丙线皆也丙丙方幂
　　也甲丙之长者皆股也【亦即丙丁
　　丁】甲丙之短者皆句也【亦即丙丁】丁丁线句股较也丁丁小方
　　较幂也甲丙甲句股和也甲甲大方和幂也
　　丁甲长方皆句股相乗即倍句股形积也
　　合而观之则幂内有句股积四及较幂一也和幂内有句股积八及较幂一也　若倍幂则有句股积八及较幂二也故以和幂减倍幂得较幂　若以较幂减之亦得和幂矣












　　以句股法解理分中末线之根
　　即几何二卷第十一题　六卷第三十题四卷第十第十一题
　　古法句较　　　　　癸庚　其鼏庚乙　丙癸
　　乘句和开　　　　　句　其鼏丙戊
　　方得股之图　　　　　引庚甲至壬使甲壬如丙
　　癸句则庚壬为句和丙庚
　　原为句较　以较乗和成
　　丙壬长方　长方内截甲丁
　　小长方与戊辛等　其余庚辛
　　合而观之是鼏内兼有句较乗和之积及句鼏也
　　夫鼏内原有句股二鼏而今以句较乗和之积可代股鼏是句较乗和即同股鼏也
　　句和及股　　　　用法
　　及句较为　　　　有句和　有句较
　　连比例图　　　　　求股法以较乗和开方得股
　　或有股有句和求句求
　　法以股自乗为实以句
　　和除之得较以较减和
　　半之得句句加较得若
　　先有较以除股鼏亦得和矣
　　如图　丙戊丁句股形　丙丁与丁乙等【亦与丁庚等】丁戊句　亥戊为倍句　乙戊为句较与庚亥等戊庚为句和与亥乙等
　　亥巳为句股和乗句较之
　　积与戊癸等
　　丙戊股　其方鼏甲丙
　　准前论甲丙方与亥巳长方
　　等积【戊癸亦同】则庚戊和与丙戊股若丙戊股与戊乙较也一　句和　庚戊
　　二　股　　　丙戊
　　三　股　　　丙戊
　　四　句较　戊乙
　　以戊乙较减亥乙和余亥戊倍句折半为句【丁戊或丁亥】或戊乙较与丙戊股若丙戊股与庚戊和也
　　一　句股较　戊乙
　　二　股　　　丙戊
　　三　股　　　丙戊
　　四　句股和　庚戊
　　又论曰以二图合观之凡倍句加句较即句和以倍句减句和余即句较
　　此不论句小股大如前图或句大股小如后图并同此可以明倍句与句较必为句和之两分线故以句和为全线则其内兼有倍句及句较之两线矣但倍句有时而大于较有时而小于较故不能自为
　　连比例而必借股以通之
　　今于句和全线内取倍句如股则先以股线为和较之中率者今以如股之倍句当之而倍句原系句和全线之大分于是和与倍句之比例若倍句与较亦即为全与大分若大分与小分此理分中末线所由出也下文详之
　　丙戊线上取理分中末线
　　先以丙戊线命为股　以丙戊折半成丁戊命为句取丙丁与丁乙等则戊乙为句较
　　变股为倍句成　　　亥戊倍句与丙戊股等　以理分中末线图　　　加较成亥乙即句和
　　亥巳为和较相乗积与丙亥
　　股鼏等【丙亥为丙戊股之方即为亥戊倍句之方】准前论亥乙和与丙戊股
　　若丙戊股与戊乙较
　　今亥戊即丙戊则又为亥乙
　　和与亥戊倍句若亥戊倍句与戊乙较也
　　夫亥乙者全线也亥戊其大分戊乙其小分也合之则是全线与其大分若大分与其小分
　　论曰此以丙戊股线为理分中末之大分而求得其全线亥乙与其小分戊乙也而大分与小分之比例原若
　　理分中末线　　　　全线与大分故即可以丙戊
　　比例图　　　　　　大分为全线而以小分戊子
　　【即戊乙也】为大分则子丙自为小
　　分矣
　　以亥乙为全线【亥戊大分即丙戊亦即乙】
　　【甲　戊乙小分即戊子】
　　亥乙与乙甲【即亥戊大分】若亥戊与子戊也【即亥戊与戊乙】
　　理分中末线　　　　此用亥乙甲大句股比亥戊
　　相生不穷图　　　　子小句股
　　若丙戊为全线
　　则又戊子为大分【亦即子巳】子丙
　　为小分【亦即巳甲】为亥戊与戊子
　　【即丙戊与戊子】若子巳与巳甲也【即子戊与子丙】
　　此用亥戊子大句股比子巳甲小句股
　　亥戊与戊乙若戊子与子丙又相视之理也
　　又若子巳为全线
　　则子庚又为大分　庚巳又为小分
　　其法但于大分子巳内截取子庚如小分丙子作丙庚小方则戊子【即子巳】与子丙若子庚与庚巳
　　似此推之可至无穷










　　解几何三卷第二十七题
　　甲乙丙句股形　以乙丙句
　　折半于巳　作已戊线与股
　　平行平分甲丙于戊　又
　　作戊庚线与句平行平分甲
　　乙股于庚成巳庚长方此即半句乗半股为句股积之半也
　　凡句股形内依正角作长方惟此为大　若于形内别作长方皆小【皆不及句股半积也】
　　今仍作卯丁形则小于巳庚何以知之曰试作丑戊线与丙巳半句平行而等又作丑丙线与戊巳半股平行而等又引壬辰至寅引壬卯至午即显壬丑形与壬巳形等又乙辰原与巳寅等则以巳寅加壬丑而成丑午壬辰巳之磬折形即亦与卯丁形等矣夫磬折形在丑巳方形内而缺午辰之一角即相同磬折之卯丁形以较已庚半积方形亦缺戊未之一角也葢丑巳等巳庚而所缺之午辰小方亦等戊未也　准此言之即凡作长方于丙戊界内者皆小于巳庚半积形也
　　又作子癸形则亦小于巳庚何以知之曰试作戊乙对角线引之至酉即显癸未形与卯未形等即卯丁形与子癸形亦等而其小于巳庚形为所缺之戊未小方亦等矣　准此言之即凡作长方于甲戊界内者皆小于巳庚半积形也
　　又知句股内容方之积亦皆小于半积惟句股相等如半方者容方即为半积
　　论曰此磬折形依线而成葢即几何所谓有阙依形也所阙之小方午辰及戊未皆与丑巳形相似而体势等以有线为之对角也然以句股解之殊简
　　又论曰若壬角在线上去戊角更逺则所缺之午辰小方亦更大而其形皆相似而体势等辛角亦然


　　解几何三卷三十五题
　　甲丙乙句股形　以
　　甲乙为半径作员
　　则甲丙股为正
　　丙乙句为余
　　己丙矢为句较丁
　　丙大矢为句和
　　依句股法　较乗和开方得甲丙股而丙戊亦甲丙也故甲丙乗丙戊与巳丙乗丁丙等积也
　　几何三卷第三十五题言员内两线相交则其各分之线相乗等积即此理也
　　巳丁过员心线
　　有庚壬斜线相交
　　于丙【分丙巳及丙丁又丙庚及
　　丙壬】皆分为两法自
　　员心乙作十字线
　　至辛平分庚壬为两【辛庚辛壬】皆斜线之半
　　辛庚半线内又分辛丙为小线
　　以辛丙减辛庚余庚丙为较以辛丙加辛壬成丙壬为和
　　以大小二方相较之理言之庚辛方内有庚丙较乗丙壬和之积及辛丙方
　　乙辛庚句股形以乙庚为幂内兼有庚辛及乙辛句股二幂即兼有庚丙乗丙壬之积及辛丙乙辛二方也又乙辛丙小句股形以乙丙为则乙丙方内兼有辛乙辛丙二方而甲丙乙句股形以同庚乙之甲乙为幂内兼有甲丙及乙丙二方　此两者既等其幂必等而其所兼之辛丙乙辛二方又与乙丙方等则各减等率而其所余之庚丙乗丙壬积亦必与甲丙方等矣
　　而已丙乗丙丁原与甲丙方等则巳丙乗丙丁亦必与庚丙乗丙壬等矣
　　辛戊线　庚壬线
　　相交于丙则戊丙
　　乗丙辛与庚丙乗
　　丙壬亦等
　　何以知之曰试作
　　一丁巳过心线与
　　两线交于丙凖前论戊丙乗丙辛之积及庚丙乗丙壬之积皆能与丁丙乗乙丙之积等则亦必自相等矣
　　丁巳员径　有
　　庚壬斜线相交
　　于丙则庚丙乗
　　丙壬与巳丙乗
　　丙丁等
　　如法作乙辛及
　　乙庚线成乙辛庚句股　又成乙辛丙小句股以丙辛句减庚辛句余庚丙为较　以同丙辛句之辛戊加庚辛句成庚戊为和【即丙壬】
　　又以乙丙【即乙子亦即乙癸】减庚乙余子庚为较　又两相加成庚癸为和【即子丑】以庚子较乗庚癸和与庚丙较乗丙壬和之积必等【详后条】而巳丙即庚子丙丁即子丑【亦即庚癸】故巳丙乗丙丁与庚丙乗丙壬亦等
　　又大小方相减之理　庚乙方内兼有庚子乗庚癸之积及乙子方即如兼有庚丙乗丙壬之积及乙丙方也【乙丙即乙子】
　　而同庚乙之甲乙幂内原兼有甲丙方及乙丙方此庚乙甲乙两积内各减去乙丙方则所存者一为庚丙乗丙壬之积一为甲丙自乗积此所余两积亦必相同可知矣
　　又巳丙乗丙丁之积原与甲丙方等则亦与庚丙乗丙壬等矣
　　先解两方相减
　　寅辛大方内减子巳小方【寅辰为两方边之较卯辰为两方之和即子辛】法以小方边【乙子】为度于大方边截取【乙长乙戊】作辰午线及
　　戊未线成辰戊
　　小方与巳子等
　　为减去之积其
　　余为寅午长方
　　【即二方较线寅长乗大方邉之
　　积】及未辛长方
　　【即较线午未乗小方邉之积】
　　末取未辛长方移补丑卯之位成卯寅长方【即较乗和之积】又庚甲大方内减己癸小方【丁辛为两方较已辛为两方和亦即辛丙】如法作丁壬癸戌二线减去丁癸小方与已癸等其余辛壬壬癸两长方又移癸壬为丙壬成丁丙长方即较乗和之积也
　　凖此论之凡大小二方相减其所余者必皆为较乗和之积
　　次解两句股形相减　凡两句股同髙即可相加减【谓股数同也】
　　乙庚辛句股内减乙庚丁句股　则以丁庚句减辛庚句余【辛丁】为两句之较　又以同【丁庚】之巳庚句加辛庚句成辛已为两句之和　和乗较成丁丙长方
　　又以乙丁减辛乙余辛戊为两之较　又两相加成辛子为两之和【戊乙子乙并同丁乙】　和乗较成卯寅长方
　　此两长方者其积必等【无论乙为正角或钝角或鋭角并同】
　　何以明其然也曰依句股法乙辛上方兼有乙庚庚辛上二方又乙巳上方兼有乙庚庚巳上一方今既以乙巳上方减乙辛上方则各所兼之乙庚方巳相同而减尽故乙辛上方之多于乙巳上方者即是庚辛上方多于庚巳上方之数也
　　又所用者是两分之乙庚辛句股及乙庚已句股【即乙庚丁】故不论乙角锐钝其法悉同也

　　解几何三卷三十六三十七题
　　甲乙丙句股形　以丙乙
　　句为半径作员　则甲丙
　　股为切线　甲乙为割
　　线
　　甲乙割线内减丁乙半径
　　则甲丁为句较　甲乙割线加戊乙半径成甲戊为句和　和较相乗平方开之得甲丙股
　　几何三卷第三十六题三十七题之理葢出于此若割员线不过乙心　如甲庚　则以他句股明之法自乙心向割员线作乙巳为十字正交线则割线之
　　在员内者平分为两【子巳巳庚】并为员内线子庚之半
　　又作乙子半径成子巳乙
　　小句股则子乙小上方
　　幂兼有子巳小股乙巳小
　　句两幂又甲庚总线既分于巳则甲巳大线内减子巳小线其余甲子在员外者为较　以小线巳庚加大线甲巳成甲庚总为和
　　凡大小二方相较则大方内兼有较乗和及小方之积
　　则是甲巳幂内必兼有甲
　　子乗甲庚之长方及子巳
　　方也
　　又甲巳乙亦句股形其甲
　　乙内原兼有甲巳及乙已句股二幂即是兼有甲子乗甲庚之长方及子巳方与乙巳方也而子巳及巳乙二方原合之成一子乙方子乙即丙乙也是合丙乙方与甲子成甲寅之长方而成甲乙方也
　　又甲丙乙句股形　同以甲乙为原合丙乙方与甲丙方而成甲乙方
　　两形之甲乙方内各去其相等之丙乙方则其余积一为甲子乗甲寅之长方一为甲丙自乗方是二者不得不等矣
　　用法
　　凡测平员形　既得甲丙切线　自乗为实　以甲丁之距为法除之得甲戊之距以甲丁距减之得丁戊员径
　　若欲测庚物之在员周者亦以甲丙切线自乗为实以甲子为法除之即得甲庚之距
　　又法用两句股相加减
　　甲乙丙句股形　以乙丙句为半径作员　又以甲乙为半径作外员　自外员任取甲防作过心员径至戊　又任作一不过心斜线入内员至庚　则以两员
　　间距线乗其全线皆与
　　股幂等而亦自相等
　　如以甲丁乗甲戊或甲
　　壬乗甲庚其积皆等又
　　皆与甲丙切线上方幂等
　　法以两句股相加减
　　先自乙心作乙辛十字正线平分壬庚线于辛成乙辛甲句股
　　又作乙壬乙庚二线成乙辛壬小句股与乙辛庚等法以辛壬与甲辛相减余甲壬为两句之较
　　又相加成甲庚全线为两句之和则以甲壬乗甲庚为句之较乗和也
　　又以乙壬与甲乙相减余甲丁为两之较
　　亦相加成甲戊全线为两之和则以甲丁乗甲戊为之较乗和也
　　此句与之和较相乗两积必等
　　而甲丁乗甲戊原与甲丙自乗等【以甲丙乙句股言之也】故三积俱等
　　凖此论之凡自甲防任作多线入内员其法并同　不但此也但于外员周任作线入内员亦同如于丑作丑戊线则丑卯乗丑戊亦与甲丙幂等
　　何以知之曰试于丑作丑寅过心线即诸数并同甲戊矣而丑卯戊之于丑辰寅犹甲壬寅之于甲丁戊故也














　　简法
　　庚壬斜线交丁巳员径于
　　丙　如法作乙辛线　成
　　乙辛庚句股形及乙辛丙
　　小句股形
　　又以丙辛小句与辛庚大句相减得庚戊较又相加成庚丙和
　　再以乙丙小【即乙癸亦即乙子】与庚乙大相减得子庚较又相加成癸庚和
　　依大小两句股相加减法庚戊较乗庚丙和与子庚较乗庚癸和同积
　　而壬丙原同庚戊又巳丙原同子庚而丁丙亦同癸庚则壬丙乗庚丙亦必与巳丙乗丁丙同积矣
　　又简法
　　壬庚线斜交已丁员径于丙　依法作乙辛又作乙壬线　成乙辛壬句股及乙辛丙小句股皆如前
　　今自庚别作一过乙心线如
　　庚戊则乙辛庚与乙辛壬成
　　相同之两句股即显壬丙为
　　大小两句之较而丙庚为其
　　和
　　又显戊癸为两之较而与巳丙等则巳丙亦较也又癸庚为两之和而与丙丁等则丙丁亦和也是故壬丙乗丙庚较乗和也已丙乗丙丁亦较乗和也而其积必等






　　厯算全书卷四十八
　　钦定四库全书
　　歴算全书卷四十九
　　宣城梅文鼎撰
　　句股阐微卷四
　　几何増解
　　方斜较求原方【几何约论线第十四条有用法今解其理】
　　甲乙丙丁正方形　甲乙其对角线　戊乙为方斜之较　于戊乙上作庚癸乙戊小方则丙庚与庚戊等
　　论曰法于方之一角甲
　　作员而以丙甲方径为
　　员之半径则乙丙为切
　　员线乙辛为自员外割
　　员之全线乙戊较为割
　　员在外之余线而两线
　　皆出一防则乙戊乗乙
　　辛之矩形与乙丙切线方形等
　　夫乙丙即原设方也今以同乙戊之癸乙为横乙辛为直作乙已长方【即乙戊乗乙辛之矩】又移切甲己长方为子甲长方又移卯补午移辰补酉移丑补寅则复成乙丙甲丁方形矣而丑卯午酉等斜剖半方形皆以乙戊较为半方形之边是庚戊及丙庚皆与乙戊等而亦自相等又何疑焉
　　用法　有方斜之较乙戊求原方形之一边法以乙戊较作小方形取其斜乙庚再引长之截丙庚如乙戊得乙丙如所求
　　从此图生一测员之法　假有员城八面开门正西门如戊门外有塔如乙其距如乙戊西南门如丙距塔若干歩如乙丙问城径
　　法以乙丙之距自乗得数为实以乙戊之距为法法除实得乙辛于乙辛内减去乙戊即员城之径　防法但倍乙丙即得城径
　　有员城正西之门如戊西南之门如丙人立于庚可两见之而庚丙与庚戊皆等问城径
　　法以庚戊自乗成戊癸小方以方斜之法求其斜距为乙庚以乙庚加庚丙为乙丙即城半径
　　按此即几何约之用法也
　　又以句股法解之
　　又论曰试于庚丙上作丙子较线上方引庚戊至丁则丁庚又为丙子方之斜而丁戊与乙丙等从丁戊作丁壬甲戊为元方如所求
　　又论曰此即句和较相乗
　　开方得股也　乙甲丁甲皆
　　如　戊甲甲辛【甲丙甲壬】皆如
　　句　乙戊如句较【丁丙同】乙辛如句和　和较相乗
　　成癸辛长方　开方得丁戊
　　股【乙丙同】

　　切线角与员周角交互相应【几何三卷三十二三十三増题】
　　乙丙丁三角形在员内有甲乙切员线则所作丙乙甲
　　角与丙丁乙角同大又丁乙戊
　　角与丁丙乙角同大所谓交互
　　相应也
　　论曰丁角以乙丙弧分论度而
　　丙乙甲角亦以乙丙弧分之度为度故丙乙甲角即丁角也丙角以丁乙弧分为度而丁乙戊角亦以丁乙弧分为度故丁乙戊角即丙角也　凡用员周度为角度皆以两度为一度详后第三増题
　　若丁为钝角则丙乙甲亦钝角两钝角同以丙辛乙弧为度故也其丙锐角与丁乙戊锐角则同以丁乙弧为
　　度
　　又増题　员内三角形一角移
　　动则余二角变而本角度分不
　　变交互相应之角度亦不变
　　如上图【三图】丁角移至辛则丙
　　角加大而相应之辛乙戊角亦
　　从之而大以辛丁乙弧大于丁
　　乙弧也辛乙戊大则辛乙丙小
　　矣其较皆为丁辛弧　若丁角虽移至辛而其度不变相应之丙乙甲角亦不变以所用之丙乙弧不变也又丙角移至壬则丁角加大相应之壬乙甲亦从之而大以壬丙乙弧大于丙乙弧也壬乙甲大则壬乙丁小矣其较皆为丙壬弧　若丙角虽移至壬其度不变相应之丁乙戊亦不变以所用之丁乙弧不变也

　　此图同论但丁角移则丙角变
　　小丙角移亦然



　　又増题　切员线作角与员周弧度相应图
　　有子甲戊员有干艮线相切于子从子防出线与切线作角必割员周之度其大小皆相应但皆以员周两度当角之一度
　　如用子午正线则所作两防子角皆正角【百八十度分两正角各皆九十度】而亦剖员为半周【两半员并百八十度】是两度当一度又如用子辛线作辛子艮钝角【四十五度】而本线割员周于辛为九十度象限亦两度当一度
　　又如用子辛线作辛子干钝角形【百三十五度】而线割辛午干员分【为二百七十度】三象限亦两度当一度
　　又如于员内任作辛子乙角形乙辛子角所乗之子甲乙弧六十度干子乙角同用子甲乙弧亦六十度然其实度是坎寅弧实只三十度亦两当一也
　　又子乙辛角乗子癸壬辛弧【一象限】艮子辛角亦割子癸壬辛弧【一象限】然其实度为震酉弧只四十五度亦两当一也所以者何曰试作辛乙线移角于辛则所乗弧【子甲
　　乙】六十度皆实度也今也
　　角在心是员周也非员心
　　也凡员周之角小于员心
　　一倍故也
　　论曰员周至员心正得员
　　径之半故所作角为折半
　　比例试作乙丙线成辛乙
　　丙句股形又从心作心周
　　线与辛乙平行则所作周心丙角与乙辛丙等而此心周线平剖乙丙句亦平分乙周丙于周而正得其半矣系句股形平分线作点从此作线与股平行即平分句线为两
　　又论曰查角度之法皆以切点为心作半员即见真度此不论半员大小或作于员内或作于员外并同　作于员外其度开明易于简查
　　又论曰试于所切圈心作横径线与切线平行如辛丙线引长之出员外而以查角度之线割员周而过之则皆成大小句股形而所过横线上防皆即八线中之切线为句股形之股角度斜线为横线所截处即八线中割线常为而切点至员心之半径常为句
　　如子辛角度线割横线于辛成辛心子句股形其所当角度为酉中四十五度则辛心即四十五度之切线辛子即四十五度之割线余并同　其子心即半径也又论曰角度半员有大小而子心半径常为句者以所作横线在员心欲用员度相较也若于半员之端【如中如外】作横线与切线平行其所作切线割线亦同比例而即以各半员之半径为句矣
　　不但此也即任于子心外直线上任作一横线其所作句股并同但皆以十字交处距子防之度命为半径此八线割员之法所由以立也


　　量无法四边形防法
　　甲乙丙丁形求其容　先作
　　乙丁对角线分为两三角形
　　次自丙作丙戊横线与乙
　　丁线相交于丑为十字正角
　　而取戊防与甲齐平则戊丑即甲庚也次以丙戊防折半于己　次作壬癸线与乙丁平行而等　又作壬辛癸子二线皆与己丙平行而等　得辛癸长方即原形之容







　　取平行线简法
　　法曰乙丙线欲于甲防作
　　线与之平行法于线外任
　　取巳防为心甲防为界作
　　辛甲丁庚圈分次以庚为
　　心取甲辛之度为界截员分得丁防末自丁作戊丁甲线此线必与乙丙平行矣
　　论曰凡圈内两直线相距之度等则其线必平行如【丁甲】与【庚辛】两线俱在一圈之内而所距之【甲辛】圈分与【庚丁】圈分等是相距之度等而其线平行也因读数度衍得此法似较他处为防
　　补测量全义斜坡用切线法【系勿庵补】
　　斜三角形有一角两边求余边
　　法用切线分外角求得余
　　角即以得边可不用垂线
　　如甲乙己斜角形　有乙
　　甲及己甲二边　有甲角求乙己边
　　法以己甲线引长之成乙甲丙角为原有甲角之外角【以元有甲角减半周得】次分外角之度而半之为半外角而求其切线为三率并乙甲己甲二边为首率又以二边相较为次率次率乗三率为实首率为法除之得半较角之切线以查表得半较角之度以减半外角得己角末用正法得己乙边　法为己角正与乙甲若甲角正与乙己
　　三率法
　　一　两线之和　　　己丙
　　二　两线之较　　　己丁
　　三　半外角之切线　戊癸
　　四　半较角之切线　壬戊
　　用外角者乙己两角之和度而较角者乙己两角之较度【以用切线故半之也】
　　论曰又如后图己甲引至丙而乙甲亦引至辛则乙甲丙及丁甲寅两角皆原有甲角之外角再作甲戊线平分外角则丁甲戊及寅甲戊皆半外角　又作甲壬线
　　与乙已平行则壬
　　甲癸角即同己角
　　壬甲辛角即同乙
　　角再于甲戊半径
　　之端作癸戊辛十
　　字线切员于戊则
　　戊癸及戊辛皆半外角之切线也再以壬甲癸角减壬甲辛角其较为壬甲子角则壬甲戊即半较角而壬戊其切线也
　　其比例为己丙【二边和】与己丁【二边较】若癸辛【外角全切线即乙己丁角和度之全切】与壬子【较角度之全切线】则亦若癸戊【半外角切线】与壬戊【即半较角之切线】何也全与全若半与半也


　　理分中末线
　　甲乙线求作理分中末线
　　法以甲乙全线折半于庚乃
　　作垂线于甲端为丙甲如半
　　线甲庚之度为句全线为
　　股次作丙乙线为
　　次以丙为心乙为界作乙丁圈界　次引丙甲句至丁则丙丁即丙乙也　末以甲为心丁为界作丁戊己圈分则甲己为理分中末之大分己乙为小分其比例为甲乙与甲己若甲己与己乙也
　　逓加法　借右图以乙为心甲为界运规截丁已圈分于戊自戊作线向甲成甲戊线与甲丁等乃自戊作戊乙线与乙甲等成甲乙戊三角形
　　此形甲戊两角悉倍于乙角乃平分戊角作戊辛线此线与甲戊并大亦与乙辛同大成辛戊甲相似三角形则甲乙与乙辛【即戊辛】若乙辛与辛甲也又平分辛角作
　　辛壬线与壬戊与辛甲
　　皆同大则成甲辛壬三
　　角形与辛戊甲相似则
　　乙辛【即戊辛亦即戊甲】与辛甲
　　【即辛壬戊壬】若辛甲与壬甲
　　也如此逓半则其角比例并同
　　一【乙甲】　　　二【乙戊即戊辛戊甲】　三【辛甲即辛壬戊壬】　四【辛癸即壬癸壬甲】五【癸甲即癸子壬子】　六【癸丑即丑子子甲】　七【丑甲即丑寅寅子】　八【丑卯即卯寅寅甲】九【卯甲】　若能知其数则以大分逓乗全数除之得细数
　　先得甲乙为大分而求乙己全分及
　　乙庚小分　用此图亦为半圆内求
　　容方法则以乙巳全分加乙庚小分
　　折半于戊得戊己为半径若先得戊
　　己则以戊己【即戊丁】为作丁甲戊句股使戊甲句半于丁甲股则丁甲即为戊己理分中末之大分
　　解曰甲庚【即乙己】全数与丁甲【大分】若丁甲【大分即甲乙】与甲己小分【即乙庚】也
　　以量分
　　甲乙线十数求作理分中末线
　　先依甲乙线作甲乙丁丙正
　　方形【四面皆十数】　次任用一面
　　平分之如甲丙平分于壬【甲壬
　　及壬丙皆五数】甲乙之半数也【甲丙与甲】
　　【乙等其分亦等】　次自壬向乙角作乙壬斜线其数一十一【一八○三三九】　次自壬量甲壬或丙壬之度【即甲乙之一半】移置于乙壬线上截壬癸如甲壬则其余癸乙即理分中末之大分其数六【一八○三三九】末以癸乙之度移置于甲乙线上如乙戊则乙戊为大分戊甲为小分其数三【八一九六六○】
　　简法
　　作句股形　令甲壬句如甲乙股之
　　半乃以壬为心甲为界作虚线圆分
　　截乙壬于癸
　　末以乙为心癸为界作圆分截甲乙线于戊
　　则乙戊为大分甲戊为小分
　　又简法
　　以甲乙全线为半径作半圆形则乙庚乙辛皆与甲乙等
　　次平分乙辛于己
　　次以己为心庚为界运规割甲乙
　　线于戊【戊己之度即同己庚】
　　则乙戊为大分　甲戊为小分
　　又简法
　　作子寅丑卯十字线相交于乙
　　次以乙为心甲为界运规截十字
　　线于甲于庚于辛则乙庚乙辛皆
　　与设线甲乙等乃折半【乙辛】于己
　　以己为心庚为界运规截甲乙于戊　则乙戊大分甲戊小分皆得矣　此法可于平面圆器上求之
　　附长方变正方法
　　甲乙丙丁长方形欲变正方以长方形之横边【乙丙】直边【丙丁】二线取其中比例即所求
　　取中比例法以丙丁乙丙【即戊
　　丙】联为一直线【丁戊】而折半于
　　己以己为心丁若戊为界作
　　半圆次引乙丙横线至圆界
　　截圆界于庚成丙庚线即乙
　　丙及丙丁二线之中比例线
　　次于丙庚线上作小方形其容与甲乙丙丁长方形等如右图丙庚线上方形为丙壬乃子壬癸句股形内之容方也而甲丙长方形则子壬癸句股外之余方也余方与容方等积
　　简法
　　先引丁丙边至午引乙丙边至
　　未次以丙角为心乙为界作小
　　员界虚线截引长线于戊
　　次以丁戊线折半于己次引乙丙至未次以己为心戊为界运规作小圆界截引长线于庚　则丙庚即所变方形之一边　末依丙庚线作方形与甲乙丙丁长方形等积　其法以丙为心庚为界运规截丙辛与丙庚等
　　理分中末线用法
　　一用以分平圆为十平分
　　法为半径与三十六度之分圆若全分与理分中末之大分也
　　一用以分平圆为五平分
　　歴书言以全分为股理分中末之大分为句求其即半径全数为股三十六度之分圆为句求得七十二度之分圆为
　　一用以量十二等面体
　　法为立方边与所容十二等面边若理分中末之全分与其小分也又十二等面体之边与内容立方边若理分中末之大分与其全分也又立方内容十二等面体其内又容小立方则外立方与内立方若理分中末之全与其大分也
　　一用以量二十等面体
　　法为立方边与所容二十等面边若理分中末之全与其大分也
　　一用以量圆灯
　　法为圆灯边与其自心至角线若理分中末之大分与其全分也此自心至角之线即为外切立方立圆及十二等面二十等面之半径又为内切八等面之半径圆灯为有法之形即此可见
　　用理分中末线説
　　言西学者以几何为第一义而传只六卷其有所秘耶抑为义理渊深翻译不易而姑有所待耶测量全义言有法之体五其面其积皆等其大小相容相抱与球相似几何十一十二十三十四卷诸题极论此理又几何六卷言理分中末线为用甚广量体所必需几何十三卷诸题全頼之古人目为神分线又言理分中末线求法见本卷三十题而与二卷十一题同理至二卷十一题则但云无数可解详见九卷其义皆引而未发故虽有此线莫适所用疑之者十余年辛未嵗养病山阿游心算学于量体诸法稍得窥其奥爰证厯书之误数端于十二等面二十等面得理分中末之用及诸体相容之确数故以立方为主其内容十二等面边得理分线之末二十等面边得理分线之中反覆推求了无凝滞始信几何诸法可以理解而彼之秘为神授及吾之屏为异学皆非得其平也其理与法详几何补编





　　遥量平面法
　　甲乙庚辛为
　　所欲量之平
　　面而不能到
　　如仰视殿
　　上承尘而人
　　在殿外又如峭壁悬崖之上有碑若碣凡平面之物人从地面斜视灼然可见而不能到
　　或平面在下如田池之类人从台上俯视可见或临深崖瞰谷底其理不异但倒用其图即是
　　欲量甲乙庚辛平面而不能到可到者丙丁则先知丙丁之距及丙丁所作各角即可以知之
　　先求甲乙线　法于丙于丁各安平圆仪各以指尺向甲向乙又自相向各作角成甲丙丁甲丁乙乙丁丙凡三角形者三依第一法用甲丙丁形此形有丙丁线【两测之距】有丙角有丁角自有甲角可求甲丁线法为甲角之正与丙丁若丙角之正与甲丁也
　　次仍依第一法用乙丁丙形此形亦有丙丁线【两测之距】有丙角有丁角自有乙角可求乙丁线
　　法为乙角之正与丙丁若丙角之正与乙丁也【此丙角与前形之丙角不同】
　　次仍依第一法用甲丁乙形此形有甲丁乙丁两线及两线间所作之丁角【与前形丁角不同】可求甲乙线为所测之一边　法自甲角作甲戊垂线至戊分乙丁线为两而甲丁乙三角形分为两句股形　其一甲戊丁句股形有丁角　有甲丁线为可求甲戊句戊丁股
　　法为全数与甲丁若丁角之正与甲戊句　又全数与甲丁亦若丁角之余与戊丁股也
　　其一甲戊乙句股形有甲戊句　有乙戊股【戊丁减乙丁得之】可求甲乙
　　法以甲戊句乙戊股各自乗而并之开方得甲乙即所测平面之一边
　　第二求庚辛线　法亦于丙于丁各安平员仪【即先所安之元处】各以指尺向庚向辛又自相向各作角成庚丙丁庚丁辛　辛丙丁　凡三角形亦三
　　依第一法用庚丙丁形　此形有丙丁线【两测之距】有丙角有丁角自有庚角可求庚丁线
　　法为庚角之正与丙丁若丙角之正与庚丁也【此丙角与前两丙角不同】
　　依上法用辛丙丁形　此形有丙角【此丙角又与上不同】有丁角自有辛角　可求辛丁线【丁角与前不同】
　　法为辛角之正与丙丁若丙角之正与辛丁也仍依上法用庚丁辛形此形有庚丁辛丁两线及两线间所作丁角【此丁角又不同】可求庚辛线为所测之又一边法自庚角作庚己垂线至己分辛丁线为两而庚丁辛三角形分为两句股形
　　其一庚己丁句股形有丁角有庚丁线为可求庚己句己丁股
　　法为全数与庚丁若丁角之正与庚己句亦若丁角之余与己丁股也
　　其一庚己辛句股形有庚己句有辛己股【己丁减辛丁得之】可求庚辛
　　法以庚己句辛己股各自乗而并之开方得庚辛为所测平面之又一边【即甲乙之对邉】
　　第三求甲庚线
　　法于丁防侧安平仪以指尺向甲向庚作甲丁庚角成甲丁庚形此形有甲丁庚丁两线及两线所作之丁角【此丁角在甲丁庚丁两线间】可求甲庚线为所测形之侧边
　　法自庚角作甲丁之垂线至壬分甲丁线为两而甲丁庚三角形分为两句股形
　　其一庚壬丁句股形　有庚丁线为有丁角可求庚壬句壬丁股【法同前用丁角之正余】
　　其一庚壬甲句股形　有庚壬句甲壬股【丁壬减甲丁得甲壬】依句股法可求甲庚线为所测平面之侧边
　　第四求乙辛线
　　法亦于丁防侧安平仪指尺向乙向辛作乙丁辛角成乙丁辛形　此形有乙丁辛丁两线及两线所作之丁角此【丁角在辛丁乙丁两线间】可求乙辛线为所测形之又一侧边法自辛角作乙丁之垂线至癸分乙丁线为两而乙丁辛三角形分为两句股形
　　其一辛癸丁句股形有辛丁线为有丁角可求辛癸句癸丁股【法亦同前用丁角之正余】
　　其一辛癸乙句股形有辛癸句乙癸股【癸丁减乙丁得乙癸】依句股法可求乙辛线为所测平面之又一侧边
　　如此则所测形之四边皆具乃用后法求其幂
　　第五求乙庚线
　　法仍于丁防斜立平仪以指尺向乙向庚作乙丁庚角成乙丁庚形此形有庚丁乙丁两线及两线所作之丁角【此丁角又在乙丁庚丁两线间】可求乙庚线为所测形内之对角斜线
　　乙庚丁角形内自庚角作乙丁之垂线至卯分乙丁线为两而乙庚丁三角形亦分为两句股形
　　其一庚卯丁句股形　有庚丁线为有丁角可求庚卯句卯丁股【依上法用丁角之正余】
　　其一庚卯乙句股形　有庚卯句有卯乙股【卯丁减乙丁得卯乙】依句股法可求乙庚线为所测平面形内对角之斜线
　　既有乙庚线则所测甲乙辛庚平面形分为两三角形可以求其幂积
　　其一乙甲庚形有乙庚底　有甲庚甲乙两腰　法以两腰相减为较相并为和和乗较为实乙庚底为法除之得乙午以减乙庚得午庚半之得子庚乃用句股法以甲庚子庚各自乗相减为实开方得甲子垂线垂线半之以乗乙庚底得乙甲庚形平积
　　其乙辛庚形有乙庚底　有乙辛辛庚两腰如上法以乙辛辛庚相减为较又相并为和和乗较为实乙庚底为法除之得乙辰为底较以减乙庚得辰庚半之得丑庚乃用句股法以丑庚庚辛各自乗相减为实开方得丑辛垂线垂线半之以乗乙庚底得乙辛庚形平积末以两三角形积并之为所测甲乙辛庚平面四不等形之总积
　　右法可以不用丈量而遥知亩歩即有种种异态以三角御之足矣新法厯书言测量详矣然未着斯法意者其在几何后数卷中为未译之书欤
　　庚午蜡月既望晤逺西安先生谈及算数云量田可以不用履亩初闻之甚不以为然归而思之得此法然未知其所用者即此与否而此法固己足用矣若用有纵衡细分之测器指尺一量即得无烦布算矣



<子部,天文算法类,推步之属,历算全书,卷四十九>
<子部,天文算法类,推步之属,历算全书,卷四十九>
　　测量用影差义疏
　　凡方形内从角剖成两句股形必相似而等【正方或长方并同】



　　方形内作对角斜线分为两句股又于斜线上任取一防作直线纵横相交如十字而悉与方边平行分方形为大小四句股形此四句股形各两两相似而等【大形丙与丁等小形庚与辛等】
　　则其四句股旁之两余方形虽不
　　相似而其容必等
　　解曰于原斜线所分相等句股内
　　各减去相等之大小两句股则其余亦等【丙戊庚形内减去大形丙小形庚余戊又于丁己辛形内减去大形丁小形辛余己原形既等所减又等则其余必等故戊己两长方虽不相似而其容必等也】
　　句股测逺
　　有甲乙之距人在戊立
　　表又立表于丁使戊丁
　　乙为一直线再于丙立
　　表使丙丁与乙戊如十字之半而与甲乙平行则丁戊小股与丙丁小句若丙庚大股与甲庚大句也
　　法以丙丁小句为二率乙丁大股为三率【即丙庚】相乗为实戊丁小股为一率为法法除实得大句甲庚再以庚乙加之得甲乙
　　假如丙丁两表相距【三歩】人在戊窥丁到乙逺【戊丁十二歩丁乙十八歩】欲求甲乙之距
　　法以丙丁【三歩】乗乙丁【十八歩】得【五十四歩】为实戊丁【十二歩】为法除之得【四十五歩】为甲庚加丙丁【三歩即乙庚】共四十八歩为甲乙
　　解曰此以乙丙长方形变为丙癸也依前论乙丙实形丙癸虚形不相似而容积等故也
　　重测法



　　有巽乙甲井方池欲遥望测其甲乙之一面方并乙丁之距
　　法立表于丁望测方池之东北角乙至东南角巽使丁乙巽为一直线　再于丁横过立一表于丙使丙丁为乙丁之横立正线【丙丁横六歩四分】次从丁退而北行至【戊】量得【十二歩】　从戊斜望池西北隅【甲】不能当【丙】表而出其间如【戌】又于戌立表【戌丁】之距【四歩】　再退而北行至【己】从【己】窥【甲】正过【丙】表己丙甲为一直线量得己丁之距【三十六歩】
　　法以【丙丁六歩四分】为一率【丁己三十六歩】为二率【戊丁四歩】为三率　二三相乗得【一百四十四歩】为实一率【六歩四分】为法除之得【二十二歩半】为辛己于辛己内减丁戊【十二歩】余【十歩半】为壬己是为景差
　　次以【戌丁四歩】减【丙丁六歩四分】余【丙戌二歩四分】以戊丁【十二歩】乗之得【二十八歩八分】为句实　景差【十歩半】为法除句实得二歩【八分弱】为甲申大句之距加丙丁【六歩四分即申乙】得共【九歩二分弱】为甲乙即方池一面之濶
　　次以辛己【二十二歩半】减丁己【三十六歩】余【十三歩半】辛丁为二率丁戊【十二歩】为三率相乗得【一百六十二歩】为股实　景差【十歩半】为法除之得【十五歩八分半弱】为乙丁大股之距
　　解曰此以四表重测改为三表乃巧算也　若测髙则重测本为前后二表者亦改用一表故当先知本法然后明其所以然下文详之
　　试先明四表本法
　　有甲乙之濶先立【丁】表从戊测之戊【人目】丁【表】乙【逺物之末端】三者参相直　次于【丁】表横过与【甲乙】平行作戊丁乙直线之横直线此线上取戊立表人目从【戊】过【戌】表窥甲逺物之西端亦参相直但于戊丁乙线为斜成句股形　量得戌丁两表横距【四歩】丁戊【人目距东表】直距【十二歩】
　　次于丁戊直线退而北行至己　又于西表戌作戌干癸直线与丁戊平行此平行线内取癸立西后表人目从【己】过【癸】至甲参相直成己甲癸斜　亦从【癸】横行至【丁己】线寻【辛】立东后表此后两表【癸辛】之距为前表【戌丁】等【四歩】　又量得【辛己】为东后表距人目之数【辛丁二十二歩半】次以丁戊【十二】减辛己【二十二半】得【十歩半】为壬己景差　末以己辛【二十二半】减【己丁三十六】余【十三歩半】为前后表间之距　以表横距【四歩】乗之得【五十四歩】为表间积【即丁癸长方】　置表间积为实以景差【十歩半】为法除之得【五歩一半弱】加表横距【四歩】　　得共【九歩二分弱】为所测逺物甲乙之濶解曰前表测得成【戊乙甲】句股形内有戌乙余方与形外戌坤余方等积　后表测得【己乙甲】句股形内有癸乙余方与形外酉癸余方等积　于【癸乙】内减【戌乙】于【酉癸】内减【寅癸即丑戌】则所余之【癸丁】及【酉辰】两余方亦必等积也故以【丁癸】变【辰酉】而得【辰寅】亦即【甲庚】也
　　次明改用三表之理
　　用三表者于【丙丁】两表间増一【戌】表其实则于【戌丁】两表外増一【丙】表也前増一表而无后表则无从而得景差故以三率法求而得之其实【癸辛】即后表也其理与四表同
　　然不用【癸子】形而用【戌子】形何也曰准前论【辰酉】形与【丁癸】形等积而【午癸】形与【丁癸】形亦等积【两余方在己丙丁句股形内外故等】则【酉辰】与【午癸】亦等积矣各减同用之【卯未】则所余之【酉卯】与【卯癸】二形亦自相等积而【卯癸】原与【戌子】等故用【戌子】变为【卯酉】而得【卯寅】即得【甲申】矣是故【戌子】可名句实也
　　其以【辛丁】乗【戊丁】为股实何也曰此三率法也【丁乙】外加【丁辛】前后两测之表距故【辛壬即戊丁】外亦加【壬己】两测之景差法为壬己与辛丁若戊丁与丁乙也凖此测髙可用一表而成两测【即借前测逺之图而以横为直】
　　假如有【甲乙】髙立【丙丁】表人目在【戊】测之则表之端不相值而参相直于表之若干度如【戊】退若干歩至【己】测之正对表端【丙】其法并同
　　因看数度衍中破勾测逺条疑其图不真因作此以证明其説
　　测量图説
　　一测股六十四尺
　　八寸【壬丁】　二测
　　句四十三尺二寸
　　【丙丁】　三大股三
　　千六百八十五尺
　　二寸【乙丁即丙午】四大
　　句二千四百五十
　　六尺八寸【甲午】加【午乙】
　　得二千五百尺为甲乙之髙
　　解曰癸丁长方形即古人所谓表间积也以景差壬辛【即丑子】除之变为寅子形是寅子与癸丁同积也　而申癸形原与癸丁同积则寅子与申癸亦同积也　于内各减同用之申子而寅未与未癸亦同积矣夫未癸即氐己也是戊丁【即亥己】乗丙己之积也故可命为句实而以景差壬辛【即申未】除之得甲午句也【甲午即戌酉】其取股实何也曰三率法也表在丁其景丁戊　后表在庚则其景庚壬后表之逺于前表者为庚丁故后景之大于前景者为辛壬则其比例为辛壬与庚丁若丁戊【即庚辛】与丁乙也
　　试引癸庚至箕截庚箕如庚壬又截尾箕如壬辛于尾于箕各作与庚乙平行线而于乙作垂弧为乙牛联之作长方形又作丁心线截之作箕乙线斜分之则其理着矣

　　三角形求外切圆法
　　设如锐角形有甲丙边七十五尺甲乙边六十一尺
　　乙丙边五十六尺　问外切
　　圆径若干　畣曰外切圆半
　　径三十八尺一寸二分五牦
　　法先求得甲丁中长线六十
　　尺为一率甲乙边六十一尺
　　为三率甲丙边折半得戊甲三十七尺五寸为三率二率与三率相乗一率除之得四率【三八一二五】为甲乙圆半径
　　解曰此甲丁乙三角形与甲己戊三角形同式故其线为相比例率也若甲为钝角其理亦同
　　以甲丙折半为三率故四率亦为半径若以甲丙全线为三率则四率必得甲辛为全径矣葢甲辛丙形与甲乙丁形同式也何以见甲乙丁形与甲辛丙形同式葢两形之乙角辛角同当甲庚丙弧分则二角必相等而丁丙又同为直角则两甲角亦必等而为同式无疑矣又界角比心角所当之弧大一倍今己心角所当甲庚弧适当乙界角所对甲庚丙之一半则两角为等可知而戊为直角与丁角等则两甲角必等故甲己戊与甲乙丁亦为同式形也
　　三角举要有量法未着算例因作此补之
　　又如甲乙丙钝角形　求外切员径【甲辛】　半径【甲己】法先求得中长线【乙丁】得【乙丁丙】句股形
　　次作【乙辛】线成【甲乙辛】大句股
　　形
　　又甲乙半之于戊从员心
　　【己】作直线过戊至庚又成
　　【甲戊己】句股形
　　一率　乙丁股【形内垂线】

　　三率　甲戊股【即甲乙之半】
　　四率　甲辛【即外切员径】　　四率　甲己【即切员半径】解曰三句股形皆相似故可以三率比例求之
　　问何以知其为相似形也曰原设形之丙角与甲乙辛形之辛角所当者同为甲庚乙员分则两角等而乙丁丙形之丁角与甲乙辛大形之乙角又皆正角则余角亦等而为相似形
　　又甲己为甲辛之半甲戊为甲乙之半戊正角与大形乙正角等又同用甲角则己戊亦乙辛之半而为相似形
　　一系凡三角形求得形内垂线为法　垂线左右两原边相乗　为实　法除实得外切员径　锐钝同法假如甲乙丙钝角形求得中垂线乙丁六分为法　左右两斜边【甲乙十八分乙丙十分】相乗【一百八十分】为实　法除实得外切员径甲辛三十分　即可借用前图【分寸畸零稍为整顿】


<子部,天文算法类,推步之属,历算全书,卷四十九>
<子部,天文算法类,推步之属,历算全书,卷四十九>















　　歴算全书卷四十九
　　钦定四库全书
　　厯算全书卷五十
　　宣城梅文鼎撰
　　三角形举要法卷一
　　测算名义
　　古用句股有割员弧背矢诸名今用三角其类稍广不可以不知爰摘纲要列于首简
　　防
　　防如针芒无长短濶狭可论然算从此起譬如算日月行度只论日月中心一点此防所到即为躔离真度线
　　线有弧直二种皆有长短而无濶狭自一防引而长之至又一防止则成线矣



　　如测日月相距度皆自太阳心算至太隂心是为弧线如测日月去人逺近皆自人目中一防算至太阳太隂天是为直线
　　凡句股三角之法俱论线线两端各一防故线以防为其界
　　面
　　面有方员各种之形皆有长短有濶狭而无厚薄故谓之幂幂者所以冒物如量田畴界域只论土面之大小







　　面之方员各类皆以线限之故面以线为界【面之线亦曰邉】惟员面是一线所成乃弧线也若直线必三线以上始能成形体
　　体或方或员其形不一皆有长短有濶狭又有厚薄【或浅深髙下之类】员体如球如柱方体如柜如防或如员塔方塔皆以面为界【图后】






　　以上四者【谓防线面体】略尽测量之事矣然其用皆在线如论防则有距线论面则有邉线论体则有棱线【面与面相得则成棱线】凡所谓长短濶狭厚薄浅深髙下皆以线得之三角法者求线之法也
　　长短濶狭厚薄等类皆以量而得而量者必于一线正中若稍偏于两旁则其度不真矣故凡测量所求者皆线也三角形
　　欲明三角之法必详三角之形



　　两直线不能成形成形者必三线以上而三线相遇则有三角故三角形者形之始也



　　多线皆可成形析之皆可成三角至三角则无可析矣故三角能尽诸形之理
　　凡可算者为有法之形不可算者为无法之形三角者有法之形也不论长短斜正皆可以求其数故曰有法若无法之形析之成三角则可量故三角者量法之宗也角
　　三角法异于句股者以用角也故先论角
　　两线相遇则成角【平行两直线不能作角何也线既平行则虽引而长之至于无穷终无相遇之理角安从生是故作角者必两线相遇必不平行也】
　　角有三类一正方角一锐角一钝角



　　如右图以两线十字纵横相遇皆为正方角【亦曰直角亦曰方角】



　　如右图以两线斜相遇则一为锐角一为钝角
　　凡锐角必小于正方角凡钝角必大于正方角
　　正方角止一锐角钝角则有多种而算法生焉
　　弧
　　角在小形与在大形无以异也故无丈尺可言必量之以对角之弧
　　法以角之端为员心用规作员员周分三百六十度乃视本角所对之弧于全员三百六十度中得几何度分其弧分所对正得九十度者为正方角【九十度者全员四之一谓之象限】若所对弧分不满九十度者为锐角【自八十九度以至一度并锐角也】所对弧分在九十度以上者为钝角【自九十一度至百七十九度并钝角也】
　　如图丁为角即用为员心以作员形
　　其庚丁丙角【凡论角度并以中一字为所指之角此言庚丁
　　丙即丁为角也】所对者庚丙弧在全员为四
　　之一正得象限九十度是为正方角
　　若乙丁丙角所对者乙丙弧在象限庚丙弧之内小于象限九十度是为锐角
　　又乙丁壬角所对乙庚壬弧过于壬庚弧【壬庚亦象限九十度弧故庚丁壬亦方角】大于象限九十度是为钝角
　　角之度生于割员
　　割员弧矢
　　有弧则有矢弧矢者古人割员之法也
　　如图以乙子直线割平员则成弧
　　矢形
　　所割乙丙子员分如弓之曲古谓
　　之弧背以弧背半之则为半弧背
　　【如乙丙】
　　通正
　　割员直线如弓之谓之通【如乙子】
　　通半之古谓之半弧今曰正【如乙甲】
　　矢线
　　正以十字截半径成矢【如丁丙横半径为乙甲正所截成甲丙矢】谓之正矢
　　【以上二条俱仍前图】
　　正弧余弧正角余角

　　所用之弧度为正弧以正弧减象限
　　为余弧【如庚丙象限内减乙丙正弧则其余乙庚为余弧】

　　正弧所对为正角【如正弧乙丙对乙丁丙角则为正角】
　　以正角减正方角为余角【如以乙丁丙正角去减庚丁丙方角则其余乙丁庚角为余角】
　　正余正矢余矢

　　有正弧正角即有正【如乙甲】有正矢
　　【如甲丙】亦即有余【如乙己】有余矢【如己庚】

　　正正矢余余矢皆乙丙弧所有亦即乙丁丙角所有
　　自一度至八十九度并得为乙丙并得为正弧即正余矢毕具
　　若用乙庚为正弧则乙丙反为余弧
　　角之正余亦同
　　割线切线
　　每一弧一角各有正余正矢余矢己成四线于平员内【古人用句股割员即此法也盖此四线己成倒顺二句股】
　　再引半径透于平员之外与切员直线相遇为割线切线而各有正余复成四线【正割正切余割余切复成倒顺二句股】共为八线故曰割员八线也
　　如图庚乙丙平员切戊丙直线于丙
　　又引乙丁半径透出员周外使两线相
　　遇于戊则戊丙为乙丙弧之正切线
　　亦即为乙丁丙角之正切线而戊丁
　　为乙丙弧之正割线亦即为乙丁丙角之正割线又以平员切庚辛直线于庚与乙丁透出线相遇于辛则庚辛为乙丙弧之余切线亦即为乙丁丙角之余切线而辛丁为乙丙弧之余割线亦即为乙丁丙角之余割线割员八线
　　凡用一弧即对一角用一角亦对一弧故可互求凡一弧即有八线【正正矢正割正切余余矢余割余切】角亦然
　　凡一弧之八线即成倒顺四句股角亦然
　　如图庚丙象弧共九十度庚丁丙
　　为九十度十字正方角
　　任分乙丙为正弧乙丁丙为正角
　　则乙庚为余弧乙丁庚为余角
　　正【乙甲　同丁己】　正矢【甲丙】正切【戊丙】　正割【戊丁】余【乙己　同丁甲】　余矢【庚己】余切【辛庚】　余割【辛丁】
　　以上八线为乙丙弧所用亦即为乙丁丙角所用【自一度至八十九度并同】若用乙庚弧亦同此八线但以余为正以正为余
　　乙甲丁句股形乙丁【半径】为乙甲【正】为
　　股丁甲【余】为句　戊丙丁句股形戊丁
　　【正割】为戊丙【正切】为股丙丁【半径】为句
　　以上两顺句股形同用乙丁甲角故其
　　比例等【凡句股形一角等则余角并等】
　　乙己丁倒句股形乙丁【半径】为己丁【正】为
　　股乙己【余】为句　辛庚丁倒句股形辛丁
　　【余割】为丁庚【半径】为股辛庚【余切】为句　以上两
　　倒句股形同用乙丁巳角故其比例亦等
　　乙甲丁句股形乙丁【半径】为乙甲【正】为股甲
　　丁【余】为句　丁己乙倒句股形乙丁【半径】为
　　己丁【正】为股乙己【余】为句　此倒顺两句股形等邉又等角【倒形之丁角即顺形丁角之余倒形之乙角即顺形乙角之余】竟如一句股也凖此论之则倒顺四句股之比例亦无不等矣
　　角度
　　凡三角形并三角之度皆成两象限【共一百八十度】
　　假如乙甲丁句股形其丁角五十五
　　度【当乙丙弧】则乙角必三十五度【当乙庚余弧】两角共一象限九十度其甲角正方
　　原系九十度合三角成一百八十度
　　乙角何以必三十五度也试引乙丁过心至夘则夘丁丑角与丁乙甲角等【夘丁乙同为一线丁丑线又与乙甲平行则所作之角必等】而夘丁丑固三十度也则乙角亦三十度矣
　　又假如丙乙丁三角形从乙角作乙
　　甲直线至丁丙邉分为两句股形【乙甲
　　丁乙甲丙】凖前论乙甲丁句股形以乙分
　　角与丁角合之成一象限九十度又
　　乙甲丙句股形以乙分角与丙角合之成一象限九十度然则以乙全角【即两分角之合】与丁丙两角合之必两象限一百八十度矣【乙为钝角并同】
　　以此推知三角形有两角即知余角【并两角以减半周一百八十度得之】句股形有一角即知余角【句股原有正方角九十度则余两角共九十度故得一可知其二】相似形
　　既知角可以论形有两三角形其各角之度相等则为相似形而两形中各邉之比例相等【谓此形中各邉自相较之比例亦如彼形中各邉自相较之比例也】
　　比例
　　两数相形则比例生比例者或相等或大若干或小若干乃两数相比之差数也有两数于此又有两数于此数虽不同而其各两数自相差之比例同谓之比例等或两小数相等又有两大数相等是为相等之比例数虽有大小其相等之比例均也或两小数相差三倍又有两大数亦相差三倍是为三倍之比例或两小数相差为一倍有半又有两大数相差亦一倍有半是为一倍有半之比例数虽有大小其为三倍之比例及一倍有半之比例均也
　　论八线之比例有二
　　一为八线自相生之比例
　　乙甲丁小句股形与戊丙丁大句
　　股形相似【见前条】故以半径乙丁比
　　正乙甲若割线戊丁与切线戊
　　丙之比例也【此为以小比小股若大与大股】股
　　求亦同
　　又以半径丙丁比正切戊丙若余甲丁与正乙甲之比例也【此为以大句比大股若小句比小股】股求句亦同余仿此以故凡八线中但得一线则余皆可求观图自明一为八线算他形之比例
　　乙丁甲角所有八线为表中原设之数亢丁房句股形为今所算之数
　　或先有丁角有亢丁而求房丁句则为以乙丁半径
　　比甲丁余若亢丁与房丁句
　　也【以角与句求亦同】以上是用八线以求
　　他形
　　或先有亢丁有亢房股而求丁
　　角则为以亢丁比亢房股若乙
　　丁半径与丁角之正乙甲也【得乙
　　甲得丁角矣】或先有亢房股与房丁句
　　而求丁角则为以亢房股比房丁
　　句若丁庚半径与庚辛余切也【得庚辛亦得丁角】以上二者是用他形转求八线
　　总而言之皆以先有两数之比例为后两数之比例其乗除之法皆依三率也
　　三率
　　三率算术古谓之异乗同除今以句股解之
　　丁戊大股【十四尺】丙戊大句【十一尺二寸】截丁乙小股【十尺】问乙甲截句
　　答曰八尺
　　术以所截小股乗大句得数
　　为实以大股为法除之即得截句





　　若先以原股【十四尺】除原句【十一尺二寸】得八寸为每一尺之句再以截股【十尺】乗之亦得八尺但先除后乗多有不尽之数故改用先乗后除乃古九章中通用之纲要也
　　先乗后除何以又谓之异乗同除曰今但有截股而不知句故以原有之句乗之股与句异名故曰异乗然后以原有之股除之股与股同名故曰同除然则又何以谓之三率曰本是以原有之股与句比今截之股与句共四件也然见有者只三件【原有之股与句及今截之股】故必以见有之三件相为乗除而得所不知之第四件故曰三率
　　三率乗除图式
　　一率　原有股十四尺　　为法
　　二率　原有句十一尺二寸【相乗】
　　三率　今截股十尺　　　【为实】
　　四率　所求截句八尺　　法除实得所求
　　术曰以原股比原句若截股与截句也
　　凡言以者为一率言比者为二率言若者为三率言与者为四率
　　二率三率常相乗为实一率常为法法除实得四率四率乃所求之数其三率者所以求之也三率与异乗同除非有二理但以横列为异然数既平列即可以四率为法除二三相乗之实而得一率并可以一率四率相乗为实用二率为法除之而得三率或用三率为法除之亦得二率是故一四二三之位可以互居【四可为一二可为三】法实可以迭用【二与三可居一四之位一与四可居二三之位】变动不居惟用所适而各有典常于异乗同除之理尤深切而着明者也
　　三率互用图
　　反之　　　　　更之　　　　　又反之
　　一句八尺　　　一股十尺　　　一句十一尺二寸二股十尺　　　二句八尺　　　二股十四尺三句十一尺二寸三股十四尺　　三句八尺
　　四股十四尺　　四句十一尺二寸四股十尺
　　右并以二率三率相乗为实一率为法除之而得四率
　　八线表
　　八线为各弧各角之句股所成故八线表者即句股形之立成数也古人用句股开方巳尽测量之理然句股皆邉线耳邉之数无方放之则弥四逺近之则陈几案故所传算术皆以一端示例而已不能备详其数也今变而用角则有弧度三百六十以限之而以象限尽全周有合于举一反三之防又析象限之度各六十分凡为句股形二千七百角度五千四百【九十度之分五千四百而句股形并有两角故其形二千七百而角数倍之】为正为切线为割线共一万六千二百【三项各五千四百正余互用也】而句股之形略备用之殊便也锐角分两句股钝角补成句股然惟有八线表中豫定之句股故但得其角度则诸数厯然可于无句股中寻出句股矣
　　半径全数
　　全数即半径也不言半径而言全数者省文也凡八线生于角度而有角有弧则有半径八线之数皆依半径而立也半径常为一【或五位则为一万或六位则为十万】则正常为半径之分【正必小于半径】而不得为全数惟半径可称全数也【割切二线皆依正而生亦皆有畸零不得为全数】
　　用全数为半径有数善焉一立表时易于求数也一用表时便于乗除也【三率中全数为除法则但降位可省一除若全数为乗法则但升位可省一乗】
　　厯书中多言全数【或但曰全】以从省便今算例中直云半径以欲明比例之理故质言之




　　补遗
　　正为八线之主
　　割圜之法皆作句股于圜内以先得正故古人祗用正亦无不足今用割切诸线而皆生于正
　　平圜径二尺【即戊壬】半之一尺【即戊丙庚
　　丙等】为圜里六孤之一面【即乙戊】半径
　　【戊丙】为半面【戊丁】为句句求股得
　　股【丁丙】转减半径【庚丙】得余【庚丁】为小句
　　半面【戊丁】又为小股句股求得小【戊庚】是为割六弧成十二弧之一面如是累析为二十四弧四十八弧至九十六弧以上定为径一尺周三尺一寸四分有竒论曰九章算经载刘徽割圜术大畧如此其以半径为六弧之一面与八线理合半径恒为一即全数半面为股则正也
　　平方径十寸其积百寸内作同径之平圜平圜内又作平方正得外方之半其积五十寸平方开之得七寸○
　　七有竒【即离震等四等面之通】乃自
　　四隅之旁増为八角曲圜
　　为第一次【即八等面通】至第二
　　次则为曲十六【即十六等面通】第三次为曲三十二每次
　　加倍至十二次则为曲一
　　万六千三百八十四于是方不复方渐变为圜矣其法逐节以大小句股幂相求至十二次所得小以一万六千三百八十四乗之得三十一寸四分一五毫九丝二忽为径十寸之圜周与祖冲之径一百一十三周三百五十五合
　　论曰元赵友钦革象新书所撰乾象周髀法大略如此所得周径与西术同其逐节所求皆通所用小股皆正也
　　又论曰刘徽祖冲之以割六孤起数赵友钦以四角起数今西术作割圜八线以六宗率则兼用之可见理之至者先后一揆法之精者中西合辙西人谓古人但知径一围三未深攷也
　　又论曰中西割圜之法皆以句股法求通通半之为正割圜诸率皆自此出总之为句股之比例而巳钝角正
　　钝角不立正而即以外角之正为正
　　钝角之正在形外即外角之正也故乙丙已钝角与乙丙甲外角同以乙丁为正【以钝角减半周得外角假如钝角一百二
　　十度其所用者即六十度之正】乙丁线能为乙
　　丙甲角正又能为乙丙已钝角
　　正八线表止于象限以此【因钝角与
　　外角同正故表虽一象限而实有半周之用】
　　钝角余
　　钝角既以外角之正为正即以外角之余为余如前图乙庚为外角【乙丙甲】余而即为钝角【乙丙己】余
　　捷法以正角【戊丙巳】减钝角【乙丙巳】得余角【戊丙乙】即得余
　　过弧
　　钝角之弧为过弧
　　巳戊为象限弧而乙戊巳为乙丙
　　巳钝角之弧是越象限弧而过之
　　也故曰过弧

　　大矢
　　钝角之矢为大矢
　　如前图以乙丁辛分全圜即全径亦分为二则丁甲为小半圜【乙甲辛】之径谓之正矢丁巳为大半圜【乙已辛】之径谓之大矢大矢者钝角所用也　钝角与外角同用乙丁正乙庚余所不同者惟矢【乙丙巳角用大矢丁已乙丙甲角用正矢丁甲】
　　捷法以乙庚【即丁丙】余加已丙半径即得【丁巳】大矢【若以余减半径亦得正矢】
　　正角以半径全数为正
　　八线起○度一分至八十九度五十九分并有正而九十度无正非无正也盖即以半径全数为其正故凡算三角
　　有用半径与正相为比例者皆正
　　角也【其法与锐角形钝角形用两正为比例同理并详后卷】八十九度竒之正至九九九九九
　　而极迨满一象限始能成半径全数是故半径全数者正角九十度之正也其数为一○○○○○





　　厯算全书卷五十
　　钦定四库全书
　　厯算全书卷五十一
　　宣城梅文鼎撰
　　三角法举要卷二
　　算例
　　三角形有三类
　　一曰句股形
　　即直角三邉形也有正方角一余并锐角
　　一曰锐角形
　　三角并锐
　　一曰钝角形
　　三角内有钝角一余并锐角
　　以上三类总谓之三角形其算之各有术



　　句股形第一术　有一角一邉求余角余邉
　　内分二支
　　一先有之邉为
　　一先有之邉为句【或先有股亦同】
　　假如【壬癸丁】句股形有丁角【五十七度】壬丁【九十一丈八尺】
　　求余角余邉
　　一求癸丁邉
　　术曰以半径全数比丁角之余
　　若壬丁与癸丁句【半径即丁乙余即甲丁
　　以丁乙比甲丁若壬丁比丁癸】
　　一率【原设】半径　　　　一○○○○○为法
　　二率【原设句】丁角【五十七度】余　五四四六四【相乘】
　　三率【今有】壬丁邉　　　九十一丈八尺【为实】
　　四率【今所求句】癸丁邉　　　五十丈　　　法除实得所求一求壬癸邉
　　术曰以半径比丁角之正若壬丁与壬癸股
　　一率【原设股】半径　　　　一○○○○○　为法二率【原设股】丁角【五十七度】正　八三八六七　【相乗】三率【今有】壬丁邉　　　九十一丈八尺　【为实】四率【今所求股】壬癸邉　　　七十七丈　　法除实得所求一求壬角
　　以丁角【五十七度】与象限九十度相减得余三十三度爲壬角
　　计开
　　先有之三件
　　癸正方角【九十度】　丁角【五十七度】　壬丁【九十一丈八尺】
　　今求得三件
　　癸丁旬【五十丈】　壬癸股【七十七丈】　壬角【三十三度】
　　右例先得以求句股也是为句股形第一术之第一支

　　假如【壬癸丁】句股形有丁角【六十二度】癸丁句【二十四丈】求余角余邉
　　一求壬角
　　以丁角【六十二度】与象限相减得余二十八度为壬角
　　【戊丙丁句股形以戊丙切线为股丙丁半径为句戊丁割线为
　　是丁角原有之线】
　　【今壬癸丁句股形既同丁角则其比例等】
　　一求壬丁邉
　　术为以半径比丁角之割线若癸丁句与壬丁
　　一【原设句】半径　　　　　一○○○○○　为法二【原设】丁角【六十二度】割线　二一三○○五　【相乗】
　　三【今有句】癸丁邉　　　　二十四丈　　　【为实】
　　四【所求】壬丁邉　　　　五十一丈二尺　法除实得所求一求壬癸邉
　　术为以半径比丁角之切线若癸丁句与壬癸股
　　一【原设句】半径　　　　　一○○○○○为法
　　二【原设股】丁角【六十二度】切线　一八八○七三　【相乗】
　　三【今有句】癸丁邉　　　　二十四丈　　　【为实】
　　四【所求股】壬癸邉　　　　四十五丈一尺　法除实得所求计开
　　先有之三件
　　癸正方角　丁角【六十二度】　癸丁句【二十四丈】
　　今求得三件
　　壬角【二十八度】　壬丁【五十一丈一尺】　壬癸股【四十五丈一尺】右例先得句以求及股也或先得股以求及句亦同是为句股形第一术之第二支






　　句股形第二术　有邉求角
　　亦分二支
　　一先有二邉
　　一先不知正方角而有三邉【新増】
　　假如【壬癸丁】句股形有壬丁【一百零二丈二】癸丁句【尺四十八】
　　求二角一邉
　　一求丁角
　　术为以壬丁比癸丁句若半
　　径乙丁与丁角之余甲丁
　　一　壬丁邉　　一百○二丈二尺　今有之为法二　癸丁邉　　　四十八丈　　　今有之句【丈相】三　半径　　　一○○○○○　　原设之【乘为】四　丁角余　　四六九六六　　法除实得所求原设句
　　依术求得丁角六十二度【实以所得余捡表即】
　　一求壬角
　　以丁角【六十二度】与象限相减得余二十八度为壬角一求壬癸邉
　　术为以半径比丁角之正若壬丁与壬癸股
　　一　半径　　　　　一○○○○○
　　二　丁角【六十二度】正　　八八二九五
　　三　壬丁邉　　　　一百○二丈二尺
　　四　壬癸邉　　　　　九十丈○二尺三寸
　　计开
　　先有之三件
　　壬丁【一百○二丈二尺】　癸丁句【四十八丈】　癸正方角
　　今求得三件
　　丁角【六十二度】　壬角【二十八度】　壬癸股【九十丈○二尺三寸】
　　右例以邉求角而先知方角故只用二邉也是为句股形第二术之第一支【此先有二邉为与句故用正余若先有者是句与股则用切线其比例之理一也】

　　假如【壬癸丁】三角形有壬丁邉【一百○六丈】壬癸邉【九十丈】癸丁邉【五十六丈】求角
　　一求癸角
　　术以壬丁大邉与丁癸邉相加得【一
　　百六十二丈】为总又相减得【五十
　　丈】为较以较乗总得【八千一百丈】为实以壬癸邉【九十丈】为法除之
　　仍得【九十丈】与壬癸邉数等即知
　　癸角为正方角
　　依术求得癸角为正方角定为句股形
　　一求丁角
　　术为以丁癸邉比壬癸邉若半径与丁角之切线
　　一　丁癸句　　五十六丈
　　二　壬癸股　　九十丈
　　三　半径　　　一○○○○○
　　四　丁角切线　一六○七一四
　　依术求得丁角五十八度○六分【以所得切线捡表即得】
　　一求壬角
　　以丁角【五十八度○六分】与象限相减得余三十一度五十四分为壬角
　　计开
　　先有三邉
　　壬丁邉【一百零六丈】　壬癸邉【九十丈】　癸丁邉【五十六丈】
　　求得三角
　　癸正方角　丁角【五十八度零六分】　壬角【三十一度五十四分】右例亦以邉求角而先不知其为句股形故兼用三邉是为句股形第二术之第二支





　　锐角形第一术　有两角一邉求余角余邉
　　假如【乙丙丁】锐角形有丙角【六十度】丁角【五十度】丙丁邉【一百二十尺】
　　先求乙角
　　术以丙角【六十度】丁角【五十度】相
　　并得【一百一十度】以减半周一百
　　八十度余七十度为乙角

　　次求乙丁邉
　　术为以乙角正比丙丁邉若丙角正与乙丁邉
　　一　乙角【七十度】正　九三九六九
　　二　丙丁邉【即乙角对邉】　一百二十尺
　　三　丙角【六十度】正　八六六○三
　　四　乙丁邉【即丙角对邉】　一百一十尺○六寸
　　次求乙丙邉
　　术为以乙角正比丙丁邉若丁角正与乙丙邉
　　一　乙角【七十度】正　九三九六九
　　二　丙丁【乙角对邉】　　　一百二十尺
　　三　丁角【五十度】正　七六六○四
　　四　乙丙【丁角对邉】　　　　九十七尺八寸
　　计开
　　先有之三件
　　丙角【六十度】　丁角【五十度】　丙丁邉【一百二十尺】
　　今求得三件
　　乙角【七十度】　乙丁邉【一百一十尺零六寸】　乙丙邉【九十七尺八寸】右例先有之邉在两角之间也若先有之邉与一角相对亦同盖三角形有两角即有第三角故无两法



　　锐角形第二术　有一角两邉求余角余邉
　　此分二支
　　一先有之角与一邉相对
　　一先有之角不与邉相对
　　假如【甲乙丙】锐角形有丙角【六十度】甲丙邉【八千尺】甲乙邉【七千零三十四尺】
　　先求乙角

　　术为以甲乙邉比甲丙邉若丙角
　　正与乙角正

　　一　甲乙【丙角对邉】　　　七千○三十四尺
　　二　甲丙【乙角对邉】　　　八千尺
　　三　丙角【六十度】正　八六六○三
　　四　乙角　　正　九八四九六
　　捡正表得乙角八十度○三分
　　次求甲角
　　以丙角乙角相并得【一百四十度○三分】以减半周余三十九度五十七分为甲角
　　次求乙丙邉
　　术为以乙角之正比甲角之正若甲丙邉之与乙丙邉
　　一　乙角【八十度○三分】正　九八四九六
　　二　甲角【三十九度五十七分】正　六四二一二
　　三　甲丙【乙角对邉】　　　　　八千尺
　　四　乙丙【甲角对邉】　　　　　五千二百一十五尺计开
　　先有之三件
　　丙角【六十度】　甲丙邉【八千尺】　乙甲邉【七千○三十四尺】
　　今求得三件
　　乙角【八十度○三分】　甲角【三十九度五十七分】　乙丙邉【五千二百一十五尺】右例有两邉一角而角与一邉相对是为锐角形第二术之第一支







　　假如【甲乙丙】锐角形有甲丙邉【四百尺】乙丙邉【二百六十一尺○八分】丙角【六十度】　角在两邉之中不与邉对求甲乙邉
　　先求中长线分为两句股形
　　术为以半径比丙角正若甲
　　丙邉与甲丁中长线

　　一　半径　　　　　一○○○○○
　　二　丙角【六十度】正　○八六六○三
　　三　甲丙邉　　　　四百尺
　　四　甲丁中长线　　三百四十六尺四寸一分次求丙丁邉【即所分甲丁丙形之句而甲丙为之】
　　术为以半径比丙角余若甲丙邉与丙丁邉
　　一　半径　　　　　一○○○○○
　　二　丙角【六十度】余　　五○○○○
　　三　甲丙邉　　　　四百尺
　　四　丙丁邉　　　　二百尺
　　次求乙丁邉【即所分甲丁乙形之句而甲丁为之股】
　　以丙丁与丙乙相减余六十一尺○八分为乙丁次求丁甲乙分角【即分形甲丁乙句股之甲角】
　　术为以甲丁中长线比乙丁分邉若半径与甲分角切线
　　一　甲丁中长线　三百四十六尺四寸一分
　　二　乙丁分邉　　　六十一尺○八分
　　三　半径　　　　一○○○○○
　　四　甲分角切线　　一七六三三
　　捡切线表得一十度为甲分角
　　末求甲乙邉
　　术为以半径比甲分角割线若甲丁中长线与甲乙邉
　　一　半径　　　　　　一○○○○○
　　二　甲分角【十度】割线　一○一五四三
　　三　甲丁中长线　　　三百四十六尺四寸一分
　　四　甲乙邉　　　　　三百五十一尺七寸五分求甲全角
　　以丙角【六十度】之余角三十度【即分形甲丁丙之甲分角】与求到甲分角【一十度】相并得四十度为甲全角
　　求乙角
　　以甲分角【一十度】减象限得八十度为乙角【或并丙甲二角减半周亦同】
　　计开
　　先有之三件
　　甲丙邉【四百尺】　乙丙邉【二百六十一尺○八分】　丙角【六十度】
　　今求得三件
　　甲乙邉【三百五十一尺七寸五分】　甲角【四十度】　乙角【八十度】右例有两邉一角而角在两邉之中不与邉对故用分形以取句股是为锐角形第二术之第二支
　　又术【新増】　用切线分外角
　　假如【甲乙丙】锐角形有甲丙邉【四百尺】乙丙邉【二百六十一尺○八分】丙角【六十度】　此即前例但求甲角
　　术以【甲丙乙丙】两邉相并为总相减为
　　较又以丙角【六十度】减半周得外
　　角【一百二十度】半之得半外角【六
　　十度】捡其切线依三率法求得半
　　较角以减半外角得甲角
　　一　两邉总　　　六百六十一尺○八分
　　二　两邉较　　　一百三十八尺九寸二分
　　三　半外角切线　一七三二○五
　　四　半较角切线　　三六三九七
　　捡切线表得【二十度】为半较角转与半外角【六十度】相减得甲角四十度
　　次求乙角
　　并甲丙二角共【一百度】以减半周得余八十度为乙角次求甲乙邉
　　一　甲角【四十度】正　六四二七九
　　二　丙角【六十度】正　八六六○三
　　三　乙丙邉　　　　二百六十一尺○八分
　　四　甲乙邉　　　　三百五十一尺七寸五分



　　锐角形第三术　有三邉求角
　　假如【甲乙丙】锐角形有乙丙邉【二十丈】甲丙邉【一十七丈五尺八寸五分】乙甲邉【一十三丈○五寸】
　　术曰任以【乙丙】大邉为底从甲角
　　作甲丁虚垂线至底分为两句股
　　形
　　一甲丁丙形以甲丙邉为丁丙
　　为句
　　一甲丁乙形以甲乙邉为丁乙为句
　　两相并为总相减为较　两句相并【即乙丙邉原数】为句总求两句相减之数为句较
　　术为以句总比总若较与句较也
　　一　两句之总【即乙丙】　二十丈
　　二　两之总　　　三十丈○六尺三寸五分三　两之较　　　四丈五尺三寸五分
　　四　两句之较【即丙戊】　六丈九尺四寸六分
　　求分形之两句
　　以句较【六丈九尺四寸六分】减句总【二十丈即乙丙】余乙戊【一十三丈○五寸四分】半之得丁乙【即戊丁】六丈五尺二寸七分为【甲丁乙】分形之句
　　又以戊丁【六丈五尺二寸七分】加句较【六丈九尺四寸六分　即戊丙】得丁丙一十三丈四尺七寸三分为【甲丁丙】分形之句
　　求丙角
　　术为以甲丙比丁丙句若半径与丙角之余
　　一　甲丙邉　　一十七丈五尺八寸五分
　　二　丁丙分邉　一十三丈四尺七寸三分
　　三　半径　　　一○○○○○
　　四　丙角余　　七六六一六
　　捡余表得丙角四十度
　　求甲角
　　术先求分形大半之甲角
　　以丙角【四十度】减象限余五十度为【丁甲丙】分形之甲角
　　次求分形小半之甲角
　　术为以甲乙比丁乙句若半径与分形甲角之正
　　一　甲乙邉　　　一十三丈○五寸
　　二　丁乙分邉　　　六丈五尺二寸七分
　　三　半径　　　　一○○○○○
　　四　甲分角正　　五○○一五
　　捡正表得三十度为【丁甲乙】分形之甲角
　　并分形两甲角【先得五十度后得三十度】得共八十度为甲全角求乙角
　　倂丙甲二角共【一百二十度】以减半周得余六十度为乙角计开
　　先有三邉
　　甲丙邉【一十七丈五尺八寸五分】　乙丙邉【二十丈】乙甲邉【一十三丈○五寸】
　　求得三角
　　丙角【四十度】　甲角【八十度】　乙角【六十度】

　　钝角形第一术　有两角一邉求余角余邉
　　假如【乙丙丁】钝角形有丙角【三十六度半】乙角【二十四度】丁乙邉【五十四丈】
　　先求丁角
　　术以丙乙二角并之共【六十度半】以减半周得余一百一十九度半
　　为丁钝角

　　次求乙丙邉
　　术为以丙角正比丁角正若乙丁邉与乙丙邉
　　一　丙角【三十六度二十分】正　五九四八二
　　二　丁角【一百十九度三十分】正　八七○三六
　　三　乙丁邉　　　　　　五十四丈
　　四　乙丙邉　　　　　七十九丈○一寸
　　右所用丁角正即六十度半正以钝角度减半周用之凡钝角并同
　　求丁丙邉
　　术为以丙角正比乙角正若乙丁邉与丁丙邉
　　一　丙角【三十六度三十分】正　五九四八二
　　二　乙角【二十四度】正　四○六七四
　　三　乙丁邉　　　　　五十四丈
　　四　丁丙邉　　　　　三十六丈九尺二寸
　　计开
　　先有之三件
　　丙角【三十六度半】　乙角【二十四度】　丁乙邉【五十四丈】
　　今求得三件
　　丁钝角【一百一十九度半】　乙丙邉【七十九丈○一寸】　丁丙邉【三十六丈九尺二寸】


　　钝角形第二术　有一角两邉求余角余邉
　　亦分二支
　　一先有对角之邉
　　一先有二邉皆角旁之邉而不对角
　　假如【甲乙丙】钝角形有乙角【九十九度五十七分】甲丙对邉【四千尺】甲乙邉【三千五百一十七尺】
　　求丙角

　　术为以甲丙对邉比甲乙邉若
　　乙角正与丙角正

　　一　甲丙邉　　　　　　四千尺
　　二　甲乙邉　　　　　　三千五百一十七尺三　乙角【九十九度五十七分】正　九八四九六【即八十度三分正】
　　四　丙角　　　　正　八六六○三
　　捡表得丙角六十度
　　求甲角
　　并乙丙二角【共一百五十九度五十七分】以减半周得余二十度○三分为甲角
　　求乙丙邉
　　术为以乙角之正比甲角之正若甲丙对邉与乙丙邉
　　一　乙角【九十九度五十七分】正　九八四六九
　　二　甲角【二十○度三分】正　三四二八四
　　三　甲丙邉　　　　　　四千尺
　　四　乙丙邉　　　　　　一千三百九十二尺计开
　　先有之三件
　　乙钝角【九十九度五十七分】　甲丙邉【四千尺】　甲乙邉【三千五百一十七尺】
　　今求得三件
　　丙角【六十度】　甲角【二十度○三分】　乙丙邉【一千三百九十二尺】右例有两邉一角而先有对角之邉是为钝角形第二术之第一支






　　假如【乙丁丙】钝角形有乙丁邉【一千零八十尺】乙丙邉【一千五百八十二尺】乙角【二十四度】　角在两邉之中不与邉对
　　术先求形外之虚垂线补成正方角
　　从不知之丙角作虚垂线于形外
　　如丙戊亦引乙丁线于形外如丁
　　戊两虚线遇于戊成正方角
　　术为以半径比乙角正若乙丙邉
　　与丙戊
　　一　半径　　　　　一○○○○○
　　二　乙角【二十四度】正　　四○六七四
　　三　乙丙邉　　　　一千五百八十二尺
　　四　丙戊邉【即虚垂线】　　　六百四十三尺
　　又以半径比乙角之余若乙丙邉与乙戊
　　一　半径　　　　　一○○○○○
　　二　乙角【二十四度】余　　九一三五五
　　三　乙丙邉　　　　一千五百八十二尺
　　四　乙戊邉【即乙丁引长线】　一千四百四十五尺
　　以原邉乙丁【一千○八十尺】与引长乙戊邉相减得丁戊【三百六十五尺】为形外所作虚句股形之句【则先得丙戊垂线为股而原邉丁丙为之】
　　求丁丙邉
　　依句股求术以丙戊股自乗【四十一万三千四百四十九尺】丁戊句自乗【一十三万三千二百二十五尺】并之得数【五十四万六千六百七十四尺】为实平方开之得七百三十九尺为丁丙邉
　　求丙角
　　术为以丁丙邉比丁乙邉若乙角正与丙角正
　　一　丁丙邉　　　　　七百三十九尺
　　二　丁乙邉　　　　一千○八十尺
　　三　乙角【二十四度】正　四○六七四
　　四　丙角　　正　五九四四二
　　捡表得丙角三十六度二十九分
　　求丁角
　　并乙丙二角共【六十度二十九分】以减半周得余一百一十九度三十一分为丁钝角
　　计开
　　先有之三件
　　乙丁邉【一千零八十尺】　乙丙邉【一千五百八十二尺】　乙角【二十四度】
　　今求得三件
　　丁丙邉【七百三十九尺】　丙角【三十六度二十九分】　丁钝角【一百一十九度三十一分】
　　右例有两邉一角而两邉并在角之两旁不与角对是为钝角形第二术之第二支




　　又术【新增】　用切线分外角
　　假如【乙丙丁】钝角形有丁乙邉【五百四十尺】丙乙邉【七百九十一尺】乙角【二十四度】　角在两邉之中不与邉对求丙角



　　以【丁乙丙乙】两邉相并为总相减为较又以乙角【二十四度】减半周得外角【一百五十六度】半之得半外角【七十八度】捡其切线得四七○四六三
　　术为以邉总比邉较若半外角切线与半较角切线
　　一　两邉之总　　一千三百三十一尺
　　二　两邉之较　　　二百五十一尺
　　三　半外角切线　四七○四六三
　　四　半较角切线　　八八七一九
　　捡表得半较角【四十一度三十五分】以转减半外角【七十八度】得余三十六度二十五分为丙角
　　求丁角
　　并乙丙二角共【六十度二十五分】以减半周得一百一十九度三十五分为丁钝角
　　求丁丙邉
　　术为以丙角正比乙角正若乙丁邉与丁丙邉
　　一　丙角【三十六度二十五分】正　五九三六五
　　二　乙角【二十四度】正　四○六七四
　　三　乙丁邉　　　　　　五百四十尺
　　四　丁丙邉　　　　　　三百六十九尺九寸八分计开
　　先有之三件
　　丁乙邉【五百四十尺】　丙乙邉【七百九十一尺】　乙角【二十四度】
　　今求得三件
　　丙角【三十六度二十五分】　丁钝角【一百一十九度三十五分】　丁丙邉【三百六十九尺九寸八分】






　　钝角形第三术　有三邉求角【新式】
　　假如【乙丙丁】钝角形有乙丙邉【三百七十五尺】乙丁邉【六百○七尺】丁丙邉【三百尺】
　　术自乙角作虚垂线至甲又引丁
　　丙线横出遇于甲而成正方角则
　　成乙甲丁句股形
　　又引横线至辛使甲辛如丙甲成
　　乙甲辛句股形则丁辛为两句之
　　总而所设丁丙邉为两句之较
　　又乙丁邉为大形【乙甲丁】之乙丙邉为小形【乙甲辛即乙甲丙】之两相并为总相减为较
　　术为以句较比较若总与句总
　　一　句较【即丁丙邉】　　　　三百尺
　　二　较【即乙丁内减乙丙之余】　二百三十二尺
　　三　总【即乙丁乙丙二邉相并】　九百八十二尺
　　四　句总　　　　　　七百五十九尺四寸
　　以句较【三百尺】减所得句总【七百五十九尺四寸】余数【五百二十九尺四寸】为大形之句甲丁
　　求丁角【用乙甲丁大形】
　　术为以乙丁比丁甲句若半径与丁角之余
　　一　乙丁　　六百○七尺
　　二　甲丁句　　五百二十九尺七寸
　　三　半径　　　一○○○○○
　　四　丁角余　　八七二六五
　　捡表得丁角二十九度一十四分
　　求丙角【用乙甲丙小形】
　　术为以甲丙句比乙丙若半径与丙角之割线
　　一　甲丙句　　二百二十九尺七寸
　　二　乙丙　　三百七十五尺
　　三　半径　　　一○○○○○
　　四　丙角割线　一六三二五六
　　捡表得丙角【五十二度一十四分】为本形之丙外角以减半周得丙钝角一百二十七度四十六分
　　求乙角
　　并丁丙二角所得度分【共一百五十七度】以减半周得余二十三度为乙角
　　计开
　　先有三邉
　　乙丙邉【三百七十五尺】　乙丁邉【六百七尺】　　丁丙邉【三百尺】
　　求得三角
　　丁角【二十九度一十四分】　丙钝角【一百二十七度四十六分】　乙角【二十三度】
　　右例钝角形三邉求角作垂线于形外径求钝角乃新式也若以大邉为底从钝角分中长线同锐角第三术


　　厯算全书卷五十一
　　钦定四库全书
　　厯算全书卷五十二
　　宣城梅文鼎撰
　　三角法举要卷三
　　内容外切【三角测量之用在邉与角而其内容外切亦所当明故次于算例之后】内容有二曰本形曰他形
　　一三角求积
　　积谓之幂亦谓之面乃本形所有
　　一三角容员
　　一三角容方
　　以上皆形内所容之他形
　　外切惟一
　　一三角形外切之员



　　三角求积第一术
　　底与髙相乗折半见积
　　内分二支
　　一句股形即以句股为底为髙
　　一锐角钝角形任以一邉为底而求其垂线为髙
　　假如句股形甲乙股【一百二十尺】乙丙句【三十五尺】求积
　　术以甲乙股乙丙句相乗【四千二百尺】折半得积
　　凡求得句股形积二千一百尺
　　如图甲乙股与乙丙句相乗成甲
　　乙丙丁长方形其形半实半虚故
　　折半见积
　　或以句折半【十七尺半】乗股亦得积【二千
　　一百尺】
　　如图乙丙句折半于戊以乙戊乗
　　甲乙成甲乙戊丁形是移丙戊己
　　补甲丁己也
　　或以股折半【六十尺】乗句亦得积【二千
　　一百尺】
　　如图甲乙股折半于己以己乙乗
　　乙丙成己乙丙丁形是移甲己戊
　　补戊丁丙也
　　右句股形以句为底以股为髙若以股为底则句又为髙可互用也
　　句股形有立有平若平地句股以句为濶以股为长其理无二
　　论曰凡求平积皆谓之幂其形如网目又似窓櫺之空皆以横直相交如十字亦如机杼之有经纬而成布帛故句股是其正法何也句股者方形斜剖之半也折半则成正剖之半方形矣其他锐角钝角或有直无横有横无直必以法求之使成句股然后可算故句股者三角法所依以立也

　　假如锐角形甲乙邉【二百三十二尺】甲丙邉【三百四十尺】乙丙邉【四百六十八尺】求积
　　术先求垂线用锐角第三术任以
　　乙丙邉为底以甲丙甲乙为两
　　两之较数【一百零八尺】总数【五百七十二尺】相乗【六万一千七百七十六尺】为实以乙丙底
　　为法除之得数【一百三十二尺】转减乙丙余数【三百三十六尺】半之得乙丁【一百六十八尺】依句股法以乙丁自乗【二万八千二百二十四尺】与甲乙自乗【五万三千八百二十四尺】相减余数【二万五千六百尺】平方开之得甲丁垂线【一百六十尺】以甲丁垂线折半乗乙丙底得积凡求得锐角形积三万七千四百四十尺
　　如图移辛补壬移庚补癸则成长
　　方形即垂线折半乗底之积
　　右锐角形任以乙丙邉为底取垂
　　线求积若改用甲乙或甲丙邉为
　　底则所得垂线不同而得积无异故可以任用为底假如钝角形甲乙邉【五十八步】甲丙邉【八十五步】乙丙邉【三十三步】求积
　　术求垂线立于形外用钝角第三
　　术以乙丙为底甲乙甲丙为两
　　总数【一百四十三步】较数【二十七步】相乗【三千八百
　　六十一步】为实乙丙底为法除之得数
　　【一百一十七步】内减乙丙余数【八十四步】折半
　　【四十二步】为乙丁【即乙丙引长邉】依句股法乙丁自乗【一千七百六十四步】甲乙自乗【三千三百六十四步】相减余数【一千六百步】平方开之得甲丁【四十步】为形外垂线以乙丙底折半【十六步半】乗之得积
　　凡求得钝角形积六百六十步
　　如图甲乙丙钝角形移戊补庚移
　　庚己补壬癸又移壬子补辛成辛
　　癸丑长方即乙丙底折半乗中长
　　甲丁之积
　　右钝角形以乙丙为底故从甲角作垂线若以甲乙为底则自丙角作垂线亦立形外而垂线不同然以之求积并同若以甲丙为底从乙角作垂线则在形内如锐角矣其垂线必又不同而其得积无有不同故亦可任用一邉为底
　　凡用垂线之髙乗底见积必其线上指天顶底线之横下应地平两线相交正如十字故其所乗之幂积皆成小平方可以虚实相补而求其积数钝角形引长底线以作垂线立于形外则两线相遇亦成十字正方之角矣
　　总论曰三角形作垂线于内则分两句股钝角形作垂线于外则补成句股皆句股法也






　　三角求积第二术
　　以中垂线乗半周得积谓之以量代算
　　假如钝角形乙丙邉【五十八步】甲乙邉【一百一十七步】甲丙邉【八十五步】求积
　　术平分甲乙两角各作线防于心从
　　心作十字垂线至乙甲邉【如心庚】即中
　　垂线也乃量取中垂线【心庚】得数【一十八步】
　　合计三邉而半之【一百三十步】为半周以半周乗中垂线得积
　　凡求得钝角形积二千三百四十步
　　又术如前取中垂线【心庚】为濶半周为
　　长【如乙癸及丁壬】别作一长方形【如乙壬丁癸】即
　　与【甲乙丙】钝角形等积
　　解曰凡自形心作垂线至各邉皆等故中垂线乗半周为一切有法之形所公用方员及五等面六等面至十等面以上并同故以中垂线为濶半周为长其所作长方形即与三角形等积
　　又解曰中垂线至邉皆十字正方角即分各邉成句股形以乗半周得积即句股相乗折半之理
　　附分角术　有甲角欲平分之
　　术以甲角为心作虚半规截角旁两
　　线得辛壬二防乃自辛自壬各用为
　　心作弧线相遇于癸作癸甲线即分
　　此角为两平分
　　三角求心术
　　如上分角术于甲角平分之于乙角
　　又平分之两平分之线必相遇成一
　　防此一防即三角形之心
　　解曰试再于丙角如上法分之则亦
　　必相遇于原防



　　三角求积第三术
　　以三较连乗又乗半总开方见积
　　假如钝角形甲乙邉【一百一十六尺】甲丙邉【一百七十尺】乙丙邉【二百三十四尺】求积
　　术合计三邉而半之【二百六十尺】为半总
　　以与甲乙邉相减得较【一百四十四尺】与甲
　　丙邉相减得较【九十尺】与乙丙邉相减
　　得较【二十六尺】三较连乗【以两较相乗得数又以余一较】
　　【乗之也】得数【三十三万六千九百六十尺】又以半总较之得数【八千七百六十万零九千六百尺】平方开之得积
　　凡求得钝角形积九千三百六十尺
　　若系锐角同法
　　解曰此亦中垂线乗半周之理但所得为幂乗幂之数故开方见积详或问


　　三角容员第一术
　　以与句股求容员径【此术惟句股形有之凡句股相并为和以和与并为和和以和与相减为和较】
　　假如【甲乙丙】句股形甲丙句【二十步】乙甲股【二十一步】乙丙【二十九步】求容员径
　　术以句股和【四十一步】与相减得数为容员径
　　凡求得内容员径一十二步
　　解曰此以和较为容员径
　　如图从容员心作半径至邉又作
　　分角线至角成六小句股形则各
　　角旁之两线相等【如丙戊丙庚两线在丙角旁则
　　相等乙庚乙己在乙角旁甲戊甲己在甲角旁并两线相等】
　　其在正方角旁者【甲戊甲己】乃和较也【于乙丙内分丙庚以对丙戊又分乙庚以对乙己则其余为甲戊及甲己此即句股和与乙丙相较之数也】然即为内容员径何也各角旁两线并自相等而正方角旁之两线又皆与容员半径等【正方角旁两小形之角皆平分方角之半则句股自相等而甲戊等心戊甲己等心己】然则和较者正方角旁两线【甲戊甲己】之合即容员两半径【心戊心己】之合也故和较即容员径也
　　试以甲戊为半径作员则戊心亦
　　半径而其全径【癸戊甲】与容员径【丁心
　　己】等以甲己为半径作员则己心
　　亦半径而其全径【辛己甲】与容员径
　　【戊心壬】亦等

　　三角容员第二术
　　以周与积求容员径
　　内分二支
　　一句股形以和和为用【亦可用半】
　　一锐角钝角形以全周半周为用
　　假如【甲乙丙】句股形甲丙句【一十六步】甲乙股【三十步】乙丙【三十四步】求容员径
　　术以句股相乗得数【四百八十步】为实并句股数【共八十歩】为法除之得数倍之为容员径
　　凡求得容员径一十二步
　　解曰此以和和除句股倍积得容员半径也
　　如图从容员心作对角线分其形为三【一甲心丙一甲心乙一丙心乙】乃于甲丙句线两端各引长之截子甲如乙甲股截丙丑如丙乙则子丑线即和和也乃自员心作癸壬直线与丑子平行两端各聫之成长方又作辛丙线分为三长方形其濶并如员半径其长各如句如股如
　　而各为所分三小形之倍积【甲辛长方
　　如甲丙句之长而以心戊半径为濶即为甲心丙分形之倍甲癸长
　　方如乙甲股之长而以同心己之半径为濶即为乙心甲形之倍丙
　　壬长方如丙乙之长而以同心庚之半径为濶即为乙心丙形之
　　倍】合之即为本形倍积与句股相
　　乗同也【句股相乗为倍积见求积条】故以和
　　和除句股相乗积得容员半径

　　假如【甲乙丙】句股形甲丙句【八十八尺】甲乙股【一百零五尺】乙丙【一百三十七尺】求容员径
　　术以句股相乗而半之得积【四千六百二十尺】为实并句股数而半之【一百六十五尺】为法除之得数倍之为容员径凡求得内容员径五十六尺
　　解曰此以半周除句股形积而得容员半径也【半周即和和之半】
　　如图从容员心分本形为六小句股则同角之句股各
　　相等可以合之而各成小方形【同甲角之
　　两句股成丁己小方形同丙角之两句股可合之成丁辛长方形以心辛
　　丙形等丙戊心也同乙角之两句股可合之成己庚长方形以乙庚心形
　　等心戊乙也】乃移己庚长方为辛癸长方
　　则癸甲即同半周而癸己大长方即
　　为半周乗半径而与句股积等也【六小形之句皆原形之周变为长方则两两相得而各用其半是半周也癸甲及壬己之长并半周壬癸及己甲辛丙之间并同心丁是半周乗半径也辛癸长方与己庚等积即与乙角旁两句股等积又丁辛长方与丙角旁两句股等积再加丁己形即与原设乙甲丙句股形等积矣】然则以句股相乗而半之者句股形积也故以半周除之即容员半径矣
　　或以和和除四倍积得容员全径并同前论
　　论曰句股形古法以和较为容员径与和和互相乗除乃至精之理测员海镜引伸其例以为测望之用其变甚多三角容员盖从此出故为第一支


　　假如【甲乙丙】锐角形乙丙邉【五十六尺】甲丙邉【七十五尺】甲乙邉【六十一尺】求容员径
　　术以乙丙邉为底求得甲丁中长线【六十尺○法见求积】以乗底得数【三千三百六十尺】倍之【六千七百二十尺】为实合计三邉【共一百九十二尺】为法除之得容员径
　　凡求得内容员径三十五尺
　　解曰此以全周除四倍积得容员
　　径也
　　如图自容员心作对角线分为
　　小三角形三各以员半径为髙
　　各邉为底若于各邉作长方而
　　各以邉为长半径为濶必倍大
　　于各小三角形【如壬丙长方倍大于丙心乙形
　　丙丑长方倍大于丙心甲形甲丁长方倍大于甲心乙形】又
　　作加一倍之长方则四倍大于
　　各小三角【如未乙长方倍大于丙壬长方必四倍于】
　　【丙心乙三角则夘甲亦四倍于丙心甲而甲酉亦四倍于甲心乙】于是而通为一大长方【移夘甲长方为亥丙移甲酉为乙辰则成亥午大长方形矣】必四倍原形之幂而以三邉合数为长以容员之径为濶然则以中长线乗底而倍之者正为积之四倍也以三邉除之岂不即得员径乎
　　或以全周除倍积得容员半径
　　或以半周除积得容员半径并同
　　若钝角形亦同上法
　　论曰锐角钝角并以周为法此与句股形用和和同但必先求中长线故为第二支






　　三角容员第三术
　　以中垂线为员半径曰以量代算
　　假如【甲乙丙】三角形求容员径【既不用算故不言邉角之数】
　　如求积术均分甲乙二角之度各
　　作虚线交于己即己为容员之心
　　次以己为心尽一邉为界运规作
　　员此员界必切三邉
　　于是从己心向三邉各作十字垂线必俱在切员之防而等为员半径知半径知全径矣【半径各如己庚线】
　　论曰此容员心即三角形之心【故以容员半径乗半总即得积也】又案此术亦句股及锐钝两角通用





　　三角容员第四术
　　用三较连乗
　　假如【甲乙丙】钝角形乙丙邉【四百三十二尺】甲丙邉【五百尺】甲乙邉【一百四十八尺】求容员径
　　术以半总【五百四十尺】求得乙丙邉较
　　【一百○八尺】甲丙邉较【四十尺】乙甲邉较
　　【三百九十二尺】三较连乗得数【一百六十九万三千
　　四百四十尺】以半总除之得数【三千一百三十】
　　【六尺】四因之【一万二千五百四十四尺】为实平方开之得容员径凡求得内容员径一百一十二尺
　　锐角同法
　　解曰此所得者为容员径上之自乗方幂故开方得径




　　三角容方第一术
　　合底与髙除倍积得容方径
　　内分二支
　　一句股形即以句股为底为髙【即句股和也其容方依正方角】一三角形以一邉为底求其垂线为髙【句股形以为底锐角形三邉皆可为底钝角形以大邉为底其容方并依为底之邉】
　　假如【甲乙丙】句股形甲丙股【三十六尺】乙丙句【一十八尺】求容方依正方角而以容方之一角切于
　　术以句股相乗得数【六百四十八尺】为实以句股和【五十四尺】为法除之得所求
　　求到内容方径一十二尺
　　如图作寅乙线与股平行作寅甲
　　线与句平行成寅丙长方为句股
　　形倍积
　　次引寅甲线横出截之于癸引乙
　　丙句横出截之于夘使引出两线
　　【甲癸及丙夘】皆如甲丙股仍作夘癸线聫之
　　乃从癸作斜线至乙割甲丙股于戊则戊丙为所求容方之邉又从戊作申未横线与上下两线平行割甲乙于己则己戊为所求容方之又一邉末从己作午辛立线割丙乙句于辛则己辛及辛丙又为两对邉而四邉相等为句股形内所容之方
　　解曰寅夘大长方以癸乙斜线分两句股则相等而寅戊与戊夘两长方等则寅丙长方与申夘长方亦等【寅丙内减寅戊而加相等之戊夘即成申夘】夫寅丙者句股倍积而申夘者句股和乗容方径也【乙丙句丙夘股合之为申夘形之长申乙及未夘并同方径为濶】故以句股和除倍积得容方径
　　又解曰寅丙长方分两句股而等则寅戊与午丙两长方等【寅己与己丙既等则于寅戊内减寅己而加相等之己丙即成午丙】而寅戊原等戊夘则午丙亦与戊夘等夫午丙形之丙甲与戊夘形之丙夘皆股也则两形等积又等邉矣其长等其濶亦等【甲丙与丙夘既等则辛丙与戊丙亦等】而对邉悉等即成正方形
　　论曰此以句为底股为髙也若以股为底句为髙所得亦同其容方依正方角乃古法也三角以底濶合中长除积盖生于此是为第一术之第一支
　　假如【甲乙丙】句股形乙丙二十八尺其积一百六十八尺求容方依线而以容方之两角切于句股术以除倍积【三百三十六尺】得对角线【一十二尺】与相并【四十尺】为法倍积为实法除实得所求
　　求到容方径八尺四寸
　　如图作寅丑线与乙丙平行又作
　　寅丙及丑乙与甲丁对角线平行成
　　丑丙长方为句股形倍积
　　次引乙丙至夘引寅丑线至癸使
　　癸丑及夘乙并同甲丁仍作癸夘线
　　聫之
　　次从癸向丙作斜线割丑乙线于子遂从子作申未线与乙丙平行割甲乙股于庚割甲丙句于己则庚己为容方之一邉末从庚作辰壬线从己作午辛线并与甲丁平行而割乙丙于壬于辛则辛壬及庚壬及己辛三线并与庚己等而成正方
　　解曰寅子长方与子夘长方等积【癸丙线分寅夘形为两句股而等则两句股内所作之方必等】午壬长方又与寅子等【寅丁形以甲丙线分为两句股则寅己与己丁等又丑丁形以甲乙线分为两句股则丑庚与丁庚等若移寅己作己丁移丑庚作丁庚则午丁等寅戊而辰丁等丑戊合之而午壬等寅子】则午壬亦与子夘等而午壬之邉【午辛及辰壬】子夘之邉【夘乙及未子】并等甲丁对角线则两形【午壬子夘】等积又等邉矣其长等其濶亦等【辰壬既等夘乙则辛壬亦等子乙而庚壬及己辛亦不得不等】故四线必俱等也
　　又解曰寅子既与子夘等则寅乙必与申夘等【于寅乙内移寅子居子夘之位即成申夘】而寅乙者倍积也申夘者底偕中长乗容方径也【乙丙也夘乙即甲丁对角中长线也合之为丙夘之长其两端之濶申丙及未夘并同方径】故合与对角线为法以除倍积得容方径
　　论曰此以一邉为底中长线为髙也既以一邉为底其容方即依此一邉而以两方角切余二邉也句股形故以为底若锐角形则任以一邉为底但依大邉则容方转小亦如句股形依方角之容方必大于依线之容方也钝角形但可以大邉为底其求之则皆一法也是为第一术之第二支




　　三角容方第二术
　　以图算
　　内分二支
　　一以法截中长线得容方径【句股形即截其邉】
　　一以法截两斜邉得容方边【句股形即截其】
　　假如锐角形求容方任以一邉为底
　　如图以乙丙最小邉为底先从对角甲作中长垂线至丁又从乙角作丑乙立线与甲丁平行而等乃从甲角
　　作横线过丑至癸截丑癸亦如甲
　　丁乃从癸向丙角作斜线割丑乙
　　立线于子末以子乙之度截中长
　　线【甲丁垂线】于戊即戊丁为容方之径
　　【从戊作己庚又从己作线至辛从庚作线至壬成庚己辛壬即所求
　　容方】
　　解曰甲戊与戊丁若甲丁与乙丙【子丑癸句股与子乙丙形有子交角必相似则丑子句与子乙句若丑癸股与乙丙股而丑子原与甲戊等子乙与戊丁等丑癸与甲丁等则甲戊与戊丁亦若甲丁与乙丙】又甲戊与己庚若甲丁与乙丙【甲己庚三角为甲丙乙之截形必相似则甲戊与己庚若甲丁与乙丙】
　　合两比例观之则甲戊与戊丁若甲戊与己庚而己庚即戊丁
　　以上并锐角形
　　凡锐角三邉并可
　　为底而皆一法






　　假如句股形求容方以股为底则于句端甲作横线与股平行而截之于癸使癸甲如甲乙句乃自癸向丙作斜线割甲乙句于戊则戊乙即容方之一邉末作己戊与股平行作己辛与句平行即成容方【或以句为底则从股端丙作丙癸横线与股等亦作癸甲斜线割丙乙股于戊其所得容方亦同图如左】





　　论曰锐角钝角皆截中长线为容方径句股形以为底亦然惟句股形以句为底即截其股为容方径【用股为底即截句】不另求中长而与截中长之法并同是为第二术之第一支





　　假如乙丙丁三角求容方　依乙丙邉为底
　　如图以乙丙底作正方形【即甲乙丙戊方】又作丁辛对角线次作甲辛及戊
　　辛两斜线割原形之两斜线于己
　　于庚乃作己庚线为所求容方之
　　一邉【末作己壬及庚癸两线成小方形于形内即所求】
　　解曰甲戊与己庚若子辛与午辛也【己庚辛三角形为甲戊辛之切形则其横与直之比例相等】而甲戊与子辛同为方径而等则己庚与午辛亦同为小方径而等
　　若底上方形大则其径亦大于对
　　角线则如第二图引丁辛线至子
　　其理亦同
　　有此二法则三邉并可为底
　　钝角形用大邉为底句股形用为底并同第二图
　　若句股形以句为底求容方如图即用乙丙句作【丙辛庚乙】方形从方角庚向丙作斜线割丁乙于壬从壬作癸
　　壬及甲壬二线即所容方【或用股上方则
　　引出句邉如股】
　　解曰庚丙线分丙角为两平分则
　　其横直线自相等【壬癸与癸丙相等壬甲与甲丙】
　　【相等则四线皆等】而成正方嘉禾陈防庵用分角法求容方与此同理
　　论曰此皆以底上方形为法而得所求小方也故不论顶之偏正其所得容方并同惟句股容方依正方角则中长线与原邉合而为一法虽小异其用不殊是为第二术之第二支






　　三角形外切平员第一术
　　句股形以为径
　　假如甲乙丙句股形乙丙长四尺五寸二分求外切员
　　术以折半取心得半径二尺二寸六分其长四尺五寸二分即外切平员全径以平员周率三五五乗之径率一一三除之得员周一十四尺二寸
　　如图乙丙员径即句股形之折半于丁即员心也以
　　乙丁半径为度从丁心运规作员
　　必过甲而句股形之角皆切员周
　　矣

　　论曰凡平员径上从两端各作直线至员周相防则成正方角【如乙丙径之两端于丙于乙各作直线防于甲则甲角必为正角】而为句股形【假令两线相遇于庚即成庚乙丙句股形于辛亦然以其皆正角故也】故不问句股长短而并以其为外切员之径
　　又论曰径一百一十三而周三百五十五此郑端清世子所述祖冲之术也【见律吕精义】按古率周三径一李淳风等释古九章以为术从简易举大纲而言之诚为通论诸家所传径五十周一百五十七则魏刘徽所改谓之徽率径七周二十二则祖冲之所定谓之宻率由今以观冲之自有两率【一为七与二十二一为一一三与三五五】盖以其捷者为恒用之须而存其精者明测算之理亦可以观古人之用心矣
　　三角形外切平员第二术
　　分邉取员心内分二支并以图算
　　一句股形但分一邉即得员心【其心在】
　　一锐角形钝角形并分二邉可得员心【锐角形员心在形内钝角形员心在形外】
　　假如甲乙丙句股形求外切员
　　术任于句或股平分之作十字正线此线过线之防即为员心
　　如图甲乙丙形以甲乙股平分于
　　戊从戊作庚丁正十字线至乙丙
　　即分为两平分而丁即员心
　　从丁运规作外切员则甲乙丙三
　　防并切员周而乙丁丙丁庚丁皆半径
　　论曰若平分甲丙句于辛从辛作十字正线亦必至丁故但任分其一邉即可得心
　　又论曰若依第一术先得丁心从丁心作直线与句平行即此线能分股线为两平分【如丁庚线与甲丙句平行过甲乙股即平分股线于戊】若与股平行而分句线亦然【如丁辛线与甲乙股平行即分句线于辛】右句股形外切平员之心在线中央





　　假如锐角形求形外切员
　　术任以两邉各平分之作十字线引长之必相遇于一防即为员心
　　如图甲乙丙锐角形任以甲丙邉
　　平分之于戊作庚戊丁十字线又
　　任以乙丙邉平分之于壬作癸壬
　　丁十字线两直线稍引长之相遇
　　于丁以丁为心作员则甲乙丙三角并切员周而丁癸丁庚皆半径
　　论曰试于余一邉再平分之作十字正线亦必防于此防故此防必员心【如甲乙邉再平分之于辛作子辛丁十字线亦必相遇于丁防】
　　右锐角形外切平员之心在形之内




　　假如钝角形求形外切员　术同锐角
　　如图甲乙丙形甲为钝角任分甲
　　丙于戊分甲乙于辛各作十字线
　　防于丁心从丁作员则丁庚丁癸
　　皆半径而三角并切员周若用大
　　邉平分于壬作壬丁子线亦同
　　论曰试于丁心作线至丙至乙至甲必皆成员半径与丁庚丁癸同故丁为员心也
　　右钝角形外切平员之心在形之外
　　总论曰此与容员之法不同何也内容员之心即三角形之心故其半径皆与各邉为垂线而不能平分其邉然从心作线至角即能分各角为两平分此分角求心之法所由以立也外切员之心非三角形之心其心或在形内或在形外距邉不等而能以十字线剖各邉为两平分此分邉求心之法所由以立盖即三防串员之法也
　　附三防串员
　　有甲乙丙三防欲使之并在员周
　　术任以甲为心作虚员分用元度
　　以丙为心亦作虚员分两员分相
　　交于戊于辛作戊辛直线又任以
　　乙为心以丙为心各作同度之虚员分相交于庚于壬作庚壬直线两直线相遇于丁以丁为心作员则三防并在员周
　　员周有三防不知其心亦用此法






　　厯算全书卷五十二
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书卷五十三
　　宣城梅文鼎撰
　　三角法举要卷四
　　或问【三角大意畧具首卷中而入算取用仍有疑端喜同学之好问事事必求其所以然故不惮为
　　之详复以畅厥防】
　　一三角形用正为比例之理
　　一和较相求之理
　　一用切线分外角之理
　　一三较连乗之理
　　附三较求角





　　问各角正与各邉皆不平行何以能相为比例曰凡三角形一邉必对一角其角大者正大而所对之邉亦大角小者正小而所对之邉亦小故邉与邉之比例如正与正也
　　两正为两邉比例图
　　乙丙丁三角形丁乙邉大对丙角
　　丁丙邉小对乙角术为以丁乙邉
　　比丁丙邉若丙角之正与乙角
　　之正
　　解曰试以丁丙为半径作丁甲线为丙角正又截戊乙如丁丙半径作戊己线为乙角正丁甲正大于戊己故丁乙邉亦大于丁丙
　　问丁甲何以独为丙角正也曰此以丁丙为半径故也若以丁乙为半径则丁甲即为乙角之正如图用丁乙为半径作丁甲线为乙角正又引丙丁至戊令戊丙如丁乙半径作戊己线为丙角正
　　即见乙角之正丁甲小于戊己
　　故丁丙邉亦小于丁乙
　　解曰正者半径所生也故必两
　　半径齐同始可以较其大小前图
　　截戊乙如丁丙此图引丁丙如丁乙所以同之也
　　三正逓相为三邉比例图
　　乙丁丙钝角形丁钝角对乙丙大邉丙次大角对乙丁次大邉乙小角对丁丙小邉其各邉比例皆各角正之比例
　　试以乙丁为半径作丁甲线为乙
　　小角之正又引丙丁邉至戊使
　　戊丙如乙丁作戊己线为丙角之
　　正又展戊丙线至庚使庚丙如乙
　　丙作庚辛线为丁钝角之正【如此则三邉皆若三正皆若股】其比例为以乙丙大邉【同庚丙】比乙丁次邉【同戊丙】若丁钝角之正庚辛与丙角之正戊己
　　又以乙丁次大邉【同戊丙】比丁丙小邉若丙角之正戊己与乙角之正丁甲
　　又以丁丙小邉比乙丙大邉【同庚丙】若乙小角之正丁甲与丁钝角之正庚辛
　　问庚辛何以为丁角正曰凡钝角以外角之正为正试作乙癸线为丁角正【乙丁癸角外角也故其正即为丁钝角正】必与庚辛等何也庚丙辛句股形与乙丙癸形等【庚丙既同乙丙又同用丙角辛与癸又同为方角故其形必等】则庚辛必等乙癸而乙癸既丁角正矣等乙癸之庚辛又安得不为丁角正乎【凡取正必齐其半径此以丁甲为乙角正是用乙丁为半径也而取丙角正戊己必引戊丙如乙丁其丁角正庚辛又即外角之正乙癸是三半径皆乙丁也】
　　试取壬丙如丁丙作庚壬线即同
　　乙丁半径则壬角同丁角壬外角
　　即丁外角而庚辛正之半径仍
　　为乙丁【庚壬同乙丁故】
　　此以庚壬当乙丁易乙丁丙形为
　　庚壬丙则庚辛正亦归本位与前图互明
　　试以各角正同居一象限较其弧度
　　如图甲乙丙形丙角最大其正乙丁亦最大所对甲乙邉亦最大甲角次大其正丑壬亦次大所对
　　乙丙邉亦次大乙角最小其正
　　丙夘亦小所对丙甲邉亦最小【丙乙
　　二角正并乙丙为半径甲角取正截丑甲如乙丙亦以乙丙为
　　半径】乃别作一象弧【如戊己】仍用乙丙
　　为半径【取戊庚如乙丙】而以先所得各角
　　之余取度于丁作乙丁为丙角
　　之正于壬作丑壬为甲角之正
　　于夘作丙夘为乙角之正即
　　如元度而各角之差数覩矣【戊庚半径既同乙丙则丁庚即丁丙而为丙角余又壬庚即甲壬为甲角余夘庚即夘乙为乙角余】
　　解曰角无大小以弧而知其大小今乙丁正其弧乙己是丙角最大也丑壬正其弧丑己是甲角次大也丙夘正其弧丙己是乙角最小也而对邉之大小亦如之故皆以正为比例也
　　或疑钝角之度益大其正反渐小而其所对之邉则渐大何以能相为比例乎曰此易知也凡钝角正即外角之正而外角度原兼有余两角之度故钝角之正必大于余两角而得为大邉之比例也如乙丙甲钝角形丙钝角最大其正乙丁亦最大而所对乙甲邉亦最大乙角次大其正丙夘亦次大而所对甲丙邉亦次大甲角最小其正丑壬亦小而所对乙丙邉亦最小【截甲丑如乙丙从丑作丑壬即甲角正】
　　乃从乙作乙庚弧【以丙为心乙丙为半径】为
　　丙外角之度又作辛丙半径与甲
　　乙平行分乙庚弧度为两则辛庚
　　即甲角之弧度其余辛乙亦即乙
　　角之弧度从辛作辛未正与丑
　　壬等又自庚截癸庚度如辛乙则
　　癸庚亦乙角之弧作癸子正与丙夘等此显丙外角之度兼有乙甲两角之度其正必大于两角正也虽丙钝角加大而外角加小则乙甲两角必又小于外角又何疑于钝角正必为大邉比例乎
　　试更以各角切员观之则各角之对边皆为其对弧之通
　　如图三角形以各角切员则乙丙邉为丙戊乙弧之通而对甲角甲丙邉为丙己甲弧之通而对乙
　　角甲乙邉为乙庚甲弧之通而
　　对丙角则是各角之对邉即各角
　　对弧之通也夫通者正之
　　倍数则三邉比例即三正之比
　　例矣
　　又试以各邉平分之则皆成各角之正
　　于前图内更以各邉所当之弧皆平分之【丙戊乙弧平分于戊防丙己甲弧平分于己防乙庚甲弧平分于庚防】自员心【丁】各作半径至其
　　防即分各边为两平分【以丁壬戊
　　半径分乙丙边于壬以丁辛己半径分甲丙边于辛以丁
　　癸庚半径分甲乙边于癸则所分之边皆为两平分】则
　　弧之平分者即原设各角之
　　度而边之平分者即皆各角
　　之正【丙丁戊角以丙戊为弧丙壬为正而丙
　　丁戊角原为丙丁乙角之半必与甲角同大故丙戊半弧
　　即甲角之本度丙壬半边即甲角之正乙丁戊角亦然】
　　【凖此论之则甲丁己角原为甲丁丙角之半必与乙角同大故甲己半弧即乙角之本度甲辛半边即乙角之正己丁丙角亦然又乙丁庚角原为乙丁甲角之半必与丙角同大故乙庚半弧即丙角之本度乙癸半边即丙角之正庚丁甲角亦然】夫分其边之半即皆成正则边与边之比例亦必如正与正矣【全与全若半与半也】
　　问三角之本度皆用半弧何也曰量角度必以角为员心真度乃见今三角皆切员边则所作通之弧皆倍度也故半之乃为角之本度
　　如图以甲角爲心甲丁爲半径作员则其弧丑丁子乃甲角之本度也而平分之丙戊及戊乙两弧并与丑丁子弧等【试作戊丙及乙戊两必相等又并与丑子等凡等者弧亦等】故乙
　　戊丙弧必爲甲角之倍度
　　【余角类推】



　　问三邉求角何以用和较相乗也曰欲明和较之用当先知和较之根凡大小两方以其邉相并谓之和相减谓之较和较相乗者两方相减之余积也
　　如图甲癸小方丁癸大方于大方
　　内依小方邉作己庚横线又取己
　　辛如小方邉作辛壬线成己壬小
　　方与甲癸等大方内减己壬小方
　　则所余者为乙庚及庚壬两长方
　　形夫乙己及丁庚及庚辛并两邉之较也甲己庚则和也若移庚壬长方为乙甲长方即成丁甲大长方而为较乗和之积故凡两方相减之余积为实以和除之得较以较除之亦得和矣
　　依此论之若有两方形相减又别有两方相减而其余积等则为公积故以此两方之和较相乗为实而以彼两方之和为法除之得彼两方之较或以彼两方之较为法除之亦必得和
　　【如图有方二十九之幂八百四十一与方二十七之幂七
　　百二十九相减成较二乗和五十六之积
　　又有方十六之幂二百五十六与方十二之幂一百四十
　　四相减成较四乗和二十八之积
　　两积同为一百一十二故以先有之较二和五十六相乗】
　　【为实以今有之和二十八为法除之即得较四为今所求数】
　　是故三角形以两之和乗较为实以两分底之和为法除之得较者为两和较相乗同积也两和较相乗同积者各两方相减同积也
　　何以明之曰凡三角形以中长线分为两句股则两形同以中长线为股而各以分底线为句是股同而句不同也句不同者不同也大者句亦大小者句亦小故两上方相减必与两句上方相减之余积等而两和较相乗亦等
　　如图甲乙丙三角形以甲丁中长线分为两句股形则丙乙为两句之和【未寅及子夘并同】丙戊为两句之较【未子及寅夘并
　　同】未夘长方为两句之较乗
　　和也又丙己为两之和【辰壬
　　同】酉丙为两之较【辰癸及辛庚壬
　　午并同】癸壬长方为两之较
　　乗和也此两长方必等积
　　问两上方大于两句上方何以知其等积曰依句股法上方幂必兼有句股上方幂是故甲丙幂内【即癸甲大方】必兼有甲丁股丙丁句两幂乙甲幂内【即辛己小方】亦兼有甲丁股乙丁句两幂则是甲丁股幂者两幂所同也其不同者句幂耳【股幂既同则幂相减时股幂俱对减而尽使非句幂不同巳无余积】然则两幂相减之余积【于癸甲大方内减己辛相同之申甲小方所余者癸辛申丙两长方成磬折形】岂不即为两句幂相减之余积乎【于丁子方内减丁寅相同之戊丑小方所　所余者丑子及戊未两长方成磬折形】由是言之两和较相乗之等积信矣【于幂相减之癸辛申丙磬折形内移申丙补庚壬即成和较相乗之癸壬长方又于句幂相减之丑子未戊磬折形内移戊未补丑夘即成和较相乗之未夘长方两磬折形既等积则两长方亦等积】
　　问和较之列四率与诸例不同何也曰此互视法也同文算指谓之变测古九章谓之同乗异除乃三率之别调也何则凡异乗同除皆以原有两率之比例为今两率之比例其首率为法必在原有两率之中互视之术则反以原有之两率为二为三以自相乗为实其首率为法者反系今有之率与异乗同除之序相反故曰别调也
　　然则又何以仍列四率曰以相乗同实也三率之术二三相乗与一四相乗同实故可以三率求一率【二三相乗以一除之得四以四除之即仍得一若一四相乗以二除之亦可得三以三除之亦仍得二】互视之术以原有之两率自相乗与今有之两率自相乗同实故亦以三率求一率【原两率自相乗以今有之率除之得今有之余一率若今两率自相乗以原有之率除之亦即得原有之余一率】但三率之术以比例成其同实互视之术则以同实而成其比例既成比例即有四率故可以列而求之也
　　如图长方形对角斜剖成两句股则相等而其中所成
　　小句股亦相等【甲壬戊与甲己戊等则甲
　　乙丙与甲辛丙等丙丁戊与丙庚戊等并长方均剖故也】即所成长方之积亦必相等
　　【于甲壬戊句股形内减去相等之甲乙丙及丙丁戊两小】
　　【句股存乙丙丁壬长方又于甲己戊句股形内减去相等之甲辛丙及丙庚戊两小句股存辛己庚丙长方所减之数等则所存之数亦等故两长方虽长濶不同而知其必为等积】今以甲乙为首率乙丙为次率丙丁为三率丁戊为四率则乙丁长方【即乙丙丁壬形】为二三相乗之积【此形以乙丙二率为濶丙丁三率为长是二率三率相乗也】辛庚长方【即辛己庚丙形】为一四相乗之积【此形以辛丙为长丙庚为濶而辛丙原同甲乙乃一率也丙庚原同丁戊乃四率也是一率四率相乗也】既两长方相等则二三相乗与一四相乗等实矣此列率之理也
　　一　　甲乙
　　二　　丙乙
　　三　　丙丁
　　四　　戊丁
　　在异乗同除本术则甲乙及丙乙为原有之数丙丁为今有之数戊丁为今求之数其术为以原有之甲乙股比原有之丙乙句若今有之丙丁股与戊丁句也故于原有中取丙乙句与今有之丙丁股以异名相乗为实又于原有中取同名之甲乙股为法除之即得今所求之丁戊句是先知四率之比例而以乗除之故成两长方【二率乗三率成乙丁长方以首率除之必变为辛庚长方】故曰以比例成其同实也
　　互视之术则乙丙与丙丁为原有之数甲乙为今有之数丁戊为今求之数术为以乙丙较乗丙丁和之积若丙庚较【即丁戊】乗丙辛和【即甲乙】之积故以原有之乙丙较丙丁和自相乗为实以今有之甲乙和【即辛丙】为法除之即得今所求之丁戊较【即丙庚】是先知两长方同积而以四率取之故曰以同实成其比例也
　　然则又何以谓之互视曰三率之用以原有两件自相比之例为今有两件自相比之例是视此之差等为彼之差等如相慕效故大句比大股若小句比小股【大句小于大股几倍小句亦小于小股几倍又大句大于小句几倍大股亦大于小股几倍】互视之用以原有一件与今一件相比之例为今又一件与原又一件相比之例是此视彼之所来以往彼亦视此之所往以来如互相酬报故之较比句之较反若句之和比之和【之和大于句故句之较反大于若和之数大于句几倍则较之数句大于亦几倍】是以别之为互视也
　　如图以甲乙为一率丙乙为二率丙丁为三率丁戊为四率作甲戊成两句股次引甲乙及丁戊防于壬成
　　乙丁长方为二三相乗之积
　　亦引乙丙至庚引丁丙至辛
　　作甲辛及戊庚线并引长之
　　防于己成辛庚长方为一四
　　相乗之积是先有比例而成
　　同实之长方
　　如图乙丙乗丙丁为乙丁长
　　方辛丙乗丙庚为辛庚长方
　　两长方以角相连于丙次引
　　己辛及乙壬防于甲引己庚
　　及壬丁防于戊乃作甲戊线
　　则辛丙与丙丁若乙丙与丙
　　庚是先知同实而成其比例
　　也


　　问三角形两又术用外角切线何也曰此分角法也一角在两邉之中则角无所对之邉邉无所对之角不可以正为比例今欲求未知之两角故借外角分之也然则何以用半较角曰较角者本形中未知两角之较也此两角之度合之即为外角之度必求其较角然后可分而较角不可求故求其半知半较知全较矣此用半较角之理也
　　如图甲丙乙形先有丙角则甲丙丁为外角外角内作
　　丙辛线与乙甲平行则辛
　　丙丁角与乙角等辛丙甲
　　角与甲角等
　　其辛丙庚角为两角之较而辛丙己角其半较也己丙丁及己丙甲皆半外角也以半较角与半外角相减成乙角【于丁丙己内减辛丙己其余丁丙辛即乙角度】若相加亦成甲角【于己丙甲加辛丙己成辛丙甲即甲角度】
　　半较角用切线何也曰此比例法也角与所对之邉并以正为比例今既无正可论而有其所对之邉故即以邉为比例【角之正可以例邉则邉之大小亦可以例角】是故乙丁者两邉之总也乙癸者两邉之较也而戊己者半外角之切线也壬己者半较角之切线也以乙丁比乙癸若戊己与壬己故以切线为比例也
　　然则何以不径用正曰凡一角分为两角则正因度离立不同在一线不可以求其比例其在一线者惟切线耳而邉之比例与切线相应切线比例又原与正相应故用切线实用正也
　　如图甲丙丁外角其弧甲
　　己丁于辛作辛丙线分其
　　角为两则小角之弧丁辛
　　其正夘丁大角之弧辛
　　甲其正甲丑【小角正当乙角之
　　对邉甲丙大角正当甲角之对邉乙丙】
　　今欲移正之比例于一线先作甲丁通割分角线于子则子甲与子丁若甲丑与夘丁【甲丑子与丁夘子两句股形有子交角等丑夘皆正角即两形相似而比例等然则子甲者大形之子丁者小形之而甲丑者大形之股夘丁者小形之股也与若股与股故子甲比子丁若丑甲与夘丁】而甲丁即两正之总【甲丁为子甲子丁之总亦即为甲丑夘丁之总】辰子即两正之较【以子丁减子甲其较辰子是辰子为子甲子丁之较亦即为甲丑夘丁之较】平分甲丁半之于酉则酉丁为半总酉子为半较其比例同也【全与全若半与半故甲丁与辰子为两正之总与较则半之而为酉丁与酉子亦必若两正之总与较】
　　于是作午戊切员线【引平分线丙酉至己分甲己丁弧于己自己作午戊线与己丙为十字垂线即此线为切员线】与甲丁平行引诸线至其上【引丙甲至午引丙丁至戊引丙辰割庚防至未引丙夘割辛防至壬】则午戊切线上比例与甲丁通等而正之比例在切线矣【先以甲丁与辰子当两正之总与较今午戊与未壬亦可当两正之总与较则先以酉丁与酉子为半总半较者今亦以己戊与己壬为半总半较矣】故曰用切线实用正也【切线与正所以能同比例者以有通作之合也】问三较连乗之理曰亦句股术也以句股为比例而以三率之理转换之则用法最精之处也故三较连乗即得容员半径上方乗半总之积
　　假如甲乙丙三角形甲丙邉
　　一百五十甲乙邉一百二十
　　二乙丙邉一百一十二术以
　　半总一百九十二较各邉得
　　甲丙之较四十二甲乙之较
　　七十乙丙之较八十三较连
　　乗得数二十三万五千二百
　　即容员半径自乗又乗半总
　　之积也
　　置三较连乗数以半总除之得数【一千二百二十五】平方开之得容员半径【三十五】倍之得容员径【七十】
　　置三较连乗数以半总乗之得数【四千五百一十五万八千四百】平方开之得三角形积【六千七百二十】
　　若如常法求得中长线【一百二十】以乗乙丙底而半之所得积数亦同
　　然则何以见其为句股比例曰试从形心如法作线分为六句股形【形心即容员心】又引甲丙邉至夘使夘丙如乙戊引甲乙邉至辰使乙辰如己丙则甲夘甲辰并半总【六小句股形之句各于其两相同者而取其一即成半总】而丙夘为甲丙邉
　　之较【即乙戊或乙辛】乙辰为甲乙邉
　　之较【即己丙或辛丙】甲己为乙丙邉
　　之较【己丙同辛丙又丙夘同乙辛则夘己同乙丙而
　　甲己为其较若用辰戊以当乙丙则甲戊为较亦同】又
　　从夘作夘壬十字垂线至壬
　　【此线与丁己员半径平行】引甲丁分角线出形外遇于壬成甲夘壬大句股形与甲己丁小句股之比例等【从辰作辰壬线成甲辰壬大句股与甲戊丁小句股为比例亦同】术为以丁己比壬夘若甲己与甲夘也次以丁己自乗方为一率以丁己乗壬夘之长方为次率则其比例仍若甲己三率与甲夘四率也【乗之者并丁己故所乗之丁己与壬夘比例不变也】
　　以数明之甲己八十甲夘一百九十二为二倍四分比例丁己三十五壬夘八十四亦二倍四分比例丁己自乗一千二百二十五丁己乗壬夘二千九百四十亦二倍四分比例故曰比例等
　　又移辛防至癸截丙癸如丙夘则乙癸亦如乙辰引丙夘至午使夘午同乙辰【亦同乙癸】引乙辰至未使辰未同丙夘【亦同丙癸】则午丙及未乙并同乙丙又作丙壬乙壬午壬未壬四线成午丙壬及乙未壬及乙丙壬各三角形皆相等【丙夘壬句股形与未辰壬等则丙壬必等未壬又午夘壬句股形与乙辰壬等则午壬等乙壬而午丙壬及乙未壬两三角形必等矣其乙丙壬三角形既以乙丙与两三角形同
　　底又同用丙壬乙壬两亦不得不等】于是自
　　癸作癸壬垂线【夘壬辰壬并垂线故癸壬
　　亦必垂线】成丙癸壬句股形与丙
　　夘壬形等即成癸丙夘壬四
　　邉形与丁己丙辛小四邉形
　　为相似形【夘与癸俱方角而小形之己与辛亦方】
　　【角则大形之丙角与壬角合之亦两方角也而小形之丙角原为大形丙角之外角合之亦两方角也则小形之丙角与大形之壬角等而小形之丁角亦与大形之丙角等是大小两形之四角俱等而为相似形】则丁己丙句股形与丙夘壬形亦相似而比例等【大小两四邉形各均剖其半以成句股则其相似之比例不变全与全若半与半也】术为以丁己比己丙若丙夘与夘壬也
　　一　丁己
　　二　己丙
　　三　丙卯　即甲丙之较戊乙
　　四　卯壬
　　凡三率法中二三相乗一四相乗其积皆等则己丙乗丙卯之积即丁己乗卯壬之积可通用也先定以丁己自乗比丁己乗卯壬若甲己与甲卯今以三率之理通之为以丁己自乗比己丙乗丙卯亦若甲己与甲卯
　　一　丁己自乗方　　　即容员半径自乗
　　二　己丙乗丙卯长方　即甲乙之较乗甲丙之数
　　三　甲己　　　　　　即乙丙之较
　　四　甲卯　　　　　　即半总
　　复以三率之理转换用之则三较连乗之积【以己丙较乗戊乙较为二率又以甲己较为三率乗之是二三相乗即三较连乗】即容员半径自乗方乗半总之积也【以丁己半径自乗为首率以甲卯半总为四率乗之是一四相乗也凡一四相乗必与二三相乗之积等】
　　以数明之丁己【三十五】卯壬【八十四】相乗得二千九百四十己丙【七十】丙卯【四十二】相乗亦二千九百四十故可通用
　　己丙乗丙卯【二千九百四十】又以甲己【八十】乗之得二十三万五千二百丁己自乗【一千二百二十五】又以甲卯【一百九十二】乗之亦二十三万五千二百故可通用
　　问三较之术可以求角乎曰可其所求角皆先得半角即锐钝通为一术矣
　　术曰以三边各减半总得较各以所求角对边之较乗半总为法以余两较各与半径全数相乗又自相乗为实法除实得数平方开之为半角切线捡表得度倍之为所求角
　　假如甲乙丙三角形甲丙边
　　七十五甲乙边五十六乙丙
　　边六十一与半总九十六各
　　相减得甲丙之较二十一甲
　　乙之较四十乙丙之较三十
　　五
　　今求乙角术以乙角所对边
　　甲丙之较【二一】乗半总【九六】得数
　　【二○一六】为法以余两较【甲乙较四○乙
　　丙较三五】各乗半径全数又自相
　　乗得数【一四○○○○○○○○○○○○】为
　　实法除实得数【六九四四四四四四四四】平方开之得数【八三三三三】为半
　　角切线捡表【三十九度四十八分一十九秒】倍之得乙角【七十九度三十六分三十八秒】
　　次求丙角术以丙角所对边甲乙之较【四○】乗半总得数【三八四○】为法余两较【甲丙二一乙丙三五】各乗半径全数又自相乗得数【七三五○○○○○○○○○○】为实法除实得数【一九一四○六二五○○】平方开之得半角切线【四三七五○】捡表【二十三度三十七分五十二秒半】倍之得丙角【四十七度一十五分四十五秒】
　　次求甲角术以甲角所对邉乙丙之较【三五】乗半总得数【三三六○】为法余两较【甲丙二一甲乙四○】各乗半径全数又自相乗得数【八四○○○○○○○○○○○】为实法除实得数【二五○○○○○○○○】平方开之得半角切线【五○○○○】捡表【二十六度三十三分五十三秒】倍之得甲角【五十三度○七分四十六秒】
　　问前条用三较连乗今只用一较为除法何也曰前条求总积故三较连乗今有専求之角故以对邉之较为法也然则用对邉何也曰对邉之较在所求角之两旁为所分小句股形之句今求半角切线故以此小句为法也
　　如求乙半角则所用者角旁小句股【心戊乙或心丁乙】其句【乙戊或乙丁】并二十一即对邉甲丙之较也术为以乙戊比心戊若半径与乙角【小形之角即半角也】之切线
　　其与半总相乗何也曰将以半
　　总除之又以小形句【即对邉之较】除
　　之今以两除法【一半总一对邉之较即小形句】相乗然后除之变两次除为一
　　次除也【古谓之异除同除】
　　用两次除亦有说乎曰前条三较连乗必以半总除之而得容员半径之方幂今欲以方幂为用故亦以半总除也然则又何以对邉之较除曰非但以较除也乃以较之幂除也何以言之曰原法三较连乗为实今只以两较乗是省一乗也既省一对邉之较乗又以对邉之较除之是以较除两次也即如以较自乗之幂除之矣余两较相乗先又各乗半径何也曰此三率之精理也凡线与线相乗除所得者线也幂与幂相乗除所得者幂也先既定乙戊句为首率心戊股【即容员半径】为次率半径为三率乙角切线为四率而今无心戊之数惟三较连乗中有心戊【即容员半径】自乗之幂【即三较连乗半总除之之数】故变四率并为幂以乙戊句幂为首率【即对邉之较除两次】心戊股幂为次率【即半总除连乗数】半径之幂为三率【即半径自乗】得半角切线之幂为四率【即分形之乙角】
　　一　乙戊　　今用乙戊自乗
　　二　心戊　　　　心戊自乗
　　三　半径　　　　半径自乗
　　四　乙角切线　　切线自乗
　　故得数开方即成切线
　　又术
　　以三较连乗半总除之开方为中垂线【即容员半径】以半径全数乗之为实各以所求角对边之较除之即得半角切线
　　一　乙戊【乙角对边之较】　丙戊【丙角对边之较】　甲己【甲角对边之较】二　心戊中垂线　心戊中垂线　心己中垂线【亦即心戊】三　半径全数　　半径全数　　半径全数四　乙半角切线　丙半角切縁　甲半角切线
　　此即用前图可解乃本法也
　　论曰常法三边求角倘遇钝角必于得角之后又加审焉以钝角与外角同一八线也今所得者既为半角则无此疑实为求角之防法











　　补遗
　　问以邉求角【句股第二术】因和较乗除而知正角乃定其为句股形何也曰古法句较乗句和开方得股今大邉【壬丁】与小邉【癸丁】以和较相乗为实癸壬邉为法除之而仍得癸壬是适合开方之积也则大邉小邉之和较即句之和较而癸为正角成句股形矣【凡句股形为大邉而对正角今丁壬邉最大即也故所对之癸角为正角】
　　试再以丁壬与壬癸之和较求之
　　如法用丁壬壬癸相加得和【一百九十
　　六丈】相减得较【一十六丈】较乗和【三千一百三十
　　六丈】为实丁癸【五十六丈】为法除之亦仍
　　得五十六丈何则股较乗和亦
　　开方得句故也
　　然则句股和较之法又安从生曰生于割圜
　　试以丁壬为半径作戊丁丙己圜　全径二百一十二　半径一百○六　乙丁正九十【即癸壬股】　乙壬余
　　五十六【即癸丁句】　丙乙正矢五
　　十【即句较】　乙庚大矢一百六十
　　二【即句和】　正矢乗大矢得数八
　　千一百开方得正【即句和乗较开方
　　得股】
　　然则此八千一百者既为正矢大矢相乗之积又为正自乗之积故以正自乗为实而正矢除之可以得大矢大矢除之亦得正矢【即乙丁股自乗为实而以句较丙乙除之得乙庚为句和若以句和除之亦得句较】
　　更之则正矢乗大矢为实以正除之仍得正矣【即句较丙乙乗句和乙庚为实以乙丁股为法除之而仍复得股】
　　论曰句股形在平圜内其半径恒为若正余则为句为股可以互用故其理亦可互明【以丁壬及丁癸二邉取和较求壬癸邉为句求股以丁壬及壬癸二邉取和较求丁癸邉为股求句一而已矣】
　　问数则合矣其理云何曰仍句股术也
　　如上图于圜径两端【如丙如庚】各作通线至正【丁乙】之锐
　　【如庚乙丙乙】成丙乙庚大句股形又
　　因中有正成大小两句股形
　　【乙丁庚为大形乙丙丁为小形】而相似【以乙丁线分正
　　角为两则小形乙角为大形乙角之余而与庚角等即大形乙
　　角亦与小形丙角等故两形相似】则乙丁正
　　既为小形之股又为大形之句其比例为丙丁【小形句】与乙丁【小形股】若乙丁【大形句】与丁庚【大形股】也故正矢【丁丙】乗大矢【丁庚】与正【乙丁】自乗等积【丙庚全径为正所分其一丁丙正矢为小形之句而乙丁正为其股其一丁庚大矢为大形之股而乙丁正为其句】
　　一　丁丙正矢　小形句　　凡二率三率相乗与一二　乙丁正　小形股　　四相乗等积故乙丁自三　乙丁正　大形句　　乗即与丁丙丁庚相乗四　丁庚大矢　大形股　　等积也
　　论曰凡割圜算法専恃句股古法西法所同也故论句股者必以割圜而论割圜者仍以句股如根株华实之相须乃本法非旁证也
　　或疑切线分外角以正为比例恐不可施于钝角作此明之




　　甲丙乙钝角形先有丙角及丙甲丙乙二邉求余角一率丁乙【邉总】二率癸乙【邉较】三率己戊【半外角切线】四率壬己【半较角切线】
　　论曰试作壬丙线与乙甲平行分外角为两则壬丙丁即乙角其正卯丁又甲丙壬即甲角其正甲丑以两句股【丑子甲卯子丁】相似之故能令两正【丑甲卯丁】之比例移于通以成和较【丑甲与卯丁既若子甲与子丁则丁甲即两正之和辰子即两正之较】而半外角半较角之算以生【半外角为和半较角为较并与两正之和较同比例即与两邉之和较同比例】并如锐角
　　又论曰此所分大角为钝角故甲丑正作于形外然虽在形外而引分角线至丑适与之防即能成丑子甲句股形与卯子丁相似而生比例




　　【丙乙甲形先有丙角求余角　法为邉总丁乙与邉较乙癸若半外角切线戊己与半较角切线未己此亦因所分为钝角故卯丁正在形外　又大邉为半径故乙癸较亦在形外而丁乙为和余并同前】






　　【丙甲乙形先有丙角求余角　法为邉总丁乙与邉较乙癸若半外角切线己戊与半较角切线己壬　此因先得钝角故所分之内反无钝角而正所作之小句股并在外角之内同锐角法矣】





　　【丙甲乙形先得丙角及丙甲句乙丙如法作丙壬线与乙甲股平行分外角为两则句和丁乙与句较癸乙若半外角切线己戊与半较角切线己壬　此以丙甲为半径作外角弧而即用丙甲为正知所得为正角】





　　【甲乙丙形先得丙角求余角　如法作丙庚线与乙甲句平行次截辛丁如庚甲作辛丙线分外角为两则小角之正卯丁大角之正即丙甲而成两句股相似为切线比例　法为句和丁乙与句较乙癸若半外角切线己戊与半较角切线己壬　此以丙甲为半径作外角弧而即用丙甲为正知辛丙甲为正角而丁辛同庚甲即辛丙甲同丁丙庚又即同丙乙甲而乙为正角矣以乙正角减外角余为甲角】
　　论曰右并以先不知其为句股形故求之而得正角凡正角之弧九十度别无正而即以半径全数为正得此明之




　　【甲乙丙形先有正角求余角　法为句股和丁乙与句股较癸乙若半外角切线戊己与半较角切线己壬】论曰此因先得者为正角故其外角亦九十度而半外角四十五度之切线即同半径全数余并同前
　　又论曰句股形求角本易不须外角而外角之用得此益明




　　【以大邉为半径作外角弧分角线丙未与次大邉平行邉总乙丁与邉较乙癸若半外角切线戊己与半较角切线壬己】




　　【以次大邉为半径作外角弧分角线丙未与小邉乙甲平行大邉总丁癸与邉较乙癸若半外角切线己戊与半较角切线己壬】
　　问平三角形以一邉为半径得三正比例不识大邉亦可以为半径乎【小邉次邉为半径已具前条故云】曰可
　　如乙丙丁钝角形引乙丁至辰如
　　乙丙大邉而用为半径以丁为心
　　作丑辰亥半弧从辰作辰午为丁
　　钝角正又作丁斗半径与乙丙
　　平行则斗牛为丙角正又截女
　　丑弧如辰斗作女丁半径则女亢
　　为乙角正合而观之丁角正【辰午】最大故对邉乙丙亦大丙角正【斗牛】居次故对邉乙丁亦居次乙角正【女亢】最小故对邉丁丙亦小
　　又问若此则三邉任用其一皆可为半径而取正是已然此乃同径异角之比例也若以三邉为三正为股则同角异邉之比例也两比例之根不同何以相通曰相通之理自具图中乃正理非旁证也试于前图用乙丁次邉为其股乙癸与斗牛平行而等则丙角
　　正也又截酉丁如丁丙小邉为
　　其股酉壬与女亢平行而等则
　　乙角正也又辰丁大邉为【即乙
　　丙】其股辰午原为丁大角正也
　　于是三邉并为三对角之正
　　并为股成同角相似之句股形而
　　比例皆等可以相求矣
　　一大邉【乙丙即辰丁】　　　　一丁角正【辰午】
　　二丁角正【辰午】　　　　二大邉乙丙
　　三次邉乙丁　小邉【丁丙即酉丁】三丙角正【乙癸】乙角正【酉壬】四丙角正【乙癸】乙角正【酉壬】四次邉乙丁　小邉丁丙此如先得大邉【乙丙即辰丁】与所对大角【丁】故用辰午丁大句股形为法求余二句股也【乙癸丁酉壬丁】皆同用丁角而形相似故法可相求其实三正皆大邉为半径所得故其理相通未有理不相通而法可相求者故曰皆正理非旁证也
　　又试于乙丙丁形【或钝角或鋭角同理】以丁丙小邉为半径作房箕壁象弧【以乙为心】如上法取三正【以尾壁弧为丁角度其正尾虚又箕壁弧为丙角度其正箕危又戍壁弧为乙角度其正戍申】成同径异角之比例又如法用三邉为三正为股【乙戍即丁丙小邉配乙角正戍申原如与
　　股又本形乙丁次邉为则丁甲为股与箕危平行而等
　　丙角正也又引乙丁至子成子乙即乙丙大邉以为
　　则子寅为股与尾虚平行而等丁角正也】则并
　　为相似之句股形而比例等
　　一小邉丁丙【即戍乙】
　　二【乙角正】戍申
　　三大邉乙丙【即乙子】　次邉丁乙
　　四【丁角正】子寅【即尾　丙角虚　　正】丁甲【即箕危】
　　此如先得小邉【丁丙】与所对小角【乙】故以戍申乙小句股形为法求两大句股也【丁甲乙子寅乙】皆同用乙角而形相似又试以乙丁次邉为半径作象限如前【以丙为心】取三正【张娄为丁角弧度张井其正氐娄为丙角弧度氐参其正室娄为乙角弧度室奎其正】成同径
　　异角之比例又仍用三邉为三正
　　为股【引丁丙至翌与大邉乙丙等成翌丙其股翌胃与张井
　　平行而等丁角正也又乙丁次邉成氐丙其股氐参原为丙角正
　　又丁丙小邉为其股丁柳与室奎平行而等乙角正也】即复
　　成相似之句股形而比例等
　　一次邉乙丁【即氐丙】
　　二【丙角正】氐参
　　三大邉乙丙【即翌丙】　小邉丁丙
　　四【丁角正】张井【即翌　乙角胃　　正】丁柳【即室奎】
　　此如先得次邉【乙丁】及所对丙角故以氐参丙句股为法求大小二句股也【求翌胃丙为以小求大求丁柳丙为以大求小】皆同用丙角而比例等
　　问员内三角形以对弧为角倍度设有钝角小邉何以取之【或问内原设锐角两邉并大于半径故云】曰法当引小邉截大邉作角之通【如图乙甲丙钝角形在平员内以各角切员而乙甲邉小于半径则引乙甲出员周之外乃以甲角为心平员心丁为界作子丁丑弧截引长邉于子截大邉于丑则丑甲子甲并半径与丁甲等而丑子为
　　通】又平分对邉作两通【从员心作
　　丁乙丁丙两半径截乙戊丙员周为甲角对邉所乗之弧而半
　　之于戊作乙戊丙戊二线成两通】则此两通
　　自相等又并与丑子通等夫
　　子丁丑弧甲角之本度也丙戊
　　弧乙戊弧皆对弧之半度也而今乃相等【通等者弧度亦等】是甲角之度适得对弧乙戊丙之半而乙戊丙对弧为甲角之倍度矣















　　厯算全书卷五十三
　　钦定四库全书
　　厯算全书卷五十四
　　宣城梅文鼎撰
　　三角法举要卷五
　　测量【三角用法算例已具兹则举髙深广逺以徴诸实事亦与算例互相补备也】
　　一测髙
　　一测逺
　　一测斜坡
　　一测深
　　附隔水量田
　　附解测量全义





　　三角测髙第一术
　　自平测髙
　　假如有塔不知其髙距三十丈立表一丈用象限仪测得髙二十六度三十四分弱依切线术求得塔髙一十六丈
　　一半径　　　　　　一○○○○○
　　二戊角切线　　　　　五○○○○
　　三距塔根【丙乙即戊丁】　　　三十丈
　　四塔顶髙【甲丁　是截算表端以上】　十五丈
　　加戊丙表一丈【即丁乙】共得塔髙十六丈【甲乙】
　　凡用象限仪以垂线作角与用指尺同理【指尺即闚衡亦曰闚管亦曰闚筩】若戊丙表立于髙所当更加立处之髙以为塔髙
　　省算法从表根丙平安象限
　　以一邉指塔根乙一邉指癸
　　乃顺丙癸直线行至癸得三
　　十丈与丙乙等复于癸平安
　　象限作癸角与戊角等邉指
　　丙尺指壬则壬丙逺即甲丁之髙【亦加丁乙为塔髙】
　　论曰癸角同戊角丙癸同丙乙丙
　　与乙并正角则两句股形等立面
　　与平面一也
　　又术自丙向癸却行以象限平安
　　邉指丙尺指乙求作戊之余角得
　　己丙之距即同甲丁之髙
　　又省算法用有细分矩度自戊数至癸令其分如丙乙
　　之距【或两倍三倍】从癸数壬癸直线之
　　分即甲丁之距也【先以二分为丈或三分为丈今
　　亦同之】

　　用矩度以垂线作角其用亦同



　　三角测髙第二术
　　平面则不知逺之髙法用重测
　　假如有山顶欲测其髙而不知所距之逺依术立二表相距一丈二尺用象限仪测得髙六十度十九分退测后表得五十八度三十七分查其两余切线以相减得
　　较数为法表距乗半径为实算
　　得山髙三十一丈
　　一　余切线较○○四○○○
　　二　半径　　一○○○○○
　　三　表距戊己　一丈二尺
　　四　山髙甲丁　三十丈
　　加表一丈共三十一丈
　　省算法用矩度假令先测指线
　　交于辛后测指线交于庚成辛
　　庚戊三角形法于两指线中间
　　以两测表距【即戊己】变为分如壬
　　癸小线引长之至丙即丙戊所当测髙
　　论曰此即古人重表法也或隔水量山或于城外测城内之山并同





　　三角测髙第三术
　　从髙测髙　又谓之因逺测髙
　　假如人在山颠欲知此山之髙但知山左有桥离山半里用象限测桥得逺度一十八度二十六分强依切线法求得山髙一里半
　　一　甲角切线　半径【一○○○○○】二　半径　　　甲角余切【三○○○二八】三　桥逺【戊丁】　一百八十步
　　四　山髙【甲丁】　五百四十步【○五尺】省算法用矩度作壬癸线以当
　　戊丁则己壬当甲丁





　　三角测髙第四术
　　从髙测不知逺之髙　法用重测
　　假如人在山上欲知本山之髙然又无可防之逺但山有楼或塔量得去山二十一丈以象限仪指定一处于楼下测得五十五度二十六分又于楼上测得五十三度五十分用余切线求得山髙三百四十四丈五尺
　　一　两余切较　　　四二
　　二　下一测余切　六八九
　　三　楼髙【两测之距】　二十一丈
　　四　山髙　　　三百四十四
　　丈五尺
　　省算法用矩度上测交庚下测
　　交辛成辛己庚三角形法于两
　　指线中间以上下两测之距变
　　为分如壬癸小线引长之至丙
　　即壬丙当所测本山之髙
　　三角测髙第五术
　　若山上无两髙可测则先测其【但山上有两所可以并见此物即可测矣】
　　甲乙为山上两所【不拘平斜但取直线】任
　　指一处如戊于甲于乙用噐两
　　测之成甲乙戊形此形有甲乙
　　两角又有甲乙之距为两角一
　　邉可求甲戊邉法为戊角之正
　　与甲乙邉若乙角之正与甲戊
　　再用甲戊丁句股形为半径与甲戊若甲角余与甲丁即山之高也





　　三角测髙第六术
　　借两逺测本山之髙
　　有山不知其髙亦无距山之逺但山前有大树从此树向山而行相去一百八十五丈又有一树人在山上可见两树如一直线即于山上以象限仪测此二树一测逺树四十三度三十二分一测近树三十度○七分用切线较得本山髙五百丈
　　一　切线较　　三七○○○
　　二　半径　　　一○○○○○
　　三　两逺之较　一百八十五丈
　　四　本山髙　　五百丈
　　省算作壬癸小线当两逺之距【己戊】而丙甲当本山髙【甲丁】




　　三角测髙第七术
　　用山之前后两逺测髙
　　甲为山颠可见戊己两树其树
　　与山参相直【如山南树直正子北树直正午】而
　　不知其距但山外有路与此树
　　平行为庚辛其长三里【如两树正南北
　　此路亦自南向正北行】即借庚辛之距为
　　两树之距以两切线并为法求之
　　先从甲测巳得甲角一十七度○四分又从甲测戊得甲角三十四度三十四分法为两切线并与己戊若半径与甲丁也
　　一率两切线并【○九九六○○】二率半径【一○○○○○】三率己戊即庚辛【三里】求得四率甲丁【三里○四步又三之一强】



　　三角测髙第八术
　　测山上之两髙
　　甲山上有塔如乙欲测其髙如
　　乙甲之距于戊安仪噐测乙测
　　甲得其两戊角之度【一乙戊丁二甲戊丁】各取其切线相减得较法为半
　　径比切线较若戊丁与乙甲
　　省算法数戊丙之分以当戊丁作壬癸丙小线则壬癸之分即当乙甲
　　用矩度亦同






　　三角测髙第九术
　　隔水测两髙之横距
　　有甲乙两髙在水外欲测其相
　　距之逺任于丙用仪噐以邉向
　　丁窥筩指甲得甲丙丁角【一百二十
　　五度】又指乙得乙丙丁角【五十度】次
　　依丙丁直线行至丁【得一百步】再用
　　仪噐以邉向丙窥筩指甲得甲丁丙角【三十九度】又指乙得乙丁丙角【一百零八度】又甲丁乙角【六十九度】得三角形三【一甲丁丙二乙丁丙三甲丁乙】
　　今算甲丁丙形有丁丙邉丁丙二角求甲丁邉
　　一率甲角【一十六度】正【二七五六四】二率丁丙【一百步】三率丙角【一百二十五度】正【八一九一五】求得四率甲丁邉【二百九十七步】
　　次乙丁丙形有丁丙邉丙丁二角求乙丁邉
　　一率乙角【二十二度】正【三七四六一】二率丁丙邉【一百步】三率丙角【五十度】正【七六六○四】求得四率乙丁邉【二百○四步】
　　末乙丁甲形有甲丁邉【二百九十七步】乙丁邉【二百○四步】丁角【六十九度】先求甲角
　　一率两邉之总【五百○一步】二率两邉之较【九十三步】三率半外角【五十五度半】切线【一四五五○一】求得四率半较角切线【二七○○九】查表得一十五度○七分弱以减半外角得甲角四十度二十三分强
　　次求甲乙邉
　　一率甲角正【六四七九○】二率乙丁邉【二百○四步】三率丁角正【九三三五九】求得四率甲乙邉二百九十四步弱
　　论曰此所测甲丁及乙丁皆斜距也或甲乙两髙并在一山之上于山麓测之或甲乙分居两峯于两峯间平地测之或甲在水之东乙在水之西于一岸测之并同若用有度数之指尺并可用省算之法



　　三角测髙第十术
　　隔水测两髙之直距
　　有两髙如乙与甲于戊于庚测
　　之
　　先以乙庚戊形求乙庚斜距次
　　以甲庚戊形求甲庚斜距末以
　　乙甲庚形【有乙庚邉甲庚邉及庚角】求乙甲邉即所求

　　三角测髙第十一术
　　若山之髙颠为次髙所掩则用逓测
　　山前后左右地势不同则用环
　　测环测者从髙测下与测深同
　　太髙之山则用屡测
　　癸极髙为甲次髙所掩则先测
　　甲复从甲测癸谓之逓测
　　乙丁与子丑居癸山之下为地
　　平而各不等则从癸四面测之如测癸辛之髙以辛乙为地平又测癸戍之髙以戌子丑为地平则乙丁与子丑之较为戍辛谓之环测
　　若山太髙太大则于乙测甲又于甲测癸或先测卯又测寅又测丑测子再从子丑测癸细细测之则真髙自见而地之髙下亦从可知矣谓之屡测


　　三角测逺第一术
　　平面测逺
　　有所测之物如乙于甲立表安象限以邉指乙余一邉对丁从甲乙直线上任取九歩如丁于丁复安象限以邉对甲闚管指乙得丁角七十一度三十四分用切线算得乙距甲二十七步
　　一　半径
　　二　丁角切线
　　三　丁甲
　　四　乙甲

　　若欲知丁乙之距依句股法甲丁甲乙各自乗并而开方即得乙丁
　　若径求乙丁则为以半径比丁角之割线若甲丁与丁乙也是为以句求
　　省算用矩度自丁数自癸取丁癸之分如丁甲之距【或以
　　分当步或二分或三分当一步皆可】作壬癸丁小
　　句股则壬癸之分即乙甲也【或一
　　分当步或二分三分并如丁癸之例】而丁壬亦即
　　当丁乙【若尺上有分数即径取之】
　　若先从丁测测以测噐向甲指尺向乙作丁角次依丁甲直线行至甲务令测噐之一邉顺丁甲直线余一邉指乙则甲为正方角如前算之即得【若甲非正方角则于丁甲直线上或前或后移测求为正方角乃止】
　　三角测逺第二术
　　省算法
　　人在甲欲测乙之逺于甲置仪
　　噐一邉向乙一邉向丁成正方
　　角乃依甲丁直线行至丁以邉
　　向甲闚管指乙作四十五度角
　　即甲丁与甲乙等
　　若用矩度以乙丁线正对方角则丁角为正方角之半而甲丁等乙甲
　　论曰丁角为正方角之半则乙角亦正方角之半而句与股齐故但量甲丁即知甲乙
　　又省算法
　　于甲置仪噐以邉向丁闚管指
　　乙作六十度角顺甲丁直线行
　　至丁复作六十度角则甲丁等
　　甲乙
　　论曰甲角丁角俱六十度则乙角亦六十度矣故三邉俱等
　　若丁不能到则于甲丁线上取丙以仪噐二邉对甲对乙成正方角则甲丙为乙甲之半




　　三角测逺第三术
　　平面测逺用斜角
　　人在甲测乙而两旁无余地可
　　作句股则任指一可测之地如
　　丁量得丁甲二十丈于丁安仪
　　噐以邉向甲窥筩指乙得丁角
　　【四十六度】又于甲安仪噐以邉指丁窥筩指乙得乙甲庚角【二十一度】加象限【九十度】得甲钝角【一百一十一度】法为以乙角之正【二十三度乃甲丁二角减半周之余】比丁甲若丁角之正与乙甲算得乙甲三十六丈八尺二寸
　　若求乙丁则为以乙角之正比丁甲若甲角之正与乙丁算得乙丁四十七丈七尺八寸【甲为锐角法同】
　　省算法于仪噐作壬甲线与乙丁平行作壬癸线与乙甲平行成壬癸甲小三角形与丁乙甲等则甲癸当甲丁而壬癸当甲乙又壬甲当乙丁用矩度同【但于象限内作横直分用同矩度】
　　论曰壬角既同乙角【壬甲与乙丁平行壬癸与乙甲平行则作角必相等】癸钝角又同甲角则两三角相似而比例等
　　锐角形于甲测乙用矩度之邉指
　　丁作甲角另用一矩度【其矩须于两面纪度】从丁测之以邉向甲闚筩指乙作
　　丁角末移丁角作癸角于噐上作
　　壬癸线与乙丁平行则癸甲当丁
　　甲而壬甲当乙甲壬癸当乙丁
　　三角测逺第四术
　　平面测逺借他线为比例
　　甲乙为两所顺甲乙直线行任取
　　若干步至丙又于丙任作直线至
　　丁得若干步于丁安仪噐以邉对
　　甲闚衡指丙作丁角顺此直线至
　　戊复安仪噐邉对乙衡指丙作戊
　　角令与丁角等则丙丁比丁戊若丙甲与甲乙
　　省算法于乙甲直线上取丙
　　又从丙作丙戊直线截丁丙
　　如乙丙于丁用象限闚乙作
　　丁角再于戊闚甲作戊角令
　　与丁角等则丁戊即甲乙
　　又法甲置仪噐指乙指丁作
　　角以减半周成外角【己戊为甲角之
　　度丙庚戊为外角之度】于丁置仪噐指
　　甲指乙使丁角如半外角之度但量甲丁即得甲乙论曰凡外角能兼内余二角【乙丁】之度丁角既为外角之半则乙角亦外角之半矣角等者所对之邉亦等故甲丁等甲乙




　　三角测逺第五术
　　平面测逺借他形为比例法
　　从甲测乙任立一表于丙从甲
　　用仪噐以邉向乙闚管指丙得
　　甲角复于丁加仪噐以邉向戊
　　闚管指丙使丁丙甲为一直线
　　而作丁角与甲角等乃顺仪噐邉取直线至戊令戊丙乙为一直线则丁丙与丁戊若丙甲与甲乙【钝角形句股形并同一理】
　　论曰丙戊丁与丙甲乙两三
　　角形相似以两形之丙角为
　　交角必相等而丁角又等甲
　　角则戊角亦等乙角矣故其
　　比例等


　　三角测逺第六术　省算
　　有甲乙两所欲测其距如前立丙
　　表以噐测得甲丙乙角之度又顺
　　乙丙直线行至戊令丙戊之距同
　　甲丙而止再从戊行至丁从丁闚
　　丙至甲成一直线于此直线上进退移测使乙丁丙角为乙丙甲角之半则但量丁戊即同乙甲【甲为钝角或丙为钝角并同】
　　论曰甲丙与丙戊既相等乙
　　丁丙角为乙丙甲外角之半
　　则丙乙丁角亦外角之半是
　　乙丙与丁丙亦等也而丙交
　　角又等是甲丙乙三角形与
　　戊丙丁形等角等邉也故丁
　　戊即乙甲

　　三角测逺第七术　重测
　　甲乙为两所欲测其距而俱不能
　　到则两测之于戊于丁量得戊丁
　　之距【十六步半】用噐测得戊角【五十度四十三
　　分】丁角【三十六度一十分】两角之余切线
　　较【五五○○○】为一率半径【一○○○○○】为二率戊丁【十六步半】为三率得四率为乙甲之距【三十步】
　　若求戊甲之距以两测之余切较【五五○○○】为一率先测戊角之余切【八一八○○】为二率丁戊【十六步半】为三率得四率戊甲【二十四步五四】
　　论曰此即古人重表测逺法也必丁戊甲直线与乙甲线横直相遇使甲为正角其算始真假如乙甲正南北距则丁戊甲必正东西斯能横直相交而成正角也



　　三角测逺第八术
　　分两处重测
　　乙岸在河东欲测其距西岸之逺
　　如甲则任于甲之左右取丁戊两
　　所与甲参相直而距河适均测得
　　丁角【五十度四十三分】戊角【五十五度四十三分】用
　　两角度之余切线并【一五○○○○】为一
　　率半径【一○○○○○】为二率丁戊之距【九十六步】为三率求得四率乙甲之距【六十四步】为两岸阔
　　论曰此法但取丁戊直距与河岸平行则不必预求甲防而自有乙甲之距为丁戊之垂线尤便于测河视用切线较更简捷而穏当矣




　　三角测逺第九术
　　用髙测逺
　　甲乙为两所不知其逺而先知丁
　　乙之髙于甲用仪噐测丁乙之髙
　　几何度分即知甲乙法为半径比
　　甲角之余切若丁乙髙与甲乙之逺
　　若人在髙处如丁用髙测逺则为半径比丁角之切线若丁乙与甲乙其理并同但于丁加仪噐而用正切三角测逺第十术
　　用不知之髙测逺
　　欲知丁乙之逺而不能至乙乙之
　　上有庚又不知庚乙之髙法用重
　　测先于丁测之得丁角【三十八度一十三分】又依丁乙直线进至甲测之得甲
　　角【五十三度五十二分强】两余切较【○五四○○一】
　　为一率丁角余切【一二七○○一】为二率丁甲之距【二十步】为三率得四率丁乙【四十七步○三】　或丁后有余地退后测之亦同
　　省算作壬癸丙线以壬癸分当丁甲之距壬丙当丁乙之逺
　　若人在髙处如庚于庚测丁测甲以求丁乙其法亦同但于庚施仪噐而用正切【法为以两庚角之切线较比丁庚乙之切线若丁甲与丁乙】

　　三角测逺第十一术
　　用髙上之髙测逺
　　甲乙为两所而乙之根为物所掩
　　【如山麓有小阜坡陀礨砢林木蔽亏或岛屿盘纠荻苇深阻】难
　　得真距若用两测甲外又无余地
　　但取其髙处如戊为山颠山上又
　　有石台台上有塔如丁丁戊之髙
　　原有定距以此为用从甲测丁又测戊得两角【一丁甲乙二戊甲乙】求其切线法为以切线较比半径若丁戊与乙甲省算作壬癸丙小线以壬癸当丁戊则甲丙当甲乙矩度同
　　若从髙测逺则于丁于戊两用仪噐测甲用丁戊两角之余切较以当丁戊而半径当甲乙其理亦同



　　三角测逺第十二术
　　从髙测两逺
　　甲乙两逺人从髙处测之于丁用
　　仪器测甲测乙得两丁角【一甲丁丙二乙
　　丁丙】法为以半径比两角之切线较
　　若丁丙髙与乙甲也
　　又法既得两角则移仪噐窥戊作
　　戊丁甲角如甲丁丙之倍度又移窥己作己丁乙角如乙丁丙之倍度则但量己戊即知乙甲







　　三角测逺第十三术
　　连测三逺
　　丙乙为跨水长桥甲乙为桥端斜岸今于丁测桥之长
　　并甲乙岸阔及其距丁之逺近
　　法于丁安仪噐以邉指戊衡指
　　甲指乙指丙作丁角五【一甲丁戊二乙
　　丁戊三乙丁甲四戊丁丙五乙丁丙皆丁角而有大小】次顺仪噐邉直行至戊得丁戊
　　之距于戊复用仪噐以邉指丁衡指丙指乙指甲作戊角三【一丁戊丙二乙戊丙三甲戊丁皆戊角而有大小】
　　一甲丁戊形有丁角戊角有丁戊邉可求甲丁邉一乙丁戊形有丁角戊角有丁戊邉可求乙丁邉一戊丁丙形有戊角丁角有丁戊邉可求丁丙邉以上并二角一邉求余邉得甲乙丙三处距丁之逺近
　　一乙丁丙形有丙丁邉乙丁邉有丁角可求乙丙邉一乙丁甲形有甲丁邉乙丁邉有丁角可求乙甲邉以上并二邉一角求余邉得岸阔与桥长






　　三角测斜坡第一术
　　斜坡上平面测两所之距
　　斜坡上有甲乙两所欲量其相距
　　之数任立丙表测得乙丙甲角度
　　乃顺甲丙直线进退闚乙至戊得
　　乙戊丙角为乙丙甲角之半又横
　　过至丁从丁闚丙至乙成一直线顺此直线进退闚甲至丁得甲丁丙角亦为丙角之半则丁戊即乙甲又法不必立表但任指一防为丙而于甲丙直线上任取己防乙丙直线上任取庚防作庚丙己三角形有己角庚角即知丙角末乃如上作丁戊两角为丙角之半即所求
　　论曰此因乙甲在斜面髙处而不能到故借用丁丙戊形测之以丁丙戊乙丙甲两形相等故也何则丙交角既等而乙丙甲外角原兼有丙乙戊乙戊丙两角之度戊角既分其半乙角亦半则两角等而乙丙戊丙两邉亦等矣凖此论之则甲丁丙角为丙外角之半者丁甲丙角亦必为丙外角之半而甲丙丁丙亦等矣两形之角既等各两邉又等则三邉俱等而戊丁即乙甲若甲乙两所在下而丁戊两测在上亦同




　　三角测斜坡第二术
　　斜坡测对山之斜髙
　　对山之斜髙如甲戊乙于对
　　山之斜坡测之如丙丁先量
　　得丙丁之距于丙安仪噐得
　　丙角二【一乙丙丁二戊丙丁】于丁安仪
　　噐得丁角四【一乙丁丙二乙丁戊三戊丁丙四乙丁甲】成各三角形
　　先用乙丙丁形【有丙角丁角及丁丙邉】测乙丁邉　次用戊丙丁形【有丙丁二角及丁丙邉】测丁戊邉　三用乙丁戊形【有乙丁戊丁二邉及丁角】测乙角及乙戊邉　四用乙丁甲形【有乙角丁角及乙丁邉】测乙甲邉乙甲内减乙戊得戊甲邉【乙戊甲为垂线之髙法同】





　　三角测斜坡第三术
　　测对坡之斜髙及其岩洞
　　从丙从丁测对面之斜坡戊甲及乙戊
　　一乙丙丁形【有丙丁两测之距丙角丁角】可求乙丁邉　二戊丙丁形
　　【有丙丁邉丁角丙角】可求丁戊丙戊二
　　邉　三乙丁戊形【有乙丁邉戊丁邉丁
　　角】可求乙戊邉为所测对山
　　上斜入之岩　四丙丁甲形【有丁角丙角丙丁邉】可求丙甲邉五甲丙戊形【有丙戊邉丙甲邉丙角】可求戊甲邉为所测对坡斜髙
　　或戊为髙处基址乙为房檐亦同




　　三角测深第一术
　　测井之深及濶
　　甲乙为井口之濶于甲作垂线至丁【或用砖石投之以识其处】从乙
　　测之得乙角成甲乙丁句股
　　形即以甲乙井口为句得甲
　　丁股为井之深　既得乙丙
　　深【即甲丁】即可用乙己戊形得
　　己戊为底濶法以半径当井
　　深【乙丙】以两乙角【一戊乙丙二己乙丙】之
　　切线并当井底之濶【己戊】若不知井口则立表于井口
　　如庚甲求庚甲二角成庚甲
　　丁形测之



　　三角测深第二术
　　登两山测谷深
　　先于二山取甲乙之平而得其距
　　数为横线即可用三角形求丙丁
　　垂线为谷之深与测髙同理【亦可用以】
　　【测髙也】法为甲乙两角之余切线并比半径若甲乙与丙丁论曰深与髙同理测深之法即测髙之法也存此数则以发其例有不尽者于测髙诸术详之可也
　　附隔水量田法
　　甲乙丙丁田在水中不可
　　得量于岸上戊庚两处用
　　仪噐测之得诸三角形算
　　得其邉【一甲乙二乙丙三丙丁四丁甲】次
　　求乙丁对角线分为两三
　　角形【一甲乙丁二丙乙丁】末用和较法求得分形之两垂线【一甲癸二壬丙】并两垂线而半之以乗乙丁即得田积
　　或用三较连乗法求三角形积并之亦同
　　凡有平面形在峭壁悬崖之上及屋上承尘可以仰观者并可以此法测之





　　解测量全义一卷十二题加减法
　　甲寅象限弧　甲乙半径全数
　　为首率
　　丙寅弧之正丙辛为一率
　　丁寅弧之正丁庚为三率
　　戊己为四率
　　二三相乗为实首率为法法除实得四此本法也今以加减得之则不用乗除
　　丙寅加丁寅【即辰丙】为辰寅总弧其余辰卯【即子癸】丙寅内减丁寅为丑寅【即丙丁】存弧其余癸丑以子癸减癸丑余子丑平分之于壬为壬子或壬丑即
　　四率【其壬子壬丑皆与戊己等】　此因总弧
　　不及象限故以两余相减
　　甲寅象限弧甲乙半径全数
　　为首率
　　丙寅弧之正丙辛为二率
　　丁寅弧之正丁庚为三率
　　戊己为四率
　　以上皆与前同
　　丙寅加丁寅【即辰丙】为辰寅总弧【此总弧大于象限】其余卯辰【即子癸】　丙寅内减丁寅【即丙丑】余丑寅为存弧其余丑癸
　　以子癸加丑癸为子丑半之于壬分为壬子及壬丑二线皆与戊己同即为四率如所求
　　此因总弧过象限故以两余相加
　　今订本书之譌
　　甲寅皆象限弧　甲乙半径
　　一○○○○○为首率
　　丙辛○五九九九五为二率
　　丁庚○二五○一○为三率
　　以三率法取之得○一五○
　　○四为四率
　　今用加减法
　　以丙辛线为正查其弧得丙寅三十六度五十二分亦以丁庚线为正查其弧得丁寅十四度二十九分以丙寅弧与丁寅弧相加得总弧辰寅五十一度二十一分其余○六二四五六如辰卯【即子癸】
　　又以丙寅弧与丁寅弧相减得存弧丑寅二十二度二十三分其余○九二四六六如丑癸
　　因总弧小于象限当以两余相减其较○三○○一○如子丑【于丑癸内减子癸得之】乃平分子丑于壬其数○一五○○五为壬丑或壬子皆与戊己同即为四率　此所得与三率所推但有微差而不相逺
　　按此以加减代乗除依其法宜如此今刻本相减相并讹为并而相减又于相并之弧讹为五十度二十分相减之存弧讹为二十二度二十四分故其正皆讹而所得之四率只一四三一与三率所推不合矣
　　又按以加减代乗除之法不过以明图法之妙其中又有此用耳若以入算终不如乗除之便何也设问毎多整数而正之数皆有畸零不能恰合一也先用设数求弧度必用中比例始得相合则于弧度亦有畸零二也弧度既有畸零则其查余又必用中比例三也两余有用加之时有用减之时易至于讹四也及其所得四率以较三率法之所得终有尾数之差五也盖论数学则宜造其防而施之于用则贵其简易若可以简易者而故引之繁重又何贵乎故曰不如乗除之便也观设例之时便有讹错如此则其不便于用亦可见矣又按此加减法即测量全义第七卷所言加减也其以总存两余相加减而半之者即初得数也然彼以两正相乗得之此以加减得之而省一乗矣实弧三角中大法而彼但举例而隠其图姑示其端于此而又不直言其即弧度之初得数此皆译书者秘惜之故耳向后二图发明所以然之故
　　甲寅象限弧　乙丙半径为首率
　　丙寅弧之正丙辛为次率
　　丙丑弧之正丑戊为三率【辰丙弧同丙丑其正辰戊亦同丑戊】得戊巳为四率【丑壬及壬子并同】
　　论曰戊巳辰【或丑壬戊亦同】句股形与
　　丙辛乙句股形相似故其比例
　　等法为乙丙与丙辛若丑戊与
　　丑壬也【或辰戊与戊巳亦同】
　　又论曰凡两十字垂线相交作
　　句股则其形俱相似如辰丑线即丙丑及丙辰之正与丙乙半径相交于戊防一十字也辰午线【辰寅弧之正也】丑癸线【丑寅弧之余】相交于子防一十字也此两十字相交而成诸句股形则俱相似矣故戊壬庚与丑壬戊相似而戊壬庚原与丙辛乙相似则丑壬戊与丙辛乙不得不为相似之形矣
　　解曰乙丙首率半径也丙辛正为次率其弧丙寅丑戊正为三率其弧丙丑丙丑既与丙辰同则以丙丑【三率之弧也】加丙寅【次率之弧】成辰寅总弧而辰卯则总弧之余也以丙丑【三率之弧】减丙寅【次率之弧】其余丑寅为存弧而丑癸则存弧之余两余相减其较为子丑【子癸同辰卯故以子癸减癸丑得较子丑】子丑折半于壬而壬丑与壬子皆同戊巳是为所求之四率也
　　如此以量法代算法的确不易但细数难分耳
　　若以酉丙为过象限之大弧丙丑为小弧则酉丑为总弧其正丑丁余丑癸【即丁乙】
　　酉辰为存弧其正辰午余辰卯【即子癸】算法略同但先所用者存弧之正小于总弧今则总弧正小于存弧正大则余小正小则余反大加减之用以小从大其理无二故其图可通用也
　　又按壬丑即初得数也两正相乗以半径除之者也乙亥即次得数也两余相乗以半径除之者也今改用加减则以两弧相并为总弧而相较之余为存弧存总两余相加减而半之成初得数省两正乗矣又以初得数去减余成次得数省两余乗矣
　　两余加减例
　　凡总存二弧俱在象限内或俱出象限外则两余相减　若存弧在象限内总弧在象限外则两余相加
　　初得数减余弧例
　　凡存弧之正小于总弧即用存弧之余在位以初得数减之余为次得数　若总弧之正小于存弧即用总弧之余在位以初得数减之余为次得数盖
　　小者余大其余内
　　皆兼有初得次得两数详
　　见环中黍尺
　　甲寅象限弧　乙丙半径
　　为首率
　　丙寅弧之正【丙辛】为次率
　　丙丑弧之正丑戊为三
　　率【辰丙弧同丙丑其正辰戊亦同丑戊】
　　求得戊巳为四率【丑壬壬子并同】
　　以上皆与前图同
　　论曰凖前论丙辛乙句股形与丑壬戊句股形相似法为乙丙与丙辛若丑戊与丑壬也【或辰戊与戊巳亦同】
　　解曰乙丙首率半径全数也丙辛正为次率其弧丙寅丑戊正为三率其弧丙丑而丙丑【三率】即丙辰以加丙寅【次率之弧】成辰寅总弧而辰卯亦总弧之余也以丙丑【三率之弧】减丙寅【次率之弧】其余丑寅为存弧而丑癸则亦存弧之余也两余相加成子丑【子癸同辰卯皆总弧余】子丑折半于壬而壬丑同壬子亦同戊巳则所求之四率也





　　厯算全书卷五十四
　　钦定四库全书
　　厯算全书卷五十五
　　宣城梅文鼎撰
　　解八线割圆之根
　　八线割圆説
　　天体至圆最中一防为心过心直线为径圆面诸圏为弧弧与径古用径一围三之比例【有宻术徽术各家不同】然终非弧度之真葢圆为曲线径为直线两者为异类亘古无相通之率夫日月星辰之道皆弧线也人目测视之线皆直线也苟非由直线以得曲线纵推算极精皆非确数于推歩测量诸用所关甚钜其可畧欤西儒几何等书别立数法求得弧与径相凖之率更以逐度之弧准逐度之线内用矢外用割切于是始则因弧而求线继则因线而知弧交互推求虽分秒之弧度尽得其准立法之善即首商髙复生无以易也苐割圆八线表虽乆传于世而立法之根未得専书剖晰大测中如十边五边形之理皆缺焉弗讲薛青州作正解亦仅依式推衍未能有所发明予于厯算生平癖嗜凡有奥义必欲直穷其所以然而后快窃思割圆八线乃厯算之本源岂可习焉不察因反覆抽绎耿耿于心者数年积思之乆乃得渐次防通遂着其图衍其算理之隠赜者明之法之缺畧者补之防而成帙以备好学者之采择云尔









　　立表之根有七
　　一大圆中止有径线初无边角可寻乃作者慿空结撰求得七弧之通而全割圆表即从此推出又絶无假借纽合之病割圆之巧孰有加于是焉
　　表根一　圆内作六等邉切形求得六十度之通法曰六十度之通与圈之半径等作表时命为十万亦曰全数
　　解曰如图辛为心作甲丙丁圈甲丁为全径辛丁为半径次取丁为心辛为界作戊庚辛圈与原圈相交于丙于戊次引长丁辛线至庚必平分丙戊弧于丁亦平分戊丙弧于辛【以丁为戊庚圈心故】次作辛丙丙丁丁戊戊辛四线成丁辛丙丁辛戊二形必皆三邉等三角形何则丁为
　　心辛为界则丁辛与丁丙皆
　　为戊庚圏之半径仍用辛丁
　　为度辛为心丁为界则辛丁
　　又为甲己圈之半径辛丙亦
　　同则辛丁丁丙辛丙三线俱等而辛丁丙为三邉等形丁辛丙三角俱自相等每角六十度夫辛角在心者也则丙丁弧为六十度丙丁即六十度之通与辛丁半径等矣丁戊辛形仿此
　　次以丙辛引至己戊辛引至乙其甲辛己乙辛甲交角俱与丙辛丁戊辛丁角等角等弧亦等即平分大圈为六分次作丙丁等六线相连成六等邉内切形等邉等角葢乙辛己丙辛戊两交角之弧既当六分圈之四则中间己戊乙丙二弧亦必各为六分圈之一故成六等邉形皆以半径为邉此天地自然之数也
　　表根二　圈内作四等邉切形求得九十度之通法曰半径上方形倍之开方得九十度之通
　　解曰圈内四等邉切形即内切
　　直角方形也　如图甲癸丁圏
　　庚为心作丁癸全径又作甲己
　　全径与丁癸十字相交为凑心
　　四直角即平分大圆为四分每分九十度次作甲癸己癸己丁甲丁四线相连成四邉等形其切圏之甲丁己癸四角俱为直角【以各角俱乗半圈故】所容之癸甲丁己为正方形甲癸等为九十度之通用甲庚癸直角形甲庚半径上方与庚癸半径上方并开方得甲癸句股求术也
　　巳上二根并仍厯书之旧
　　表根三　圈内作十等邉切形用理分中末线求得三十六度之通
　　法曰圏径上作理分中末线其大分为十邉等形之一邉即三十六度之通今欲明十邉形之理先解理分
　　中末线欲明理分中末线先解方形
　　及矩形
　　一解曰凡正方形内【如乙庚戊丙方】依一角
　　复作正方形【如丁庚方】以小方之各邉引长之如甲午辛壬即分元方戊庚为四分小方之各邉与大方之各邉俱两两平行其与小方丁庚相对之丁戊形亦必正方形左右所截之午壬甲辛二形必皆矩形而恒自相等一解曰任设一线如甲戊两平分之于乙又任引长之为戊庚【长短不论】其全线甲庚偕引长线戊庚【即子庚】矩内形
　　【甲子矩】及半元线甲乙【癸丑等】上
　　方形【癸辛方】并成子丑壬甲磬
　　折形此形与半元线【乙戊】偕引
　　长线乙庚上之乙丙方形等
　　何则乙庚上方乙丙与磬折形子丑壬甲共用乙子矩形今试以此两率各试去乙子矩形两所余为乙壬矩及丑丙矩夫此两矩形邉各相等【辛丙与乙辛等辛丑与壬辛亦等以壬丑为正方故】其幂亦必等则于乙子形加丑丙得乙丙方于乙子形加乙壬得子甲壬磬折形亦无不等矣　又己辛亦正方形以相对之己庚为正方故己辛方与壬丑方亦等以同在甲庚癸子两平行线内又甲乙乙戊相等故也分中末线
　　解理分中末线　明上二图可论理分中末线矣法曰如图任作甲戊线两平分于乙以甲戊线自之作戊卯方从乙平分处向丁作乙丁线次以甲戊引至庚令乙庚与乙丁等于乙庚上作乙丙方又取庚子与戊庚等作癸子线分戊丁于己则戊己为戊丁元线之大分己丁为小分戊己丁己戊丁三线成连比例戊丁与戊己若戊己与己丁而戊己为中
　　解曰依上二图之论甲庚线偕戊庚矩形及乙戊【即甲乙】上方形并与乙庚上方等今乙庚线既令与乙丁等则
　　乙丁上方亦与乙庚上方等是
　　甲庚偕戊庚矩形及乙戊上方
　　并与乙丁上方等而乙丁上方
　　与乙戊丁戊上两方之并等此
　　二率者共用乙戊上方试以此二率各减去乙戊上方则所存之戊卯方与甲子矩形必等矣夫戊卯方既与甲子矩等又共用甲己矩形试各减去甲己矩形则所存戊子方与卯巳矩形必等矣卯巳与戊子两矩形既等又以巳直角相连则两形之邉为互相似之比例癸己与巳子若戊己与己丁夫癸己即戊丁也则戊丁与戊己若戊己与己丁为连比例而戊己为中率戊己上方【二三率】与戊丁【一率】偕己丁【四率】矩形等戊丁全线为首率戊己大分为中率减戊丁【甲戊同】存己丁小分为末率葢理分中末线云者于一直线上作连比例之谓也求之法以所设甲戊半于乙为句甲戊为股【即戊丁】求乙丁即乙庚也减乙戊句存戊庚即戊己大分减戊丁元线存己丁小分
　　又甲戊引长线止于庚者欲令乙庚等乙丁也若不为连比例戊庚可任意引长之如前二图之论然理分中末线法实从二图之理推出其关键全在乙庚乙丁二线等也
　　解理分中末线大分为三十六度之通　观上诸论可明理分中末线之法然何以知其大分能为十等邉形之一边如图任作甲乙线用上法分之于内为理分中末线甲乙与甲丙若甲丙与丙乙甲丙其大分丙乙其小分次用甲乙全线为半径甲为心乙为界作圏又从乙作乙丁合圏线令与甲丙等末从圏心作甲丁线相连其甲乙甲丁两半径等即甲丙丁为两腰等三角形夫此三角形其腰间之甲乙丁甲丁乙二角必各倍大于底上甲角何则试从丙作丙丁线于甲丙丁角形外作甲丙丁外切圏其甲乙偕乙丙矩内直角形与甲丙上方形等【因连比例等】亦即与至规外之乙丁上方等而乙丁切小圏于丁为切线即乙丁切线偕丁丙线所作乙丁丙角与负丁甲丙圏分之甲角交互相等【见几何三巻三
　　十二】此二率者每加一丙丁
　　甲角即甲丁乙全角与丙
　　甲丁丙丁甲两角并等夫
　　乙丙丁外角与丁甲相对
　　之内两角并等即乙丙丁
　　角与甲丁乙全角等而与相等之甲乙丁亦等丙丁与乙丁两线亦等夫乙丁原与甲丙等即丙丁与丙甲亦等因丙甲丁丙丁甲两角亦等又甲角既与乙丁丙角等即乙丁丙甲丁丙两角亦相等是甲丁乙倍大于丙丁甲亦即倍大于相等之丙甲丁角也而甲乙邉与甲丁等则甲乙丁角亦倍大于甲角也
　　次解曰丙丁乙角何以知其与丙甲丁角交互相等试作未丁全径与乙丁为直角又作未丙线成未丙丁直角夫丙未丁丙丁未二角并与一直角等乙丁未亦一直角此二率者各减去未丁丙角所存丙丁乙丙未丁二角必等夫丙未丁负圏角也丙甲丁亦负圏角也同负丙丁弧则丙甲丁角与丙未丁角等夫未角与丙丁乙角等也今既与丙甲丁等则丙甲丁角亦必与丙丁乙角等
　　依上论显甲乙丁形之乙丁二角俱倍大于底上甲角形内之丙丁乙形与甲乙丁原形相似其丙乙二角亦倍大于乙丁丙角乙丁丙丁甲丙三线俱等夫甲丁乙形之甲乙丁三角并等两直角今乙丁二角既倍大于甲角是合乙甲丁角而为五分两直角矣则乙甲丁角该五分两直角之一为三十六度夫五分两直角之一与十分四直角【全周】之一等则乙甲丁角或乙丁弧即十分圏之一分乙甲丁甲又各为半径则乙丁即十等边形之一边夫乙丁与丙丁等丙丁与甲丙等则甲丙与乙丁亦等而甲丙即理分中末线之大分故圏径上作理分中末线其大分为三十六度之通
　　圏内作十等边切形法　先依上作甲丁乙两腰等三角形以甲乙甲丁各引至圏界为乙己丁戊其己戊弧与乙丁等次以戊乙弧半于庚作乙庚戊庚二线各半之于辛于壬又作癸丑子寅卯庚诸线俱过甲心各抵圏界即平分大圆为十分末作戊己等十线相连即所求十边形之理据厯书见几何十三卷九题而几何六卷巳后之书未经翻译不可得见考之他书未有发明其义者余特作此解之
　　表根四　圈内作五等邉内切形求得七十二度之通法曰六邉形上方形及十邉形上方形并开方得七十二度通
　　解内切五等邉形法　法曰甲乙丁圈于圈内作甲丙
　　丁两腰等乗圈角形令腰间丙丁
　　二角各倍大于甲角即甲角所乗
　　之丙丁弧为全圈五分之一何则
　　甲丙丁形之三角并等两直角今丙丁二角既各倍大于甲角则甲角为五分两直角之一又甲为乗圈角所乗之丙丁弧必更倍大于甲角之度为全圏五之一矣【七十二度】夫丙于二角又倍大于甲角则其所乗甲丙甲丁二弧亦必倍大于丙丁为全圈五分之二即作丙戊丁乙二线平分丙丁二角亦平分甲丁甲丙二弧分大圈为五平分丙丁线即五等邉之一末作丁戊等四线相连成五等邉内切形等邉等角　此系歴书原法新増作五等邉形法
　　甲庚壬平圆内作五邉等形法任作
　　切圆直线如子丑切平圆于甲乃以
　　切防甲为心任作半圈如子寅丑次
　　匀分半圆周为五平分如子辰等次
　　从半圆上取五平分之各防作直线至切防甲此直线必过半圆周【如甲辰线必过庚寅甲线必过戊余仿此】末于平圆内联各防作通即成五等邉形【庚甲乙甲本为通补作戊庚丁戊乙丁三线并与庚甲乙甲
　　等皆七十二度通也】
　　解曰卯甲寅负圈角正得丁心戊
　　分圆角之半卯甲寅既为十等面
　　凑心之角必三十六度也则丁心
　　戊角必七十二度而为五等邉角矣　或作半圆于外如下图亦同前论
　　解六邉十邉两方并等五邉上方形　法曰依前理分中末线法作己丁丁丙二邉为十分圏之一乙己乙丙甲乙三线俱为中末线之大分与十边形之一等乙丁
　　其小分次取己丁
　　弧之倍至丙作甲
　　丙线得己丙七十
　　二度为五分圏之
　　一【己丁丙为十分圏之二即五分
　　圏之一矣】作丙己线即
　　五等形之一边也
　　己甲丙为七十二度之角次取己为心己丁大分为界作丁未庚圏又以丙为心丙甲半径为界作子甲丑图两圏相交于辛末从丙心向交防【辛】作丙辛线从己心向交防【辛】作己辛线成丙己辛三角形此形辛为直角丙辛六边形之边【即子丙】为股己辛十边形之边【即己丁】为句己丙五边形之边为用句股术得己丙七十二度之通
　　解曰丙辛己形何以知辛防必为直角试观乙己丁乙丙丁俱为两腰等形又自相等合之成己乙丙丁四等
　　邉斜方形则丙己线必平分
　　乙丁小分于壬甲丁线因己
　　丙弧为己丁之倍亦平分丙
　　己于壬壬防为直角又形
　　内所分之乙壬己乙壬丙丁壬己丁壬丙四句股形俱自相等夫丙己邉上方形为壬己上方形之四倍【几何言全线上方形为半元线上方形之四倍】而壬己上方乃乙己上方减去乙壬上方之数【句求股】是以乙己上方四倍之【即己乙己丁丙丁丙乙四线上方之并】减去乙丁小分上方【乙丁上方为乙壬上方之四倍以乙壬为乙丁之半故也即乙壬等四小句方之并】所余即与丙己上方等矣而此四乙己方减乙丁上方之余又与全数上方及中末线大分之方并等【即十邉形之一】何则试观二图【即理分中末线图】甲丁为全数甲戊为全数上方丁乙为大分丁子为大分上方两方之并成甲壬子戊磬折形此形内容丁子大分方形之四则重一庚己小分之方【取丙丁与乙丁等则己丁壬乙俱为大分之方而庚壬矩与丁子方等甲壬矩又与庚壬矩等是共有大分上方形之四倍而庚己小方则重叠在内庚己乃辛己小分之方也】今试于磬折形内减去重叠之方【癸辛方】是即于四个大分方内减一小分上方亦犹之前图四乙己方内减去乙丁上方而所余必等矣夫此磬折形既与前四乙己方内减乙丁上方之余幂等而此余幂又与丙己上方等则此磬折形亦与五等边之一丙己上方等而磬折形乃甲戊丁子两方之并也甲戊方之根甲丁即前丙辛己形之丙辛边丁子方形之根丁己即前丙己辛形之己辛边今丙辛己辛上两方并既等于丙己上方是丙辛己为句股形而辛为直角矣丙辛半径股也己辛大分句也丙子弧六十度之边子丙即丙辛股己丁弧三十六度之边丁己即己辛句而丙辛己辛丙己三边适凑成句股形故厯书言六边上方并十边上方与五边上方等葢以此也
　　若作戊乙线成戊丁乙句股形与前丙辛己形等戊乙即五边形之一益可见辛之必为直角矣
　　求七十二度通法取迳甚竒大测止具算术未着其理【据云见几何十三卷十题】薛书及孔林宗説殊多牵附余此图与原算脗合乃知古人立法之简奥也因更推衍四法如下
　　如图午丁大圈依理分中末线法作十邉等内切形丁午等俱大分次从癸昴诸防【癸甲昴甲俱为大分】作癸昴昴壁等线俱为小分各连之则中末线之大小两分成内外两十邉等形俱各两两平行一切于周一切于径次任取
　　戊为心甲为界作圈
　　亦依上法用其大分
　　小分作内外两十邉
　　等形末作乙丙乙丑
　　等五线为五邉形之
　　各邉诸线交错得求
　　乙丙邉之法有五
　　一丁乙丙形有丁丙全径有丁卯全数及卯乙大分并为丁乙【丁乙与午戊必平行】乙为直角用股求句法得乙丙邉二乙丙寅形有乙寅小分为句有丙戊戌寅两大分并得丙寅为求得乙丙股
　　三乙甲丙形用其半甲壬丙形有甲丙全数有甲辛大分有辛壬为辛戊小分之半并为甲壬求壬丙勾倍之得丙乙邉
　　四乙壬戊形有乙戊大分为有壬戊小分之半为句求乙壬股倍之得乙丙邉
　　又形中两圈相交内有甲卯乙戊未为小五邉形其各邉即大分甲辰戊丙庚形同又有甲卯乙戊丙庚为小六邉形其各邉亦即大分又小五邉形与午丑乙丙氐大五邉形相似而体势等则其各邉俱成比例乙甲全数与甲卯大分若乙午与午丑则以甲卯与午乙相乗全数除之亦得五邉形之一其午乙线以乙亢午直角形用句求股术取之
　　表根五　圈内作三等邉内切形求得一百二十度通
　　半之为六十度正
　　法曰全径上方形内减六边形
　　上方形开方得一百二十度之
　　通
　　解曰甲为圏心甲乙为半径作圏次乙为心仍用乙甲为半径作弧与大圏相交于丁于戊其所截之丁乙戊弧即三分圏之一何则依前六边形之论丁乙戊乙二弧俱为六分圈之一今丁乙戊弧乃倍大于丁乙必三分圈之一矣【一百二十度】即作丁戊线为三等边形之边次以乙甲引至丙必平分丁丙戊大半圏于丙以丙乙为过心线既平分丁戊弧于乙亦必平分丁丙戊弧于丙也从丙作丙戊丙丁二线成丁丙戊三边等内切形求之用乙丁丙三角形丁为直角【以丁角乗丙戊乙半圏故】丁乙为六边形之一丙乙全径上方减去丁乙半径上方【丁乙即乙甲】余开方得丙丁边句求股术也
　　表根六　圏内作十五等边内切形求得二十四度之通
　　法曰三边等形与五邉等形之较即十五分圏之一可求二十四度通
　　解曰戊丙大圈丑为心作丙子全径取丙防为宗依前法作丙甲辛三邉等形又作丙戊乙己庚五边等形丙甲弧为三分圈之一【一百二十度】丙戊乙弧为五分圈之二【七十二度】相较得甲乙弧二十四度即十五分圈之一也其求甲乙之邉以五邉形之邉乙己半于癸三邉形之邉甲辛半于壬得乙癸与甲壬相减【丁壬即乙癸】存甲丁为股次作乙丑甲丑两半径成乙丑癸甲丑壬二直角形以
　　乙丑半径上方减乙癸半
　　上方余开方得癸丑邉又以
　　甲丑半径上方减甲壬半
　　上方余开方得丑壬邉次以
　　丑癸与丑壬相减得壬癸【即乙丁】为句末用甲丁乙直角形甲丁上方与丁乙上方并开方得甲乙为十五等邉内切形之边
　　又解曰甲乙弧何以知为十五分圏之一凡一圏内作三边等形又作五边等形以其边数三与五相乗得十五即知可为十五等边切形其两弧之较必有十五分圏之一如甲乙也余仿此推　此亦厯书原法
　　表根七　圈内作九等边内切形求得四十度之通【新増】求内切九等边形　法曰甲为圆心于圆内先作庚子辛三边等形【法见前】平分大圆为三分次用甲庚为度作
　　庚己线与庚辛为直角庚为
　　心己为界作己壬弧为全圏
　　六之一【六十度】次于己壬弧上
　　任取癸防向甲心作癸甲直
　　线与庚辛交于戊其自癸至戊之度令与甲乙半径等次癸为心戊为界作圏与大圏相交于丙于庚【庚防为己壬弧圏心又癸戊半径与庚己等必相交于庚】从癸又作癸庚癸丙二线得庚戊丙圈所割之庚乙丙弧必为庚辛弧三之二辛丙为三之一即全圏九分之一也末作丙辛线为内切九等形之邉依此作丙乙乙庚诸线成九等邉内切形等邉等角解曰癸戊线既等甲乙半径则两圈相交之庚戊丙庚乙丙两弧必等又癸甲线既过两心【甲大圆心癸庚戊丙圈心】试作庚丙通必平分通于丁亦平分庚丙弧于乙与丙庚弧于戊而庚乙与丙乙等庚戊与丙戊等又两弧【庚乙丙庚戊丙】共用庚丙通则丙戊与丙乙庚戊与庚乙亦各相等其丙戊丙乙庚戊庚乙四线亦等又癸丙癸戊癸庚三线俱即半径【癸为庚戊丙圈心故】则癸庚戊癸丙戊为两腰等三角形而两癸角又等【庚戊丙戊二弧等故】则两形之邉角俱自相等又丙戊辛形其戊辛二角亦等何则戊角之余为丙戊庚角而丙戊庚乃庚戊癸丙戊癸两角之并亦即癸丙戊癸戊丙两角之并【癸戊庚角与癸戊丙等因两形为等形亦与癸丙戊角等】是丙戊辛角必与戊癸丙角等其丙辛戊角乗庚丙弧则辛角必得庚丙之半与乙丙弧等亦与丙戊等是丙辛戊角亦与戊癸两角等而辛丙戊为两腰等形因得戊丙与辛丙两邉亦等夫丙戊边本与戊庚等则丑丙与戊庚亦等而丙戊即丙乙庚戊即庚乙是辛丙丙乙乙庚三线等也而辛丙丙乙乙庚三圈分亦等矣前庚乙辛弧乃全圈三之一今庚乙又为庚辛三之一即全圈九之一为四十度而庚乙即四十度通　按癸丙线必与庚甲平行其交己壬弧之丑防必居癸壬弧之中而壬丑丑癸癸己为三平分各得十二度
　　求九边形之边　法曰取十边形相较可得九分圏之
　　边如图乙辛戊圆甲为心取
　　辛丙弧为十边形之一【三十六度】戊乙弧为九邉形之一【四十度】辛丙为十邉形之邉乙戊为
　　九边形之边二线令平行则其较弧辛乙与丙戊相等【各二度】次作辛乙丙乙诸线成辛乙戊丙四邉形此形有丙辛边【前第五根所得】有辛乙边【一度正之倍用后法所得】先求丙乙线用丙辛乙钝角形作辛丁垂线以辛丙半之因乙辛得辛丁次以辛丁上方减辛乙上方开方得乙丁又以减辛丙上方开方得丁丙并之得乙丙线与辛戊等次以乙丙自乗方内减去辛乙自乗方余以辛丙除之得乙戍为九边形之边即四十度通也【上图之庚乙线】
　　解曰丙辛线既与戊乙平行则丙乙辛戊两线相等辛乙与丙戊亦等从辛从丙作辛己丙午二垂线所截戊乙线之戊午己乙为丙辛戊乙二线相较之半亦必等夫丙乙自乗得丙乙上方形辛乙自乗得丙戊上方形【辛乙与丙戊等故】而丙乙上方乃丙午乙午上两方之并丙戊上方又丙午戊午上两方之并则试于丙乙上方减去丙午上方所余为乙亥方丙戊上方减去丙午上方所余为午未方而午未方即己子方也今于丙乙上方形减丙戊上方形是减去丙午上一方又减去巳子一方【即戊午上方形】所余为午卯丑亥磬折形夫午乙与己戊二线相等则午丑与巳酉两方形亦等因得卯午矩与申酉矩等移卯午补申酉则丑未矩形与午卯丑亥磬折形等矣故以子丑除之【子丑即丙辛以卯亥为正方故】得子未边即乙戊四十度通也
　　按九边形法诸书所无然缺此则九十度之正不备壬寅秋客润州魏副宪官署时魏公鋭意厯学因作此图补之
　　附求一度之通【一度为全圆三百六十之一亦可名三百六十等邉内切形】法曰一度之通取相近之数用中比例法得之如图庚乙弧为一度先设甲庚一度三十分依前法【表根六及表法一】求其正甲癸○度○二六一七六八九又求其通得○度○二六一七九二半之得○度○一三
　　○八九六为己庚四十五
　　分弧正己辛也三分之
　　得己寅○度○○四三六
　　三三为十五分弧略大线
　　加己辛【即未丑】得壬丑○度○一七四五二八为一度弧略大之正次于甲癸线内减己辛【即戊癸】余戊甲亦三分之得丙戊○度○○四三六二四为十五分弧略小线加戊癸得丙癸○度○一七四五二即丁午也为丁庚一度略小弧之正夫大小两其差八数为壬亥半之得四壬申也【申亥同】加小减大得乙子○度○一七四五二四为乙庚一度之正若求其通用正与正矢为句股求之【此薛仪甫歴学防通法】
　　再细求一度正【系作枚法】
　　前四十五分弧之正○度○一三○八九六法以四十五分半之为廿二分三十秒求其正得六五四四九又半之为十一分十五秒求得正三二七二四五夫廿二分三十秒之弧倍于十一分十五秒而其亦倍则知二十分以内之弧正若平分数【纵有叅差非算所及】法以廿二分三十秒为一率正六五四四九为二率十五分为三率得四率十五分正○度○○四三六三二六次以十五分正与四十五分余○度九九九九一四三相乗得○度○○四三六二八八六○六八六为先数以十五分余○度九九九九九○四八与四十五分正○度○一三○八九六相乗得○度○一三○八九四七五三八为后数【相乗之理见表法六】两数相并得○度○一七四五二三六一四五为一度正与薛书略同但此法似宻
　　论曰弧与非平分数然一度以内弧相切曲直之分所差极微故可以中比例法求也
　　按上七根所求者皆各弧之通表中所列俱正葢论割圆必以通便算则惟正然正即通之半全与分之比例等其理一也






　　作表之法有七
　　用上根数于大圆中求七弧之通以为造端之始而各度之尚无从可得爰立六种公法或折半或加倍或相总或相较转辗推求以得象限内各度之正葢上诸法乃其体此则其用也二者相资表以成焉
　　表法一　有一弧之正求其余及半本弧之正与余
　　解曰如图甲为圈心乙丙戊弧为全圈四之一【九十】乙甲戊甲俱半径设有戊丁丙弧其正为丙庚即从丙作丙甲线成丙庚甲直角形法甲丙全数上方减丙庚正上方余开之得甲庚与丙辛等即丙戊弧之余也又用甲庚减甲戊半径得庚戊矢又作丙戊线成丙庚戊直角形法庚戊矢上方与丙庚上方并开方得丙戊为戊丁丙弧通半之得丙己或戊己即半本弧丙丁或丁戊之正又以丙甲己形【戊甲己形同】用句求股
　　术求己甲得半本弧之余【癸丙等】若
　　再以丙己丁己二边求丙丁半之
　　又得半丙丁弧之正余仿此逓求
　　之
　　论曰丙戊弧既平分于丁其丙戊
　　亦必平分于巳故半丙戊为半本弧
　　之正试作丁甲壬象限则丙己正己甲余尤了然矣
　　表法二　有一弧之正余求其倍本弧之正与余解曰甲丙象限内设有甲戊弧其正戊己余己乙今求倍甲戊之甲丁弧正丁癸与余癸乙法先作丁甲线为丁戊甲倍弧之通此线必为乙戊线平分
　　于壬则壬甲亦为甲戊弧正与
　　戊己等丁壬亦等夫壬甲既等戊
　　己则其余壬乙亦必等己乙法
　　用己戊乙庚壬乙两形乙戊全数
　　与戊巳正若乙壬余【即乙己】与壬庚而壬庚即辛癸倍之得丁癸为倍弧甲丁之正
　　论曰乙戊己乙壬甲两形相等戊乙等甲乙戊己等甲壬己乙等壬乙故壬乙得为余又乙戊己乙壬庚两形相似故第四率可求壬庚【即辛癸】而壬庚必为丁癸之半以丁癸甲直角形丁甲既平分于壬从壬作壬辛垂线亦必平分其股于辛也故倍癸辛得丁癸为倍弧甲戊丁正又壬庚线亦平分甲癸句于庚用甲壬庚形依句股术求甲庚倍之以减甲乙存癸乙或丁子即倍弧之余也
　　表法三　求象限内六十度左右距等弧之正解曰六十度左右距等弧之正与其前后弧两正之较等如图乙丙象限内设丙戊为六十度【不动】有丙己小弧【须在三十度以上】丙巳丁大弧其大弧与丙戊六十度之较戊丁令与丙己小弧与戊丙六十度之较戊己等其大小两弧正一为己辛一为丁庚相较为丁癸此丁癸与己壬丁壬等则丁癸为戊丁戊己距等弧之正壬甲为余
　　论曰试从巳向子作巳子线则丁巳子为三边等形何则形中壬子丁壬子己两形相等【丁子壬己子壬两角本等又同用壬子边则两形自等】而丁子壬角与乙甲戊角等【以丁庚与乙甲平行故】为三十度【乙甲戊为丙戊甲角六十度之余】则丁子巳角为丁子壬之倍必六十度又丁子壬巳子壬两角等则其余壬丁子壬巳子二角亦必各六十度而与丁子巳角等则丁子巳为
　　平边三角形夫丁子巳既为平边
　　三角形其巳癸垂线必平分丁子
　　于癸子壬垂线必平分丁巳于壬
　　两分之丁癸与丁壬必等而丁癸
　　乃己丙丁丙大小二弧两正【一巳辛一丁庚】之较
　　按此须先求得象限内六十率之正依上法可求左右三十率之正外此即不可用以六十度之余止三十度故也
　　表法四　任设两弧之正余求两弧并及较弧折半之正
　　解曰戊壬象限内任设不齐之两弧一置在上如戊丙
　　一置在下如丁壬中间所容丙丁
　　弧即戊丙丁壬两弧并之余今求
　　半丙丁弧丙乙【丁乙同】之正法作
　　丁壬弧正丁辛余丁癸戊丙
　　弧正丙壬【即癸己】余丙子又作丙丁线为较弧之通成丙己丁直角形次以丁壬弧正【丁辛巳子同】减戊丙弧余【丙子】得丙己为股丁壬弧余【丁癸】减戊丙弧正【癸己】得丁己为句句股求得丙丁邉半于庚得丙庚或庚丁为丙丁半弧丙乙之正
　　巳上俱系厯书原法
　　表法五　有一弧之正求倍本弧之矢因得余解曰设戊乙弧其正乙丁戊丙为戊乙弧之倍其正丙己正矢戊己丙戊为倍弧通半于辛其辛戊与乙
　　丁等法用戊丙己戊辛甲两直角
　　相似形【二形同用戊角故相似】甲戊与戊辛
　　若丙戊与戊己倍弧矢夫四率之
　　理二三相乗之矩内形与一四相
　　乗之矩等则丙戊乗辛戊即甲戊乗戊己而丙戊乗辛戊所得矩形为辛戊上方形之倍【戊辛自乗得辛庚方倍之为丙庚矩即丙戊与戊庚相乗之幂也戊庚即戊辛】而全数【甲戊也】又省一除故以乙丁正【即辛戊】自乗倍之退位即得戊己倍弧矢用减半径得倍弧余己甲若反之以戊己矢折半进位开方即得半本弧之正【丁乙】　此孔林宗术勿庵称为正简法余作此图以着其理
　　表法六　任设不齐之两弧求两弧相并之正及相较之正
　　解曰寅巳未圏甲为心寅巳为一象限设寅已弧内有己辛弧若干度为前弧又有己戊弧小于己辛为后弧戊子为后弧正子甲其余午辛为前弧正午甲
　　其余次取辛丑弧与己戊后
　　弧等则己戊丑为前后两弧之
　　并弧丑亥即并弧之正次作
　　丑壬线为丑辛弧正与戊子
　　等其余壬甲亦与子甲等辛壬亦与子巳等法用甲午辛甲壬丁二相似形以后弧之余壬甲因前弧之正辛午全数【甲辛】除之得壬丁为初数【卯亥等】寄位　次用甲辛午丑壬卯二相似形【甲辛午形之辛角与丑乙辛角等因丑壬乙为直角其丑壬卯角亦与丑乙壬角等则亦与甲辛午角等又二形之卯午俱为直角则两形相似】甲辛与甲午若丑壬与丑卯则以前弧之余甲午因后弧之
　　正丑壬全数【辛甲】除之得丑
　　卯为次数末以五卯与初数
　　卯亥相并得丑亥为已戊丑
　　两弧相并之正　若求两
　　弧相较之正法以后弧丑壬正引长之抵圈界于癸则丑癸为丑辛癸弧之通因壬防为直角其癸壬与丑壬必等因得丑辛癸辛两弧亦等夫丑辛弧原与戊巳后弧等则辛癸与戊己弧亦等即以辛癸减辛己前弧得癸己为两弧之较癸庚即较弧之正癸酉其余法用丑辰癸形此形内之癸申壬丑卯壬二直角形相等【丑癸辰句股形丑癸既平分于壬则从壬作壬卯壬申二垂线亦必平分丑辰句于卯癸辰股于申而癸申壬丑卯壬两形必等】因得壬申即丑卯次数【壬申等卯辰卯辰即丑卯】用以减初数壬丁存申丁即癸庚也为较弧癸巳之正亦与戊辛弧正等
　　若两弧相并在象限外如次图巳寅丑弧理亦同【钤记同前】有不齐之两弧求相并相较弧正又法
　　法曰两弧【小甲丙大甲戊】相并曰总弧【甲癸】相减曰多弧【戊丙】置大小两弧以大弧正【戊辛】因小弧较【子庚】曰先数【庚乙】以大弧较【辛庚】因小弧正【庚午】曰后数【午未】　视两弧在象限内者以后数【亥壬】减先数【亥丙也以午亥丙形与庚乙子形等故】为多弧正【壬丙】以后数卯丑加先数【丑已以庚巳丑形与庚乙子形等故】为总弧正【卯巳也以卯午巳形与庚酉癸形等故卯己即酉癸】若两弧过象限者加减各异
　　又或置大小两弧【同上】以
　　大弧正【戊辛】因小弧正
　　午庚曰先数【庚未】以大
　　弧较【庚辛】因小弧较
　　【庚子】曰后数【子乙】　视两弧在象限下以后数【午亥】加先数得多弧较【壬庚】以后数【庚丑】减先数【庚未】得总弧较【丑未即午卯亦即庚酉】若两弧象限内外不等加减亦异
　　此法详三角会编五卷梅勿庵先生环中黍尺亦着其法然彼所论者弧三角形此则平圆中求正也
　　表法七　圆内有五通错互成四不等边形求不知一弧之通
　　解曰甲为圆心戊庚为圆径戊丙丙丁丁庚俱为通成戊庚丁丙四不等形丁戊丙庚为对角线法丁戊偕丙庚相乗之矩形内减丁庚偕丙戊相乗之矩形余为戊庚与丙丁相乗之矩形葢丁庚丙戊相乗之矩与戊庚丁丙相乗之矩并与丁戊丙庚两对角线相乗之矩
　　等也若有丙戊丁庚戊庚丙
　　庚丁戊五通用此可得丙
　　丁弧之通
　　论曰庚戊丁形与庚丙丁形
　　其戊丙两角等【同乗丁庚弧故】若以
　　丙丁引至己作庚己丙直角形则庚戊丁庚己丙两直角形相似庚戊与戊丁若庚丙与丙己夫四率之理二三相乗矩形与一四相乗之矩等则庚丙与丁戊相乗所得即庚丙与丙己相乗之己壬矩也【取己癸与庚戊径等】次作丁辛线与己癸平行割圈于子其子庚弧与丙戊弧等何则戊丁庚为直角丙丁子亦为直角同用戊丁子角【子戊弧】则丙丁戊庚丁子两角必等其所乗之丙戊庚子两弧亦等矣因得庚子边即丙戊通又庚子丁角与庚戊丁角等【同乗丁庚弧故】于庚作庚乙垂线与己丙平行成子庚乙直角形与庚戊丁直角形相似戊庚与庚丁若子庚与庚乙依四率之理庚子【即丙戊】与丁庚相乗所得即庚戊与庚乙相乗之己辛矩也【丁辛即庚戊己丁即庚乙】用以减己壬矩形余丁壬矩形乃庚戊与丁丙相乗之幂故以庚戊除之得丁丙为丁丙弧之通
　　若戊丙丁庚非半圈【或大或小不论】则庚
　　戊为戊丙庚弧之通理亦同但
　　己壬为斜方形如上图戊丁庚为
　　小半圈成己壬斜方其庚乙线不
　　与丁己平行法作己庚乙角令与
　　丁己庚角等则腰间相对丁乙二角亦等因得庚乙丁己为等边而庚乙子钝角为丁乙庚之余与丁己庚角自等亦即与圆内戊丁庚角等而庚乙子庚戊丁为相似形庚乙即丁己
　　此上古多罗某法诸书未有能言其故者得余此图庶不昧古人精意　已上二法系余所增
　　用上七法交互推求可得象限内各度之正细推之又可每隔十五分【四分度之一】得一正十五分以下用中比例法以十五分正为实十五为法而一得一分之正逓加之得每度内各分之正立割圆表又此正算一象限巳足以适满一直角故也
　　求切线角线矢线
　　割圆正而外又有切割矢三线并正为四线合其余为八线葢以八线凖一弧弧之曲度得其真矣切线止切圈以一防全在圏外割线从圈心过规半在内半在外正与矢全在圈内如图甲为圈心庚丁为象限庚甲丁甲俱半径设有庚乙正弧即戊乙为正乙辛【戊甲同】为余次于圏外作庚己线与戊乙平行切圈于庚又从甲心过所截弧乙防作甲己线与庚己交于己成甲己庚直角形此己庚为乙庚弧正切线己甲其正割线也而甲己庚直角形与圆内戊甲乙形相似甲戊与戊乙若甲庚与庚己故以余除正半径因之得本弧正切又戊甲与甲乙若庚甲与甲己故以余除半径全数因之得本弧正割以戊甲余减甲庚半径得庚戊本正矢此皆庚乙弧相当之线也夫庚乙既为正弧则乙丁为余弧作乙辛线为余弧之作丙丁线切圏于丙为余弧之切甲乙引出之遇于丙甲丙为余弧之割成甲丙丁直角形与圆内甲乙辛形相似甲
　　辛与辛乙若甲丁与丁丙得
　　余切甲辛与甲乙若甲丁与
　　甲丙得余割乙戊【即甲辛】正
　　减甲丁半径得辛丁余矢此
　　又丁乙余弧相当之线也一正一余共有八线若或以丁乙为正弧即庚乙反为余弧其八线正余之名亦互易葢此为正彼自为余耳
　　论曰庚乙正弧之各线为甲庚己甲戊乙两句股形所成乙丁余弧之各线为甲丁丙甲辛乙两句股形所成而甲庚己形与甲丁丙形相似【一为顺句股一为倒句股】又圆内之乙甲辛甲戊乙二句股形俱自相似亦与甲丁丙甲庚己二形相似是庚乙弧相当之线成相似之直角形四设算可以用正亦可以用余是一弧而能兼用八线此八线表所由名也
　　按表中不列矢线者以矢线用正余减半径即得且不常用故省之　又按割圆之难全在求正若切割线俱以比例得之
　　附求割线省法【用加减算】
　　如乙己弧为二十度其切线乙戊求割线甲戊法先以余己丙七十度半于丁得丁己三十五度丁丙等次
　　以戊乙切线引长之令与戊甲
　　等作甲戊辛两腰等三角形而
　　乙庚弧必与丁丙等即查乙庚
　　弧之切乙辛并乙戊得戊辛即甲戊割也
　　解曰乙庚弧何以与丁己弧等葢甲辛戊既为两腰等三角形则甲角之己庚弧必为丙己余弧【己壬也】之半壬庚与己庚等而庚防居己壬弧之中夫丙己与己壬并等两直角则己庚弧之不满直角者必为丙己之半今丙己既半于丁则以丁己益己庚丁甲庚必为直角而乙甲丙亦直角也共用乙甲丁角【或丁乙弧】则丙己与乙庚等
　　求矢线　余减半径得正矢正减半径得余矢求切线　余除正半径因之得正切正除余半径因之得余切
　　求割线　余除半径半径因之得正割正除半径半径因之得余割
　　按圆内矢二线当正弧初度则无九十度极大即半径圈外切割二线切线当正弧初度亦无割线即半径至九十度俱极大且切与割平行不能相遇名曰无穷之度然至此亦无切割之可言矣惟将近九十度防有极大之切割线
　　定八线正余之界
　　庚戊丙半圆甲为心戊丙为象限设丙乙正弧在九十度内则乙壬为正壬丙为正矢甲丁为正割丙丁为
　　正切其戊乙余弧乙己为余己
　　戊为余矢甲辛为余割戊辛为余
　　切若设庚戊乙为正弧在九十度
　　外亦以乙壬为正丁丙为正切
　　甲丁为正割壬丙为正矢而庚壬亦为正矢又名大矢其余弧仍用戊乙【非乙丙】在庚戊象限之外乙己为余戊己为余矢戊辛为余切甲辛为余割葢乙壬正为丙乙庚乙两弧共用故总以戊乙为余弧也凡算三角形取用正余诸线以此为凖






　　厯算全书卷五十五
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　歴算全书卷五十六
　　宣城梅文鼎撰
　　方圆幂积一卷
　　方圆幂积说
　　歴书周径率至二十位然其入算仍用古率【十一与十四之比例本祖冲之径七周二十二之宻率】岂非以乗除之际难用多位欤今以表列之取数殊易乃为之约法则径与周之比例即方圆二幂之比例【径一则方周四圆周三一四一五九二六五而径上方幂与员幂亦若四与三一四一五九二六五尾数八位并以表为用】亦即为立方立圆之比例【同径之立方与圆柱若四与二一四有竒则同径之立方与立员若六与三一四有竒】殊为简易直截癸未歳匡山隠者毛心易干干偕其壻中州谢野臣惠访山居共论周径之理因反覆推论方员相容相变诸率庚寅在吴门又得锡山友人杨昆生定三方员订注圗说益觉精明甚矣学问贵相长也
　　方圎相容
　　新法厯书曰割圆亦属古法盖人用圭表等测天天圎而圭表直与圎为异类讵能合欤此所以有割圎之法也新法名为八线表云
　　又云径一围三絶非相凖之率然径七围二十二则盈径五十围百五十七则朒或详绎之则径一万围三万一四五九虽亦小有竒零不尽然用之颇为相近今算得平方与同径之平圆其比例若四○○与三一四五九平方内容平员平员内复容平方则内方与外方内员与外员之幂皆加倍之比例
　　假如戊己庚辛平方内容甲乙丙丁
　　员员内又容甲乙丙丁小平方小方
　　内又容壬丑癸子小平员如此逓互
　　相容则其幂积皆如二与一也
　　假外大平方【戊己庚辛】之积一百则内小平方之积【甲丁乙丙】必五十平员亦然
　　若求其径则成方斜之比例大径如斜小径如方假如内小平方积一百以甲丁或丙乙为径【甲丙或丁乙并同】开方求一百之根得径一十其外大平方积二百以甲乙或丁丙为径【或用戊庚或己辛或己戊或辛庚为径并同】开方求二百之根得径一十四一四有竒
　　甲乙为甲丁方之斜故斜径自乗之幂与其方幂若二与一而其径与斜径若一十与一十四【一四竒】也折半则为五与七【○七竒】故曰方五则斜七有竒也
　　三邉形内容平员平员内又容三邉则其幂之比例为
　　四与一甲乙丙三邉形内容丁戊己
　　平员平员内又容丁戊己小三邉则
　　内小三邉形为外大三邉形四之一
　　内外两平员之幂其比例亦为四与一
　　若有多层皆以此比例逓加
　　浑员内容立方立方内又容浑员如此逓互相容则外员径上幂与内员径上幂为三倍之比例外立方与内立方之径幂亦然丙庚丁浑员内容丙甲丁乙立方丙戊及戊甲皆立方边【丙辛及甲辛并同丙乙及甲丁等亦同】丙戊甲辛为立方面【余六面并同】丙甲【为方面斜线】丙丁【为立方体内对角线】即浑员径【乙甲同其辛壬及己戊皆亦对角若作线亦同】丙乙及甲丁等又皆为立楞【戊壬及辛己同】解曰立方面上斜径之幂为方幂之倍【句股法也
　　斜为方为句又为股并句股实成实故倍方幂即成斜径之幂】又以斜径
　　为股立方之立楞为句求得立方体内両对
　　角之斜径为此实内有股实【即面上斜径之幂为
　　方幂者二】有句实【即立楞之幂立楞原即方邉故其幂即立方面幂】共得方
　　幂三而此丙对角斜径即浑员之径内小员径又在立方体内即以方径为径其径之幂即立方面也故曰三倍比例也立方内又容立员则内员径即立方之径
　　若求其径则外径大于内径若一十七有竒与一十内径之幂百开方得一十为径则外径之幂三百开方得一十七【又三十五之一十一】为径若有几层互容皆以此比例逓加卽得若求其体积则为五倍有竒之比例【若有多层亦以此比例逓加】假如内容立方积一千则外大立方积五千一百九十四有竒解曰立积一千则其径幂一百而外大立积之径幂三百又以径一十七【又三十五之一十一】乗之得五千一百九十四【又七之二】　此言大方积又在圗上浑员之外
　　积之比例
　　立方同径之立员其比例为六○○与三一四
　　立方同径之员柱其比例为四○○与三一四
　　员柱与同径之立员其比例为三与二
　　方圎周径相求
　　同积较径　为方变员员变方之用
　　凡方圎同积则员径大方径小其比例若一一二八三七九与一○○○○○○
　　解曰员径一一二八三七九则方径一○○○○○○也法曰有员径求其同积之方径当以一○○○○○○乗以一一二八三七九除
　　有方径求其同积之员径当以一一二八三七九乗以一○○○○○○除
　　凡方员同积则员径上平方与方径上平方其比例若四○○○○○○○○与三一四一五九二六五解曰员径自乗四○○○○○○○○则方径自乗三一四一五九二六五
　　法曰有员径求其同积之方径当以三一四一五九二六五乗之四○○○○○○○○除之得数平方开之得方径
　　有方径求其同积之员径当以四○○○○○○○○乗三一四一五九二六五除得数平方开之得员径凡方员同积则员径与方径若一○○○○○○与○八八六二二六
　　解曰员径一○○○○○○则方径八八六二二六也法曰有员径求同积之方径以八八六二二六乗员径一○○○○○○除之即得方径
　　有方径求同积之员径以一○○○○○○乗方径八八六二二六除之即得员径
　　约法
　　以一一二八二七九乗方径去末六位得同积之员径以○八八六二二六乗员径去末六位得同积之方径同积较周
　　凡方员同积则员周小方周大其比例若一○○○○○○与一一二八三七九亦若八八六二二六与一○○○○○○
　　解曰员周一○○○○○○则方周一一二八三七九也
　　方周一○○○○○○则员周八八六二二六也约法
　　以一一二八三七九乗员周去末六位得同积之方周以○八八六二二六乗方周去末六位得同积之员周凡方员同积则其径与径周与周为互相视之比例解曰方周与员周之比例若员径与方径也
　　论曰凡同积之周方大而员小同积之径则又方小而员大所以能互相为比例
　　约法
　　以方周乗方径为实员周除之得员径若以员径除实亦得员周
　　以员周乗员径为实方周除之得方径若以方径除实亦得方周　皆用异乗同除例如左
　　一　员周一○○○○○○　　一　方周一○○○○○○二　方周一一二八三七九　　二　员周○八八六二二六三　方径○二八二○九四【七五】　三　员径○二八二○九四【七五】四　员径○三一八三○九【八八】　四　方径○二五○○○○积七九五七七【四四八　　　○○○○○○】　　积六二五○○○○○○○○
　　一　员径一○○○○○○　　　一　方径一○○○○○○二　方径○八八六二二六　　　二　员径一一二八三七九三　方周三五四四九○四　　　三　员周三五四四九○四四　员周三一四一五九二　　　四　方周四○○○○○○积七八五三九【八一六　　　○○○○○○】　　积一○○○○○○○○○○○○
　　第四率并与一率乗得四倍积四除之得本积
　　论曰以上皆方员周径互相求乃同积之比例方员交变用之即比例规变面线之理
　　同径较积较周　即方内容员员外切方
　　凡方员同径则方积大员积小周亦如之其比例若四○○○○○○○○与三一四一五九二六五
　　方径一○○○○周四○○○○　积一○○○○○○○○员径一○○○○周三一四一五竒积○七八五三九八一六方径二○○○○周四○○○○　积四○○○○○○○○员径二○○○○周六二八三一竒积三一四一五九二六五凡径倍者周亦倍而其积为倍数之自乗亦谓之再加比例授时厯谓之平差
　　径二倍周亦二倍而其积则四倍径三倍周亦三倍而其积九倍乃至径十倍周亦十倍而积百倍径百倍周亦百倍而积万倍皆所加倍数之自乗数亦若平方谓之再加也
　　同周较积较径
　　凡方员同周则员积大方积小径亦如之其比例若四○○○○○○○○与三一四一五九二六五
　　方周一○○○○○○径○二五○○○○积六二五○○○○○○○○员周一○○○○○○径○三一八三○九八八积七九五七七四七○○○○方周四○○○○○○径一○○○○○○积一○○○○○○○○○○○○员周四○○○○○○径一二七三二三九五四积一二七三二三九五四○○○○论曰周四则径与积同数但其位皆陞皆视周数之位今用百万为周则积陞六位成万亿矣故虽同而实不同不惟不同而且悬絶定位之法所以当明也
　　问位既大陞而数不变何耶曰周径相乗得积之四倍于是四除其积即得所求平积此平幂之公法也兹方员之周既为四则以乗其径而复四除之即还本数矣惟周数之四或十或百或千万亿无定而除法之四定为单数故无改数而有进位也
　　又论曰周四倍之径与周一之径为四倍其积则十六倍所谓再加之比例
　　浑圎内容立方径一万寸求圎径　法以方斜一万四千一百四十二寸为股自乗得二亿为股实以方径一万寸为句自乗得一亿为勾实并勾股实为三亿为实开方得一万七千三百二十○半寸命为浑圎之径
　　又以浑圎径求围得五万四千四百十四寸弱　周径相乗得九亿四千二百四十七万六九九四寸为浑幂以四除浑幂得二亿三千五百六十一万九千二百四十八寸竒为大平圎幂即立方一万寸外切浑圎之腰围平幂也
　　圎柱积四万○千八百十○亿四三一八四九八四寸以浑圎径乗平圎幂得之
　　倍圎柱积以三除之得浑圎积二万七千二百○六九五四五六六五六寸
　　约法　立方径一千尺其积一十尺　外切之浑圎径一十七尺三二○五　浑圎积二千七百二十○尺六九五四　约为二千七百二十一尺弱
　　试再用径上立方求浑圎积法【即立方内求所容浑圎】以浑圎径自乗再乗得浑圎径上立方以圎率【三一四竒】乗之得数六除之得浑积并同
　　立方与员柱若四○○与三一四竒【同径之员柱也】
　　立方为六方角所成员柱为六员角所成其所容角体并六而方与员异故其比例如同径之周　此条为积之比例
　　员周上自乗之方与浑员面幂若三一四竒与一○○浑员面幂与员径上平方形亦若三一四竒与一○○皆员周与径之比例
　　浑员面幂与员径上平员若四与一
　　员柱面幂与员径上平员若六与一【六员角之底皆外向合成此数】平员并为一而员柱幂为其六倍浑员幂为其四倍浑员为员柱三之二即此可徴积之比例如其面也以上四条并面幂之比例浑员体与员角体若四与一浑员面既为平员之四倍从面至心皆成角体故体之比例亦四倍
　　立方面与径上平方若六与一【六面故也】
　　立方体与浑员体若六○○与三一四竒
　　浑员面与径上平方既若三一四竒与一○○而立方面与径上平方若六与一平方同为一○○而立方面为其六倍浑员面为其三倍一四竒故立方之面与浑员之面亦若六○○与三一四竒也而体之比例同面故亦为六○○与三一四竒
　　立员得员柱三之二
　　论曰凡员柱之面及底皆立员径
　　上平员也旁周似员筩亦如截竹
　　周围并以员径为髙即员径乗员
　　周幂也为径上平员之四倍与浑
　　员面幂同积【半径乗半周得平员则全径乗全周必平员之四倍】合面与底共得平员之六倍而浑员面幂原系平员之四倍是员柱幂六而浑员幂四也而体积之比例凖此可知亦必为三之二矣【三之二即六之四之半】
　　问体积之比例何以得如面幂曰试于员柱心作员角
　　体至面至底成员角体二皆以半
　　径为髙平员为底其余则外如截
　　竹而内则上下并成虚员角于是
　　纵剖其一邉而令员筩伸直以其
　　幂为底以半径为髙成长方锥【底濶
　　如全径直如员周髙如半径锥只一防】此体即同四
　　员角【或纵剖为四方锥亦同皆以周四分之一为底濶以全径
　　为底长以半径为髙其体并同员角何也以周四之一乗全径与半
　　径乗半周同故方底同员底而其髙又同则方角同员角】合面
　　底二员用共六员角矣而浑员体
　　原同四员角【浑员面为底半径为髙作员锥即同四员
　　角】是员柱浑员二体之比例亦三
　　与二也
　　员角体得员柱三之一　凡角体并同
　　凖前论员柱有六员角试从中腰平截为两则有三员角而员筩体原当四员角今截其半仍为二员角或面或底原系一员角合之成三员角以为一扁员柱然则员角非员柱三之一乎
　　若立方形各从方楞切至心则成六方角【皆以方面为底半径为髙】从半径平切之为扁立方则四周之四方角皆得一半成两方角而或底或面原有一方角亦是三方角合成一扁立方而方角体亦三之一矣
　　浑员体分为四则所分角体各所乗之浑幂皆与员径上平员幂等
　　甲戊丙丁浑员体　从丑乙辰乙癸乙子乙卯乙寅乙等各半径各自其浑幂透至乙心而以半径旋行而割切之则成上下两员角体一甲卯辰丑乙【以甲丑卯辰割浑员之面为底乙为其锐此割员曲径自丑而甲而辰居员周三之一】一丙癸寅子乙【以子丙寅癸浑员之割面为底乙为其锐此割员曲径亦
　　三之一如三百六十之一百二十】此上下两角体
　　相等皆居全浑体四之一中腰成
　　鼓形而上下两面并穵空各成虚
　　员角【其外则周遭皆凸面如丑戊子及辰丁癸之割员状此割
　　员曲径自辰而丁而癸居员周六之一为三百六十之六十】
　　此鼓形体倍大于上下两角体居浑员全体之半若从戊乙丁腰横截之为二则一如仰盂一如覆碗而其体亦浑员四之一也
　　如此四分浑体而其割员之面幂即各与员径上之平员幂等故曰浑员面幂与径上平员若四与一也问何以知中腰鼓体能倍大于上下两角体曰试于子丙乙癸角体从子寅癸横切之则成子未癸午小员面
　　为所切乙子寅癸小员角体之底
　　乃子寅小半径乗子未癸小半周
　　所成也然则以子寅小半径乗子
　　未癸小半周又以乙寅半半径为
　　髙乗之而取其三之一即小角体矣
　　试又于中腰鼓体从丑子及卯寅
　　及辰癸诸立线周遭直切之脱去
　　其外鼓凸形即成员柱体之外周
　　截竹形又从酉乙申横切之为两
　　【一仰盂一覆碗】则此覆碗体举一式为例
　　可直切断而伸之亦可成方角体
　　此体以乙寅半半径乗子未癸午
　　小员全周为底【其形长方】又以小半径
　　子寅【子寅即乙申】为髙而乗之取三之
　　一为长方角体此长方角体必倍
　　大于小员角体何也两法并以小
　　半径及半半径两次连乗取三之
　　一成角体而所乗者一为小员全
　　周一为小员半周故倍大无疑
　　也
　　又丙癸寅子亦可成角体与乙子
　　寅癸等覆碗体既倍大则兼此两
　　角体矣
　　凖此而论仰盂体必能兼甲丑卯辰及乙辰卯丑两角体亦无疑也
　　又角体内既切去一小角体又穵
　　去一相同之小角体则所余者为
　　丙癸寅子员底仰盂体
　　鼓体内既穵去如截竹之体则所
　　余者为内平【如丑子及辰癸】外凸【如子戊丑及辰
　　丁癸】之空圈体而此体必倍大于员
　　底仰盂体何以知之盖两体并以
　　半径为平面【丑子与癸丙并同】并以员周
　　六之一为凸面而腰鼓之平面以
　　半径循员周行员底仰盂之平面则以半径自心旋转周行者两头全用旋转者在心之一头不动而只用一头则只得其半矣故决其为倍大也
　　凖此而甲丑卯辰亦为穵空之员覆碗体而只得鼓体之半矣由是言之则上下角体各得中腰鼓体之半而鼓体倍大于角形浑体平分为四夫复何疑
　　曰浑体四分如此真无纎芥之疑体既均分为四则其浑体外幂亦匀分为四亦无可复疑但何以知此所分四分之一必与径上平员相等耶曰此易明也凡割浑员一分而求其幂法皆从其所切平面员心作立线至凸面心而以其髙为股员面心至邉之半径为勾勾股求其斜用为半径以作平员即与所割圎体之凸面等幂假如前圗所论上下两角体从丑夘辰横线切之则以甲夘为股夘丑为句求得甲丑与半径同以作平员与丑夘辰甲凸面等然则此角体之凸面岂不与径上平员等幂乎
　　甲亢半径与甲丑同以作丑
　　亢平员与甲丑夘辰凸面等
　　幂
　　试又作甲戊线为半径之斜线【甲乙与戊乙皆半径为句为股故也】以为半径而作平员必倍大于半径所作之平员而浑员半幂与之等则浑员半幂不又为平员之倍乎
　　【如图甲丑为半径作乙庚房平员与丙戊甲平员等亦与甲辰夘丑
　　割员凸面等为浑幂四之一也】
　　【甲戊为半径作戊心亥平员与甲丁乙戊半浑幂等而倍大于乙庚
　　房亦倍大于丙戊甲平员则平员居浑幂四之一】
　　如是宛转相求无不脗合则平员为浑员幂四之一信矣取浑幂四之一法
　　当以半径为通以一端抵圎径之端为心旋而防之则所割浑幂为四之一而其浑幂与圎径上平员幂等
　　甲辰【即丁乙】之自幂一百辰夘之自
　　乗幂【七十五】如四与三则辰丑通
　　为径以作平员亦丁戊全径上平
　　员四分之三也大小两平员各为
　　底以半径为髙而作员角体其比
　　例亦四与三也
　　今浑员径上平员【即下戊径上平员】所作之员角体既为浑积四之一则辰丑通径所作之员角体即浑体十六之三矣【即甲丑夘辰角体及乙丑夘辰角体之合】若以丑辰通上平员为底半半径为髙而作角体即浑体三十二之三
　　分浑体为四又法
　　甲乙丙浑员体　从员周分为三【一丑甲辰一辰癸丙一丙子丑各得周三之一】又从辰从丙从丑依各半径【辰乙丙乙丑乙皆是】至乙心旋而
　　切之则成三角体者三各得浑体
　　四之一【一辰甲丑乙一丑子丙乙一丙癸辰乙说见前】则
　　其所余亦浑体四之一也【此余形有三平
　　员面以辰丑丑丙辰丙为员径而并穵空至乙心如员锥之幂有两】
　　【凸面以辰丑丑丙辰丙之员周为界以乙为顶皆弧三角形三角并锐】两凸面各得浑员幂八之一按辰丑即一百二十度通也凖前论以此通为圎径作平员为底半半径为髙而成员角体此员角体积即为浑员体积三十二分之三【即先所论员角体八之三】
　　若依此切浑员体成半平半凸之体其积为浑积三十二之五【即员角体八之五】
　　环堵形面幂　锥形面幂
　　有正方正员面欲于周作立围之堵墙而幂积与之倍法于方面取半径为髙即得
　　甲乙丙平方于其周作立起之
　　方围形如环堵取平方乙丙半
　　径为髙则方围面幂倍大于平方
　　论曰从平方心乙对角分平方为四成四三角形并以方根为底半径为髙于是以此四三角形立起令乙锐上指则皆以乙丙半径为髙而各面皆半幂故求平方以半径乗周得幂也然则依方周作方墙而以半径为髙岂不倍大于平方幂乎
　　凖此论之凡六等邉八等邉以至六十四等邉虽至多邉之面而从其各周作墙各以其半径为髙则其幂皆倍于各平幂矣然则平员者多邉之极也若于其周作立圈如环而以其半径为髙则环形幂积亦必倍大于平员有方锥员锥于其周作围墙而幂积与之倍
　　法于锥形之各斜面取其至锐之中线【如乙丙】以为环墙之髙即得
　　方墙如环堵底用方周髙如乙
　　丙即斜面自锐至底之斜立中
　　线
　　解曰此以锥体之斜面较幂也
　　论曰凡方锥皆有棱两棱交于锐各成三角面而斜立从此斜立之三角面自锐至根濶处平分之得中线【乙丙】于是自棱剖之成四三角面而植之则中线直指天顶而各面皆圭形为半幂故凡锥体亦可以中线乗半周得幂也然则于底周作方墙而以中线为髙四面补成全幂岂不倍大乎
　　凖此论之凡五棱六棱以上至多棱多面之锥体尽然矣而员锥者多棱多面之极也则以其斜立线为髙而自其根作员环则其员环之幂亦必倍大于员锥之幂前条所论切浑员之算得此益明盖员仰盂员覆碗及穵空之鼓形其体皆一凸面一平面相合而成其凸面弧径皆割浑员圈六之一其平面之濶皆半径然而不同者其内面穵空之平幂一为锥形【仰盂覆碗之内空如笠】一为环形也【鼓体之内空如截竹】准前论穵空之环幂必倍大于锥形之幂则其所负之割浑员体亦必环形所负倍大于锥形而穵空之鼓体必能兼员覆碗员仰盂之二体








　　撱圎算法【订厯书之误】
　　偶查撱圎求体法见其截小分之法有误今以数考之假如撱圎形长径为一千四百尺短径七百尺大分截长径一千○五十尺
　　甲己三百五十戊乙七百相并得
　　一千○五十　以此乗
　　己乙一千○五十尺　以此除
　　两数相同
　　右依厯书先求得庚壬甲圎角形为苐三率再用截大分轴己乙为法为苐一率以截小分轴甲己并戊乙半长径为苐二率求得小分之容与圎角形等夫小分之容形外为弧线圎角之容形外为直线小分必大于圎角而今等是不合也况自此而截小分渐小则乙己大分轴反大于甲己小轴及戊乙并之数而求小分之容反将更小于圎角矣有是理哉【小分渐小如辛癸甲则其甲己小于己戊而己乙者己戊与戊乙并也则其数亦大于甲己与戊乙并矣】
　　又如截大分长七百二十分己乙
　　为其轴甲己为其小分轴六百八
　　十分
　　依厯书法甲己小分轴【六百八十】为一率甲乙长径【一千四百】并戊乙短径【七百】共【二十一百】为二率求到庚壬乙圎角体为三率则所得四率为大分之容者比圎角容大三倍有竒亦恐无是理也何也圎角在圎柱形为三分之一而撱形必小于柱形不宜有三倍之比例也【虽壬庚畧小于丙丁在中腰相近可以不论】今试求之【用苐一圗】依勿庵改法
　　假如截己乙大分轴一千○五十尺求庚己壬平圎面法先求庚己　依勿庵补法以己戊【三百五十尺】自乗【一十二万二千五百尺】与甲戊【七百尺】自乗【四十九万尺】相减余【三十六万七千五百尺】开方得己庚相当之原数　再以丙戊【三百五十尺】乗之甲戊【七百尺】除之为己庚实数倍之为庚壬线
　　再以壬庚线上方变为平员今用简法【因长径甲乙与短径丙丁原是折半之比例故也】竟以减余【三十六万七千五百尺】命为庚壬线上方以十一乗之得【四百○四万二千五百尺】又以十四除之得【二十八万八千七百五十尺】为庚壬线上所截撱体之平圎面
　　法以平圎面各乗其【大分小分】之轴【一千○五十尺三百五十尺】皆成圎柱形乃三除之为【大小】分内所容之【大小】圎角形
　　再以长径【一千四百尺】乗大圎角为实小轴【三百五十尺】除之为所截撱形之大分
　　以长径【一千四百尺】乗小圎角为实大轴【一千○五十尺】除之为所截撱形之小分
　　今用简法　置平圎面三除之得【九万六千二百五十尺】以小分轴【三百五十】乗之得庚甲壬小圎角形【三千三百六十八万七千五百尺】置小圎角四因三除之得【四千四百九十一万六千六百六十六又三之二】为所截小圎分
　　又置圎面三除之积【九六二五○】以大分轴【一千○五十尺】乗之得庚子乙大圎角形【一亿○一百○六万二千五百尺】
　　置圎角形【一○一○六二五○○】用四因之得【四亿○四百二十五万尺】为所截大圎分
　　小圎分大圎分两形并之【共四亿四千九百一十六万六六六六】为撱形全积
　　另求撱形全积
　　置短径【七百】自乗得【四十九万】以长径【一千四百】乗之得【六亿八千六百万】以十一因之二十一除之得【三亿五千九百三十三万三三三】为真撱圎全积
　　以真撱圎积与两截形并相较其差为九十分之一而弱
　　若用厯书法　求得截小分【二千三百六十八万七千五百尺】与小圎角同
　　截大分【六亿○六百三十七万五千】为大圎角之六倍
　　相并得【六亿四千○○六万二千五百尺】为撱圎全积　与撱圎真积相较其差更甚
　　如是辗转推求则知撱体大截分不可算今别立法凡撱体皆先如法求其全积再如法求其小分截积以小分截积减全积余为大分截积此法无可存















　　厯算全书卷五十六
　　几何补编自序
　　天学初函内有几何原本六卷止于测面其七卷以后未经译出葢利氏既歾徐李云亡遂无有任此者耳然厯书中往往有杂引之处读者或未之详也壬申春月偶见馆童屈为灯诧其为有法之形【其制以六圈成一灯每圈匀为六折并周天六十度之通故知其为有法之形而可以求其比例然测量诸书皆未言及】乃覆取测量全义量体诸率实攷其作法根源【法皆自楞剖至心即皆成锥体以求其分积则总积可知】以补原书之未备而原书二十等面体之算向固疑其有误者今乃徴其实数【测量全义设二十等面体之边一百则其容积五十二万三八○九今以法求之得容积二百一十八万一八二八相差四倍】又几何原本理分中末线亦得其用法【几何原本理分中末线但有求作之法而莫知所用今依法求得十二等面及二十等面之体积因得其各体中棱线及辏心对角诸线之比例乂两体互相容及两体与立方立圆诸体相容各比例并以理分中末线为法乃知此线原非徒设】则西人之术固了不异人意也爰命之曰几何补编


　　钦定四库全书
　　厯算全书卷五十七
　　宣城梅文鼎撰
　　防何补编卷一
　　四等面形算法
　　先算平三角形平三角形
　　三边同者求中得中长线
　　【乙甲】其三之一即内容平圆
　　半径【心甲】其三之二即外切
　　圆之半径【乙心或心丙】


　　又法以边半之【丙甲】自乘得数【丙庚方】取其三之一开方【甲壬小方】得容圆之半径【壬癸或甲癸俱与心甲等】又取自乘数【丙庚方】三分加一【丙庚方加壬甲小方】并而开方得外切圆之半径【丙心】
　　论曰三边角等则半边之角六十度【丙心甲角】其余角三十度【心丙甲角】内容圆半径为三十度之正【心甲】外切圆半径如全数【丙心】其比例为一与二故内容圆半径【心甲】正得外切圆半径【丙心】之半也【此论可解前一条】
　　形内丙心甲与乙心丁两小句股形相等又并与乙甲丙大句股形相似【何则乙角丙角并分原等角之半丁甲等为正角则三角皆等而边之比例等】而大形之句【丙甲】旣为其【乙丙】之半则小形之句【心丁亦即心甲】自必各为其【心乙亦即心丙】之半故知心甲【原同心丁】为乙甲之半也
　　心甲旣为心丙之半则心甲一心丙必二而丙戊必三矣【乙甲同】何也以乙心与丙心同为二心甲与心戊同为一也联心乙二与心甲一岂不成三
　　今以内圆半径为股【心甲】外圆半径为【心丙】三边之半为句【丙甲】成心甲丙句股形则心丙自乘内【幂】有心甲【股幂】及甲丙【句幂】两自乘之积也而心甲股与心丙旣为一与二之比例则心甲之幂一心丙之幂必四也以心甲股幂一减心丙幂四其余积三即丙甲句幂矣故心甲之幂一则丙甲之幂三心丙之幂四今先得边故以丙甲三为主而取其三之一为心甲股幂又于丙甲三加三之一为四即成心丙幂也【此论可解后一条】
　　以上俱明三等边平面之比例
　　今作四面等体求其心
　　法自乙顶向子向甲剖切之成乙子甲三角面
　　心者面之心中者体之心
　　前图所谓心者面之心也今
　　所求者体之心即后图所谓
　　中也故必以剖而后见
　　次求甲丑线
　　乙子边平分于丑从丑向甲
　　得垂线此丑甲垂线在体中
　　必小于乙甲在外之垂线故
　　乙甲如丑甲如股乙丑如句也法以甲乙自乘内减乙丑句幂余为股幂开方得丑甲
　　又法凖前论乙丑之幂三【即丙甲皆半边故】则乙甲之幂九【乙甲三倍大于心甲故心甲幂一则乙甲幂九】以三减九余六亦即甲丑股幂矣以开方得甲丑
　　捷法倍原半边【甲丙】自乘数以开方得【甲乙】中垂线　或半原边【丙己】自乘之数开方亦得【甲丑】　丙甲之幂三【乙丑同】则甲丑之幂六而丙己之幂十二也【甲丑与丙己幂积之比例为一与二】次求心中线
　　捷法但半心甲自乘即心中幂
　　论曰心甲与心中犹甲丑与乙丑也甲丑幂与乙丑幂为六与三则心甲与心中之幂亦如二与一
　　又捷法心中之幂一心甲之幂二则乙丑之幂六【即丙甲】而心丙之幂八【亦即乙心】俱倍数
　　但以半边【乙丑或丙甲】之幂取六之一即心中幂开方得心中即四等面形内容小浑圆之半径也【心中线者即各面之心至体心也故为内容小浑圆半径】
　　以心中之幂一【句】加乙心之幂八【股】并之为幂九开方得中乙【或中子或用前总图则为甲丙为甲己并同】是即四等面形外切浑圆之半径也外切圆之幂九【中乙】内切圆之幂一【心中】得其根之比例为三与一故四等面形内容浑圆之径一则其外切浑圆之径三又捷法但以乙丑半边之幂加五【即二之一】为中乙【或中子等】幂开方得外切圆之半径【葢乙丑之幂六中乙之幂九其比例为一有半也】
　　此四边不等形【又为三角立锥形】为
　　四等面形四之一各自中切
　　至边线成此形其底三边等
　　即四等面形之一面其髙为中心即内容小浑圆之半径其中乙等三楞线三倍大于中心之髙即外切浑圆之半径
　　取四等面形全积捷法
　　先取面幂【即前图乙己丙平面依前比例求其幂】以内容圆半径【心中】乘之得数四因三归见积
　　法曰丙甲半边之幂三则甲乙中长之幂九开方得中长【乙甲】以乘丙甲得乙己丙三等边之幂积即四等面形之一面也
　　次求本积四之一【即各面辏心剖裂之形如右图】
　　丙申半边之幂六则中心之幂一开方得中心髙以乗所得面幂而三分取其一即为四等面形四之一于是四乗之即为全积也
　　又防法以丙甲乗心甲又以中心乗之即得本形四之一【即同三除以心甲为乙甲三之一故也】
　　此带纵小立方形与右图四等面形四之一等积
　　又防法以丙己全边【亦即丙乙】乗
　　乙心再以中心乗即得本形
　　全积【乙心为心甲之倍数丙己为丙甲之倍数用以】
　　【相乗则得丙甲乗心甲之四倍数也】
　　边设一百
　　依上法求容
　　丙己边一百其幂一万丙甲半边五
　　十其幂二千五百三因之得七千五百
　　为乙甲中垂之幂【丙甲股幂减丙己幂得句幂也丙己亦即丙乙】　平方开之得八十六【六○二五】为乙甲其三之一得二十八【八六七五】为心甲　其三之二得五十七【七三五○】为心乙　又置丙甲幂二千五百取六之一为心中幂得四百一十六六六不尽　开方得心中之髙二十零四一二四亦即内容浑圆之半径
　　依上法以丙己全边一百乘乙心五十七【七三五○】得五千七百七十三半　又以心中二十零【四一二四】乘之得全积一十一万七千八百五十一弱【与厯书微不同】
　　四等面体求心捷法
　　准前论心中幂一则心甲幂
　　二中乙幂九乙丑幂六以句
　　股法考之则中甲与中丑之幂俱三也
　　何也心中甲句股形以中甲为故心中句幂一心甲股幂二并之为中甲幂三也而乙中丑句股形以中丑为句故乙中幂九内减乙丑股幂六其余为中丑句幂亦三也
　　由是徴之则中丑与中甲正相等但如法求得甲丑线折半得中防即为体心
　　又捷法取乙丑幂【即原设边折半自乗】半之为中丑幂开方得中丑亦得甲中【或乙子全边自乘取八之一为甲中幂亦同】
　　中丑即原边乙子距体心之度甲中即原边丙己距体心之度而中为体心
　　想甲防在丙己边折半之处今从侧立观之则线化为防
　　而丙己与甲成一防故从丙
　　己原边依楞直剖至乙子对
　　边即成甲丑线其线即所剖
　　面之侧立形

　　此图即前图甲丑线所切之
　　面葢面侧视则成线矣

　　原设四等面全形今依子丑
　　乙楞剖至甲则成纵剖图故
　　甲防内有丙己线若依丙甲
　　己楞剖至丑则成横剖图故
　　丑防内有子乙也
　　纵剖有三依子乙楞剖至甲而平分丙己边于甲一也依丙乙楞剖而平分子巳边二也依己乙楞剖而平分子丙边三也
　　横剖亦三依丙己楞剖至丑而平分子乙边于丑一也依子丙边剖而平分乙己边二也依子巳楞边剖而平分丙乙边三也其所剖之面并相似皆以中防为三对角垂线相交之心
　　一率　一一七八五一　　　例容
　　二率　一○○○○○○　　例边之立方积
　　三率　一○○○○○○　　设容
　　四率　八四八五二九○　　设边之立方积
　　开方得根二百○四弱为公积一百万之四等面体楞与比例规解合
　　若商四数则其平廉积四十八万长廉积九千六百其隅积六十四共得四十八万九千六百六十四不足四千三百七十四为少百分之一弱故比例规解竟取整数也
　　计开
　　四等面诸数
　　边一百
　　积一十一万七八五一
　　积一百万
　　边二百○三九六
　　内容浑圆半径二十○【四一二四】
　　内容浑圆全径四十○【八二四八】
　　外切浑圆半径六十一【二一○○】
　　外切浑圆全径一百念二【四二○○】
　　互剖求心之图
　　设边一百其幂一万【丙己乙子乙丙
　　乙己子丙子己并同为外切浑圆径幂三之二】半边五十其幂二千五百【丙甲
　　甲己乙丑丑子等并同为边幂四之一】
　　斜垂线之幂七千五百【乙心甲子
　　角甲丙亢丑己氐丑并同为边幂四之三】
　　其根八十六六○二五
　　斜垂线三之一二十八八六
　　七五其幂八百三十三三三
　　【即外切浑圆径幂十八之一为边幂十二之一】即各
　　面内容平圆半径【心甲角甲亢丑氐丑并同】
　　斜垂线三之二五十七七三五○其幂三千三百三十三三三【乙心子角丙亢己氐并同】
　　内容浑圆半径二十○四一二四其幂四百一十六六六不尽【为边幂二十四之一即外切浑圆三十六之一】即分体中髙【心中角中亢中氐中并同】　若内圆全径之幂则一千六百六十六六六【为边幂六之一外切浑圆径幂九之一】
　　外切浑圆半径六十一二三七二其幂三千七百五十即分体之立面楞【乙中子中丙中己中并同】四因之为浑圆全径幂一万五千其径一百二十二四七四四
　　又外切正相容之立方其幂五千为四等面边幂之半即斜方之比例又为外切浑圆径幂三之一
　　一率　外切浑圆径一百二十二四七四四
　　二率　四等面之边一百
　　三率　浑圆径一百
　　四率　内容四等面边八十一六四九六
　　又捷法浑圆径幂一万五千则内容四等面边幂一万或内容立方面之斜亦同为浑圆径幂三之二
　　若设浑圆径一百其幂一万则内容四等面边之幂六千六百六十六六六亦三之二也
　　平方开之得八十一六四九六为四等面边即内容立方之斜内容立方面幂三千三百三十三三三为浑圆径幂三之一即方斜之半幂亦即四等面边幂之半平方开之得五十七七三五○是为浑圆径一百内容立方之边亦即浑圆内容立方立方又容小圆之径若于四等面内又容浑圆则其径幂一千一百一十一一一为浑圆径幂九之一为四等面幂六之一立方面幂三之一
　　开得平方根三十三三三不尽【幂九之一则其根必三之一也】为内容小浑圆之径以径乗幂得三万七千○三十七为径上立方积　以十一乗十四除得二万九千一百○○半为圆柱积　柱积取三之二得一万九千四百为小浑圆积得大浑圆二十七之一　以小浑圆积二十七因之得五十二万三千九百为四等面外切大浑圆积【即径一百之浑圆积也】
　　互剖求心法
　　凡四等面体任以一尖为顶则其垂线为自尖至相对之平面心【亦即平面容圆之心】而以余三尖为底其垂线至底之防旁距三尖皆等【即乙心丙心己心三线之距心皆等而以子尖为顶其垂线为子中心其底为乙丙己平三角面余仿此】此为正形【各尖皆可为顶其法并同】若以子中心垂线为轴而旋之则成圆角体
　　凡四等面体任平分一边而平分之防为顶以作垂线则其垂线自此防至对边之平分防而以对边为底底无面但有边底边与顶边相午直正如十字形假如以子乙边平分于丑以线缀而悬之则其垂线至所对丙己边之平分正中为甲防其线为丑中甲而子乙边衡扵上则丙己边纵于下正如十字无左右之欹亦无髙下之微差也
　　若以丑中甲垂线为轴旋之则成圆柱体
　　凡四等面体以其边为斜线而求其方以作立方则此立方能容四等面体
　　何以知之曰准前论以一边衡于上而为立方上一面之斜则其相对之一边必纵于下而为立方底面之斜
　　矣又此二边之势旣如十字
　　相午直而又分于上下为立
　　方上下两面之斜线然则自
　　上面之各一端向底面之各一端联为直线即为四等面之余四边亦即立方余四面之斜如此则四等面之六边各为立方形六面之斜线而为正相容之体如前所论圆角体圆柱体虽亦能容四等面形而垂线皆小于圆径故不得为正相容
　　捷法四等面之边自乘折半开方即正相容之立方根【即倍句股意】设边一百其幂一万折半五千即为立方一面之积求其立方根得七十○七一○六即丑中甲垂线之髙
　　若以此作容四等面之圆柱则其髙七十○七一○六同立方之方根而其圆径一百同立方面之斜此圆柱内可函立方
　　其乙中子中等为自四等面体心至各角之线又为立方心至各角之线又为外切浑圆之半径又为四等面分为四体之楞线又为立方分为六方锥之楞线又捷法以四等面之边幂加二分之一开方即外切正相容之浑圆径亦即立方体内对角线【如自乙至震】折半为自心至角线　四等面设边一百其幂一万用捷法二分加一得一万五千为外切正相容之浑圆全径幂开方得一百二十二四七四四为浑圆全径折半得六十一二三七二为浑圆半径
　　立方内容四等面图
　　设立方边一百其积百万内
　　容四等面边一百四十一【四二
　　一三】其积三十三万三千三百
　　三十三【三三三三】为立方积三之
　　一乾坤震防立方【干丙坤己乙防子震与中心之丑甲同髙】内容子乙丙己四等面为立方积三之一
　　何以明之凡锥体为同底同髙之柱体三之一今自立方之乙角依斜线剖至丙巳成乙丙巳防三角锥以丙巳防立方之半底为底又自子角斜剖至丙巳成子丙巳震锥以丙巳震立方之半底为底合丙半底则与立方同底矣而子震与乙防之髙即立方髙也是此二锥得立方三之一矣
　　又自子乙斜线斜剖至巳角成倒锥以子乙坤立方之半顶为底以坤巳立方髙为髙又自子乙斜剖至丙角亦成倒卓之锥以子乙干立方之半顶为底以干丙立方髙为髙与前二锥同亦三之一也
　　合此二锥共得立方三之二则其余为子乙丙巳四等面体者必立方三之一矣
　　准此论之凡同边之八等面积四倍大于四等面积何以知之以此所剖之四锥体合之则为八等面之半体皆以剖处为面而其边其面皆与四等面等是同边之体也而八等面之半体旣倍大于四等面则其全体必四倍之矣
　　设八等面边一百四十一【四二一三】与四等面同边则八等面之积一百三十三万三千三百三十三【三三不尽】为四等面之四倍
　　若设四等面边一百则其外切之立方面幂五十立方根七十○【七一○六】以根乘幂得立方积三十五万三千五百五十三四等面积一十一万七千八百五十一为立方积三之一
　　推得八等面边一百其积四十七万一千四百○四此同边之比例
　　若立方内容之八等面则其积为立方内容之四等面二之一何以知之八等面与立方同髙则其积为立方六之一故也
　　设立方边一百内容八等面边七十○【七一○六】其积一十六万六千六百六十六为四等面之半若设立方边七十○【七一○六】则内容八等面积五万八千九百二十五半其边五十
　　四等面体又容小立方小立
　　方内又容小四等面体则内
　　容小立方径为外切立方三
　　之一内小四等面在小立方
　　内其径亦为四等面三之一
　　而其积皆二十七之一
　　何以知之凡三等边平面之心皆居垂线三之一假如子巳丙为四等面之一面其平面之心必在癸而子甲垂线分三之一为癸甲其余三面尽同而内容之小立方必以其下方之两角纵切子巳丙之癸心及乙己丙之壬心其上方之两防必横切于子乙己之卯心及子乙丙之申心而立方内容之小四等面亦必以其四角同切此四防也今壬癸两防旣下距丙己线为其各斜垂线三之一而卯申两防又上距子乙线之斜垂线亦三之一则其中所余三之一必为立方所居也而内小立方不得不为子乙与丙己相距线三之一矣
　　问癸防为三之一者斜面之垂线也小立方者直立线也何以得同为三之一乎答曰癸防所居三之一虽在斜面而子乙纵线与丙己横线上下相距必有垂线直立于其心此直立垂线即前图之甲丑与外切立方线同髙者也丑甲中垂线以上停三之一之上防与卯申平对以下停三之一之下防与壬癸平对依句股法与股比例同也然则丑甲线之中停即小立方之所居矣
　　又丑甲者即外切立方之髙也故知小立方径为外切立方径三之一
　　又小四等面在小立方内以其边为小立方之斜而纵横边相午对如十字其中心亦以丑甲线之中停为其轴其斜面之势一切皆与大四等面同而丑甲者亦大四等面之轴也小四等面之中轴旣为丑甲三之一其余一切皆三之一矣
　　夫体积生于边者也边为三之一者面必为九之一体必为二十七之一无疑也
　　准此论之浑圆在四等面内者亦必为外切浑圆二十七之一其径亦三之一也何也浑圆之切防与小立方小四等面之切防并同也
　　以此推知小立方与小四等面在大四等面内或居小浑圆内以居大四等面内其径积并同
　　求体积
　　浑圆径一百其径上立方一百万依立圆法以十一乘十四除得七十八万五千七百一十四为圆柱积仍三分取二得五十二万三千八百○九为浑圆积
　　内容立方面幂三千三百三十三【三三】其边五十七【七三五○】以边为髙乘面得一十九万二千四百五十○为内容立方积
　　内容四等面体边幂六千六百六十六【六六】其边八十一【六四九六】
　　依前论四等面体为立方三之一得六万四千一百五十○为四等面积
　　立方内容小浑圆以立方之边为径五十七【七三五○】依立圆法以立方积十一乘十四除得一十五万一千二百一十为圆柱积取三之二得一十○万○八百六十六为小立圆积
　　四等面内容小浑圆径幂一千一百一十一【一一】其径三十三【三三】以径乘幂得径上立方积三万七千○三十七以十一乘十四除得二万九千一百○半为圆柱积又三分取一得一万九千四百为立方内之四等面内容小浑圆积为大浑圆积二十七之一若先有内小浑圆积但以二十七因之得大浑圆积
　　依此论之凡浑圆内容立方立方内又容四等面体四等面内又容小浑圆其内外相似之大小二体皆二十七之比例也
　　又捷法用方斜比例
　　立方面之斜设一百其幂一万则其方幂五千用三
　　因之得一万五千开方得立
　　方对角斜线即为外切浑圆
　　全径

　　立方面之斜一百即立方内容四等面之边
　　立方体对角斜线一百二十二【四七四四】即立方外切浑圆之全径亦即四等面外切浑圆全径半之得六十一【二三七三】即立方外切浑圆半径亦即立方体心至各角之线亦即四等面体心至各角之线
　　八等面形图注
　　第一合形
　　甲丁　甲丙　甲己　甲戊
　　丁丙　丙己　己戊　戊丁
　　戊乙　己乙　丁乙　丙乙
　　以上形外之楞凡十有二即根
　　数也其长皆等
　　或设一百为一楞之数则十二楞皆一百也
　　甲丁戊　甲戊己　甲己丙　甲丙丁　丙丁乙己丙乙　戊己乙　丁戊乙
　　以上形周之分面凡八皆等边平三角形也其容积其边皆等
　　或设一百为边数则三边皆一百而形周之分面八皆三边边皆一百也
　　第二横切形【二】
　　甲丁丙己戊为上半俯形
　　丁丙己戊乙为下半仰形
　　右二形各得合形之半皆从
　　丁戊楞横剖至己丙
　　一俯一仰皆方锥扁形丁丙
　　己戊为方锥之底其边皆等
　　其从四角凑至顶之楞皆与
　　底之边等
　　第三直切形【四】
　　从甲尖依前后楞直剖过丁
　　己至乙尖成左右两形
　　从甲尖依左右楞直剖过丙
　　戊至乙尖成前后两形
　　此四形者一切皆与仰俯二
　　形同但彼为眠坐之体故为
　　方锥【仰者即倒卓方锥】而此则立体即如打倒方锥之形也第四横切之面一直切之面二
　　因横剖得正方平面在立方锥以此
　　为底倒方锥以此为面在合形则为
　　腰围其己丁及丙戊两对角斜线相
　　交于心即两直切之界也【心即合形中心】因直剖得斜立方面二其己丁及戊
　　丙横对角线即横切之界其从甲至
　　乙垂线即直剖之界如立面在前后
　　互剖之形则此线为左右直剖之界
　　彼此互为之也亦即为全形之中髙
　　径线
　　以此知八等面之中髙线为方斜之
　　比例


　　第五分形
　　因横剖及两直剖分总形为八皆
　　三角锥形也
　　皆以等边平三角形面为锥形之
　　底而以横直剖线相交处之点为
　　其锐顶即合形之中心也
　　其自顶心至角之楞皆等皆边线
　　之方斜比例也【底线为方则此线为其斜之半】而
　　此楞线又即为八等面形之外切
　　圆之半径


　　设己戊边一百其幂一万则心戊
　　楞之幂五千【倍戊庚半边之幂为半斜幂也】戊心之幂五千内减戊庚幂二千
　　五百则其余二千五百为心庚之
　　幂故心庚必与戊庚等
　　从心顶对己庚楞直剖至庚分形为两则其中剖处成三角平面
　　己庚者乙己戊等边三角平面之
　　中垂线也其幂为边四之三设边
　　一百之幂一万则己庚之幂七千
　　五百
　　庚辛者平面三角容圆之半径也得己庚三之一其幂则九之一也己庚之幂七千五百则庚辛之幂八百三十三【三三】辛防即各三角平面之中心
　　以庚辛幂八百三十三【三三】减心庚幂二千五百得心辛幂一千六百六十六开方为心辛即分形之中髙也求得分形中髙四十○【八二四七】
　　依平面三等边法设边一百其中长线八十六【六○二五】其幂积得四千三百三十○【一二五○】　取平幂三之一得一千四百四十三【三七五○】以乘中髙得分形积五万八千九百二十五【三五一三】　再以八因之得总积四十七万一千四百○二【八一○四】与总算合
　　设八等面之边一百其幂一○○○○即横剖中腰之正方　半之为每角辏心之线之幂得○五○○○此线即分形自底角辏顶心之楞【如心戊心己心乙】又为八等面形外切浑圆之半径　又半之为分形每面自顶至边斜垂线之幂【即心庚】得○二五○○此线即设边之半其幂为设边四之一
　　设半边之幂取其三之二为分形中髙线之幂【即心辛】得○一六六六不尽又为八等面形内容浑圆之半径防法取八等面设边之幂六而一为八分体中髙之幂开方得中髙
　　假如设边一百其幂一万则分体中髙之幂一千六百六十六不尽　求其根得四十○【八二四八】　以中髙乘三角平面幂三除之得分体八因之得全积
　　又捷法八等面设边之幂取三之二为体内容浑圆之径幂开方得内容浑圆径折半为八分体中髙
　　假如设边一百其幂一万则内容浑圆之径幂六千六百六十六不尽　求其根得八十一【六四九六】　折半为分体中髙
　　或竟以内容浑圆全径乘设面三角平幂四因三除之得全积
　　又捷法　此方斜之比例
　　八等面设边之幂倍之为体外切圆径幂开方得径以乘设边之幂【即腰广平方】得数三归见积
　　假如设边一百其幂一万其斜如之幂倍方幂得二万求其根得一百四十一【四二一三】　以乘腰广一万得一百四十一万四千二百一十三　三除之得总积四十七万一千四百○四
　　一系　八等面体之边上幂与其外切浑圆之径上幂
　　其比例为一与二【方斜比例】
　　一系　八等面体之边上幂与其内容浑圆之径上幂
　　其比例为三与二
　　一系　八等面体外切浑圆之径上幂与其内容浑圆之径上幂　其比例为三与一
　　准此而知八等面内容浑圆浑圆内又容八等面其浑圆外切之八等面边或径上幂与内容之八等面边或径上幂其比例亦必为三与一也
　　计开
　　八等面形诸数
　　设边一百　其积四十七万一四○四【与厯书所差甚微】其体外切浑圆之径一百四十一【内外两浑圆之径幂为三与一其根约为四与七而强】体内容浑圆之八十一
　　八等面外切立方径一百四十一【方斜比例也与外切浑圆同】八等面内容立方径四十七
　　内外切大小立方之径之比例为三与一
　　内外两立方之积之比例为二十七与一
　　若浑圆内容立方立方内容八等面体八等面体内又容浑圆则大小两浑圆之径亦若三与一其积亦若二十七与一
　　一率　　四七一四○四　　例容
　　二率　　一○○○○○○　例边之立方
　　三率　　一○○○○○○　设积
　　四率　　二一二一三二二　设边之立积
　　开立方得根一百二十八为公积一百万之八等面根【与比例规解合】

　　防何补编卷二
　　二十等面形自腰切之成十等边平面
　　先求甲丁　乃十等边平面
　　从心对角之线　亦即二十
　　分形各三角立体一面之中
　　垂斜线
　　法为甲乙【即切形十等边之半在原设二十等面形边为四之一】与甲丁若十八度之正与全数也【十等边各三十六度其半十八度】
　　设边一百　所切十等边平面之边五十　其半甲乙二十五
　　一率　十八度正　○三○九○
　　二率　全数　　　　一○○○○
　　三率　甲乙　　　　　　　二五
　　四率　甲丁　　　　　　　八○【九○六一】
　　用等边三角求容圆法
　　设边一百　其内容圆半径二十八【八六七五】为心甲
　　以心甲为句二十八【八六七五】其幂八百三十三【三三二五】以甲丁为八十○【九○六一】其幂六千五百四十五【七九七○】
　　句幂减幂余五千七百一十二【四六四五】为心丁股幂开方得心丁七十五【五八○八】　此即各面切形自各面之心至切体尖之髙也　其切体之尖即原设二十等面总形之体心为丁点
　　用后法得乙己丙平面幂积四千三百三十○【一二五○】又依三等边角形设边一百【丙己】　其半五十【丙甲】　求到乙甲中长八十六【六○二五】用其三之一即心甲二十八【八六七五】以与丙甲五十相乘得一千四百四十三【三七五○】为各等面平积三之一【三因之得平面幂】
　　又以丁心七十五【五八○八】乘之得一十○万九千○九十一【四三七二】为二十等面形分切每面至心之积又以二十乘之得全积
　　依上法求到二十等面全积
　　设边一百　其积二百一十八万一千八百二十八【查比例规解差不多惟测量全义差逺】
　　按此法以本形分为二十各成三角立锥形而各以分形之髙乘底取三之一以为分形积然后以等面二十为法乘而并之得总积可谓的确不易矣然与厯书中比例规解及测量全义俱不合何耶
　　计开
　　二十等面形
　　设边一百　其每面中长线八十六【六○二五】
　　其每面幂积四千三百三十○【一二五○】
　　其每面容平圆之心作线至形心之丁七十五【五八○八】即心丁　心丁即内容浑圆之半径
　　其分形各以每面之幂积为底心丁为髙各得三角立锥积一十万九千○九十一【四三七二】
　　其立锥积凡二十合之得总积二百一十八万一千八百二十八
　　用上法求形内容浑圆
　　其心丁七十五【五八○八】即内容浑圆半径【以心丁线与各平面作垂线而丁防即体心故】倍之得一百五十一【一六一六】为内容浑圆全径置小浑圆径一百五十一零自乘得二万二千八百○一以十一乘十四除得一万七千九百一十五为圆幂置内容浑圆之平圆幂一七九一五以圆径一百五十一取三之二得一百强以乘平圆幂得一百八十○万二千二百四十九为二十等面内容浑圆之积
　　置内容圆径一百五十一自乘得【二万二千八百○一】再乘【三百四十四万二千九百五十一】以立员捷法【○五二三五九八七七】乘之得浑圆积一百八十○万二千七百二十五
　　先用宻率【十四除十一乘】得浑圆一百八十万二千二百四十九以较立圆捷法所得少尾数四百七十六约为一万
　　八千之五弱不足为差也
　　依立圆法以圆率三一四一五九二乘立圆法六而一得五十二万三五九八为径一百之浑圆积
　　依法求得立方边五十七【七三五○】立方积一十九万二四五○四等面积六万四千一百五十○并合前算小浑积一○○七六六　若用捷法以浑圆率五二三五九八乘立方积得数后去末六位亦得一十○万○七六六
　　内容浑圆尚且如此之大况二十等面之形又大于内圆乎然则厯书之率其非确数明矣
　　二十等面
　　一率　　二一八一八二八　　例容
　　二率　　一○○○○○○　　例根一百之体积三率　　一○○○○○○　　设容
　　四率　　○四五八三三二　　所求根立积
　　如法算得二十等面之容一百万其根七十七
　　比例规解作七十六尚差不多测量全义云二十等边设一百其容五二三八○九则大相悬絶矣乆知其误今乃得其确算己未年所定之率以两书酌而为之究竟不是今乃得之可见学问必欲求根也
　　二十等面分体之图
　　亥子戌为二十等面之一面
　　亦即各分体之底
　　亥子子戍戍亥皆其边即根
　　也半之为亥甲
　　甲乙丙为横边切处即横切成十等边形之一边丁为体心亦即切十等边平面之中心
　　甲乙丙丁即横切十等边平面之分形　心为二十等面每面之正中　心丁为体周各平面至体心之垂线亦即分体之中髙亦即体内容浑圆之半径　丁亥丁子丁戌皆分体之楞线乃自各分面角辏体心之棱也亦即为外切浑圆之半径　丁甲丁丙皆横切平面各角辏心之线亦即分体各斜面之中垂斜线也
　　求法以丁甲为股亥甲为句【即根之半】两幂相并开方得即丁亥也【丁子丁戌同】
　　求二十等面外切浑圆之半径
　　依句股法　以丁甲股八十○【九○六一】自乘幂六千五百四十五【七九七○】　亥甲句五十○自乘幂二千五百　相并为亥丁幂九千○四十五【七九七○】　平方开之得亥丁九十五【一○五二】为外切浑圆半径　亦即二十分形自其各角辏心之棱　倍之得一百九十○【二一○四】即外切浑圆全径
　　计开二十等面体诸数
　　设边一百　其容二百一十八万一千八百二十八其内容浑圆径一百五十一　其外切浑圆一百九十其每面中心至体心七十五半【即内容浑圆之半径】
　　其每面各角至体心九十五【即外切浑圆之半径】
　　计开二十等面体诸用数
　　设边一百　外切立方之半径八十○【九○一七】为体心至边之半径【即寅中卯中辰中等】
　　倍之为边至边一百六十一【八○三四】即外切立方全径外切浑圆之半径九十五【一○五六】为体心至各角尖之半径【即甲中戊中心中等】
　　倍之为角尖至角尖一百九十○【二一一二】即外切浑圆全径
　　内容浑圆及内容十二等面之半径七十五【五七六一】为体心至各面之半径【即己中庚中等】
　　倍之为内容浑圆全径一百五十一【一五二二】为面至面内容十二等面之边五十三【九三四四】
　　每面之幂四千三百三十○【一二五○】
　　二十等面之幂共八万六千六百○二半
　　分体积一十○万九千○八十四【六五】为二十等面体积二十之一
　　合之得全积二百一十八万一千六百九十三
　　内容小立方之边八十七【二六　以内容立圆径自乘七七　乏幂取三之一开方得之】
　　内容灯体边五十【即原边之半】
　　立方内容二十等边算法
　　亢卯寅房为立方全径一百
　　中寅中卯为半径五十
　　寅卯二点为二十等面边折
　　半之界
　　寅卯线为二十等面边之半
　　中为体之中心　寅中卯角为三十六度
　　中寅半径当理分中末之全数　寅卯即理分中末之大分
　　甲戊戊心心甲皆寅卯之倍数即
　　二十等面之边其数六十一【八○三三九八】
　　甲辰半边三十○【九○一六六九与寅卯同】
　　心辰垂线五十三【五二三三】　半垂线心箕二十六【七六一六】　甲辰幂九百五十四【九一五○】　三因甲辰幂为心辰幂二千八百六十四【七四五○不尽】
　　计开
　　立方径设一百　半径五十
　　理分中末线大分六十一【八○三三九八】即二十等面之边论曰以中寅半径五十求寅卯正得理分中末大分之半而甲戊边原倍于寅卯寅房全径亦倍于寅中是全数与大分皆倍也故径以全数当寅房全径以理分中末之大分当甲戊等二十等边之全边也
　　又立方边设一百【即寅房径】　半之五十【即中寅】
　　内容二十等面之边六十一【八○三三九八即甲戊等】
　　面之中垂线五十三【五二三三即心辰】
　　中垂线之半二十六【七六一六即心箕】
　　面之幂一千六百五十三【九五七八甲戊心面】
　　中垂线三之一得一十七【八四一一即心己】
　　内容立圆半径四十六【七○八六即己中】　全径九十三【四一七二】二十等面全积五十一万五千○二十六【九五九七】
　　约法
　　立方根与所容二十等面之边若全数与理分中末之大分　面幂三之一以乘容圆全径得数十之为全积中垂线三之一心己为句【即平面容员半径】自乘得句幂三百一十八【三○四八四九】以减中寅幂二千五百○○余己中股幂二千一百八十一【六九五一五一】开方得己中根四十六【七○八六】
　　二十等面边设一百用理分中末线求其外切之立方一率　二十等面边六十一【八○三三九八】
　　二率　外切立方一百○○
　　三率　二十等面边一百○○
　　四率　外切立方一百六十一【八○三四】
　　依法求得二十等面边一百其外切立方一百六十一【八○三四】与先所细算合
　　半圆内容正方
　　法以圆径为三率【丙丁】　理分中末之小分为二率【庚辛】理分中末全线加小分为首率【丁辛为全线再加庚辛为小分共得为丁庚总线也】　二三相乘一率除之得四率【丙乙即甲丁】为全径之小
　　分以减全径余【乙丁】乃于乙作
　　正十字线至圆界【如己乙】即以
　　此线自乘作正方【己甲】如所求

　　论曰己乙即丙乙与乙丁之中率而丙乙旣为乙丁全径之小分则己乙即大分也而甲乙亦为大分　甲丁亦为小分矣若自甲作甲戊必与己乙甲乙等而其形正方
　　半浑圆内容立方
　　法以乙甲圆径自乘之幂取其六之一开方得容方根【丙丁方丙戊边】
　　论曰试倍甲丙乙庚半浑圆为全浑圆体亦倍丙丁正方形作丙己长立方形亦必能容矣然则丙己线在长
　　立方形之内为斜线者亦即
　　浑圆之径也【与甲乙径等】
　　试于长立方面作戊己斜
　　则己壬为之句戊壬为之股
　　而戊己幂内有己壬幂与
　　戊壬幂矣
　　而丙己线为则戊己又为
　　股丙戊又为句而丙己自幂内又兼有戊己幂及丙戊幂矣【丙戊亦即己壬】
　　又戊壬为己壬【即丙戊亦即戊癸】之四倍则戊壬股幂内有己壬句幂四合之为戊己幂则戊己幂内有己壬幂五矣
　　而丙己幂内复兼有戊己股幂及丙戊句幂是丙己幂内有丙戊幂六也丙己旣同圆径则取其幂六之一开方必丙戊容方边矣
　　立方内容十二等面其内又容立方【此相容比例】
　　立圆内容十二等面其内又
　　容立方此立方之面幂为外
　　圆径上面幂三之一而立方
　　之各角即同十二等面角以切于立圆之面
　　法以外切浑圆径上幂取三之一为十二等面内小立方幂平方开之得小立方根根乘幂见积
　　又简法以十二等面之面幂求其横剖之大线此线即
　　十二等面内容小方之边
　　如图作甲乙线剖一面为二
　　此线在面中最大即为内小
　　立方根以此自乘而三之即
　　小立方外切浑圆径幂
　　凡立方内容二十等面二十等面内又容浑圆圆内又容小立方此小立方之各角能同浑圆之切点以切于二十等面之平面心
　　法以内容浑圆径之幂取三
　　之一为内小立方之幂平方
　　开之得切点相距即小立方
　　根以根乘幂见积
　　简法取内容浑圆之内小立方边求其理分中末之大分为内容十二等面边
　　又简法如前求得二十等面内容十二等面之一面乃求其横剖之大线即二十等面内容小立方之根　以根自乘而三之即二十等面内容浑圆之径幂　开方得根即内容浑圆径　折半为分体之中髙
　　此二十等面之面作三分之
　　一横剖
　　此十二等面之面在二十等
　　面内
　　此五等面边即前横线所成

　　凡五等边平面其边即七十二度之通横剖大线即一百四十四度之通各折半为正可以径求一率　　三十六度正
　　二率　　七十二度正
　　三率　　五等边之一边
　　四率　　横剖之大线
　　凡十二等面体与二十等面体可互相容而不穷十二等面体有二十尖二十等面体有十二尖其各尖之相距必均其互相容也皆能以其在内之尖切在外各面之中心而徧
　　凡二十等面内容立圆仍可以容二十等面
　　二十等面内容立圆仍可以容十二等面
　　甲心乙　乙心丙　丙心丁
　　丁心戊　戊心甲　皆二十
　　等面之一面其各三边皆等
　　各以庚辛壬癸己为其面之
　　心若内容十二等面体则十二等面之各尖必切于庚辛壬癸己等心点
　　今求内容十二等面之边则必以庚辛等心点聮为直线即成五等边面之边而与十二等面之形相似而可
　　以相容矣
　　法当以边【如甲戊】半之【如甲辰】作
　　对心垂线【如辰心】成心辰甲句
　　股形既得己卯倍之为己庚即内容十二等面之一边二十等面体内容十二等面之图
　　第一图原形如五面扁锥心
　　尖鋭起甲心戊等三等边平
　　面凡五共辏而成一心尖乃
　　二十等面四之一
　　其己庚辛壬癸五点皆三等边平面之中心亦即内容十二等面之棱尖所切故必先求此点
　　简法曰以甲戊边半之于辰作辰心对角斜垂线又以心甲心戊各取三分之二为心子心丑乃聮子丑为线与甲戊边平行与辰心垂线十字交于己点则己点即甲心戊平面之心再从子至午作与边平行线线之半即庚点余三面尽如此作平行线则辛点在午未线壬点在未酉线癸点在酉丑线但半之皆得心矣
　　第二图剖形是五等边平面
　　因前图所作子丑等平行线
　　横剖之去其中髙之尖成子
　　午未酉丑五等邉平面此平
　　面之心点在前图心顶之内
　　惟子丑等邉线是原形所作平行线在体外可见余皆以剖而成乃从各角作线至心如子心等分形为五皆平面三角形而心子等线皆小于子丑邉因子己原邉及子心丑角求得心己垂线及子心对角线
　　第三图正用之形即内容十二等面之一面
　　因前第二图各平分其邉得
　　己庚辛壬癸五点即原形之
　　平面心又聮此点作己庚等
　　直线则成此形以此形为内容十二等面之一面则己庚等五点为十二等面之鋭角而皆切二十等靣之平面心矣
　　求己庚线法因心子对角线及心己垂线子己原半边得己卯倍之为己庚
　　第一图
　　设二十等面边一百　甲戊等五边甲心等五辏顶线并同　则子心六十六【六六】　子丑平行线同　皆为原边三之二　心己斜垂线五十七【七三五○】　为心辰斜垂线三之二
　　以上用第一图乃斜立面也
　　第二图
　　子己半边三十三【三三】　子心对角线五十六【七○九九】己心垂线四十五【八七九二】
　　法为全数与五十四度之割线【一七○一三○】若子己边与子心也子己乘割线以全数十万而一得子心
　　又全数与五十四之切线【一三七六三八】若子己边与己心也子己乘切线以全数十万而一得己心　凡全数除降五位
　　第三图　仍从第二图生
　　己庚等两平面心相距线五十三【五八一六】　其半己卯二十六【七九○八】
　　法为子心对角线与己子半边若己垂线与己卯也倍己卯得己庚
　　求得二十等面边一百　内容十二等面其边五十三【五八一六】
　　防法但用法聮两平面之中心点即为内容十二等面之边　两平面心相聮为直线之图
　　乙心甲及戊心甲两等边平
　　三角面以甲心边为同用之
　　边而甲心隆起如屋之山
　　两平面之中心为己为庚聮
　　为己庚线与甲心为十字然
　　不相切何也甲心既隆起
　　则甲心折半之卯在己庚折
　　半之栁点上其距为卯栁
　　试侧视之则甲心戊面变为
　　戊卯线甲心乙面变为卯乙
　　线而甲卯心线变为卯点己
　　庚点在平面原近甲心点为
　　卯戊卯乙三之一则卯栁之距亦为垂线三之一矣二十等面从腰横剖之图
　　凡二十等面体其面之边皆
　　等而皆斜交故边皆髙于面
　　面之中心如己如庚是距体
　　心最近之处故为内容浑圆
　　及十二等面所切之点也
　　边之两端又髙于其折半之处边所辏为尖如甲如戊如乙如心等是距体心最逺之处故为外切浑圆及外切十二等面之尖也　其各边折半之点如寅如卯其距体心在近逺酌中为外切立方之半径其内切之己庚外切之甲戊乙心等頼寅卯距心之线为用然后可知故其用最要
　　横剖所成之面【十二等面从腰横剖其根亦同】
　　问各边既髙于面而又斜交
　　何以能横切成平面乎曰从
　　右图观之甲戊尖最髙则其
　　所对之乙心等边似平矣而
　　乙心等尖亦髙则其所对之甲戊等边又平一髙一平彼此相制而成相等之距故寅卯等折半之处其距体心皆等联之为线即成相等之线而皆平行也
　　然则何以知其为十等边平面曰准右图上下各五面其腰围亦上下各五面而尖牙相错成十面今各从其半边剖之则必为十边平面无疑也
　　如图奎卯寅十等边平面以中为心
　　中寅中卯皆原体心与其邉
　　折中处相距之半径亦即为
　　外切立方之半径也于前图
　　作外切之奎角卯寅平图则
　　寅卯等即为分圆线乃全圈十分之一当三十六度理分中末线图
　　奎中为全径井中为半径以半
　　径【设五十】为句全径【设一百】为股
　　求其得一百一十一【八○三三】
　　【九八】为井奎　以井为心中为界作圆分如中斗截井奎线于斗则井斗亦半径也　以井斗减井奎其余斗奎即为理分中末线之大分【亦即奎牛】　以奎牛为度作点于倍径之圈周而徧即成十平分圈周之点聮其点为线即成寅卯等十等边故十等边之寅卯等即木圈半径之理分中末大分也　若奎中为半径则井中为半半径亦同
　　奎中全数【半径】设一百　寅卯必六十一【八○三三九八】即半径理分中末之大分【奎牛即奎斗】
　　理分中末线　法以全数一百之幂一万为股幂其半五十之幂二千五百为句幂并得一万二千五百为幂开方求其根得一百一十一【八○三三九八】以半数五十减之得六十一【八○三三九八】为理分中末之大分即三十六度之分圆线也
　　半之为十八度之正三○九○一六九九【八线表作三○九○二】二十等面分体之图
　　甲戊心为二十等面之一面
　　其三边等中为体心
　　甲中戊中心中皆各面之鋭
　　角距体心之线又为体外切
　　浑圆及外切十二等面之半
　　径
　　以甲戊心面为底依甲中戊
　　中心中三线剖至体心中成
　　三角锥体为二十等面体二
　　十之一
　　锥体之底各以其三边半之
　　于寅于辰于卯从此三点作
　　线而体心之中点皆为锥体各立面之斜垂线如辰中即为甲中戊立面之斜垂线寅中为甲中心立面之斜垂线卯中为戊中心立面之斜垂线并同
　　又聮寅卯辰三点为寅卯卯辰辰寅三线成寅卯辰小等边平三角面以此为底依寅中卯中辰中三斜垂线剖至体心之中点成小三角锥体其积为大三角锥四之一其寅卯等边为原边二之一　原设边一百则寅卯五十
　　其己点为三角面之中心【大小并同】　己中即分体之中髙【大小锥体同】是即内容浑圆之半径亦即内容十二等面体各尖距其体中心之半径
　　其辰中卯寅中卯卯中辰皆立三角面皆为横剖成十等边平面之分形故寅卯与寅中之比例若理分中末线之大分与其全数也
　　今求寅中线【即外切立方半径卯中亦同】
　　一率　理分中末之大分　　　　　六十一【八○三三九八】
　　二率　全数　　　　　　　　　　一百
　　三率　寅卯【剖形十等边之一即原边之半】　　　　五十
　　四率　寅中　　　　　　　　　　八十○【九○一七】按寅中线为量体之主线既得此线即可以知余线而此线实生于理分中末线几何原本谓分中末线为用最广盖谓此也
　　次求己中【即内容浑圆及十二等面之半径】
　　甲戊原边设一百半之于寅
　　作寅己垂线至己心【乃平靣心】己寅二十八【八六七五】为句其幂
　　八百三十三【三三三三】　用防法
　　以边幂一万取十二之一得
　　之
　　寅中八十○【九○一七】为其幂
　　六千五百四十五【○八五○】句幂减幂余五千七百一
　　十一【七五一七】开方得股为己中
　　七十五【五七六一】
　　订定寅中线
　　一率　理分中未线大分　六十一【八○三三九八】
　　二率　全数　　　　　　一百
　　三率　寅卯【剖形十等边之一即原边之半】五十
　　四率　寅中【即外切立方之半径】　　八十○【九○一七】
　　订定己中线
　　甲戊边原设一百【半之于寅作寅己线】
　　己寅句二十八【八六七五】　幂八百三十三【三三三三】
　　寅中八十○【九○一七】　幂六千五百四十五【○八五○】己中股幂五千七百一十一【七五一七】　根七十五【五七六一】末求己庚线【两平面心相聮即内容十二等面之边】
　　一率　寅中八十○【九○一七】　为大
　　二率　己中七十五【五七六一】　为大股
　　三率　寅己二十八【八六七五】　为小
　　四率　己星二十六【九六七二】　为小股
　　倍己星得五十三【九三四四】为己庚
　　解曰中寅己大句股形与己寅星小句股形同用寅角则其比例等而为相似之形故也
　　己庚等线相聮成五等边平靣图
　　准前论甲心戊等三角平面
　　合二十面为二十等面体则
　　甲心等边线皆髙于平面而边
　　线之端五相辏即为尖角【如心
　　点】依此推知甲乙丙丁戊点
　　皆必与他线五相辏而成尖角矣
　　其己庚辛壬癸各点为各平面之最中央在体为最平之处故内容之浑圆及内容之十二等面各尖必切此点
　　今依前法求得己庚等点相联为直线则凡五平面相辏为尖必有各中央之点相联为线而皆成五等边平面形矣【此平面形正与心尖相应】　依此推知甲乙丙丁戊各点皆能为尖则其周围相辏之五平面亦必各以其中央之点相联为线而皆成五等边平面形　二十等面体以五边线相辏之尖凡十有二每一尖之周围皆有五平面即皆有中央之点相联而成五等边平面亦十有二如此而内容十二等平面体己成故曰但联己庚二
　　点为线即内容十二等面之边也
　　求甲中线【即外切浑圆及十二等面之半径心中戊中并同】
　　寅甲为原边之半设五十其
　　幂二千五百为句幂
　　寅中为外切立方半径八十
　　○【九○一七】其幂六千五百四十
　　五【○八五○】为股幂并句股幂九千○四十五【○八五○】平方开之得甲中
　　依法求得甲中九十五【一○六五】
　　求体积
　　设边一百其半五十　斜垂线八十六【六○二五】　相乗得面幂四千三百三十○【一二五○】
　　又以己中髙七十五【五七六一】乗面幂得柱积三十二万七千二百五十三【九六○○】
　　三除之得分体积一十○万九千○八十四【六五○○】以二十乗之得全积二百一十八万一千六百九十三十二等面分体之图
　　戊辛庚己壬五等边形即十二等面立体之一面　亦即分体形之底【乃五面立锥形之底】丙为平面心
　　丙丁为平面心至体心之垂线亦即分体形之中髙又为体内切浑圆之半径亦即为内切二十等面之半径丁为全体之中心又为十二分体之上鋭即五等面立锥形之顶
　　戊辛壬庚等皆各面之外周线【即边也】为体之棱亦名之
　　为根
　　自分面之心丙作垂线至边
　　【如癸丙甲丙】分各边为两其分处
　　为癸为甲【即各边折半处】
　　乃自癸至甲聮为癸乙甲线又自此线向丁心平剖之成甲丁癸三角形面各分形俱如此切之成十等边平面形故丁癸丁甲皆分体形自顶鋭至各边之斜垂线在所切之十等边平面形即为自丁心至平面角之线【甲癸等点在各边为折中在切形之平面则对角】
　　又自丁至体周各角之线【如丁辛丁庚丁戊等】在分体即为自底角至顶鋭之棱又为外切浑圆之半径又为外切二十等面之半径
　　先算十二等面之面【即戊辛庚己壬】
　　法为全数与五十四度之切线若甲辛与甲丙也　以甲丙乘甲辛又五乘之得戊辛庚己壬五角面积【甲丙辛角为五等边之半角三十六度其余角甲辛丙必五十四度】
　　次算面上大横线【即甲癸】
　　又全数三十六度之正若甲丙与甲乙也倍甲乙得甲癸
　　次算中髙线【丙丁】
　　法为全数与七十二度之割线若甲乙与甲丁也【因平切十等边为三十六度半之为十八度其余角七十二度即乙甲丁角】
　　乃以甲丁为甲丙为句两幂相减开方得股即丙丁也
　　次算分体之积
　　法以中髙丙丁乘戊辛庚己壬底而取其三之一为分形积
　　末以十二为法乘分形积得总积
　　简法以分形中髙乘底又四乘之即得总积【三归三因对过省用】算甲丙
　　一率　全数　　　　　一○○○○○
　　二率　五十四度切线　一三七六三八【相乗得六八】
　　三率　设根之半【甲辛】　　　　　五○【八一九○○】
　　四率　甲丙　　　　　六八　【以全数除之减五位为畸零】算甲乙
　　法为全数与三十六度之正若甲丙与甲乙也
　　一率　全数　　　　　一○○○○○
　　二率　三十六度正　○五八七七九
　　三率　甲丙　　　　　六八八一九○
　　四率　甲乙　　　　　四○四五一一
　　甲癸为横切十等边平面之一
　　其半为甲乙丁即总形之心
　　亦横切平面之心
　　算甲丁
　　法为全数与十八度之余割若甲乙与甲丁也
　　一率　全数　　　　　一○○○○○
　　二率　七十二度割线　三二三六○七
　　三率　甲乙　　　　　四○四五一一
　　四率　甲丁　　　　　一三○九○二五
　　算丙丁中髙线
　　法以甲丁为　甲丙为句　求得股为丙丁
　　算得丙丁一百一十一【三五二六】为中髙线亦即十二等面形内浑圆之半径
　　算五等邉面幂
　　法以甲丙乘甲辛五十得三千四百四十○九半又五乘之得一万七千二百○四七五为五等边【边各一百】之平幂亦即十二等面分形之底积
　　算总积
　　用简法以底积一七二○四七五四因之得六八九九○以乘中髙得七百六十八万二千二百一十五八七四○为十二等面之积
　　计开十二等面
　　一率　七六八二二一五　　例容
　　二率　一○○○○○○　　例边上立积
　　三率　一○○○○○○　　设容
　　四率　○一三○一七○　　求得设边上立积立方法开之得其根五十
　　与比例规解合与测量全义差四千一百七十四为二百分之一
　　算辛丁【庚丁戊丁并用】　又即为外切浑圆半径
　　法以甲丁股幂【一七一三五】甲辛句幂【○二五○○】并为幂【一九六三五】求得数一百四十○为辛丁即外切圆半径计开
　　十二等面之数
　　设边一百　其容积七百六十八万二二一五
　　内容浑圆径一百二十二　外切浑圆径二百八十防法十二等面边求外切内容之立方及外切之立圆置十二等面边为理分中末之小分求其大分为内容立方边内容立方边自乘而三之开方得外切立圆全径
　　又置十二等面边为理分中末之小分求其全线为外切立方边
　　一率　理分中末之小分【三十八一九六六○一】　理分中末之大分二率　理分中末之大分【六十一八○三三九八】　理分中末之全分三率　十二等面之边
　　四率　内容小立方边　即大横线
　　又
　　一率　理分中末之小分
　　二率　理分中末之全分
　　三率　十二等面之边
　　四率　外切立方边
　　以十二等面边减外切立方边余为内容立方边以内容立方边加十二等面边即外切立方边
　　又防法但以十二等面边加大横线【即小立方边】　即外切立方边
　　立方内容十二等面算法　用理分中末线
　　此五等边面为十二等面之
　　一
　　巳为平面心　中为体心
　　寅卯为戌亥大横线之半【三十】
　　【○九○一六九九】卯中寅中为外切立方半径【五十】　戌亥为面之大横线【六十一八○三三九八】为理分中末之大分亦即内容小立方之根
　　巳寅巳卯俱平面容圆半径
　　巳中为内容立圆半径即分体中髙
　　丑中为外切立圆半径【亥中戌中并同】
　　设立方根一百为径　半径五十为寅中卯中　理分中未大分之半为寅卯【三十○九○一六九九】　又半之为寅子【一十五四五○八四九五】为理分中末大分四之一
　　一率　全数　　　　　　一○○○○○
　　二率　五十四度之割线　一七○一三○
　　三率　寅子　　　　　　【一十五四五○八四九五】
　　四率　寅巳【即卯巳】　　　　二六二八六五
　　求得卯巳为平面中垂线
　　一率　全数　　　　　　一○○○○○
　　二率　三十六度之切线　○七二六五四
　　三率　卯巳　　　　　　二十六二八六五
　　四率　卯丑【即半边】　　　　一十九○九八二
　　倍卯丑得丑亥边三十八【一九六四】即十二等面边乃理分中末大分之大分也以此知大横线与五等边为理分中末之全分与其大分之比例也
　　卯巳句幂【○六九○九八】　卯中幂【二五○○○○】相减为股幂一八○九○二　开方得巳中【四十二五三二五】为内容浑圆半径
　　卯丑句幂【○三六四七四一二四三】　卯中股幂【二五○○】　相并为幂【二八六四七四一二四三】　开方得丑中【五十三五二三二】为外切浑圆半径
　　丑亥巳卯相乘五因二除为面幂以乘巳中而四因之得十二等面积
　　简法
　　十二等面内容小立方【六十一八○三三九八】即理分中末之大分葢戌亥大横线倍大于寅卯故也　大横线即小立方之边
　　以大横线之幂三因之开方得亥中为外切浑圆半径【丑中同】
　　又立方根与所容十二等面边若全数与理分中末之小分
　　约法
　　立方根与其所容十二等面体内小立方之根若全数与理分中末之大分
　　凡立方外切浑圆则径上幂三倍于方幂
　　计开
　　立方设径一百
　　内容十二等面边三十八【一九六六○一】
　　内容小立方边六十一【八○三三九八】
　　外切浑圆径一百○七【○四六六二五】　即丑中亥中倍数外切浑圆半径【五十三五二三三】　即丑中亥中
　　内容浑圆半径四十二【五三二五】　即已中　为分体中髙内容浑圆全径八十三【○六五一】
　　内容二十等面边四十四【七二一一】








　　几何补编卷三
　　十二等面体分图　用理分中末线





　　辛戌亥五等边形为十二等面之一
　　寅卯防为边折半处中为体心
　　卯中为外切立方半径【设五十】
　　卯亢为外切立方全径【设一百】
　　寅卯线与卯中半径若理分中末之大分与其全数也在圆内为三十六度之分圆　辛癸辛戌等俱七十二度之分圆
　　乙巳为半径【己丑同】乙癸为三十六度之通
　　乙已半径与乙癸亦若理分中末一之全数与其大分也故乙已癸三角形与卯中寅相似
　　若取乙丙切线如乙癸之度则丙巳必同亥癸边【即七十二度通】折半于甲则甲乙为十八度正再于寅卯线取子壬如乙甲取壬癸如乙己半径引已子至癸中末乃自卯作线至中与壬癸平行因得寅中与卯中等则寅中卯即为横切之半面
　　一率　全数　　　　　一○○○○○
　　二率　三十六度割线　一二三六○七
　　三率　子寅　　　　　一十五【四五○八四九五】
　　四率　丑寅半边　　　一十九【○九八三】
　　倍丑寅得丑戌三十八【一九六六】与简法合
　　论曰凡十二等面从其半边之防【如寅如卯】聮为线以剖至体之心【中防】则所剖成寅中卯三角形平面必为全圆十之一即寅中卯角必三十六度而中寅或中卯两与寅卯底若理分中末之全分与其大分矣
　　又十二等面在立方形内必以卯中【或寅中】自心至边之线当立方之半径是立方半径与十二等面之寅卯线亦若理分中末之全与其大分也　若设立方半径一百则寅卯必六十一【八○三三九八】如理分中末之大分也今设立方全径一百其半径五十则寅卯亦必三十○【九○一六九九】如大分之半矣　寅卯二防既在【丑戌丑亥】两边之折半则戌亥大横线必倍大于寅卯而与理分中末大分之全相应为六十一【八○三三九八】　此皆设立方半径五十之数也而半径五十其全径必一百故知设径一百则十二等面之大横线必六十一【八○三三九八】而竟同理分中末大分之数也既得此大横线则诸线可以互知
　　试先求边　法为酉戌【半大横线】与丑戌等边若全数与三十
　　六度之余割线也
　　一率　全数　　　　　一○○○○○
　　二率　三十六度割线　一二三六○七
　　三率　酉戌半大横线　三十○【九○一六九九】
　　四率　丑戌全边　　　三十八【一九六六】
　　论曰五等边各自其角作线至心分形为五则各得七十二度角【如丑巳戌等其巳角皆七十二度】其半必三十六度【如寅已丑之巳角得戊已丑之半正三十六度】而丑戌酉与丑巳寅皆句股又同用丑角则戌角与巳角等为三十六度
　　十二等面求积
　　平面中垂线【卯己】二十六【二八六五】
　　边【即丑亥丑戌等】三十八一九【六六】　半边【即丑卯丑寅】一十九【○九八三】一面之平幂二千五百一十○【一三七○】
　　内容浑圆半径四十二【四三二五】　即分体五面立锥之中髙【已中】　中髙三之一一十四【一四四一】
　　分积三万五千四百九十五【八四七三】　其形为五面立锥其体积为十二之一
　　全积四十二万五千九百五十○【一六七六】
　　外切立方根一百　其积一百万
　　外切浑圆径一百○七【○四六六】
　　内容立方根六十一【八○三三九八】
　　外切立方与体内容立方径之比例若理分中末之全分与其大分
　　又若外切立方之外又切十二等面体体外又切大立方则大立方之径与今所算外切立方径亦若理分中末之全分与其大分而外切之十二等面与其内十二等面径亦必若理分中末之全分与其大分也
　　孔林宗云外立方与内立方之径为理分中末线全分与大分之比例是矣若内立方之内又容立圆则小立圆之径与小立方之径同而外浑圆与外立方之径不似未可以前比例齐之
　　若十二等面外切大立方大立方之外又切大立圆大立圆外又切十二等面则大立圆与内容小立圆亦必若理分中末之全分与其大分而外切十二等面与十二等面亦必若理分中末之全分与其大分何则皆外切立方与内容立方之比例也
　　十二等面容二十等面图
　　第一图
　　割十二等面之三平面一尖
　　成此形癸丑丙丑戊丑俱五
　　等边平面皆十二等面之一
　　【已庚辛各为其中心一防】
　　丑为三平面棱所聚之尖　亥丑戌丑乙丑俱平面边各为两平面所同用之棱　中为体心　巳中辛中庚中皆内切浑圆半径亦内容二十等面自尖至体心半径　巳卯庚卯巳寅辛寅辛壬俱平面中垂线　寅卯壬皆平面边折半之防
　　第二图
　　内容二十等面体各自其边
　　剖至心成此分体为内容体
　　二十分之一　辛庚巳三角
　　尖即十二等面之中心原防
　　此防以外俱剖而得甲防与卯防同在卯中线而甲在卯之下丁在寅下辰在壬下俱同
　　第三图
　　自卯防起依卯己卯庚二线
　　剖至体心中成此平面形卯
　　即原边折半处卯中即原体
　　外切立方之半径中即体心
　　已庚即原两平面之中心防今联为【已庚】线即内容二十等面之一边
　　已中庚即内切二十等面分体之立面乃三角锥体之一面　甲中为内切二十等面分体之斜垂线　观第二图可明【第二图角防居剖内三角之中心正对原体之丑尖而在其下故角中为内容分体之正髙而甲中为斜垂线也】
　　今求已庚线【即内容二十等面之边】
　　法于卯中【外切立方半径】内求甲中以相减得卯甲为股用与卯已【原体之面上中垂线】两幂相减开方得句为已甲倍之得巳庚
　　卯已中三角形
　　卯中即外切立方半径设五十为底
　　卯已即原体之平面中垂线二十六【二八六五】
　　巳中即内容浑圆半径亦即
　　内容二十等面分体之斜棱四
　　十二【五三二五】
　　以卯巳巳中两相减为较
　　相并为总以总乘较为实卯中底五十为法除之得亢中二十二【三六○六】以减卯中余二十七【六三九四】为亢卯折半得一十三【八一九七】为卯甲
　　计开
　　立方根设一百其半五十【即卯中】亦为十二等面自体心至边
　　十二等面之平面中垂线【即卯巳】二十六【二八六五】
　　十二等面内容浑圆半径【即已中】四十二【五三二五】亦为内容二十等面自尖角至体心分体以为锥体之棱
　　卯巳已中之较一十六【二四六○】　总六十八【八一九○】
　　较总相乘一千一百一十八【○三三四】为实　卯中五十为法除之得中亢二十二【三六○六】　以中亢减卯中五十余二十七【六三九四】为亢卯折半得一十三【八一九七】为卯甲以卯甲减卯中余三十六【一八○三】为甲中即内容二十等面分体之斜垂线
　　卯巳自乘得六百九十○【九八○○】为幂
　　卯甲自乘得一百九十○【九八
　　四一】为股幂　相减余四百九
　　十九【九九五九】为勾幂　开方得
　　巳甲二十二【三六○五】　倍之得
　　巳庚四十四【七二一一】即为内容二十等面边
　　此法甚确亦且甚防无可疑者偶于枕上又思得一法借灯体分形之三角锥以求十二等面内容二十等面分体之三角锥是以锥体相截而知其所截之
　　边即为内容二十等面之边
　　第一图
　　丑为三平面所聚之尖　丑
　　戌丑亥丑乙皆两平面同用
　　之棱　巳庚辛皆五等边平
　　面之心　己寅己卯等皆平面心至边垂线　已牛丑为平面心对角线　寅卯壬皆平面边折半之防　寅中卯中壬中为体心至边线即外切立方半径　中为心
　　第二图
　　聮寅卯卯壬壬寅三线为平
　　三角面横剖之又各依寅中
　　卯中壬中线剖至体心中则
　　成三角锥体二其一为丑寅
　　卯壬体是三角锥而稍扁者也其一为寅卯壬中体是三角锥而稍长者也其寅卯壬三角平面为扁形之底又为长形之面其寅卯等线与寅中卯中之比例皆若理分中末之大分与其全分也其扁形锥既剖而去则成圆灯所存长锥即灯形分体之一平面心之防为斗在丑尖下与牛防平故丑牛为则斗牛如勾而丑牛之距如股也
　　第三图
　　又于圆灯分体剖去辰甲丁
　　之一截则成甲丁辰中三角
　　锥乃十二等面内容二十等
　　面分体中之分体其辰甲丁面与巳庚辛脗合为一葢巳庚辛者内容二十等面之一面各于边折半为甲丁辰而聮之为线则成小三角于中故辰丁等线皆居巳庚线之半而甲中原为二十等面分体之斜垂线者今则为三角锥之楞
　　第四图
　　己牛丑即原平面从心至角
　　尖之线丑斗角中即原体自
　　尖至中心之线又为外切浑圆半径
　　依第二图截丑巳于牛而横剖之亦截丑中于斗成丑斗牛勾股形　又依第三图截斗中于角成丑角巳勾股形此两勾股相似而比例等
　　法为丑牛与丑斗若丑巳与丑角也
　　第五图
　　寅中卯三角形为圆灯分体
　　之立面截为甲丁中三角形
　　此两形相似而比例等　法为卯中与卯寅若甲中与甲丁也
　　又斗中为圆灯分体之中髙其平面为寅卯壬角中为截体之中髙其平面为丁甲辰此两体相似而线之比例等　法为斗中髙与寅卯濶若角中髙与甲丁濶先求丑斗髙
　　用截去扁三角锥以牛卯【即寅卯之半】自乗幂三分加一以减丑卯幂为丑斗幂开方得丑斗高
　　次求丑角髙
　　用巳丑对角线乗丑斗以丑牛除之得丑角髙　其丑牛线以牛卯幂减丑卯幂开方得丑牛　巳寅丑寅两幂并开方为己丑
　　末求巳庚线
　　用丑角减丑中得角中　又用丑斗减丑中得斗中以角中乘寅卯以斗中除之得甲丁倍甲丁得己庚为内容二十等面之边
　　理分中末线　以量代算
　　先以巳为心作图而匀分其
　　边为五作甲庚乙丙丁五等
　　边平面【即十二等面之一面】
　　乙丁为大横线设一百甲庚
　　等边必六十一【八○三三九八】为大横线理分中末之大分若乙丁大横线设六十一【八○三三九八】则甲庚等边必三十八【一九六六】亦为大横线理分中末之大分
　　设立方一百　内容十二等面边三十八【一九六六】为理分中末之小分亦即大分之大分
　　十二等面内又容小立方其边与十二等面之大横线等六十一【八○三三九八】为大立方边一百与十二等面边三十八【一九六六】之中率何也大立方一百乘十二等面边三十八【一九六六】开方得根即小立方及大横线六十一【八○三三九八】
　　若大横线自乗之幂以十二等面边除之即仍得外立方根而以外立方根除大横线幂必仍得十二等面之边矣
　　求理分中末线防法　用前图
　　作五等边平面　求其大横线【乙丁】　聮两角为线即得之
　　次以大横线之一端【如乙】为心其又一端【如丁】为界作丁戊圆分乃引五等边与圆分相遇【如引乙丙至戊与圆分遇于戊】则相遇处【如戊】至圆心【如乙】为全分【即乙戊亦即乙丁大横线】原边为大分【即乙丙】引出余边为小分【即丙戊】
　　又法
　　作平三角使两角【如戊如丁】俱倍大于一角【如乙】末乃破一倍
　　角平分之作线至一边【如平分丁
　　角为两作丁丙线至乙戊边】则其斜线即
　　为理分中末之大分【即丁丙也】
　　解曰倍破角则与小角等【如破丁角为两皆与乙角等】而乙丙丁形之乙丁两角同大则【乙丙丁丙】两亦同大而乙丙既为大分丁丙亦为大分矣准此又破丙角可以递求于无穷诸体比例
　　凡诸体之比例有三
　　一曰同边之比例可以求积
　　一曰同积之比例可以求边
　　一曰相容之比例可以互知
　　内相容之比例亦有三
　　一曰立圆内容诸体之比例　所容体又容立圆一曰立方内容诸体之比例　所容体又容立方一曰诸体自相容之比例【即同径同髙之比例】或或两体互相容或数体递相容
　　等积之比例　比例规解所用今攷定
　　立方积　　　一○○○○○○　其边一百
　　四等面积　　一○○○○○○　其边二百○四八等面积　　一○○○○○○　其边一百二十八十二等面积　一○○○○○○　其边五十
　　二十等面积　一○○○○○○　其边七十七方灯
　　圆灯
　　凡方灯依楞剖之纵横斜侧皆六等边平面凡圆灯依楞剖之纵横斜侧皆十等边平面故皆有法形体
　　等边之比例　测量全义所用今攷定
　　立方边　　一○○　　　　积一○○○○○○方灯体边　○七○七一○六积○八三三三三三
　　边　一○○　　　　　积二三五七○二一
　　八等面边　○七○七一○六　积○一六六六六六
　　边　一○○　　　　　积○四七一四○四
　　四等面边　一○○　　　　　积○一一七八五一
　　十二等面边一○○　　　　　积七六八二二一五
　　二十等面边一○○　　　　　积二一八一八二二圆灯体边　○三○九○一七　积○二九○九二九
　　边　一○○　　　　　积○九八五九一六
　　等径之比例　　　皆立方所容
　　立方径　　　　一○○积一○○○○○○　边【一○○】内容方灯径　　一○○积○八三三三三三　边【○七○七一○六】内容四等面径　一○○积○三三三三三三　边【一四一四二一三】内容八等面径　一○○积○一六六六六六　边【○七○七一○六】内容立圆径　　一○○积○五二三八○九
　　内容二十等面径一○○积○五一五二二六　边【○六一八○三四】内容十二等面径一○○积○四二五九五○　边【○三八一九六六】内容圆灯径　一○○积○二九○九二九　边【○三○九○一七】右以立方为主而求诸体
　　内立方及灯体之径为自面至面
　　四等面十二等面二十等面之径皆自边至边【以边折半处作垂线至对边折半处形如工字四等面则上下边遥相午错如十字】
　　八等面之径为自尖至尖　然皆以其径之两端正切于立方方面之中心一立方面其相切亦必六求积约法
　　凡立方内容诸体皆与立方之六面同髙同濶　则灯形积为立方积六之五　四等面积为立方积三之一八等面积为立方积六之一　以上三者皆方斜比
　　例
　　灯形及八等面皆以方求斜法以边自乘倍之开方得外切立方径以径再自乘得立方积取六之五为灯六之一为八等面积
　　四等面则以方求其半斜法以边自乘半之开方得外切立方径以径再自乘为立方积取三之一为四等面积
　　立圆在立方内则其积为立方积二十一之十一谨按方圆比例祖率圆径一百一十三圆周三百五十五见郑世子律学新説较径七周二十二之率为宻又今推平圆居平方四百五十二分之三百五十五较十四分之十一为宻又推得立圆居立方六百七十八分之三百五十五较二十一分之十一为宻
　　准立方比例以求各体自相比　皆以同髙同阔同为立方所容者较其积
　　灯内容同髙之八等面　为八等面得灯积五之一又立圆内容同髙之八等面　为八等面得圆积六十六之二十一【即二十二之七】　二者皆同髙而又能相容用课分法母互乘子得之


　　准此而知立圆内容八等面其积之比例若围与径也
　　又立方内容十二等面其内又容八等面　又立方内容二十等面其内又容八等面　二者亦同髙而能相容
　　同髙之四等面积为灯积五之二【即十之四　以灯面四因退位得四等面积】同髙之八等面积为四等面积二之一
　　同髙之四等面积为立圆积十一之七


　　此三者但以同髙同为立方所容而不能自相容若相容则不同髙
　　凡立方之灯形内又容立方则内小立方边与径得外立方三之二体积为二十七之八面幂为九之四凡灯容立方以其边为方而求其斜为外切之立方边取方斜三之二为内立方边
　　立方边一○○　　　　　　面幂一○○○○　　　体积【一○○○○○○】
　　灯边　　○七○七一○六　面幂○五○○　　　　体积【○八三三三三三】小立方边○六六六六六六　面幂○四四四四四四　体积【○二九六二九六】凡方内容圆圆内又容方则内小方之幂得大方三之一防法以小方根倍之为等边三角形之边而求其中垂线即外切立圆之径亦即为外大方之边
　　如图三边既等则乙丙得甲丙之半若乙丙一其幂亦一而甲丙二其幂则四以乙丙句幂一减甲丙幂四所余
　　为甲乙股幂三
　　内方之幂一而外切浑圆之
　　幂三故其根亦如乙丙与甲
　　乙也　或以小立方之根为句倍根为求其股为外切浑圆径亦同【浑圆径即外方边】
　　若以量代算则三角形便
　　如以大方求小方者则以大方为中垂线而作等边三角形其半边即小方根也
　　或用大方为股而作句股形使其句为之半即得之防法句股形使甲角半于丙角则倍于句而句与股如小立方根与大方根
　　或以甲角作三十度而自乙作垂线引之与甲丙线遇于丙则乙丙即圆所容方之根
　　又按先有大方求小方者取大方根倍之为等边三角形之边而求其中垂线以三归之即得
　　凡立方内容方灯灯内又容立圆圆内又容圆灯灯内又容八等面凡四重在内其外切于立方也皆同防【切立方有六处所同者皆在其方面之最中一防若从此一防刺一针则五层悉透内惟方灯以面切面不可言防若言防则有十二皆切在立方边折半处】
　　凡立方内容方灯灯内又容十二等面体体内又容圆灯灯内又容八等面凡四重在内其切于立方也皆同处【凡六处皆在立方面内方灯体以面切面十二等面以边切余皆以尖切尖切者皆每面之最中防】凡立方内容方灯灯内又容二十等面体体内又容圆灯灯内又容八等面同上
　　凡立方方灯立圆十二等面二十等面圆灯内所容之八等面皆同大
　　凡立方内容四等面体体内又容八等面其切立方皆同处【四等面以边切为立方六面之斜八等面以尖切居立方各面中心即四等面边折半处】准此而知立方内所容之八等面与四等面所容之八等面亦同大且同髙各体中所容八等面皆同大因此可知
　　凡立圆内容十二等面体　又容立方其立方之角同十二等面之尖而切于立圆故立圆内所容之立方与十二等面内所容之立方同大
　　凡二十等面体内容立圆　内又容立方立方之角切立圆以切二十等面之面故立圆所容之立方与二十等面内所容之立方必同大
　　凡二十等面体内容立圆　内又容十二等面体体内又容立方此立方之角切十二等面之角以切立圆而切于二十等面之面皆同处
　　凡诸体能相容者其相容之中间皆可容立圆此立圆为外体之内切圆亦为内体之外切圆
　　惟八等面外切二十等面十二等面四等面及圆灯其中间难着立圆何也八等面之切圆灯以尖切尖而其切四等面十二等面二十等面则以尖切边故其中间不能容立圆
　　其他相切之中间能容立圆者皆以内之尖切外之面凡诸体在立方内即不能外切他体惟四等面在立方内能以其角同立方之角切他体故诸体所容四等面之边皆与其所容立方之面为斜线
　　凡诸体相容其在内之体为所容其在外之体为能容能容与所容两体之相切必皆有一定之处
　　凡相容两体之相切或以尖或以边【即体之棱】或以面浑圆在立方内为以面切面其相切处只一防皆在立方每面之中央【立方六面相切凡六防】
　　立方在浑圆内为以尖切面【立方之角有八故相切有八防】有一防不相切者即非正相容也
　　浑圆在诸种体内皆与在立方内同谓其皆以面切诸体之面而切处亦皆一防也然其数不同如四等面则切防有四方灯则切防有六八等面则切防有八十二等面及圆灯则切防有十二二十等面则切防有二十其切防之数皆如其面之数而皆在其面之中央也方灯则以其方面为数圆灯则以其五等边之面为数而不论三角之面者何也三角之面距体心逺故不能内切立圆也
　　诸体在浑圆内皆与立方在浑圆内同谓其皆以各体之尖切浑圆之面也其数亦各不同如四等面则切防亦四方灯则切防十二八等面则切防六十二等面则切防二十二十等面则切防十二圆灯则切防三十皆如其尖之数也
　　四等面在立方内以边棱切立方之面四等面有六棱以切立方之六面皆徧其四尖又皆切于立方之角十二等面二十等面在立方内皆以其边棱切立方之面两种各有三十棱其切立方只有其六以立方只有六面也
　　此三者为以楞切面
　　八等面在立方内以尖切面凡六防　圆灯在立方内亦以尖切面有六防皆在立方面中尖与八等面同方灯在立方内则以面切面皆方面也方灯之方面六亦与立方等也其十二尖又皆切于立方之十二边楞皆在其折半处为防
　　十二等面与二十等面逓相容皆以内体之尖切外体之面
　　十二等面在八等面内以其尖切八等面之面体有二十尖只用其八也
　　方灯在八等面内亦以面切面而皆三角面方灯之三角面有八数相等也又其尖皆切于八等面各棱之中央折半处棱有十二与灯之尖正等也
　　圆灯在十二等面内以面切面皆五等边平面也圆灯体之五等边平面原有十二故也又皆以其尖切十二等面之边楞而皆在其中半
　　圆灯在二十等面内亦以面切面皆三角平面也圆灯体之三角平面原有二十故也又皆以其尖切二十等面之边楞而皆在其中半
　　问十二等面与二十等面体势不同而圆灯之尖皆能切其楞边何也曰圆灯有三十尖而两等面体皆有三十楞故也
　　凡能容之体皆可改为所容之体递相容者亦可递改如立方容圆即可刓方为圆浑圆容方即可削圆为方递相容者如立方内容浑圆圆内又容十二等面体体内又容二十等面即可递改
　　凡所容之体皆可补为能容之体皆以数求之
　　如立方外切立圆以其尖角则求立方心至角之线为立圆半径
　　凡以面切面者其情相通
　　如方灯以其方面切立方面又能以其三角切八等边面则此三者皆方斜之比例也
　　又如圆灯以其五等边面切十二等面又能以其三角面切二十等面则此三者皆理分中末之比例也若反用之而令立方在方灯之内则立方之尖所切者必三角面若八等面在方灯之内则其尖所切又必方面也若令十二等面在圆灯内则所切者必三角面而二十等面居圆灯内所切者又必五等边面也故曰其情相通
　　诸体相容
　　凡立圆立方皆可以容诸体
　　凡立圆内容立方立方内又可容立圆两者不杂他体可以相生而不穷
　　凡立圆内容立方此立方内又可容四等面四等面又可容立圆三者以序进亦可以不穷
　　凡立圆内容立方又容四等面四等面在立方内以其尖切立圆与立方尖所切必同防
　　凡立圆容四等面在立圆所容立方内必以其楞为立方面之斜依此斜线衡转成圆柱形必为立圆之所容而此柱形又能含立方
　　外圆者柱之底若面内方者
　　立方之底若面直而斜者四
　　等面之边
　　凡四等面体在立圆内任以一尖为顶以所对之面为防旋而作圆锥此锥体必为立圆之所容而不能为立方之容
　　此两体虽非正相容体然皆有法之体
　　凡立方内可容八等面八等面又可容立方而相与为不穷
　　凡立方有六等面八尖八等面有八等面六尖故二者相容则所容体之尖皆切于为所容大体之面之中央而等
　　凡立方内容立圆此立圆内仍容八等面其八等面尖切立圆之防即可为切立方之防
　　八等面内容立圆此立圆内仍容立方则立方尖切立圆之防亦即可为其切八等面之防
　　凡立圆可为诸等面体所容其在诸体内必以圆面一防切诸体之各面此一防皆在其各等面之中心而等而徧
　　凡八等面内容立圆仍容立方　立方内仍容四等面而四等面以其角切立方角即可同立方角切立圆以切八等面叠串四体皆一防相切必在八等面各面之中心
　　立方设一百内容二十等面边六十一【八○三三九八】内又容立圆也十三【四一七二】
　　简法取内容立圆径幂三之一开方得内容小立方再以小立方为理分中末之全分而求其大分得内容十二等面边
　　凡十二等面二十等面皆能为立圆之所容皆以其尖切浑圆凡十二等面二十等面皆能容立圆皆以各面之中心一防正与浑圆相切
　　凡十二等面与二十等面可以互相容皆以内体之尖切外体之各面中心一防
　　凡十二等面内容浑圆浑圆内又容二十等面与无浑圆者同径二十等面内容浑圆浑圆内又容十二等面亦与无浑圆同径何也浑圆在各体内皆以其体切于外体各面之中心防而此防即各内体切浑圆之防故也以上皆可以迭串相生而不穷
　　凡十二等面内容浑圆浑圆内又容十二等面亦可以相生不穷
　　二十等面与浑圆递相容亦同
　　凡立方内容十二等面皆以十二等面之边正切于立方各面之正中凡六皆遥相对如十字
　　假如上下两面所切十二等
　　面之边横则前后两面所切
　　之边必纵而左右两面所切
　　之边又横若引其边为周线
　　则六处相交皆成十字
　　立方内容二十等面边亦同
　　凡各体相容皆以内之尖切
　　外之面惟立方内容四等面
　　则以角而切角立方内容十
　　二等面二十等面则以边而
　　切面




　　厯算全书卷五十七
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书卷五十八
　　宣城梅文鼎撰
　　防何补编卷四
　　方灯
　　凡灯形内可容立方立方在灯体内必以其尖角各切于八三角面之心
　　如图
　　灯体者立方去其八角也平
　　分立方面之边为防而联为
　　斜线则各正方面内成斜线
　　正方依此斜线斜剖而去其
　　角则成灯体矣此体有正方
　　面六三角面八而边线等故
　　亦为有法之体
　　凡灯体内可容八等面八等面在灯体内又以其尖角各切于六方面之心
　　凡灯体内可容立圆此立圆内仍可容八等面此八等面在立圆内可以各角切立圆之防同防于灯体之六方面而成一防
　　凡灯体容立圆其内仍可容诸体然惟八等面在立圆内仍能切灯体余不能也按圆灯在立圆内亦能切灯体与八等面同
　　凡诸体相容皆有一定比例以其外可知其内
　　灯体之边设一百其幂一万○倍之二万开方得一百四十一【四二一三】为灯之高及其腰广【边如方面高广如斜故倍幂求之】以高一百四十一【四二一三】乘方斜之面幂二万得二百八十二万八千四百二十六为方斜之立方积
　　立方积五因六除得二百三十五万七千○二十一为灯积
　　灯积为立方六之五
　　以灯积减立积余四十七万一千四百○五为内容八等面积此八等面在立积内亦在灯积内皆同腰广同高　其积之比例为立积六之一为灯积五之一此相容比例
　　八等面与灯积不惟同高广亦且同边故五之一亦即为八等面与灯积同边之比例也
　　灯形内容立方其边为灯体高广三之二　设灯体边一百其高广一百四十一【四二一三】则内容立方边九十四【二八○八】立方积八十三万八千○五十一
　　灯高广自乘之幂二万如左图甲乙方去其左右各六之一余三之二如丙丁矩又去其两端六之一余三之
　　二如戊正方丙丁矩一万三千
　　三百三十三【三三】戊正方八千
　　八百八十八【八八】为内容正方
　　之一面幂其根九十四【二八○八】以根乘面得八十三万八千
　　○五十一
　　凡等边平三角之心依边剖
　　之皆近大边三之一灯内容
　　立方之八角皆切于平三角
　　之心灯改立方则所去者皆
　　四围斜面三之一于前形爲六之一四围皆六之一合之爲三之一而所存必三之二矣
　　凡立方体各自其边之中半斜剖之得三角锥八此八者合之卽同八等面体
　　依前算八等面体其边如方其中高如方之斜若以斜径爲立方则中含八等面体而其体积之比例爲六与一
　　何以言之如己心辛爲八等
　　面之中高庚心戊爲八等面
　　之腰广己庚己戊戊辛辛庚
　　则八等面之边也若以庚心
　　戊腰广自乗爲甲乙丙丁平面又以己辛心中高乗之爲甲乙丙丁立方【立方一面之形与平面等】则八等面之角俱正切于立方各面之正中而爲立方内容八等面体矣夫己心辛庚心戊皆八等面【己庚等面】爲方之斜也故曰以其斜径爲立方则中含八等面体也
　　又用前图甲乙丙丁爲立方之上下平面从己庚庚辛辛戊戊己四线剖至底则所存爲立方之半而其所剖
　　三角柱体四合之亦爲立方之
　　半也
　　此方柱也其高之度如其方之斜
　　立方之四隅各去一立三角
　　柱则成此体　其积爲立方
　　之半爲八等面之三倍其中
　　仍容一八等面体
　　八等面体在方柱体内
　　柱形从对角斜线【如己辛戊庚】剖
　　至底又从对边十字线【如丑尾卯
　　箕】剖至底又从腰线【角申亢】横
　　截则剖为三角柱一十六【即皆
　　如心辛申未丑之体】
　　三角柱眠视之则堑堵也
　　堑堵从一尖【即心尖】斜剖至对
　　底【未申】则鼈臑也鼈臑居堑堵
　　三之一
　　堑堵立则为三角柱鼈臑立
　　则为三角锥
　　八等面体从尖心剖至对角
　　亦剖至对边而皆至底【子】又
　　从腰【角申亢】横剖之则成三角
　　锥十六
　　夫方柱为堑堵十六而八等
　　面为鼈臑亦十六则堑堵鼈
　　臑之比例即方柱八等面之
　　比例矣鼈臑为堑堵三之一
　　则八等面亦方柱三之一矣方柱者立方之半也八等面既为方柱三之一不得不为立方六之一矣
　　立方内容灯体
　　甲庚立方体六面各平分其
　　边【如壬丑癸卯及子未酉午辰诸防】而斜剖
　　其八角【如从丑癸剖至子从从癸卯剖至酉从酉
　　剖至午未则立方去其八角】成灯体
　　灯体立方六之五
　　何以知之立方所去之八角
　　合之即成八等面八等面既
　　为立方六之一则所存灯体
　　不得不为立方六之五矣
　　凡立方内容灯体皆以灯之边线为立方之半斜立方内之灯体又容八等面则以内八等面之边线为立方之半斜与立方竟容八等面无异推此灯内容八等面其边线必等其中径亦等

　　剖立方之角成此


　　以剖处为底则三边等以立
　　方之角丁为顶成三角扁锥


　　扁锥立起则成偏顶锥为八
　　等面分体

　　凡八等面容灯体皆以灯体
　　之边线得八等面之半八等
　　面内之灯体又容立方则亦
　　方斜比例与八等面竟容立
　　方无异也
　　甲丙丁丙丁乙甲丁戊戊丁
　　乙皆八等面之一己子卯等
　　小三角在甲丁丙等大三角
　　面内即灯体之八斜面正切
　　于八等面者也其中央心防
　　即内容立方角所切
　　等径之比例
　　立方径一　　　其边一　　其积一　　一○○○○○○内容灯径一　　其边○七　其积六之五○八三三三○○内容八等面径一　其边○七　其积六之一○一六六六○○凡立方内容灯体灯内又容立圆圆内又容八等面其切于立方之面之中央凡六处皆同一防若立圆内容灯体灯内又容立方方内又容八等面其相切俱隔逺不能同在一防
　　凡灯体皆可依楞横剖如方灯横剖成六等边面故其外切立圆之半径与边等　如圆灯横剖成十等边面故其外切立圆之半径与其边若理分中末之全分与其大分
　　凡诸体改为灯皆半其边作斜线剖之
　　凡灯体可补为诸体皆依其同类之面之边引之而防于不同类之面之中央成不同类之锥体乃虚锥也虚者盈之即成原体所以化异类为同体也
　　如方灯依四等边引之补其八隅成八尖即成立方若依三等边引之补其六隅成六尖即成八等面如圆灯依五等边引之补其二十隅成二十尖即成十二等面若依三等边引之补其十二隅成十二尖即成二十等面
　　増异类之面成锥则改为同类之面而异类之面隐此化异为同之道也
　　凡灯体之尖皆以两线交加而成故棱之数皆倍于尖【方灯十二尖二十四棱圆灯三十尖六十棱】
　　凡灯体之棱【即边】皆可以联为等边平面圏　如方灯二十四棱联之则成四圏每圏皆六等边如六十度分圆线　圆灯六十楞联之则成六圏每圏皆十等边如三十六度分圆线　此外惟八等边联之成三圏每圏四楞成四等面而十二棱成六尖有三棱八觚之正法其余四等面十二等面二十等面皆不能以边正相联为圏
　　灯体亦有二
　　其一为立方及八等面所变其体有正方之面六三角之面八有边棱二十四而皆同长棱尖凡十有二其一为十二等面二十等面所变其体有五等边之面十二有三角等边之面二十有边楞六十而皆同长棱尖凡三十
　　立方及八等面所变是刓方就圆终方势谓之方灯十二等面及二十等面所变是削圆就方终带圆体谓之圆灯方灯为立方及八等面所变其状并同而比例同
　　甲乙立方体丙丁戊己庚辛
　　壬癸子皆其边折半处各于
　　折半防联为斜线【如丙戊丙己等】依
　　此灯体斜线剖而去其角则
　　成灯形矣
　　灯形之丁辛高丙丁濶皆与立方同径　其边得立方之半斜【假如立方边丁辛一百则灯体边丁壬七十有竒】其积得立方六之五【假如立方边一百其积百万则灯体边七十有竒其积八十三万三千三百三十三三三】此为立方内容灯体之比例也若灯与立方同边必反小于灯【假如灯体边亦一百则其积二百三十五万七千○二十一而立方一百之积只一百万是反小于灯也】解曰灯体边一百【如前图之丁壬】其外切立方必径一百四十一【四二一三如前图之丁辛】其自乘之幂二万以径乘幂得二百八十二万八四二六为立方积再五因六除得灯积二百三十五万七千○二十一
　　又法以灯边自乘倍之开方得根仍以根乘倍幂再五因六除
　　见积亦同
　　甲乙为八等面体　甲乙丙
　　丁戊皆其边棱所辏之尖
　　甲丙丁面三边皆等其三边
　　折半于辛于庚于己
　　甲丁戊面其边折半于辛于
　　壬于癸乙丙丁面其边折半
　　于寅于己于丑乙丁戊面其
　　边折半于丑于癸于子各以折半防联为斜线则各成小三等面如甲丙丁面内又成庚辛己三等边面其边皆半于原边如庚辛得丁丙之半余三边同
　　各自其小三角之面之边剖之而去其锥角则成灯形矣
　　如依辛巳己丑丑癸癸辛四边平剖之而去其丁角【以丁角为尖辛巳丑癸为底成扁方锥甲丙乙戊尖并同】则所剖处成辛巳丑癸平方面【去甲壬辛庚锥成卯壬辛庚面去丙庚己寅锥成庚酉寅己面并同一法余可类推】
　　八等面体有六角皆依法剖之成平方面六而剖之后各存原八等面中小三角等边面八与立方剖其八角者正同
　　灯形之高濶皆得八等面之半
　　如辛丑高得甲乙之半
　　己癸濶得丙戊之半
　　其边亦为八等面原边之半
　　其积得八等面八之五
　　何以知之曰同类之体积以
　　其边上立方积为比例故边
　　得二之一其积必八之一也
　　今所剖去之各尖俱以平
　　方为底而成方锥两方锥合
　　为一八等面体皆等面等边
　　与原体为同类而其边正得
　　原边二之一则其积为八之
　　一也　原体六尖各有所成之锥体皆相等合之成同类八等面之体凡三其积共为原积八之三以为剖去之数则所存灯体得八之五也
　　如上图甲乙二锥合为八等面体一丙戊二锥合为八等面体一　丁尖及所对之尖其二锥合为八等面体一　通共剖去同类之形三
　　假如八等面之边一百则其积四十七万一千四百○四其所容灯体边五十其积必二十九万四千六百二十七五　以八等面积五因八归之见积
　　或用捷法竟以十六归进位所得灯积亦同
　　右法乃八等面内容灯体比例也
　　若灯体之边与八等面同大则其积五倍大于八等面假如灯体边一百则其积二百三十五万七千○二十以八等面边一百之积四十七万一千四百○四加五倍得之　此法则灯体与八等面同为立方所容之比例亦即为灯内容八等面之比例
　　准此而知灯内容八等面八等面又容灯则内灯体为外灯体八之一
　　灯体内容八等面　五之一　【用畸零乘法化大分为小分以八等面母数八乘五之一】八等面内容灯体　八之五　【得八乘母数五得四十】
　　外灯体四十　八等面体八　内灯体五　合之为内体得外体四十之五约为八之一
　　又八等面容灯灯又容八等面内八等面亦为外八等面八之一　其体之比例既同则其所容之比例亦同也立方内容灯体灯内又容立方则内立方边得外立方边三之二内立方积得外立方积二十七之八
　　以三之二自乘再乘为三加之比例也
　　六　之　五　一百三十五
　　二十七之八　四十八
　　准此而知灯内容立方则内立方积得灯积一百三十五之四十八　若灯容立方立方又容灯则内灯积亦为外灯积二十七之八其为所容者之比例即能容者之比例故也求方灯所去锥体
　　三角锥棱皆五十即原边之
　　半【甲乙甲丙甲丁】　底之边皆七十
　　○【七一○七】即灯体之边【丙乙乙丁丁丙】其半三十五【三五五三乙戊戊丁】
　　求甲戊斜垂线
　　法曰乙丁为甲乙之方斜线则甲戊为半斜与乙戊戊丁等皆三十五【三五五三】其幂皆一千二百五十
　　求丙戊中长线
　　以戊丁幂三因之为丙戊幂平方开之得六十一【二三七二】为丙丁乙等边三角形中长线
　　求甲己中高线
　　法以戊丁幂【一千二百五十】取三之一为己戊幂【四百一十六六六六六】与甲戊幂【即丁戊幂】相减余【八百三十三三三三三】为甲己中高幂开方得甲己中高二十八【八六七五】
　　又以己戊幂开方得己戊二十○【四一二四】以己戊【二十○四一二四】乘戌丁【三十五三五五三】得【七百二十一六八六五】又三因之得【二千一百六十四○五七五】为乙丙丁三等边幂
　　又以中高甲己【二十八八六七五】乘之得数三除之得三角锥积二万○八百二十三【六六三五】又八乘之得一十六万六千五百八十七【三○】为所去八三角锥共积即立方一百万六之一与前所推合【本该一十六万六千六百六十六六六不尽因积算尾数有欠然不过万分之一耳】
　　圆灯为十二等面二十等面所变体势并同而比例亦别
　　公法皆于原边之半作斜线相联则各平面之中成小平面此小平面与原体之平面皆相似即为内容灯体之面　依此小平面之边平剖之去原体之锐角此所去之锐角皆成锥体锥体之底平割锥体则原体挫锐为平亦成平面于灯体原有若干锐亦成若干面而与先所成之小平面不同类然其边则同
　　如图
　　十二等面每面五边等今自
　　其各边之半联为斜线则成
　　小平面于内亦五等边为同
　　类
　　依此斜线剖之而去其角所
　　去者皆成三角锥锥体既去
　　即成三等面为异类
　　原有十二面故所存小平面
　　同类者亦有十二
　　原有二十尖故所剖锥体而
　　成异类之面者亦二十
　　求灯体边
　　法以十二等面边为理分中末之大分求其全分而半之即为内容灯体之边
　　一率　理分中末之大分　　六十一【八○三三九八】二率　理分中末全分之半　五十○
　　三率　十二等面之边　　　一百○○
　　四率　内容灯体之边　　　八十○【九○一七】
　　灯体边原为大横线之半十二等面边与其大横线若小分与大分则亦若大分与全分也而十二等面边与灯边亦必若大分与全分之半矣
　　总乘较为实戊丙底为法法
　　除实得丙辛以丙辛减戊丙
　　得戊辛折半为戊己
　　法当以所得戊己自乘为句
　　幂用减甲戊幂余为甲己幂
　　开方得一十七【八四一一】为中高
　　今改用捷法【省求丙辛】取戊丙幂
　　九之一为戊己幂【戊己为戊内三之一
　　故其幂为九之一】得五百四十五【四二
　　三七】
　　或径用戊丁幂三之一亦同
　　又捷法不求甲戊斜垂线但以戊丁幂三分加一以减甲丁【即甲丙或甲乙】幂为甲己幂开方即得甲己中高比前法省数倍之力
　　戊丁幂　一千六百三十六【二七一二】
　　三之一　　　五百四十五【四二三七】
　　并得　　二千一百八十七【六九四九】
　　甲丁【即甲丙幂】二千五百○○
　　相减余【甲乙幂】　三百一十八【三○五一】　　与前所得同解曰原以戊丁幂减甲丁幂得甲戊幂复以戊丁幂三之一减甲戊幂得甲己幂今以戊丁三分加一而减甲丁幂即径得甲己幂其理正同
　　前之捷法有求丙辛及较总相乘后用底除诸法可谓捷矣今法径不求甲戊斜垂线捷之捷矣凡三角锥底濶等者当以为式
　　订定三角锥法【圆灯所去】
　　用捷法以戊丁幂三分加一减甲丁幂为甲己幂
　　甲丁【甲乙甲丙】皆设五十
　　丙丁【丁乙乙丙】皆八十○【九○一七】其
　　半【戊丁戊乙】四十○【四五○八半】丙戊七十○【○六二九】为底之垂线
　　甲己一十七【八四一一】为中高
　　丙乙丁底幂二千八百三十四
　　【一○三八】
　　法以半边【戊丁】乘中长【丙戊】得底幂【丙乙丁】　以中高【甲己】乘底幂【丙乙丁】得三角柱积五万○五百六十三【五二九三】　三除之得锥积一万六千八百五十四【五○九七】　又以二十乘之为灯体所去之积三十三万七千○九十○【一九四○】十二等面边设一百前推其积为七百六十八万三千二百一十五今减去积三十三万七千○九十存灯积七百三十四万五千一百二十五　内容灯体边八十○【九○一七】
　　依测量全义凡同类之体皆以其边上立方为比例可以推知二十等面所变之灯体
　　二十等面边设一百则灯体之边五十
　　捷法求得一百七十三万三千九百四十八为设边五十之灯积
　　一　灯体边八十○【九○一七】之立方五十二万九千○百○八【五】二　灯体积七百三十四万五千一百二十五
　　三　灯体边五十之立方一十二万五千
　　四　灯体五十之积一百七十三万三千九百四十八圆灯
　　边设三十○【九○一七即理分中末之大分乙丁】外切立圆半径五十【即理分中末之全分丁中乙中】外切立圆全径一百【即外切立方】体积四十○万三千三百四十九
　　内有三角锥计二十共计一十二万
　　八千七百五十二
　　五棱锥计十二共积二十七万四千
　　五百九十六
　　丁中丙乙三角锥为圆灯分体之一　乙丁丙三等边面巳为平面心　中为体心　中巳为分体之中高戊丁为半边丁中自体心至角线为分体之棱　戊中为斜垂线
　　乙癸中辛五棱锥亦圆灯分体之一　乙丁癸壬辛五等边面庚为平面心　中庚为分体中高　其戊丁半边丁中分体棱戊中斜垂线与前三角锥皆同一线何以知两种锥形得同诸线乎曰乙戊丁边两种分体所同用而两种锥体皆以体心中为其顶尖故诸线不得不同观上图自明
　　先算三角锥【共二十】
　　半边一十五【四五○八五】戊丁幂二百三十八【七二八七】
　　平面容圆半径【即戊巳】○八【九一○五】其幂七十九【五七六二用捷法取戊丁幂以三除得之】
　　平面积【乙丙丁面】四百一十三【四八七九】
　　中高【即己中】四十六【七○七五本法以戊丁幂减丁中幂为戊中幂又以戊丁幂三之一当戊己幂减之为巳中幂今径以戊丁幂加三之一减丁中幂为己中是捷法也】
　　三角锥积六千四百三十七【六六二○】
　　二十锥共积一十二万八千七百五十三【三四】
　　次算五棱锥【共十二】
　　半边一十五【四五○八五戊丁】
　　半周七十七【二五四二五用半边五因得之】
　　平面容圆半径二十一【二六六三戊庚】
　　五等边平积一千六百四十二【九一二○】
　　中高四十一【七八五三庚中】
　　五棱锥积二万一千九百六十二【六六】
　　十二锥共积二十七万四千五百九十六
　　求戊庚半径
　　一率　三十六度切线　○七二六五四
　　二率　全数　　　　　一○○○○○
　　三率　半边戊丁　　　一十五【四五八五】
　　四率　平面容圆半径【戊庚】二十一【二六六二】
　　戊丁句幂二百三十八【七二八七】丁中幂二千五百○○
　　戊中股幂二千二百六十一【二七一三】

　　戊庚句幂四百五十二【二五五五】戊中幂二千二百六十一【二七一三】庚中股幂一千八百○九【○一五八】
　　戊丁半边幂四因之为全边三十○【九○一七】之幂
　　一　灯体边五十之立方一十二万五千
　　二　灯体边五十之体积一百七十三万三千九百四
　　十八
　　三　灯体边三十○【九○一七】之立方二万九千五百○八
　　【四九八七】
　　四　灯体边三十○【九○一七】之体积四十○万九千三百二十九与细推者只差五千九百八十为八十分之一
　　柱积六万八千六百四十九
　　锥积二万二千八百八十三
　　十二锥共积二十七万四千五百九十六
　　孔林宗附记
　　方灯可名为二十四等边体　圆灯可名为六十等边体
　　四等面体又可变为十八等边体为六边之面四为三边之面四凡十二角
　　又可变为二十四等面体面皆三边凸边二十四凹边十二十字之交六凡八角如蒺藜形
　　六等面体又可变三十六等边体为八边之面六为三边之面八凡二十四角
　　八等面体亦可变三十六等边体为六边之面八为四边之面六凡二十四角
　　又可变四十八等边体为四边之面十八为三边之面八凡二十四角
　　大圆容小圆法　平浑
　　甲大圆内容乙戊丙三小圆
　　法以小圆径【如乙戊戊丙】为边作
　　等边三角形而求其心如丁
　　乃于丁戊【三角形自心至角线】加戊甲
　　【小图半径】为大圆半径【丁甲】
　　凡平圆内容三平圆四平圆五平圆六平圆皆以小圆自相扶立　若平圆内容七平圆以上皆中有稍大圆夹之
　　甲大浑圆内容丙戊乙己四
　　小浑圆法以小浑圆径【如乙戊戊
　　巳等】为边作四等面体而求其
　　体心如丁　次求体心至角
　　线【如丁戊丁己丁乙丁丙又为外切立圆半径】加小浑圆半径【即戊甲】为大圆半径【如丁甲】
　　凡浑圆内容四浑圆或容六浑圆或容八浑圆十二浑圆皆直以小浑圆自相扶　若浑圆内二十浑圆则中多余空必内有稍大浑圆夹之
　　甲大平圆内容乙戊丙己四
　　小平圆法以小圆径【如乙戊等】为
　　边作平方【如乙戊丙己方】而求其斜
　　【如丁乙即方心至小圆心线】加小圆半径
　　【如乙甲】为大圆半径【如丁甲】
　　若先有大圆【甲】而求所容小圆则以三率之比例求之一率　方斜并数　二四一四
　　二率　方根　　　一○○
　　三率　所设之浑圆半径　丁甲
　　四率　所容之小圆半径　乙甲
　　推此而知五等边形于其锐角为心半其边为界作小圆而以五等边之心至角如半边以为半径而作大圆则大圆容五小圆俱如上法
　　若六等边于其鋭作小圆仍可于其心作圆共七小圆何也六等面之边与半径等也其法只以小圆径【即六等边】
　　二分加一为大圆半径
　　甲大浑圆内容乙丙等六小
　　浑圆
　　法以小浑圆之径为边作八
　　等面虚体如乙己丙辛戊皆
　　小立圆之心联为线则成八
　　觚　乃求八等面心【丁】至角
　　之度【如丁乙等】加小圆半径【如甲乙】为大浑圆半径【如甲丁】
　　捷法以小浑圆径为方【即乙己丙
　　辛平方】求其斜【如丁乙】加小圆半
　　径【如甲乙】为大圆半径或以小浑圆径自乘而倍之开方得根加小圆半径为大圆半径亦同
　　或先得大圆而求小圆径则用比例
　　一率　方斜并　二四一四
　　二率　方根　　一○○
　　三率　所设大浑圆之径
　　四率　内容六小浑圆之径
　　甲浑圆内容乙丙戊已庚壬辛及癸丑子寅卯十二小圆
　　法以小立圆径【如乙丙等】作二十
　　等面虚体之棱【如乙丙等俱小圆之心联
　　为线则成二十等面之棱】次求体心【丁】至
　　角【即小圆心】之线【如乙丁】加小圆半
　　径【如甲乙】为大圆半径【如甲丁】按体心至角线即二十等面
　　外切圆半径
　　二十等面之例边一百【即小浑圆
　　例径】
　　外切浑圆例径二百八十八
　　【一三五五】
　　二十等面边一百者其外切浑圆径一百八十八奇又加小浑例径得此数
　　若先有大浑圆而求所容之十二小浑圆则以二率爲一率四率爲三率
　　一　外切浑圆之例径二百八十八【一三五五】
　　二　二十等面之例边一百【卽小浑圆例径】
　　三　设浑圆之全径一百
　　四　内容十二小浑圆之径三十八【六九　其比例如全四八　分与小分】甲庚大平圆内容七小圆
　　法以甲庚圆径取三之一【如丁
　　乙庚辛等】爲小圆径若容八圆以
　　上则其数变矣假如以七小圆
　　均布于大圆周之内而切于
　　边则中心一小圆必大于七
　　小圆而后能相切【以上仿此】

　　甲大浑圆内容八小立圆
　　法以小圆径作立方【如乙庚方】求
　　其立方心至角数【即外切浑圆半径如
　　乙丁】再加小圆半径【如甲乙】为大
　　浑圆半径【如甲丁】
　　按八小员半径十【甲乙】则其全径二十内斜线【乙丁】十七加【甲乙】共二十七内减小圆径二十余七倍之得十四是比小圆半径为小其比例为十之七安得复容一稍大小圆在内乎
　　又二十等面有十二尖可作十二小圆以居大浑圆之内而为所容
　　又八等面有六尖可作六小圆为大浑圆所容　四等面有四尖可作四小圆
　　又方灯亦有十二尖可作十二小圆为大浑圆所容其中容空处仍容一小圆为十三小圆皆等径也
　　十二等面有二十尖用为小浑圆之心可作二十小立圆以切大浑圆内有稍大浑圆夹之
　　圆灯尖三十可作三十小球亦皆以内稍大浑圆夹之公法皆以心至尖为小浑圆心距体心之度皆以小浑圆径为所作虚体边
　　如作内容二十小浑圆联其心成十二等面虚体虚体之各边皆如小浑圆径也虚体之各尖距心皆等此距心度以小浑圆半径加之为外切之大浑圆半径以小浑圆半径减之为内夹稍大浑圆半径
　　浑圆内容各种有法之体以查曲线弧面之细分公法凡有法之体在浑圆体内其各尖必皆切于浑圆之面
　　凡浑圆面与内容有法体之尖相切成防皆可以八线知其弧度所当
　　内惟八等面皆以弧线十字相交为正角余皆鋭角其十二等面则钝角
　　十二等面每面五边等析之从每面之角至心成平三
　　角形五则辏心之角
　　皆七十二度半之三
　　十六度即甲心乙角
　　其余心乙甲角必五
　　十四度倍之为甲乙
　　丁角则百○八度故
　　为钝角
　　凡浑圆面切防依内切各面之界联为曲线以得所分浑体之弧面皆如其内切体等面之数之形
　　如四等面则其分为弧面者亦四而皆为三角弧面十二等面则亦分弧面为十二而皆成五边弧形八等面则弧面亦分为八二十等面弧面亦分二十而皆为三角弧形内惟六等面为立方体所分弧面共六皆为四边弧形
　　凡浑圆面上以内切两防联为线皆可以八线知其几何长
　　其法以各体心到角之线命为浑圆半径以此半径求其周作圈线即为圆浑体过极大圈以八线求两防所当之度即知两防间曲线之长
　　凡浑圆面以曲线为界分为若干相等之弧面即可以知所分弧面之幂积
　　假如四等面外切浑圆依切防聨为曲线分浑圆面为四则此四相等三角形弧面各与浑圆中剖之平圆面等幂何也浑圆全幂得浑体中剖平圆面之四倍今以浑幂分为四即与浑圆中剖之平圆等幂矣
　　推此而知六等面分外切浑圆幂为六即各得中剖平圆三之二
　　八等面分浑圆幂为八即各得中剖平圆之半幂十二等面分浑圆幂为十二即各得中剖平圆三之一二十等面分浑圆幂为二十即各得中剖平圆五之一凡依等面切浑所剖之圆幂又细剖之皆可以知其分幂
　　假如四等面所分为浑圆幂
　　四之一而作三角弧面若中
　　分其边而防于中心则一又
　　剖为三为浑圆幂十二之一
　　与十二等面所分正等但十
　　二等面所剖为三边弧线等此所分为四边弧线形如方胜而边不等若自各角中防于心成三边形其幂亦不等也
　　再剖则一剖为六为浑圆面幂二十四之一【皆得十二等面所剖之半而边不等】若但一剖为二则得浑圆幂八之一与八等面所剖正等但八等面三边等又三皆直角此则边不等又非直角
　　假如八等面所剖为浑幂八
　　之一若一剖为二则十六之
　　一剖为四则三十二之一可
　　以剖为六十四至四千九十
　　六　若以三剖则浑幂二十四之一如十二等面之均剖亦如四等面之六剖也再细剖之可以剖为九十是依度剖也可以剖为五千四百则依分剖也再以秒防剖之可至无穷
　　惟八等面可以细细剖之者以腰围为底而两防于极其形皆相似故剖之可以不穷
　　又以此知曲面之容倍于平面何也八等面所剖之浑体腰围即平圆周也以平圆周之九十度为底两端皆
　　以平径为两以防于平圆
　　之心则其幂为平圆四之一
　　若浑体四面以腰围九十度
　　为底两端各以曲线为两
　　以防于浑圆之极则其幂为
　　平圆二之一矣
　　假如六等面【即立方】在浑圆内
　　剖浑幂为六得浑幂六之一
　　若一剖为二则与十二等面
　　所剖等剖为四则二十四之
　　一再剖则一为八而得四十
　　八之一
　　假如十二等面剖浑幂为十
　　二各得浑幂十二之一若剖
　　一为五则得六十之一再剖
　　一为十则得百二十之一而
　　与八等面所剖为十五之一
　　假如二十等面剖浑幂为二十各得浑幂二十之一若一剖二则四十之一若一剖三则六十之一若一剖六则百二十之一皆与十二等面所剖之幂等而边不必等也
　　凡球上所剖诸幂以为底直剖至球之中心成锥形即分球体为若干分
　　如四等面之幂得球幂四之一依其边直剖至球心成三角锥其锥积亦为球体四之一推之尽然















　　防何补编【补遗】
　　平三角六边形之比例
　　平三角等边形
　　甲丁丙三边等形其边【丁甲】折半
　　【丁乙】自乘而三之即为对角中
　　长线幂开方得中长线丙乙
　　既得中长线丙乙以乘丁
　　乙半边即等边三角形积　若以丙乙幂丁乙幂相乘得数平方开之得三等边形之幂积
　　防法不求中长线但以丁乙幂三因之与丁乙幂相乘开方得根即三等边幂积　或用原边丁甲自乘得数乃四分之取四之一与四之三相乘得数开方得三等边积亦同
　　论曰边与边横直相乘得积若边之幂乘边之幂亦必得积之幂矣故开方得积
　　法曰以原边之幂三因四除之又以原边之半乘之两次为实平方为法开之得三等边形幂积
　　解曰原边幂四之三即中长幂也半边乘二次以幂乘也　又法以原边与半边幂相减相乘开方见积平三角等边形幂积自乘之幂与平方形幂积自乘之幂若三与十六【理同前条】
　　解曰甲戊庚丁为平方形丁
　　丙甲为等边三角形其边同
　　为甲丁题言丁甲线上所作
　　三等边形与所作正方形其积之比例若平积三与十六之平方根也【即一七竒与四○】
　　防法于分面线上取三点为等边三角形积其十六点即正方积　若以边问积则以边之方幂数于分面线之十六点为句置尺取三点之句即得三等边积其设数得数并于平分线取之【此用比例尺算】
　　又法作癸卯辰半员辰癸为径于径上匀分十七分而尽一端取其四分如丑癸【丑癸为辰癸十七分之四则丑子为辰子十六分之三】
　　折半于丁以丁为心丁癸为
　　半径作癸壬丑小半员又以
　　丁癸折半于子作卯子直线
　　【与辰癸径为十字埀线】割小员于壬则
　　壬子与卯子之比例即三等
　　边幂与正方幂积比例
　　用法有三等边形求积法以甲丁边上方形【即庚甲】积作卯子直线如句四倍之作横线如辰子为股次引横线取子癸为卯子四之一又取丁子如癸子次以丁癸为半径丁为心作半员截卯子于壬即得壬子为三等边积
　　防法不作辰子线但于子作半十字线如癸丁次于子点左右取癸取丁各为卯子四之一乃任以丁为心癸为界作割员分即割卯子于壬而为三等边形之积论曰此借用开平方法也平方求根有算法有量法此所用者量法也量法有二其一以两方之边当句当股而求其是为并方法也其一用半员取中比例此所用者中比例也【详比例规觧】
　　附三等边求容圆
　　法曰以原边之幂十二除之为实平方开之得容圆半径
　　解曰原边幂十二之一即半边三之一也
　　附三等边形求外切圆
　　法曰以原边之幂三除之为实平方开之得外切圆半径　一法倍容圆半径即外切圆半径
　　新増求六等边法
　　法曰六等边形者三等边之六倍也【以同边者言】　用前法得三等边积六因之即六等边积
　　依前法边上方幂与三等边形幂若四○与一七竒因显边上方幂与六等边形幂若四○与十○二竒【亦若一○○与二五五】
　　今有六等边形问积　法以六等边形之一边自乘得数再以二五五乘之降两位见积
　　解曰置四○与一○二各以四除之则为一○○与二五五之比例也
　　若问员内容六等边形者即用员半径上方幂为实以二五五为法乘之得数降二位见积亦同【降二位者一○○除也】依显平员积与其内容六等边形积之比例若三一
　　四与二五五
　　论曰六等边形之边与外切员形之半径同大故以半
　　径代边其比例等【半径上方与六等边
　　形亦若一与二五五】然则员全径上方
　　形与内容六等边形必若四
　　○○与二五五【全径上方原为半径上方】
　　【之四倍】而员面幂积与六等边形积亦必若三一四与二五五矣【员径上方与员幂原若四○○与三一四故也】
　　用尺算　用平分线　求同根之幂
　　平方幂　四○○　　　　八十○　　　【皆倍而退位之数】平员幂　　　三一四　　约爲六十三弱【实六二八】
　　六等边幂　　二五五　　　　五十一
　　三等边幂　　一七○　　　　三十四
　　右皆方内容员员内又容六角之比例其六等边与员同径乃对角之径也于六等边之边则爲倍数三等边则只用边
　　若六等边形亦卽用边与平方平员之全径相比则如后法
　　平方　　　四○○　　　平方　一○○○○平员　　　三一四　　　平员　　七八五四六角　　一○二○　　　六角　二五五○○三角　　　一七○　　　三角　　四二五○论曰以平方平员之径六角三角之边并设二○则爲平方四○○之比例若设一○○则如下方平方一○○○○之比例也
　　量体细法
　　四等面体求积
　　法曰以原边之幂三除之得数以乘边幂得数副寘之又置边幂二十四除之得数以乘副平方开之即四等面积也
　　又法置半边幂三除之得数以乗半边幂得数副寘之又以六为法除半边幂得数为实平方开之即四等面积四分之一也【即三角扁锥】
　　算二十等面
　　二十等面之棱线甲丁设一百七十八【原设一百一十因欲使外切立方与十二等面同故改此数】　心乙一百四十四【即原切十等边之半径又为外切立方之半径】　外切立方径二百八十八
　　求中心为分体之高　法先
　　求乙中【乃各棱折半处至三角面中央一点之距】依防何补编半甲丁得八
　　十九为甲乙自乘【七千九百二十一】取三之一【得二千六百四十又三之一】为
　　乙中句幂又以心乙【一四四】自乘【二○七三六】为幂相减余【一万八千○九十五又三之二】为股幂开方得心中一百三十四半强为分体鋭尖之高倍之得二百七十九半弱为内容立员径
　　求甲心为分体斜棱　法以甲乙为句其幂【七九二一】以乙心为股其幂【二○七三六】并之【二八六五七】为幂开方得甲心一百六十九二为分体自角至鋭之斜棱　倍之三百三十八半弱为外切浑员之径
　　或取理分中末线之大分【如心乙】为股小分【如甲乙或丁乙】为句取其【甲心或丁心】为二十等面自角至心之楞线合
　　之成甲心丁形即二十等面分形之
　　斜立面也甲丁则原形之楞也
　　如【甲心丁】之面三皆以心角为宗以甲
　　心等合之【三面皆有此】则甲丁等底【三底
　　并同甲丁】以尖相遇而成三等边之面即
　　二十等面之一面也以此为底则成
　　三角尖锥矣　尖锥之立三角面皆等皆稍小于底解曰乙戊与甲乙等而甲心与戊心【即乙心】不等如与股【乙戊即十等边之一边乃二十等面横切之面之边】今欲求心中正立线中即
　　二十等面一面之中自此至
　　心成心中线则其正高也
　　法先求甲中为句取其幂以
　　减甲心幂即心中股幂开
　　方得心中
　　简法取乙甲【即原楞之半又即小分】自幂三之一以减乙心【即大分又即原楞均半处至形心即斜立面中线】之幂即心中幂
　　又解曰原以甲乙半楞【又即二十等面中剖所成之楞即十等边之一边故为小分】为句【在形内为小分乃乙戊也今形外之甲乙与甲乙同大故亦为小分】乙心【即二十等面中切成十等边自角至心之故为大分又即为二十尖锥各立面三角形之中长线】为股则甲心为【自各角至体心之线】而甲心幂内有乙心股甲乙句两幂今求心中之高则又以甲中为句自各角至各面心也而仍以甲心为幂内减甲中句幂则其余心中股幂也　依防何补编甲乙幂三分加一为甲中幂故但于乙心幂内减去甲乙幂三分之一即成心中股幂又解曰若以乙心为则中乙为句而心中为股依补编中乙幂为甲乙幂三分之一故直取去甲乙幂三之一为句幂以减心乙幂即得心中股幂开方得心中此法尤防
　　作法　以二十等面之楞【如甲丁】折半【如甲乙或丁乙亦即甲戊】为理分中末之小分求其大分【如乙心即二十等面各楞线当中一点至心之线亦即外切立方之半径】　再以大分为股【乙心】小分为句【甲乙亦即甲戊亦即戊乙】取其【甲心即二十等面自各角至心之线谓之角半径亦即切员半径】　再以原楞【甲丁】为底切员半径为两【甲心及丁心】成两等边之三角形即二十等面体自各角依各楞线切至体心而成立锥体之一面三面尽如是则成三角立锥矣　如是作立锥形二十聚之成二十等面体
　　立锥体之中高线【心中】以乘三体面之幂而三除之得各锥积二十乘锥积得立积　其中高线【心中】即内容立员之半径
　　立方内容二十等面体其根之比例若全分与大分立方内容十二等面体其根之比例若全分与小分二十等面体之分体并三楞锥以元体之面为底原体之楞【甲丁】折半【甲乙】为小分为句取其大分【心乙】为股句股求得自角至心为外切员之半径【心甲】
　　假如【甲丁】原楞一百一十半之得甲乙半楞五十五自乘【三千○二十五】为句幂其大分乙心【即外切立方半径】八十九自乘【七千
　　九百二十一】为股幂并二幂【一万○九
　　百四十六】平方开之得【一○四又六二
　　不尽约为一○四半强】为角至体心之
　　线【心甲】即外切立员之半径
　　算二十等面之楞于浑天度
　　得防何分
　　法以心甲为浑天半径甲乙
　　为正法为心甲与甲乙若
　　半径与甲心乙角之正查正表得度倍之为丁甲通所当之度
　　算十二等面
　　五等边面为十二等面之一　面有五边在体之面则为五楞锥其一楞设一百一十【甲丙】半之五十五【乙丙】以甲丙为小分求其大分得一百七十八丙戊也【即丙丁壬丁壬戊丁角为丙中甲角之半与平圆十等边之一面等】半之八十九已丙也【即乙辛以丙巳乙为两腰等形辛巳乙亦两腰等形故辛乙与巳丙等丙巳乙形与元形丙戊甲形相似巳角即戊角而乙丙为小分乙巳或辛乙为大分】为内作小五等边之一边【乙辛】亦即十二等面从腰围平切之十等边面也
　　又以乙辛为小分求得大分一百四十四心乙也【分图辛心乙形即前图辛心乙形乙辛为心壬之小分心乙为大分乙心线即五等面一边折半处至体心之距丙防即五等面边两楞相凑之角　　　乙丙辛虚线形即前图乙丙辛形】为甲丙半楞【乙丙】之全分何则前图之丙巳乙形乙丙为小分丙巳为大分试于辛乙心形内【分图】作庚辛乙形与丙巳乙形等【庚乙即乙丙五等面一边之半乙辛庚辛即丙巳乙巳为小五边形之一边】则乙庚为小分乙辛为大分【心庚同】今又以乙辛为小分求其大分壬癸而壬癸即心乙也【乙癸同】夫心乙乃庚乙【小分】辛乙【大分即心庚】之并则乙心为庚乙之全分矣其比例心乙与心庚若心庚与庚乙而乙心即外切立圆半径也
　　右法杨作枚补
　　今求心中线为五等边最中一防【中】至体心【心】之距亦即内容浑员半径
　　先求乙中线为五等边各楞折半处至最中之距　法为甲乙比乙中若半径与五十四度之切线
　　一　半径　　　　　　一○○○○○
　　二　乙甲中角【五十四度】切线一三七六三八
　　三　半楞甲乙　　　　五十五
　　四　中乙　　　　　　七十五【七○】
　　用句股法以心乙【一百四十四】为中乙【七十五七】为句句各自乘相减得心中股幂平方开之得中高线【心中为容员半径】求得容员半径一百二十二半弱【心中】
　　又求甲心线为各角至体心之距【即外切浑员半径】　用句股法以甲乙【五五】为句心乙【一四四】为股并句股幂求甲心
　　求得外切圆半径一百五十四强【甲心】
　　十二等面根一一○【甲丙】
　　外切立员半径一四四【心乙】全径二八八○
　　内容浑员半径一二二半【心中】全径二四五【弱】
　　外切浑员半径一五四【甲心】全径三○八【强】
　　十二等面之分体并五楞锥并以五等边面为底原体之楞甲丙设一百一十半之乙甲五十五为小分求其全分乙心一百四十四【即外切立方半径】乙甲【五十五】自乘【三千○二十五】为句幂心乙【一百四十四】自乘【二万○七百三十六】为股幂并之得【二万三千七百六十一】平方开之得【一百五十四强】为自角至心之线甲心即外切员半径
　　作法　以五等面之一边为
　　底楞【甲丙】以外切员半径【角至心之】
　　【线】为两之楞【甲心及丙心】而防于心五边悉同则为十二分体之一如是十二枚则成十二等面体
　　变体数
　　求浑圆积
　　设浑圆径一○○○自乘得一○○○○○○又十一【古法】乘之得一一○○○○○○为实十四除之得○七八五七一四为平圆面幂或用旧径七围念二之比例亦得圆面七八五七一四以四因之得浑圆之幂三一四二八五六
　　置浑圆之幂以半径五○○因之得一五七一四二八○○○是为以浑圆面幂为底半径为高之圆柱形积置圆柱形积以三为法除之得五二三八○九三三三是为以浑圆面幂为底半径为高之圆角形积亦即浑圆之积
　　浑圆根一○○○体积五二三八○九三三三用为公积
　　立方
　　置公积即浑圆积【五二三八○九三三三】立方开之得立方根八○六二○二七一七是为与浑圆等积之立方
　　方锥
　　置公积【五二三八○九三三三】以三因之得数立方开之得高濶相等之方锥形根一一六二二四四四四七是为与浑圆等积之方锥
　　方
　　锥
　　圆柱
　　置公积【同上】十四因之十一除之为实立方开之得高濶相等之圆柱形根八七四二三九四二是为与浑圆之积之圆柱
　　【圆柱】
　　圆锥

　　置公积【同前】以三因之【变圆锥形积为圆柱积】再以十四因之十一除之为实【变圆柱积为立方积】立方开之得高濶相等之圆锥形根一二五九四七五九是为与浑圆等积之圆锥　或置积以四十二因之十一除之立方开之亦同
　　【圆锥】
　　按变体线本法有四等面八等面十二等面二十等面诸数表皆未及其同者惟有浑圆立方二形其余三形皆比例规解及测量全义之所未备今以法求之则皆长濶相等而不为浑圆立方者耳夫不为浑图立方而仍可以法求者以其长濶相等则仍为有法之形也然而与今西书所载合者二不合者一意者其传之有误耶或其所用非径七围二十二之率耶俟攷
　　浑圆以径求积
　　置径自乘又以半径乘之又四因之又以十一乘之以十四除之又以三除之见积

　　解曰平圆与平方之比例知其周与周假如七则方周二十八圆周二十二两率各折半为十四与十一　径自乗则为平方形以十一乗十四除则平方变为平圆矣以平圆为防半径乗之成圆柱形再以三归之成圆角形【即圆锥】浑圆面幂为防半径为髙之角形四倍大于此圆角形故又四因之即成浑积也
　　防法　径自乗以乗半径乃以四十四因四十二除见积　或径上立方形二十二因四十二除或用半数十一因二十二除见积并同
　　浑圆以积求径
　　置积以三因之四除之又以十四因之十一除之再加一倍立方开之得圆径
　　解曰圆积是圆角形四今三因之变为圆柱形四矣故用四除则成一圆柱此圆柱形是半径为髙全径之平圆为防今以十四乗十一除则变为全径之平方为防半径为髙矣故加一倍即成全径之立方
　　防法　积倍之以四十二因四十四除立方开之得圆径　或用本积以八十四乗四十四除立方开之　或用半数以四十二乘二十二除立方开之　或又折半以二十一乗乗十一除立方开之得积并同
　　按径七围二十二者乃祖冲之古法至今西人用之可见其立法之善虽异城有同情也虽其于真圆之数似尚有盈朒然所差在防忽之间而已吾及锡山杨昆生柘城孔林宗另有法其所得之周俱小于径七围二十二之率则其所得圆积亦必小于古率矣
　　杨法立圆径一○○○○积五二三八○九二五六四孔法立圆径一○○○○积五二三五九八七七五
　　约法
　　立方与立圆之比例若二十一与十一　平圆与外方若十一与十四　平圆与内方若十一与七
　　圆内容方之余【即四小弧矢形】若七与四圆外余方【即四角减弧矢】若十一与三准此则余圆【即小弧矢】与余方若四与三而小弧矢与其所减之余方角若一与七五亦若四与三也














　　厯算全书卷五十八
　　少广拾遗序
　　少广爲九章之一其开平方法爲薄海内外测量家所需非隶首不能作也平方而外有立方以爲凿筑土方之用课工作者犹能言之若三乗方以上知之者葢已尠矣尝见九章比类厯宗算会算法统宗俱载有开方作法本原之图而仅及五乗竝无算例同文算指稍变其图具七乗方算法而不适于用诠释不无譌误西镜録演其图爲十乗方而举数仅详平立三乗一式而已余皆未及康熙壬申余在都门有友人传逺问属询四乗方十乗方法葢诸乗方法独此二端不可以借用他法而问者及之窃喜朋侪中固自有留心学问之人遂稍取古图防绎发其指趣爲作十二乗方算例颇觉详明然后知今日所用开平方法廼算数家径捷之用而不及古图之简括精深也宣城梅文鼎


　　钦定四库全书
　　厯算全书卷五十九
　　宣城梅文鼎撰
　　少广拾遗
　　开方求亷率作法本原图
　　自开平方至开八乗方
　　古图附説









　　图最上书一者本数也本数者即大方也大方无隅无乘除之可言而数从此起也次并列【一一】者方邉也西法谓之根数即一十一也左一即本数因有次商而进位成一十为初商之根右单一为次商之根既有根数即有平幂故第三层　者幂积也西法谓之面即一百二十一也左一百为初商自乗之幂即大方积也右单一为次商自乗之幂即隅积也小平方也中二十则两亷积也并长方也
　　如图大小两方幂以
　　一角相聫必得两亷
　　以辅之而其方始全
　　故平方亷积二也
　　第四层　者立方积也西法谓之体积即一千三百三十一也左一千初商再乗之积大立方也右单一为次商再乗之积隅积也小立方也中三百三十皆亷积也三百为三平亷积扁立方也三十为三长亷积长立方也








　　如图析观之则初商大立方体与次商隅积小立方体相连于一角必得三平亷之扁立方体补于大立方之三面又有三长亷之长立方体补于小立方之三面及三平亷之隙而方体始全故立方之亷积有二等而其数各三也
　　第五层　者三乘方也即一万四千六百四十一也左一万者大三乗方也初商方积也右单一者小三乗方也次商隅积也大方积既以三乗之故而积陞至万小
　　【隅虽　　　　　三　　　　　乘】
　　【仍单一也其相隔已三位故必有第一亷为】【千数第二亷为百数第三亷为十数以补之其数始足其理亦如平方立方也三乘方以】【上不可为图诸书有强为之图者非也然其理则有可言者焉以其相生之序言之则皆】【加一筭法也初商次商如十与一而其幂则如百与一故于之下各加即成如十一之自】【乘也此平方率也又以十一乗之成即立方率也又以一十乗之成即三乗方率四乗】【以上凖此加之皆加一法　也曰若是则诸乗】【方皆以十一逓乗而得非十一者何以处之】【曰根非十一而其理皆如十与一何则凡増一乗积陞一等而亦増一亷亷与亷之积亦】【皆如十与一也幂幂旧名方法旧名上亷旧名下亷一一一一音觅周礼幂人掌共巾幂説文覆也开平方四邉俱等中函纵横之积亦如覆物之巾有经纬缕文故谓之幂亦谓之面同上省文也见张参五经文字书或小写】









　　亷率立成附説
　　凡开方一位除尽者无亷隅也亷隅皆生于次商次商之根必小于初商一等而其小隅之体必与初商之大方同状【如再乗之隅即小立方三乘方之隅即小三乘方】此可借初商表而降等求之不必更立隅法也亷法则不然每増一乗则亷増一等【如平方但有亷立方则有平亷长亷三乗方则有三种亷四乘方则有四种亷其亷之等并与其乘数同増】而亷亦加多【如平方只二亷立方则平亷长亷各三三乗方则三种亷共有十四乗以上则更増而多如图所列】此亷率所由立也
　　问亷既有等【如平方亷为十立方亷为十为百之类】而今亷率只作单数用何也曰此亷之数也非亷之积也亷积有等则既于其次序分之矣挨次乗之其等自见【如第一亷必小于初商大方一等第二亷又小一等其最末之亷必大于小隅一等各乗方皆如是】若同一等中应各有若干亷必先知之而后可用故立成中所列皆单数问古图以右为隅法其序自左而右今亷率之序自右而左何也曰既皆作单数用则左右一也今依笔算自右而左便于取用故也【亷法相生之序左右同数如立方平亷三长亷亦三也三乗方第一亷四第三亷亦四也其近大方有若干亷则其近小隅亦有若干亷故左右并同可以左为初商大方右为小隅亦可以右为大方而左为小隅此亦见古图之妙也】
　　问旧有方法亷法之目今防曰亷法何也曰开方法有方有亷有隅其初商自乗即方也次商自乗即隅也方与隅之间次商初商相乗而得者皆亷也旧以立方之平亷有似扁方故名之方法而三乗方因之遂又有上亷下亷之目故不如一切去之但以一二三四为序较画一耳
　　问平方之亷皆平幂也立方之平亷长亷皆体积也不知三乗方以上之亷积亦能与方隅并状乎曰凡诸乗方之亷积无不与方隅之乗数等也试以三乗方言之其第一亷有四皆初商之再乗积而又以次商根乗之是三乗也其第二亷有六皆初商自乗之平幂也而又以次商之平幂乗之第三亷有四皆初商之根数而又以次商之立积乗之皆三乗也又以四乗方言之其第一亷有五皆初商三乗积也又乗次商根是四乗也其第二亷有十皆初商再乗积也又以乗次商幂亦四乗也其第三亷亦十皆初商幂积也又以乗次商再乗积其第四防有五皆初商根也又以乗次商之三乗积皆四乗也五乗方以上俱如是观后算例自明




<子部,天文算法类,推步之属,历算全书,卷五十九>
<子部,天文算法类,推步之属,历算全书,卷五十九>










　　诸乗方根同而积不同本易知也惟根之一者积同为一似乎无别矣然有幂积之一有体积之一有三乗以上诸乗方之一虽曰积同为一其实不同也今以方根之为单一为一十为一百者为例如右


<子部,天文算法类,推步之属,历算全书,卷五十九>









　　因有续商故方根以十数见例方积以尾○定位无次商者去尾○用之则方根只为单数












　　多【如第一亷用初商立积二亷则初商幂逓减以至三亷则初商只用根】近小隅者次商乗之遍数多【如第一亷只用次商根第二亷则次商亦用幂三亷则逓加而用次商立积】各乗方皆如是






　　开诸乗方大法
　　诸乗方法惟平方为用最多因有専法今自平方立方推之三乗以上至于多乗而通为一法是为大法【诸乗方大法可以开平方而平方専法不可以开诸乗方】
　　总法　凡诸乗方皆先列实　次作防分段　次查表以定初商　次求亷隅以定续商
　　列实之法　依勿庵笔算作平行两直线以设积纪于右直线之右皆自上而下至单数止无单数者作○存其位
　　作防分段之法　皆于原积末位单数作一防起【凡减隅积必至单位故分段之法以此为宗同文算指但言起末位殊混】依各乗方宜以若干位为一段即隔若干位防之【或作实防丶或作虚防□俱可然虚防尤便以减商积时有借上位之防免凌杂也】如平方以每两位为一段则隔一位防之立方以三位为一段则隔两位防之乃至十二乗方以十三位为一段则隔十二位之并同一法
　　谨案作防分段其用有二一以定开方有若干次也如有一防则只开一次有两防则开二次三防则开三次之类一以定开方所得为何等数也如只有一防则初商即单数二防则初商是十数三防则初商是百数之类是故初商减积必至于最上防而止也次商减积必至于次防而止也每开一次必减积一次而所减之数必各尽于其作防之位亦可以验开方之无误也又最上防以上初商实也次以上次商实也每商皆以防位截实此法于初商尤为扼要
　　又案开方分段古人旧法之精钱塘吴信民九章比类山隂周述学厯宗算防悉着其説而同文算指西镜录本其意以作防定之施于笔算为极善也【鼎于三十年前见同文算指作防之法惊叹其竒后读诸书始知其有所祖述非西人创也】
　　初商之法　皆以最上一防截原积若干位为初商实乃查初商表视本乗方下数有与实相同或较小于
　　实者录之纪于左线之左【皆以表数末位对右线上原实最上纪之】是为初商应减之积　即于本表旁行查方根纪于左线之右【皆对所纪表数首位进一位纪之】是为初商数
　　以初商应减之积【左行所纪】与初商实【右行最上防所截原实】对位相减【皆以左减右须依笔算从小数减起如左行减数大右行实数反小而不及减则作防于上一位借十数减之】减不尽者为余实以待续商
　　凡原实有二则初商为十数而有次商有三防初商为百数而有次商及三商以上仿论如实只一防则初商即是单数无续商
　　次商之法　皆以第二截余实为次商实
　　凡初商皆为方积次商以后则有亷积隅积
　　先求亷率　查亷率立成本乗方亷率有若干等等有若干数平列之为若干行谓之定率【如平方只一种亷其定率二立方有二种亷曰平亷曰长亷其定率并三若三乗方则有三种亷曰一亷曰二亷曰三亷其定率曰四四六曰四详后式】每増一乗即亷増一等而定率増一行【有亷之等有亷之数如平方有二亷立方有三平亷三长亷此亷之数也平方之两亷同积共为一等立方之三平亷同积为一等三长亷同积为一等共为二等此亷之等也亷率中兼此二义】
　　求亷泛积　以各亷定率乗初商应有各数各依本乗方减小一等用之亷多者又递减挨次乗之至根数止是为泛积【有初商数即各带有自乗幂积二乗立积乃至三乗以上各积是为应有各数也今求泛积当依本乗方减小一等用之如平方只用根数立方用初商幂积乃至十二乗方用初商十一乗此为减小一等也至第二亷则立方用初商根三乗方用初商再乗乃至十二乗方用初商十乗此为亷多者二亷以上又逓减挨次乗之也逓减至初商根则为末后一亷矣故曰至根数止】
　　求防商数以泛积约余实得之
　　求亷定积　以各亷泛积乗次商数亷多者逓増一等挨次乗之至本乗方减小一等止是为定积【凡第一亷泛积皆乗次商根而得定积有第二亷则以次商自乗积乗之有三亷则以次商立方积乗之是为逓増一等也然增不得至本乗方但增至本乗方减小一等数即为末后一亷矣】
　　求隅积　以次商数查初商表各依本乗方取之【以次商对横行根数以本乗方对直行纵横相遇得之】列于亷积之后一行是为隅积【小隅体势并同初商大方如平方则隅即小平方立方则隅即小立方三乗方之隅亦为小三乗方四乗以上并同故可借初商表用之】
　　求亷隅共积　以所得各亷定积及隅积用并法并之即得
　　求次商定数　以所得亷隅共积纪左线之左【又在表数之左以末位对第二防纪之为次商应减之数】与次商实【右行第二防所截】对位相减【以左减右】减不尽者又为余实以待三商遂纪次商数于初商之下为次商定数　如亷隅共积大于次商实不及减则改次商至及减而止乃为次商定数
　　三商以后并同上法
　　不论三商四商乃至多商其亷定率不变但求泛积时三商则并初商次商两位商数合而用之四商则并前三次商数皆取其应有各数以乗定率而得泛积亦如上法之用初商　其求定积则三商即用三商之数四商即用四商之数以乗泛积而得定积亦如上法之用次商　余法并同次商
　　审○位之法　凡亷泛积大于余实或仅相等而无隅不能商一数是次商为○位也即纪○位于先商之次而并下一防余实为续商余实
　　次商单一之法　凡泛积与实仅同而有隅一是商得一数也即以泛积为定积不必更乗次商【惟单一则然若商得一十一百一千仍须如法乗之】














　　开平方【即一乗方】
　　设平方积三千三百四十四万三千○八十九问方根若干
　　答曰五千七百八十三
　　列实法【先作两直线次以方积三三四四三○八九列
　　右线之右】　作【法于实末位单数作一防起逆上每
　　隔一位防之有四防宜商四次初商是千】初商法曰
　　【用最上一防截原实两位三三为初商实查表有小于实三三】
　　【者是二五其方根五即以五为初商对实首上一位书于左线之右却以表数二五对实三三书左线之左与原实对减先于实次位减五实系三不足减作防借上一数为十三减去五余八改书八于实三之右次于实首减二原实是三因借下去一只得二减尽乃作线抹去三三存八以待次商亦于左作线抹去减数二五】
　　求次商　用第二防上余实八四四为次商实


　　隅　　　　　　　　　　次商自乗　四九○○○○
　　亷隅共积　　　并　　得　　　　七四九○○○○次商法曰【置亷率立成内定率二乗初商五千得一万为泛积乃约实作七百定为次商即以泛积乗之得定积七百万再用次商自乗为隅其积四十九万并定积成七百四十九万即亷隅共积也俱如式列之于是将次商七续书初商五之下又将共积七四九对实八四四书左线之左以减实余九五乃作线抹去八四四亦于左作线抹去七四九】
　　求三商　用第三防上余实九五三○为三商实


　　隅　　　　　　　　　三商自乗　　　　六四○○
　　亷隅共亷　　　并　　　得　　　　九一八四○○三商法曰【复置定率二以乗初商次商合数五千七百得一万一千四百为泛积乃约实作八十为三商即以泛积乗之得定积九十一万二千三商亦自乗为隅得积六千四百以并定积成九十一万八千四百为亷隅共积俱如式列之再将三商八十挨书次商七百之下而以其亷隅积九一八四对实九五三○书于左线之左去减实余三四六即改书之以待四商作线抹去九五三○左亦作线抺去九一八四】
　　求四商　用第四防上余实三四六八九为四商实


　　隅　　　　　　　　　　四商自乗　　　　　九
　　亷隅共积　　　并　　　得　　　　三四六八九四商法曰【用定率二乗初商次商三商合数五千七百八十得一万一千五百六十为泛积乃约实可商三定为四商即以泛积乗之得定积三万四千六百八十四商三自乘得九为隅积并定积成三万四千六百八十九是为亷隅共积各如式列讫再将四商三挨书于三商八十之下而以其亷隅积三四六八九对第四防实书于左线之左就以减四商实恰尽乃作线抹去之左减数亦抺去】初商五千　有四防故初商是千位
　　次商七百
　　三商八十
　　四商单三
　　凡开得平方根五七千百八十三
　　还原法　置方根五千七百八十三自乗得积三千三百四十四万三千○八十九合原积

　　开立方【即再乗方】
　　设立方积一千○○七万七千六百九十六尺问每面方若干
　　答曰二百一十六尺
　　依法列实　作防【自末位单数作一防起逆
　　上每隔两位防之有三防宜商三次】
　　求初商【用最上一防截原实两位一○为初商实查初
　　商表有小于一○者是○八其方根二即以二定为初商对实】
　　【首上一位书左线之右而以其积数○八对实一○书左线之左对减初商实余二改书之以待次商】初商二百尺【有三防初商是百】
　　求次商　用第二防上余实二○七七为次商实




　　依法求得次商一十尺【书于初商二百之下而以其亷隅共积一百二十六万一千减防商实余八一六改书之以待三商】
　　求三商　用第三防上余实八一六六九六为三商实


　　隅　　　　　三　商　再　乗　　　　　　二一六
　　亷隅共积　　　并　　得　　　　　八一六六九六依法求得三商六尺【续书次商一十之下而以亷隅共积八十一万六千六百九十六减三商实恰尽】
　　凡开得立方根二百一十六尺
　　还原　置方根【二百一十六尺】自之得【四万六千六百五十六尺】为平幂又置平幂以方根乗之得一千○○七万七千六百九十六合原数



　　开三乗方
　　设三乗方积一亿三千六百○四万八千八百九十六问方根若干
　　答曰一百○八
　　依法列实　作防【自末位单数作一防
　　起逆上每隔三位防之】
　　求初商　用最上一防截实
　　首位一为初商实
　　凡积一者其根亦一不必查表竟以一为初商【其积与实对减恰尽】
　　初商一百【有三防初商是百】
　　求次商　用第二防余实三六○四为次商实



　　隅　　　　次　　商　　三　　乗　　一○○○○
　　亷隅共积　　　并　　得　　　　　四六四一○○○○依法求得亷隅共积四千六百四十一万为次商一十之积大于次商实不及减是无次商也法于初商一百下书○
　　求三商　用第三防合上第二防余实三六○四八八九六共八位为三商实【三商减积至末位第三防故合八位为其实】凡求三商当合初商次商两数乗定率以求泛积今次商　故只用初商数



　　隅　　　三　商　自　乗　三　次　　　　　四○九六
　　亷隅共积　　　并　　得　　　　　三六○四八八九六依法求得三商八【续书次商○之下而以其亷隅共积三千六百○四万八千八百九十六与余实相减恰尽】
　　凡开得三乗方根一百○八
　　还原　置方根【一○八】自乗得【一一六六四】为平幂平幂又自乗得一亿三千六百○四万八千八百九十六合原积
　　或以方根一百○八自乗三次亦同
　　开方简法　置三乗方积【一三六○四八八九六】以平方法开之得【一一六六四】再置【一一六六四】以平方开之得方根一百○八合问









　　开四乗方
　　设四乗方积一十三亿五千○一十二万五千一百○七问方根若干
　　答曰六十七
　　依法列实　作【自末位单数作一防
　　起逆上每隔四位防之共两防宜商两次】
　　求初商　用最上一防截原
　　实一三五○一为初商实【查表有七】
　　【七七六小于实其根六即以六为初商而以其积七七七六对减初商实余五七二五改书之以待次商】初商六十【有两防初商是十】
　　求次商　用第二防上余实五七二五二五一○七为次商实




　　隅　　　　次　商　四　　乗　　　　　　　一八六○七
　　亷隅共积　　并　得　　　　　　　五七二五二五一○七依法求得次商七【书于初商六十之下而以亷隅共积五亿七千二百五十二万五千一百○七减次商实】　凡开得四乗方根六十七
　　还原　置方根【恰尽六】自乗四次得积一十三亿五千○一十二万五千一百○七合原数










　　开五乗方
　　设五乗方积一兆七千五百九十六万二千八百七十八亿○一百万问方根若干
　　答曰五百一十
　　列实【数以单位
　　为根今原积尾位是
　　百万故补六○列之】作防【自末单位】
　　【○上作一防起逆上每隔五位防之】　求初商【用最上一截原实五位一七五九六为初商实入表得五为初商对实首上一位录左线右即以其积数对实列左线左相减余一九七一改书之以待次商】　初商求到五百【有三防故初商是百】
　　求次商【用第二防上余实一九七一二八七八○一为次商实】











　　隅　　　　次　　　商　　五　　乗　　　　一○○○○○○亷隅共积　　并　　得　　一九七一二八七八○一○○○○○○依法求得次商一十【书初商五百之下再将亷隅共积一千九百七十一万二千七百七十八亿○一百万去减次商实恰尽】
　　原实三宜有三商而次商已减实尽无可商作○于次商下
　　凡开得五乗方根五百一十○
　　还原　置方根【五百一十○】自乗五次复得一兆七千五百九十六万二千八百七十八亿○一百万合原积
　　开六乗方
　　设六乗方积三百四十三亿五千九百七十三万八千三百六十八问方根若干
　　答曰三十二
　　依法列实　作防【自末位单数作
　　防起逆上每隔六位防之共两防宜商两次】求初商　用最上截原
　　实三四三五为初商实【查表】
　　【得三为初商书左线右而以其积数二一八七书左线之左对减初商实余一二四八改书以待续续商】初商三十【有两防故初商是十】
　　求次商　用第二防上余实【一二四八九七三八三六八】为次商实






　　隅　　　次　　商　　六　　乗　　　　　　　　　一二八
　　亷隅共积　　并　　　得　　　　一二四八九七三八三六八依法求得次商二【书初商三十之下再以亷隅共积与次商实对减】
　　凡开得六乗方根三十二
　　还原　置方根【恰尽三】自乗六次得积【十二三四三五九七三八三】合原数









　　开七乗方
　　设七乗方积一千一百○○亿七千五百三十一万四千一百七十六问方根若干
　　答曰二十四
　　依法列实　作【自末位单
　　数作防起逆上每隔七位再作一防】求初商　用最上防截
　　原实一一○○为初商
　　实【查表得二为初商即以二书左线之右而以其积二五六书左线之左对减初商实余八四四改书之以待续商】
　　初商二十【有两防初商是十】
　　求次商　用第二防上余实【八四四七五三一四一七六】为次商实








　　亷隅共积　　并　　　　得　　　　八四四七五三一四一七六依法求得次商四【书初商二十之下再将亷隅共积八四四七五三一四一七六与次商实对减恰尽】
　　凡开得七乗方根二十四
　　还原　置方根【二十四】自乗七次复得【一一○○七五三一四一七六】合原数
　　或以根【二十四】自乗得【五百七十六】为平幂平幂又自乗得【三十三万一千七百七十六】为三乗方积三乗方积又自乗得【一一○○七五三一四一七六】亦合原数
　　开方简法　置设积【一一○○七五三一四一七六】以平方法开之得【三三一七七六】又置为实以三乗方法开之得方根二十四
　　或置设积【一一○○七五三一四一七六】用平方法连开三次亦得方根二十四













　　开八乗方
　　设八乗方积一千六百二十八万四千一百三十五亿九千七百九十一万○四百四十九问方根答曰四十九
　　列实【法同前】作防【自末位单数作
　　防起逆上每隔八位防之】求初商【用最上一】
　　【防截原实一六二八四一三为初商实查表得八乗方积二六二一四四其根四即以四定为初商书左线右而以其积数书左线左对减初商实余一三六六二六九以待次商】
　　初商四十【有两防初商是十】
　　求次商　用第二防上余实【一三六六二六九五九七九一○四四九】为次商实

















　　隅　　　次　　　商　　　八　　乗　　三八七四二○四八九亷隅共积　并　　　得　一三六六二六九五九七九一○四四九依法求得次商九【书初商四十之下再将亷隅共积对减次商实恰尽】
　　凡开得八乗方根四十九
　　还原　置方根【四十四】自乗八次复得【一六二八四一三五九七九一○四四九】合原积












　　开九乗方
　　设九乗方积八十三兆九千二百九十九万三千六百五十八亿六千八百三十四万○二百二十四问方根若干
　　答曰六十二
　　列实【法同前】作【自末位单数作
　　起逆上每隔九位之】
　　求初商【如法用最上一原积八位截为初商实查表得九乗方根六即以六为初商而以其积数六○四六六一七六减初商实余二三四六三七六○待续商各如法书之】
　　初商六十【冇两初商是十】
　　求次商　用第二上余实二三四六三七六○五八六八三四○二二四为次商实


















　　隅　　　　　　　次商九乗　　　　　一○二四
　　亷隅共积　　　　　并得　　二三四六三七六○五八六八三四○二二四依法求到次商二【书于初商六十之下乃以其亷隅共积二十三兆四千六百三十七万六千○五十八亿六千八百三十四万○二百二十四减次商实恰尽】
　　凡开得九乗方根六十二
　　又法　置九乗方积【八三九二九九三六五八六八三四○二二四】以平方法开之得【九一六一三二八三二】为四乗方积　再以四乗方法开之得方根【六十二】
　　或置九乗方积【八三九二九九三六五八六八三四○二二四】以四乗方开之得【八三四四】再以平方开之得方根【六十二】并同
　　还原　以方根【六十二】自乗九次得原积
　　或以原根【六十二】自乗四次得【九一六一三二八三二】为四乗方积再以四乗积四乗得原积亦同




　　开十乗方
　　设十乗方积七千四百三十○亿○八百三十七万○六百八十八问方根
　　答曰一十二
　　依法列实　作防【自末位单
　　数作一防起逆上每隔十位再作一防】求初商【用最上防截实首位七为初商
　　实查表得十乗方根一定为初商即以其积一】
　　【减初商实七余六改书之以待续商】
　　初商一十【有二防初商是十】
　　求次商　用第二防上余实六四三○○八三七○六八八为实




<子部,天文算法类,推步之属,历算全书,卷五十九>
　　隅　　　　次　商　十　　乗　　　　二○四八
　　亷隅共积　　并　得　　　　六四三○○八三七○六八八依法求得次商二【书初商一十之下再将亷隅共积减次商实恰尽】
　　还原　置方根【一十二】自乗十次复得七千四百三十○亿○八百三十七万○六百八十八合原积又法　置方根【一十二】自乗【一四四】为平幂平幂自乗【二○七三六】为三乗方积三乗方又自乗得【四二九九八一六九六】为七乗方积再以根再乗之立积【一七二八】乗之得十乗方积







　　开十一乗方
　　设十一乗方积七千三百五十五万八千二百七十五亿一千一百三十八万六千六百四十一问方根若干
　　答曰二十一
　　列实【法同前】作防【自末位单数作防起
　　逆上每隔十一位防之】
　　求初商　用最上一防截实七三五五为初商实查表得十一乗方根二定为初商【以其积四○九六对减初商实余三二五九以俟续商皆各如法书之】
　　初商二十【有二防初商是十】
　　求初商　用第二防上余实【三二五九八二七五一一三八六六四一】为次商实












　　亷隅共积　　并　得　　　　三二五九八二七五一一三八六六四一依法求得次商一【书初商二十之下其亷隅共积三千二百五十九万八千二百七十五亿一千一百三十八万六千六百四十一减余实恰尽】
　　凡开得十一乗方根二十一
　　还原　用方根【二十一】自乗十一次复得原积
　　又法　置方根自乗再乗得【九二六一】为立方积立方积自乗得【八五七六六一二一】为五乗方积五乗方积又自乗得十一乗方原积
　　开方简法　置设积【七三五五八二七五一一三八六六四一】以平方法开之得五乗方积【八五七六六一二一】又置为实以五乗方法开之得根二十一











　　开十二乗方
　　设十二乗方积一十五兆四千四百七十二万三千七百七十七亿三千九百一十一万九千四百六十一问方根若干




　　依法列实　作防【自末位单数作防起逆上隔十二位防之】
　　求初商　用最上一防截原实一五四四七为初商实查表得十二乗积【八一九二】其方根二即以二定为初商【其积数与实对减余七二五五再俟续商】
　　求初商　用第二防上余实七二五五三三七七七三九一一九四六一为次商实













　　亷隅共积　　　并　　得　　七二五五二三七七七三九一一九四六一依法求得次商一【书于初商二十之下再将亷隅共积七兆二千五百五十二万三千七百七十七亿三千九百一十一万九千四百有六十一以减余实恰尽】
　　凡开得十二乗方根二十一
　　还原　置方根二十一自乗十二次复得原积或以方根【二十一】自乗得【四四一】再乗得【九二六一】三乗得【一九四四八一】为三乗方积即以三乗方积自乗得【三七八二二八五九三六一】再自乗得【七三五五八二七五一一三八六六四一】为十一乗方积又置为实而以方根【二十一】乗之得十二乗原积又法　以方根自乗再乗得【九二六一】为立方积就以立方积自乗三次得【七三五五八二七五一一三八六六四一】为十一乗方积如前再以方根乗之亦得原积
　　又法　以根【二十一】自乗之平方【四四一】为法自乗四次得九乗方积【一六六七九八八○九七八二○一】再以根【二十一】再乗之立方【九二六一】乗之得十二乗原积并同






　　论诸乗方简法
　　凡开平方二次即三乗方也是为方之方开平方立方各一次五乗方也可名为立方之平方亦可名为平方之立方
　　开平方三次七乗方也或三乗方平方各开一次亦同可名为平方之三乗亦可名为三乗方之平方
　　开立方二次八乗方也可名为立方之立方
　　开四乗方平方各一次九乗方也可名为四乗方之平方
　　开平方二次立方一次十一乗方也或三乗方立方各一次亦同可名为三乗方之立方亦可名为立方之三乗方
　　按惟四乗方六乗方十乗方不能借用他法同文算指谓四乗方开二次为六乗方又谓四乗方开三次为十乗方非也且四乗方平方各一次已为九乗方矣安得有开四乗方二次而反为六乗开四乗方三次而止为十乗乎必不然矣















　　演诸乗方逓増通法
　　平方积自乗为三乗方　立方积自乗为五乗方　三乗方积自乗为七乗方　四乗方积自乗为九乗方五乗方积自乗为十一乗方　六乗方积自乗为十三乗方　七乗方积自乗为十五乗方　八乗方积自乗为十七乗方　九乗方积自乗为十九乗方　十乗方积自乗为二十一乗方　十一乗方积自乗为二十三乗方　十二乗方积自乗为二十五乗方　十三乗方积自乗为二十七乗方　十四乗方积自乗为二十九乗方　十五乗方积自乗为三十一乗方【以上并超两位】平方积再自乗为五乗方　立方积再乗为八乗方三乗方积再乗为十一乗方　四乗方积再乗为十四乗方　五乗方积再乗为十七乗方　六乗方积再乗为二十乗方　七乗方积再乗为二十三乗方　八乗方积再乗为二十六乗方　九乗方积再乗为二十九乗　十乗方积再乗为三十二乗方【以上并超三位】
　　平方积自乗三次为七乗方　立方积自乗三次为十一乗方　三乗方积自乗三次为十五乗方　四乗方积自乗三次为十九乗方　五乗方积自乗三次为二十三乗方　六乗方积自乗三次为二十七乗方　七乗方积自乗三次为三十一乗方【以上并超四位】
　　平方积四乗为九乗方　立方积四乗为十四乗方三乗方积四乗为十九乗方　四乗方积四乗为二十四乗方　五乗方积四乗为二十九乗方【以上并超五位】平方积五乗为十一乗方　立方积五乗为十七乗方三乗方积五乗为二十三乗方　四乗方积五乗为
　　五十九乗方【以上并超六位】
　　平方积六乗为十三乗方　立方积六乗为二十乗方三乗方积六乗为二十七乗方　四乗方积六乗为
　　三十四乗方【以上并超七位】
　　平方积七乗为十五乗方　立方积七乗为二十三乗方　三乗方积七乗为三十一乗方【以上并超八位】
　　平方积八乗为十七乗方　立方积八乗为二十六乗方　三乗方积八乗为三十五乗方【以上并超九位】
　　平方积九乗为十九乗方　立方积九乗为二十九乗方【以上并超十位】












　　【平方至十二乗方已有初商表其十三乗以后不及详列推以根之为二为三者演之至三十二乗以见其意】
　　根二【至三十二乗则有十位】　　　　根三【至三十二乗则有十六位】
　　【十三乗】　　　　　一六三八四　　　　　　四七八二九六九
　　【十四乗】　　　　　三二七六八　　　　　　一四三四八九○七
　　【十五乗】　　　　　六五五三六　　　　　　四三○四六七二一
　　【十六乗】　　　　一三一○七二　　　　　一二九一四○一六三
　　【十七乗】　　　　二六二一四四　　　　　三八七四二○四八九
　　【十八乗】　　　　　五二四二八八　　　　　一一六二二六一四六七
　　【十九乗】　　　　一○四八五七六　　　　　三四八六七八四四○一
　　【二十乗】　　　　二○九七一五二　　　　一○四六○三五三二○三
　　【二十一乗】　　　四一九四三○四　　　　三一三八一○五九六○九
　　【二十二乗】　　　八三八八六○八　　　　九四一四三一七八八二七【二十三乗】　　一六七七七二一六　　　二八二四二九五三六四八一【二十四乗】　　三三五五四四三二　　　八四七二八八六○九四四三【二十五乗】　　六七一○八八六四　　二五四一八六五八二八三二九
　　【二十六乗】　　一三四二一七七二八　　　　七六二五五九七四八四九八七【二十七乗】　　二六八四三五四五六　　　二二八七六七九二四五四九六一【二十八乗】　　五三六八七○九一二　　　六八六三○三七七三六四八八三【二十九乗】　一○七三七四一八二四　　二○五八九一一三二○九四六四九【三十乗】　　二一四七四八三六四八　　六一七六七三三九六二八三九四七【三十一乗】　四二九四九六七二九六　一八五三○二○一八八八五一八四一【三十二乗】　八五八九九三四五九二　五五五九○六○五六六五五五五二三









　　附开多乗方求次商防法
　　列实作防截实求初商如常法既得初商减一等自乗为亷积【加五乗方则用四乗】又以本乗方数加一为亷数【如五乗方则用六】亷数乗亷积得数为法以除余实为次商遂合初商次商数依本乗方数乗之【如五乗方亦自乗五次】得积合原数定所得为方根【如原积数少不及减则改次商及减而止】
　　假如三乗方积五百七十六万四千八百○一问方根若干
　　答曰四十九
　　如法于初商表取三乗方积二五六
　　减原实定初商为四十余实【三二○四八○
　　一】为次商实　法置初商四○自乗
　　再乗得【六四○○○】为亷积【本方三乗故亷积用再乗为减一等】又以四为亷数【三乗方故用四为亷数为加一数】亷数乗亷积得【二五六○○○】为法以除次商实得九为次商【得数可进一十因欲存第二亷以下亷隅积数不得满除只商作九数待酌】遂合初商次商共四十九依法自乗得【二四○一】又以【二四○一】自乗得【五七六四八○一】以较原实相同减尽即定四十九为三乗方根













　　厯算全书卷五十九
<子部,天文算法类,推步之属,历算全书>
　　钦定四库全书
　　厯算全书卷六十
　　宣城梅文鼎撰
　　壍堵测量二
　　总论
　　堑堵测量者句股法也以西术言之则立三角法也古九章以立方斜剖成堑堵其两端皆句股再剖之则成锥体而四面皆句股矣任以锥体之一面平寘为底则其鋭上指环而视之皆成立面之句股而各有三角三边故谓之立三角也
　　立三角之法以测体积方圆斜侧靡所不通其测浑圆之弧度则有二理其一用视法如弧三角所诠用三角三弧之正切线移于平面【谓浑圆立剖之平面】即成三层句股相似之比例今谓之浑圆容立三角也其一不用视法而用实数如句股锥形等法用三弧三角之割线余各于其平面自成相似之句股以为比例【三弧直剖至浑圆之心即各成句股形之面】今谓之堑堵测量也【浑圆内容之立三角亦堑堵之分形而堑堵测量所测亦浑圆之度因书匪一时所为而意各有属其名遂别二而一一而二者也】
　　以上通论立三角及堑堵测量命名之意并其同异之处【因立三角有堑堵之名因浑圆内三层句股生堑堵之用故存此二者以为堑堵测量基本】
　　凡数之可算者皆可作图以明之故浑圆可变为平圆如古者葢天之图是也数之可算可图者皆可制器以象之故浑圆可剖为锥体堑堵测量之仪器是也凡测算之器至今日大备且益精益简古者浑仪经纬相结为仪三重至郭太史之简仪立运仪则一环而已足今则更省之为象限仪是益简益精之效也至于浑象无与于测而有资于算所以证理也西法之简平浑葢以平写浑亦可谓工巧之至独未有器以证八线夫用句股以算浑圆其法莫便于八线然八线之在平圆者可以图明在浑圆者难以笔显【鼎】葢尝深思其故而见浑圆中诸线犁然有合于古人堑堵之法乃以坚楮肖之为径寸之仪而三弧三角各线所成之句股了了分明省笔舌之烦以象相告于作圆布算不无小补而又非若浑象之难成因名之曰堑堵测量从其质也堑堵形析浑象之一体亦如象限仪割浑仪之一隅环而测之则象限即浑仪之全周也周徧析之则堑堵即浑象之全体也是故堑堵形可析为两可合为一其析者一为句股锥【亦曰立三角仪】则起二分讫二至一为句股方锥【亦曰方直仪】则起二至讫二分起二分者西率起二至者古率也是两者九十度中皆可为之【自分讫至九十度并可为句股锥自至讫分九十度并可为句股方锥】然至半象以上割切三线太长溢出于方堑堵之外故又有互用之法也其合者近分度用句股锥近至度用句股方锥以黄道四十七度赤道四十五度为限过此者互用其余如是则两锥形合之成方堑堵矣
　　方堑堵内又成圆堑堵二其一下为赤道圆象限而一为撱形之象限距度之割切二线所成也其一下为撱形象限而上为黄道之圆象限距度正黄道半径所成也【两圆堑堵之用已括于两锥形内】两圆堑堵内又以黄道正距度正成小方堑堵之象则郭太史圆容方直本法也于是又有圆容方直仪简法而立三角之仪遂有三式【一句股锥其形四鋭一方直仪其底长方一圆容方直简法仪其底为浑圆幂之分】
　　之三者或兼用割切或专用正而并不用角合浑圆内三层句股观之可以明立法之根
　　以上论堑堵测量仪器【句股锥形及句股方锥形二种为堑堵测量正用而圆容方直形专用正成小堑堵尤正用中之正用也此小堑堵在两重圆堑堵内故兼论之又此小堑堵足阐授时弧矢之秘因遂以郭法附焉】
　　问八线生于角用八线而不用角何也曰角与弧相应故用角即用弧也用弧即用角也明于斯理而后可以用角浑圆内三层句股是也明于斯理而后可以不用角堑堵三仪是也用角者西法也而用角即用弧则通于古法也不用角者古法也而用弧即用角则通于西法也于是而古法西法可以观其防通息其烦喙矣
　　以上论角即弧解之理















　　立三角法序
　　立三角者量体之法也西学以几何原本言度数而所译六卷之书止于测面其测体法则未之及葢难之也余尝以句股法释几何而稍为推广其用谓之几何补编亦曰立三角法本为体积而设然其中义类颇有与浑圆弧度之法相通者故摘録之以明堑堵测量之理










　　立三角法摘録
　　总论
　　一立三角为有法之形
　　立三角之面皆平三角也平三角不拘斜正皆为有法之形故立三角亦不拘斜正而皆为有法之形


　　一立三角为量体之宻率
　　凡量体者必析之析之成立三角形则可以知其容积可得而量矣若不可以立三角析者则为无法之形不可以量
　　一立三角即锥体
　　立三角任以一面平安如底则余三面皆斜立【亦有一面正立者】而鋭必在上即成三角立锥
　　一各种锥体皆立三角之合形
　　凡锥体必上尖下濶任取其一面观之皆斜立之平三角也凡锥形自其尖切至底则其中剖之立面亦平三角也锥体之底或四边五边以至多边若以对角线分其底又即皆成平三角也故四棱锥可分为两五棱锥可分为三六棱以上无不可分分之皆立三角形故知一切锥体皆立三角之合形也


　　底之边多至于三百六十又析之为分为秒以此为底皆可成锥体再析之至于无数即成平员底可作员锥要之皆小平三角面无数以成之者也


　　一各种有法之形亦皆立三角之合形
　　如立方体依其棱剖至心成立分体皆扁方锥其斜面辏心皆成立三角长方体亦然
　　四等面体从其棱剖至心成四分体八等面则成八分体二十等面成二十分体皆立三角锥


　　十二等面依棱剖至心成十二分体皆五棱锥其立面五皆立三角


　　浑员形以浑员面幂为底半径为髙作大员锥而成浑积凖前论皆无数立三角所成然则浑员亦立三角也
　　浑员既为立三角所成则半之而为半浑员【一平员面一半浑员面如员中剖】或再分之而为一象限或更小于象限之浑员【细分弧面自象限以内至于一度内若干分秒如剖橘瓤并一弧面两半平员面】以浑员之理通之皆立三角所成
　　一无法之形有面有棱即皆为立三角所成
　　凖前论各依其楞线割之至底或依对角线斜剖之即皆成立三角而无法之形皆可为有法之形
　　一立三角体之形不一而皆有三角三边
　　非四面不能成体故立三角必四面非三角三边不能成面故立三角体之面皆三角三边
　　约举其类有四面相等者即四等面形也【其面幂等其棱之长短亦等】
　　有三面相等而一面不等者其不等之一面必三边俱等余三棱则自相等

　　【以上皆形也四等面任以一面为底其雉尖正立居中三等面形以等边之一面为底锥尖亦正立居中】有二面两两相等者

　　有二面相等余二面不等者

　　有四面各不相等者

　　有三面非句股而一面成句股者有两面成句股者【其句股或等或否】
　　有四面并句股者句股立锥也
　　【以上不皆正形而皆为有法之形】
　　一立三角形有实体有虚体
　　实者如台如墖如堤虚者如井如池又如隔水测物皆自其物之平面角作直线至人目即成虚立锥体以人目为其顶鋭而所测平面则其底也所作直线皆为其棱若所测平面为四边五边以上皆可作对角线分为立三角锥形【虚体实体并同一法】
　　立三角又有三平面一弧面者如自地心作三直线至星宿所居之度则此三星之相距皆弧度也三弧度为边即成弧三角形以为之底其三直线皆大员半径以为之棱而合于地心以为之顶鋭亦立三角之虚形【即弧三角锥体】
　　若于浑球体作三大圏相交成弧三角形从三角作直线至员心依此析之即成实体与上法并同一理
　　一立三角形有立有眠有倒有倚立者以底平安则其鋭尖上指如人之立
　　眠者以底侧立如堵墙而锥形反横如人之眠此惟正形之锥则有之【既定一面为底则底在下者为立在旁者为眠】如虚形则不拘正斜皆以所测为底
　　又如弧三角锥以浑员面上所成之弧三角为底以三直线辏于浑体之心为其顶鋭则四面八方皆可为底而鋭常在心不特能眠能立亦且能倒能欹【亦惟有底有鋭之正形则然若他形底无定名随人所置】眠体倒体以及他形之欹侧不同而皆为有法之形者三角故也


　　一古法有壍堵阳马鳖臑刍甍等法皆可以立三角处之【壍堵一作堑堵】
　　凡立方体从其面之一棱依对角斜线剖至其底相对之一棱则其积平分而成壍堵形
　　【甲乙为顶有袤无广丙丁戊己为方底或长方则丙丁同巳戊为袤丁己仝丙戊为广乙丙同甲丁为其髙甲丁乙丙为立面甲乙戊己为斜面皆长方乙丙戊同甲丁巳为两端立面皆句股形而相对相等】
　　【壍堵形有如屋者甲乙顶袤如屋脊甲乙丙丁及甲乙戊巳两长方皆斜面而相等丙丁戊己为底乙丙戊与甲巳丁两圭形相对而等而以乙辛为其髙其辛丙及辛戊俱平分而等】
　　【又或甲乙顶袤不居正中而近一边然甲乙与丁丙及巳戊俱平行而等其甲丁乙丙及甲巳乙戊两斜面虽有大小而并为长方形乙辛垂线不能分丙辛及辛戊为平分而必与丙戊底为十字正角则乙辛为正髙】
　　以上三者皆壍堵之正形并以髙乘底折半见积何也皆立方之半体其两端皆立三角形也【第一形两端为句股第二第三皆以乙辛中剖成两句股】
　　凡壍堵形亦可立可眠立者以甲乙为顶长丙丁戊己为底眠者以戊己为顶长反以甲乙丙丁为底如隔水测悬崖之类
　　【又有斜壍堵形其各线不必平行底不必正方但俱直线则底与两斜面皆可作对角线以分为三角形而诸数可测实体虚体并有之于测量之用尤多】
　　斜壍堵本为无法之形而亦能为有法之形者可析之成三角也
　　凡壍堵形从顶上一角依对角线斜剖之为两则成一立方锥一句股锥
　　【堑堵形从乙角作乙巳乙丁两对角线依线剖之则成两形】

　　【立方锥一　　　　句股锥一】
　　【名阳马　　　　　名鳖臑】
　　阳马形【以丙丁戊己方形为底以乙为顶鋭而偏居一角故乙丙直立如垂线以为之髙其四立面皆成句股形故又名句股立方锥】
　　论曰阳马形从壍堵第一正形而分故其髙线直立于一隅乃立方之楞线四面句股形因此而成是为句股方锥之正体若斜壍堵等形之分形则但可为斜立方锥而不得为句股方锥亦非阳马
　　【斜立方锥者其顶不居正中然又不能正立一隅故非句股立锥而但为斜立方锥如上二形顶既偏侧底亦非方亦斜立锥形也然其立面皆三角故亦为有法之形斜立方锥亦可立可眠皆可以立三角法御之但不如句股立方锥之有一定比例】
　　鳖臑形【以甲乙为上袤而无广以丁巳为下广而无袤故称鳖臑象形也其各面或句股或不为句股而皆三角故又名三角锥】
　　句股立锥形【其上有袤而无广下有广而无袤并同鳖臑所异者甲角正方故乙甲丁立面乙甲巳斜面并成句股又丁角正方故甲丁已平面乙丁巳斜面并成句股又丁角正方故甲丁巳平面乙丁巳斜面并成句股是四面皆句股也故谓之句股方锥而不得仅名鳖臑】
　　论曰鳖臑中有句股立锥犹斜立方锥中之有句股方雉也立三角皆有法之形而此二者尤可以明测量比例之理
　　又论曰立三角所以为有法形者谓其可施八线也而八线原为句股之比例此二者既通体皆句股所成故在有法形中尤为有法矣
　　又论曰若于句股方锥再剖之即又成二句股锥而皆等积故阳马为立方三之一句股锥则为六之一皆立方之分体也
　　又论曰句股方锥及句股锥皆生于堑堵故堑堵形为测量之纲要
　　【刍薨形亦如屋而两端渐杀故顶窄而底寛其丙丁戊己底或正方或长方甲乙顶小于丙丁或居正中或稍偏然皆与丙丁及戊己平行】
　　刍甍葢取草屋之象乃壍堵形之一种亦可分为三鳖臑




　　又有刍童者形如方台皆立方之变体方台面与底俱正方蒭童则长方而面小底大则同亦皆可分为立三角


　　凖前论方台作对角线并可为两刍甍即可再分为六鳖臑即皆立三角锥也
　　论曰量面者必始于三角量体者必始于鳖臑皆有法之形也量面者析之至三角而止再析之仍三角耳量体者析之至鳖臑而止再析之仍鳖臑耳面之可以析为三角者即为有法之面体之可以析之为鳖臑者即为有法之体葢鳖臑即立三角之异名也量体者必以立三角非是则不可得而量
　　算法
　　凡算立三角体须求其正髙以正髙乘底以三而一见积其法有三其一顶居一角其棱直立即用为正髙其二顶鋭不居一角而在三角之间其三顶斜出底三边之外并以法求其垂线为正髙
　　假如巳甲乙丙立三角体甲乙丙为底已为顶鋭正居丙角之上巳丙如垂线为髙先以乙丙五十六尺甲乙边【六十一尺】甲丙边【七十五尺】求
　　其羃积【一千六百三十尺】以乘已丙髙【四十尺】得【六万七千二百尺】为实以三为法除之得【二万二千四百尺】为立三角锥体若欲知已乙甲已两斜依句股求即得【已丙既直立则恒为股以股自乘幂加乙丙句幂为幂开方得已乙又以股幂加甲丙句幂为幂开方得甲乙】若已顶不居一角而在三角之中则已丙非正髙乃斜棱也法当分为两形其法依丙已棱直剖至底
　　以上二形乃中剖为二之象其中剖之立
　　面亦成丁已丙三角形如平三角法求得已戊垂线即为正髙如上法先求甲乙丙羃以乘已戊髙得数为实三除见积
　　又法不必剖形但于形外任依一楞如丙已于庚作垂线至丙以法取庚防与已顶平行即庚丙为正髙与己戊等【或量得庚已横距为句以己丙为求其股即得庚丙正髙亦同】
　　立三角之顶有斜出者或在底外则于已顶作垂线至庚与甲乙丙底平行乃任用相近一棱如己乙为量庚乙之距为句依法求其股得己庚为其正髙以乘底三除见积
　　问己顶既居形外己庚何以得为正髙也曰此易知也但补作甲庚虚线成四边形为底则为四棱立锥而己庚为其正髙甲乙丙底乃其底之分也亦必以己庚为正髙矣
　　假如乙庚丙甲为底丙甲与乙庚等丙乙与甲庚等或斜方或正方其己庚一棱正立如垂则即为正髙正髙乘方底三除之即体积也若从甲乙对角线分其底为均
　　半又依甲己甲乙二棱从顶直剖之至底则分为两三角形而各得其积之半矣【底既平分为两则其积亦平分为两】其己庚乙甲形与己甲乙丙形既皆半积则相等而庚乙甲底与甲乙丙底又等则其髙亦等而己庚乙甲形既以己庚为髙矣则己甲乙丙形之髙非己庚而何又论曰量体积者必先知面犹量面幂者必先知线也然则量体者亦先知线矣是故量体之法可转用之以求线也【量体者有先知之面幂有求而得之面幂夫求之而得面者必先求其面幂之界界即线也故量体之法可用之以求线也】何谓以量体之法求线曰测量是也前论立三角有虚体为测量之用夫虚体者无体者无体而有线如实体之有棱故可以量体之法求之也如所测之物有三防即成三边三角当以三直线测之则立三角锥形矣所测有四防当以四直线测之则四棱立锥形矣两测则又为堑堵形矣故测量之法可以求线也
　　又论曰用立三角以量体者所用者仍平三角也而用三角以量面者所用者仍句股也吾防是而知圣人立法之精深广大


　　浑圜内容立三角体法
　　全形为堑堵
　　分形为鼈臑即立三角体又为句股
　　立锥西法所用
　　若内切小堑堵则为圜容方直形即
　　郭太史弧矢法
　　先解全形　堑堵体
　　亢戊乙夘为堑堵斜面　其形长方
　　夘乙为浑圜半径【夘为浑圜之心】亢戊为四十五度切线与夘乙同度同为横边　亢夘为乙角割线与戊乙同度同为直边
　　亢氐戊丁为堑堵立面　其形横长方
　　亢氐者乙角切线也与戊丁同度以为之髙　亢戊及氐丁皆四十五度切线与半径同度以为之濶
　　亢氐夘戊丁乙皆堑堵两和之墙　其形皆立句股氐夘同丁乙皆半径为句　亢氐同戊丁皆乙角切线为股　亢夘同戊乙皆乙角割线为
　　夘乙丁氐为堑堵之底　其形正方
　　夘乙及夘氐皆浑圜半径其对边悉同
　　法曰先为立方体以容浑球使北极在上南极在下皆正切于立方底葢之中心则赤道平安而赤道之二分二至亦皆在立方四面之中心矣
　　次依赤道横剖方体为均半而用其上半为半立方容半浑圜形则二分二至皆在半立方之底线各中心而赤道全圈居其底
　　次依二分二至从北极十字剖之又成四小立方各得原立方八之一而小立方内各容浑圜分体八之一此小立方有一角之楞直立为北极之轴上为北极下即浑圜心夘角也其立方根皆浑圜半径
　　次依黄赤道大距取切线为髙作横线于小立方夏至之一边即亢戊线
　　次依亢戊横线斜剖至对边之足则成堑堵矣【对边之足即夘乙也本为黄赤道半径今在小立方体为方底之边故云足也】
　　堑堵体有五面　其一斜面【亢戊乙夘长方】　其三立面【一亢氐戊丁长方二亢氐夘戊丁乙相等两句股】　其一方底【夘乙氐丁平方】





　　堑堵形面　有赤道象弧在方底　有黄赤大距弧在立句股边　即两和之墙
　　底形　　　　　底形正方　其夘角即黄赤道心
　　氐甲乙为赤道一象限　乙为春分
　　氐为夏至赤道　夘氐及夘乙皆
　　赤道半径　其对边氐丁及乙丁皆
　　四十五度切线

　　立句股面形一　　立句股之面有二【一亢氐夘一戊丁乙】皆同角
　　同边　亢氐夘形内有氐癸弧为夏
　　至黄赤大距二十三度半强　氐夘
　　为赤道半径　癸夘为黄道半径
　　夘角为黄赤大距角【氐癸弧之角】　亢氐
　　者氐癸弧之切线【亦即夘角切线】　亢夘者
　　氐癸弧之割线【亦即夘角割线】

　　癸弧之割线【亦即夘角割线】
　　立句股面形二　戊乙丁形即前图亢氐夘形之对面
　　戊丁髙同亢氐切线【如股】　戊乙斜
　　线同亢夘割线【如】　丁乙横线同氐
　　夘【如句】　乙角同夘角



　　又有黄道象弧在斜面
　　斜面形　　　　斜面形长方【其斜立之势依黄道】　其夘角为
　　黄道心【即赤道心】　乙丙癸为黄道一象
　　限　乙为春分【与赤道同用】　癸为黄道
　　夏至　夘癸及夘乙皆黄道半径【内夘
　　乙与赤道同用】　亢夘为二十三度半强之
　　割线【夏至黄赤大距割线】　其相对戊乙边与亢夘割线同度亢戊边与夘乙半径相对同度乃四十五度之切线【与底上切线氐丁相应】
　　立面形　　　　立面形亦长方其势直立　亢戊及
　　氐丁二边为其濶皆四十五度切线
　　与半径同度　亢氐及戊丁为其高
　　皆二十三度半之切线【夏至黄赤大距切线】以亢戊边庋起斜面之亢戊边而成
　　角体仍以氐丁边联于方底之氐丁
　　边则其形直立矣



　　次解分形　立三角体【古谓鼈臑即句股锥】
　　内含乙甲丙弧三角形及乙甲丙夘弧三角锥
　　夘为浑圜心【黄赤同用】　夘乙浑圜半径【黄赤同用】　乙丙弧为黄道经度　丙夘为黄道半径　乙甲弧为赤道经度甲夘为赤道半径　丙甲弧为黄赤距纬　乙为春
　　分防　酉乙未角为春分角二十三度半与二至大距之纬度相应此角不动　丙为所设黄道度距春分后之防此防移则丙之交角变而诸数皆从之而变法曰于前图全形堑堵斜面黄道象弧内寻所设黄道经度自春分【乙】起数设度至丙从丙向圜心夘作丙夘半径遂依半径引长至堑堵之边【酉】成酉夘直线依酉夘直线直剖至底【未夘线为底酉未线为边】成酉未乙夘立三角体此立三角体有四面而皆句股故又曰句股立锥立句股之锥尖为酉
　　其斜面为酉乙夘句股形【乙正角　乙酉为股乙夘为句　酉夘为】其立面二
　　一为酉未乙句股形【未正角　酉未垂线为股未乙为句　酉乙为】一为酉未夘句股形【未正角　酉未垂线为股未夘为句　酉夘为】
　　其底为未乙夘句股形【乙正角　未乙为股乙夘为句　未夘为】
　　以上四句股面凡楞线六
　　夘乙半径也酉乙黄道丙乙弧之切线也而酉夘则其割线也未乙赤道乙甲弧之切线也而未夘则其割线也惟酉未垂线于八线无当今名之曰锥尖垂线亦曰锥尖柱亦曰外线以其离于浑圜之体也
　　句股面有四而用者一酉未乙也以其能与乙角之大句股为比例也
　　楞线六而用者二酉乙及未乙也以其为二道之切线为八线中有定数可为比例也
　　第一层句股比例图
　　酉未乙句股形以黄道切线【酉乙】赤道切线【未乙】相连于乙角【成鋭角】则酉乙为未乙为句而戊丁乙及牛昴乙二句股形同在一立面又同用乙角故可以相为比例术为以赤道半径【丁乙】比乙角之割线【戊乙】若赤道切线【未乙】与黄道切线【酉乙】也【此为以句求】又以黄道半径【牛乙】比乙角之余【昴乙】若黄道切线【酉乙】与赤道切线【未乙】也【此为以求句】
　　解曰丁乙与氐昴同大则皆赤道半径也戊乙与亢夘同大则皆乙角割线也牛乙与癸卯同大皆黄道半径昴乙与己夘同大皆乙角余也　从乙窥夘则成一防而乙角夘角合为一角其角之割线余尽移于堑堵之第一层而同在一立面为句若【观总图自明】
　　以赤道求黄道　　以黄道求赤道
　　一　赤道半径　　一　黄道半径
　　二　乙角割线　　二　乙角余
　　三　赤道切线　　三　黄道切线
　　四　黄道切线　　四　赤道切线
　　若求角者反用其率　　　　又法



　　四　乙角割线　　　　　四　乙角余
　　第二层句股比例图
　　子甲丑句股形以黄赤距度之切线【子甲】赤道之正【甲丑】相连于甲成正角则子甲为股甲丑为句而与坎震丑及女娄丑二句股形同在一立面又同丑角故可相求术为以赤道半径【震丑】比乙角之切线【坎震】若赤道正【甲丑】与距度之切线【子甲】也【是为以句求股】又为以乙角之正【女娄】与乙角余【娄丑】若距度之切线【子甲】与赤道之正【甲丑】也【是为以股】
　　【求句】
　　解曰震丑即氐夘赤道半径也坎震即亢氐乙角之切线也女娄即癸己而娄丑即己夘乙角之正余也从乙窥夘则乙丑夘成一防而合为一角其角之切
　　线正余尽移于堑堵第二层立面为句与股以赤道求距度　以距度求赤道　又法
　　一　半径　　　一乙角正　一乙角切线　半径二　乙角切线　二乙角余　二半径　　　【乙角余切】三　赤道正　三距度切线　三　距度切线四　距度切线　四赤道正　四　赤道正若求角则反用其率　　　又法
　　一　距道切线　半径　　一　赤道正　半径
　　二　赤道正　　　　　二　距度切线
　　三　半径　　　【距度余切】　　三　半径　　　【赤道余割】
　　四　乙角余切　　　　　四　乙角切线
　　第三层句股比例图
　　丙辛壬句股形以距度正【丙辛】黄道正【丙壬】相连于丙而成鋭角则丙壬为丙辛为股而与干艮壬及奎胃壬二句股同在一立面同用壬角故可相求
　　术为以黄道半径【奎壬】比乙角之正【奎胃】若黄道正【丙壬】与距度之正【丙辛】也【是为以求股】又为以乙角之切线【干艮】比乙角之割线【干壬】若距度之正【丙辛】与黄道正【丙壬】也【是为以股求】
　　解曰奎壬即癸夘黄道半径也奎胃即癸己距度正也干艮即亢氐而干壬即亢夘则乙角之切线割线也从乙窥夘则乙丑壬夘半径因直视成一防而合为
　　为一角其角之正切割线尽移于堑堵之第三层立面以为为股
　　以黄道求距度　　以距度求黄道　又法
　　一　半径　　　一　乙角切线　一　乙角正　半径二　乙角正　二　乙角割线　二　半径　　　【乙角余割】三　黄道正　三　距度正　三　距度正四　距度正　四　黄道正　四　黄道正
　　若求角则反用其率　　　　又法
　　一　距度正　半径　　一　黄道正　半径
　　二　黄道正　　　　　二　距度正
　　三　半径　　　【距度余割】　　三　半径　　　【黄道余割】
　　四　乙角正割　　　　　四　乙角正
　　弧三角锥体【即割浑圜体之一分】




　　法曰依前论从丙防对夘直割至底则截黄道于丙截赤道于甲得丙乙及甲乙二弧所剖浑圜之迹又成丙甲弧【为两道距纬】三弧相凑成丙甲乙弧三角面　丙夘甲夘乙夘同为半径三半径为楞辏于夘心夘为三角之尖乙甲丙弧三角面为底成乙甲丙夘弧三角锥体为割浑圜体之一分也
　　此弧三角锥体含于句股立锥体内凖前论可以明之因此弧三角锥与句股锥同鋭【夘尖】异底【一以弧三角面为底一以句股平面为底】故以弧三角变为句股以求其比例而有三法【即前条所论三层句股】
　　其一为酉未乙句股形
　　用酉乙【为黄道丙乙弧切线】未乙句【为赤道乙甲弧切线】以当乙角之与句
　　其一为子甲丑句股形
　　用子甲股【为距度丙甲弧切线】甲丑句【为赤道乙甲弧正】以当乙角之股与句
　　其一为丙辛壬句股形
　　用丙辛股【为距度丙甲弧在】丙壬【为黄道丙乙弧正】以当乙角之股与
　　问两弧求一弧非句股锥乎与此所用同耶异耶曰形不异也乃法异耳何言乎法异曰句股锥一也而有用角不用角之殊此用角度其句股在锥形之底【以夘心为锥形之鋭则三层句股皆为其底】而遥对浑体之心以视法成比例两弧求一弧不用角度其句股同在锥形之一面无假视法自成比例所以不同然其为句股之比例一而已矣然则两弧求一弧惟用割线余此所用者惟正切线又何不同若是耶曰角之句股在心【如夘亢氐等形皆依极至交圏平剖浑圜成平面其象始着是在浑圜之心】与为比例之句股在面【如酉未乙等形皆以一角连于浑圜之面】二者相离以视法相叠如一平面然惟正切线能与之平行【从凸面平视则设度之正切线皆与浑圜中割之平面诸线平行】若割线余皆非平行因视法而跻缩失其本象【或斜对则长线成短线或对视则直线成一防】不能为比例无所用之矣若两弧求一弧则其句股自相垜叠于一平面【平立斜三面各具三句股而如相垜叠并以一大句股横截成三】皆以本数自相为比例全不闗于视法故无跻缩而其算皆割线余所成于正切线反无所取所以不同　若以量体之法言之割线余为量立楞斜楞之法正切线则量底之法也【两弧求一弧法见二卷】
　　如图　以卯为句股立
　　锥之顶卯乙为直立之
　　楞如浑圆半径夘未夘
　　酉为斜面之楞并如割
　　线酉乙未乙两底线并如
　　切线若依底线平截之成
　　大小三形则比例见矣
　　剖浑圜用余度法
　　乙丙黄道弧在四十五
　　度以上求甲乙赤道弧
　　【即同升度】
　　依前法　半径【癸卯亦即庚乙】与乙角【春分】之余【乙壬亦即
　　卯己】若乙丙【黄道】之切线【尾乙】与乙甲【赤道】之切线【箕乙】
　　此法无误但如此则两切线大于堑堵须引之于形外是以小比例例大比例也若至八十度切线太大不可作图矣
　　今改用余度　法自卯浑圜心遇黄道设弧丙作线至酉【剖至底】
　　以乙丙黄道之余弧癸丙取其切线于斜面如癸斗又以乙甲赤道之余弧甲氐取其切线于底如氐
　　未即以氐未移至斜面之楞如亢酉变立句股【尾箕乙】为平斜句股【酉亢卯及斗癸卯两形皆相似】　法为半径【癸卯】与乙角之正割线【乙角即卯角其割线戊乙亦即卯亢】若乙丙黄道之余切线【癸斗】与乙甲赤道之余切线也【亢酉亦即氐未】
　　按此法从亢戊边剖堑堵成句股方锥之眠体
　　其剖形以亢氐酉未长方形为底以卯为锥尖以斜面之卯亢酉句股形及平面之卯氐未句股形为相对之二边又以卯氐亢之立面句股形及卯未酉之斜立面句股形为相对之二边其四面皆句股其底长方而以卯为尖故曰眠形
　　不直曰方锥者以面皆句股而卯氐线正立故不得仅云阳马谓之句股方锥可也亦如句股锥立三角不得仅谓鼈臑












　　堑堵测量二
　　句股锥形序【即两弧求一弧】
　　正弧三角之法即郭太史侧视图也郭法以侧视取立句股又以平视取平句股故有圆容方直之法而不须用角西法専以侧视之图为用故必用角用角即用弧也惟其用角故所用者皆侧立之句股也余此法则兼用平立斜三种句股而其大小句股之比例并在一平面尤为明白易见而不更言角既与授时之法相通其兼用割线起算春分又西厯之理也葢义取适用原无中外之殊笇不违天自有源流之合敬存此稿以质方来其授时厯侧视平视之图详具别卷





　　正弧三邉形以两弧求一弧法【句股锥形之理】
　　用割线余以弧度求弧度而不言角其理与郭法相通
　　丙甲乙三角弧形　甲为正角
　　卯为浑员心丙乙为黄道距春分之
　　一弧甲乙为赤道同升之弧丙甲为
　　黄赤距度【即过极圈之一弧】丙卯为黄道半
　　径甲卯为赤道半径卯乙为黄赤两
　　道之半径壬卯为丙乙黄道之余【以丙壬为其正故】丑卯为甲乙赤道之余【以甲丑为其正故】辛卯为丙甲距度之余【以丙辛为其正故】子卯为丙甲割线【以子甲为切线知之】酉卯为丙乙割线【以酉乙为切线如之】未卯为甲乙割线【以未乙为切线知之】
　　斜面酉乙卯及子丑卯及丙壬卯皆句股形乙丑壬皆正角又同用卯角角之弧为丙乙黄道　平面未乙卯及甲丑卯及辛壬卯皆句股形乙丑壬皆正角又同用卯角角之弧为甲乙赤道　立面酉未卯及子甲卯及丙辛卯皆句股形未甲辛皆正角又同用卯角角之弧为丙甲距度【其又一立面酉未乙及子甲丑及丙辛壬三句股形为切线正所作兹不论】论曰因诸线成平面句股形为底两立面句股形为墙斜面句股形为面则四面皆句股形矣而酉未联线及子甲切线丙辛正皆直立上对天顶下指地心故谓之句股锥形也既成句股则其相等之比例可以相求用法
　　半径与赤道之余若黄道之割线与距度之割线




　　反之则赤道余与半径若距度割线与黄道割线一　甲乙余　丑卯小句　二　半径　　　乙卯大句三　丙甲割线　子卯小　四　丙乙割线　酉卯大又更之则黄道割线与半径若距度割线与赤道余一　丙乙割线　酉卯大　二　半径　　　乙卯大句三　丙甲割线　子卯小　四　甲乙余　丑卯小句右取斜面酉乙卯子丑卯两句股形以乙卯半径为比例偕一余两割线而成四率
　　半径与距度之割线若黄道之余与赤道之余一　半径　　　丙卯小　二　丙甲割线　子卯大三　丙乙余　壬卯小句　四　甲乙余　丑卯大句反之则距度割线与半径若赤道余与黄道余一　丙甲割线　子卯大　二　半径　　　丙卯小三　甲乙余　丑卯大句　四　丙乙余　壬卯小句又更之则黄道余与半径若赤道余与距度割线一　丙乙余　壬卯小句　二　半径　　　丙卯小三　甲乙余　丑卯大句　四　丙甲割线　子卯大右取斜面丙壬卯子丑卯二句股形以丙卯半径偕一割线两余而成四率
　　半径与赤道割线若距度割线与黄道割线




　　更之则赤道割线与半径若黄道割线与距度割线一　甲乙割线　未卯大句　二　半径　　　甲卯小句三　丙乙割线　酉卯大　四　丙甲割线　子卯小又更之则距度割线与半径若黄道割线与赤道割线一　丙甲割线　子卯小　二　半径　　　甲卯小句三　丙乙割线　酉卯大　四　甲乙割线　未卯大句右取立面酉未卯子甲卯二句股形以甲卯半径偕三割线而成四率
　　半径与黄道余若赤道割线与距弧余
　　一　半径　　　乙卯大句　二　丙乙余　壬卯小句三　甲乙割线　未卯大　四　丙甲余　辛卯小更之则黄道余与半径若距弧余与赤道割线一　丙乙余　壬卯小句　二　半径　　　乙卯大句三　丙甲余　辛卯小　四　甲乙割线　未卯大又更之则赤道割线与半径若距弧余与黄道余一　甲乙割线　未卯大　二　半径　　　乙卯大句三　丙甲余　辛卯小　四　丙乙余　壬卯小句右取平面未乙卯辛壬卯二句股形以乙卯半径偕两余一割线而成四率
　　半径与距度余若赤道余与黄道余




　　更之则距度余与半径若黄道余与赤道余一　丙甲余　辛卯小　二　半径　　　甲卯大三　丙乙余　壬卯小句　四　甲乙余　丑卯大句又更之则赤道余与半径若黄道余与距度余一　甲乙余　　丑卯大句　二　半径　　　甲卯大三　丙乙余　　壬卯小句　四　丙甲余　辛卯小右取平面【甲丑卯辛壬卯】二句股以甲卯半径偕三余而成四率
　　半径与黄道割线若距弧余与赤道割线




　　更之则黄道割线与半径若赤道割线与距弧余一　丙乙割线　酉卯大　二　半径　　　丙卯小三　甲乙割线　未卯大句　四　丙甲余　辛卯小句又更之则距弧余与半径若赤道割线与黄道割线一　丙甲余　辛卯小句　二　半径　　　丙卯小三　甲乙割线　未卯大句　四　丙乙割线　酉卯大右取立面酉未卯丙辛卯二句股形以丙卯半径偕两割线一余而成四率
　　作立三角仪法【即句股锥形】
　　法以坚楮依各线画成句股而折辏之则各线之在浑员者具可覩矣　任取黄道之一弧为例则各弧并同
　　底上甲乙弧赤道同升度
　　也赤道各线俱在平面为
　　底面上丙乙弧黄道度也
　　黄道各线俱在斜面立面
　　丙甲弧度黄赤距纬也距
　　纬各线俱在立面　外立面为黄赤两切线之界论曰此即郭若思太史员容方直之理也太史法从二至起算先求大立句股依距至黄道度取其正半为界直切至赤道平面截黄赤道两半径成小立句股以此为法求得平面大句股则赤道之正半也其直切两端下垂之迹在二至半径者既成小立句股其在所求本度者又成斜立句股此斜立句股之股则本度黄赤距度之正半也于是直切之迹有黄道正半为其上下之横长有黄赤距度之正半为两端之直濶成直立之长方形而在浑体之中故曰弧容直濶也此侧立长方之四角各有黄赤道之径为其楞以直凑浑体之心成眠体之句股方锥句股方锥者底虽方而锥尖偏在一楞则其四面皆成句股此郭太史之法也今用八线之法以句股御浑体其意略同但其法主于用角故从二分起算遂成立句股锥形立句股锥形亦可以卯心为锥尖是为眠体锥形如此则两锥形之尖皆在员心【一郭法一今法】而可通为一法是故用郭太史法则以句股方锥为主而句股锥形其余度所成之余形今以句股锥形为主则员容直濶所成句股方锥又为余度余形矣然则此两法者不惟不相违而且足以相法古人可作固有相视而笑莫逆于心者矣余窃怪夫世之学者入主出奴不能得古人之深而轻肆诋诃者皆是也吾安得好学深思其人与之上下其议哉

　　句股方锥序
　　堑堵虚形以测浑员原有二法一为句股锥形一为句股方锥其句股锥之法向有法方锥之法亦略见于诸篇而未畅厥防故复着之其法以弧求弧而不求角与句股锥同而起算二至则郭太史本法矣方锥与锥形互相为正余故亦可以算距分之度也










　　筭黄赤道及其距纬以两弧求一弧又法【用句股方锥形亦堑堵形之分】以八线法立筭起数二至本郭法史员容方直之理而稍广其用亦不言角
　　如图癸为二至黄道癸丙为
　　距至黄道之一弧【如所设】氐为
　　二至赤道氐甲为距至赤道
　　之一弧【与癸丙黄道相应】癸氐为二
　　至黄赤大距弧【二十三度半强】丙甲
　　为所设各度之黄赤距纬【即过极圈之一弧】卯为浑圆心黄道癸丙之正丙张余张卯正矢癸张切线癸斗割线斗卯
　　赤道氐甲之正甲庚余庚卯正矢氐庚切线氐室割线室卯
　　大距度癸氐之正癸己余己卯正矢氐己切线氐亢割线亢卯
　　距纬丙甲之正丙辛余辛卯正矢甲辛切线甲子割线子卯
　　论曰因诸线成各句股形为句股方锥之面其鋭尖皆防于卯心又成方直形以为之底遂成句股方锥之眠体
　　一斜平面有黄道弧诸线成句股形二【一丙张卯一斗癸卯】又有相应之赤道诸线亦成句股形二【一壁亢卯一子房卯】四者皆形相似而比例等
　　一平面有赤道弧诸线成句股二【一甲庚卯一室氐卯】又有相应之黄道诸线亦成句股二【一辛井卯一亥己卯】四者皆形相似而比例等
　　一立面有大距弧诸线成句股二【一癸己卯一亢氐卯】又有相对之距纬诸线亦成句股二【一张井卯一房庚卯】四者皆形相似而比例等
　　一斜立面有黄赤距度诸线成句股二【一丙辛卯一子甲卯】又有相对之大距度诸线亦成句股二【一斗亥卯一壁室卯】四者皆形相似而比例等
　　论曰斜平面平面立面斜立面各具四句股而并为相似之形者皆以一大句股截之成四也其股与并原线而所截之句又平行其比例不得不等
　　一内外两方直形【一在浑员形内即郭法所用乃黄道及距纬两正所成一在浑员形外乃赤道及大距两切线所成】有平立诸线为各相似相连句股形之句亦即为相似两方锥之底而比例等
　　一不内不外两方直形【一跨黄道内外乃赤道正及距纬切线所成一跨赤道内外乃黄道切线及大距正所成】有平立诸线为各相似相连句股形之句亦即为相似两方锥之底而比例等
　　论曰方锥眠体以平行之底横截之【即四种方直形皆方锥之底】成大小四方锥其锥体之顶鋭【卯】与其四棱皆不动所截之底又平行故其比例相似而等
　　又论曰黄道在斜平面赤道在平面而其线互居者以方直形故也大距度在立面距纬度在斜立面而其线毕具者亦以方直形故也葢形既方直则横线直线两两相对而等
　　用法
　　斜平面比例
　　黄道半径与黄道正若距纬割线与赤道正




　　更之黄道正与黄道半径若赤道正与距纬割线
　　一丙张小股　二丙卯小　三子房大股　四子卯大又更之距纬割线与黄道半径若赤道正与黄道正
　　一子卯大　二丙卯小　三子房大股　四丙张小股右取斜平面张丙卯房子卯二句股形以丙卯半径偕一割线两正而成四率
　　黄道半径与黄道切线若大距割线与赤道切线




　　更之黄道切线与黄道半径若赤道切线与大距割线一癸斗小股　二癸卯小句　三亢壁大股　四亢卯大句又更之大距割线与黄道半径若赤道切线与黄道切线一亢卯大句　二癸卯小句　三亢壁大股　四癸斗小股右取斜平面斗癸卯壁亢卯二句股形以癸卯半径偕一割线两切线而成四率
　　平面比例
　　赤道半径与赤道正若距纬余与黄道正




　　更之赤道正与赤道半径若黄道正与距纬余一甲庚大股　二甲卯大　三辛井小股　四辛卯小又更之距纬余与赤道半径若黄道正与赤道正
　　一辛卯小　二甲卯大　三辛井小股　四庚甲大股右取平面井辛卯庚甲卯二句股形以甲卯半径偕一余两正而成四率
　　赤道半径与赤道切线若大距余与黄道切线




　　更之赤道切线与赤道半径若黄道切线与大距余一氐室大股　二氐卯大句　三己亥小股　四己卯小句又更之大距余与赤道半径若黄道切与赤赤道切线一己卯小句　二氐卯大句　三己亥小股　四氐室大股右取平面亥己卯室氐卯二句股形以氐卯半径偕一余两切线而成四率
　　立面比例
　　黄道半径与大距正若黄道余与距纬正




　　更之大距正与黄道半径若距纬正与黄道余一癸己大股　二癸卯大　三张井小股　四张卯小又更之黄道余与黄道半径若距纬正与大距正
　　一张卯小　二癸卯大　三张井小股　四癸己大股右取立面己癸卯井张卯二句股形以癸卯半径偕一余两正而成四率
　　赤道半径与大距切线若赤道余与距纬切线




　　更之大距切线与赤道半径若距纬切线与赤道余一氐亢大股　二氐卯大句三庚房小股　四庚卯小句又更之赤道余与赤道半径若距纬切线与大距切线一庚卯小句　二氐卯大句三庚房小股　四氐亢大股右取立面房庚卯亢氐卯二句股形以氐卯半径偕一余两切线而成四率
　　斜立面比例
　　黄道半径与距纬正若黄道割线与大距正




　　更之距纬正与黄道半径若大距正与黄道割线一丙辛小股　二丙卯小　三斗亥大股　四斗卯大又更之黄道割线与黄道半径若大距正与距纬正
　　一斗卯大　二丙卯小　三斗亥大股　四丙辛小股右取斜立面辛丙卯亥斗卯二句股形以丙卯半径偕一割线两正而成四率
　　赤道半径与距纬切线若赤道割线与大距切线




　　更之距纬切线与赤道半径若大距切线与赤道割线一甲子小股　二甲卯小句　三室壁大股　四室卯大句又更之赤道割线与赤道半径若大距切线与距纬切线
　　一室卯大句　二甲卯小句　三室壁大股　四甲子小股右取斜立面子甲卯壁室卯二句股形以甲卯半径偕一割线两切线而成四率
　　以上方锥形之四面每面有大小四句股形即各成四率比例者六合之则二十有四并以两弧求一弧而不言角
　　方直形比例
　　黄道正与距纬正若赤道切线与大距切线




　　更之距纬正与黄道正若大距切线与赤道切线一张井小股　二井辛小句　三亢氐大股　四氐室大句又更之赤道切线与大距切线若黄道正与距纬正
　　一氐室大句　二亢氐大股　三井辛小句　四张井小股再更之大距切线与赤道切线若距纬正与黄道正
　　一亢氐大股　二氐室大句　三张井小股　四井辛小句右取浑体内所容方直形上黄道及距纬两正偕浑体外所作方直形上赤道及大距两切线而成四率
　　赤道正与距纬切线若黄道切线与大距正




　　更之距线切线与赤道正若大距正与黄道切线一房庚小股　二庚甲小句　三癸己大股　四己亥大股又更之黄道切线与大距正若赤道正与距纬切线
　　一己亥大句　二癸己大股　三庚甲小句　四房庚小股再更之大距正与黄道切线若距纬切线与赤道正一癸己大股　二己亥大句　三房庚小股　四庚甲小句右取方直形上黄道切线大距正偕又一方直形上赤道正距纬切线而成四率
　　以上大小方锥形之底各成方直形而两两相偕即各成四率比例者四合之则八并以三弧求一弧而不言角
　　凡句股方锥形所成之四率比例共三十有二皆不言角内四率中有半径者二十四并两弧求一弧四率中无半径者八以三弧求一弧其不言角则同
　　问各面之句股形并以形相似而成比例若方直形所用皆各形之大小句然不同居一面又非相似之形何以得相为比例曰句股形一居平面一居立面而能相比例者以有棱线为之作合也何以言之如亢卯割线为方锥形之一棱而此线既为斜平面句股形【壁亢卯】之股又即为立面句股形【氐亢卯】之故其比例在斜平面为亢卯与张卯若亢壁与张丙也而在立面为亢卯与张卯若亢氐与张井也合而言之则亢壁与张丙亦若亢氐卯与张井余仿此
　　问此以方直相比非句股本法矣曰亦句股也试平置方锥【以方底着地使卯鋭直指天顶而卯氐棱线正立如垂】而从其卯顶俯视之则卯井庚己氐棱线上分段之界因对视而成一防亢卯棱线与亢氐线相疉室卯线与室氐相叠皆脗合为一惟亢壁室氐直　形因平视而得正形其壁卯棱线则成壁氐而斜界于对角分直方形为两句股形矣又其分截之三方直形亦以平视得正形亦各以棱线分为两句股而大小相疉成相似之形而比例等矣
　　如图亢氐室壁长方以壁氐
　　线成两句股而张井辛丙长
　　方【即张氐辛丙】亦以丙卯线【即丙井亦
　　即丙氐】成两句股并形相似则
　　亢壁与张丙若亢氐与张井【张井即张氐】
　　又癸己亥斗长方【即癸氐亥斗】以斗卯线【即斗己又即斗氐】成两句股而房庚甲子长方【即房氐甲子】亦以子卯线【即子庚又即子氐】成两句股而形相似则癸斗与房子若癸己与房庚【癸己与房庚即癸氐与房氐】



　　展形【展之成四句股面一方直底】　　　合形【合之则成句股方锥】







　　作方直仪法【即句股立方锥】
　　法以坚楮依黄赤大距二十三度半画成立面再任设赤道距至度画成平面再依法画距纬斜立面及黄道距至度斜平面并方直底然后依棱折辏即浑员上各线相为比例之故了然共见
　　任指黄道或赤道之距至一弧为式即各弧可知其所用距至弧或在至前或在至后或冬至或夏至并同一理








　　方堑堵内容员堑堵法
　　先解方堑堵
　　堑堵以正方为底【氐卯丁乙形】其上有
　　赤道象限【氐干乙弧乙春分氐夏至】以长方为
　　斜面【亢卯戊乙形】其上有黄道象限【癸巽
　　乙弧乙春分巽夏至】底与而一邉相连【卯乙邉为
　　底与斜面所同用故相连乃黄赤道之半径】一邉相离
　　【氐丁邉在底与赤道平行亢戊邉在斜面故相离其距为亢氐为戊】
　　【丁皆大距度癸氐弧之切线】其形似斧
　　从斜面作戊卯对角线切至底【戊丁卯对角线于底】分堑堵为两则赤道为两平分【赤道平分于干干乙距春分干氐距夏至各得四十五度】而黄道为不平分【黄道分于巽则巽乙距春分四十七度二十九分弱而巽癸距夏至四十二度三十一分强】于是黄道切线【戊乙】与大距度割线【亢卯】等而方堑堵之形以成【亢卯为大距二十三度三十一分半之割线其数一○九○六五戊乙为黄道四十七度二十九分之切线其数亦一○九○六五两数既同故能作长方斜面而成堑堵】乃黄道求赤道用两切线之所赖也【若赤道求黄道则反用其率】
　　法曰自黄道四十七度二十九分以前用正切是立面句股比例【戊丁乙句股比例即亢氐卯或用癸巳卯皆大句股也其酉未乙则为小句股】




　　右黄道求赤道为以求句
　　一　赤道半径氐卯　　　大句
　　二　大距割线亢卯　　　大
　　三　赤道切线未乙【甲乙赤道】　小句
　　四　黄道切线酉乙【丙乙黄道】　小
　　右赤道转求黄道为以句求
　　自黄道四十七度二十九分以后用余切是斜平面句股比例【斜面亢虚卯为大句股癸斗卯为小句股在平面则为氐危卯大句股己心卯小句股】一　黄道半径癸卯　小股
　　二　大距割线亢卯　大股
　　三　黄道余切癸斗　小句　【牛乙黄道其余弧牛癸】
　　四　赤道余切亢虚　大句　【女乙赤道其余弧女氐】
　　右黄道求赤道为以股求句
　　一　赤道半径氐卯　　　大股
　　二　大距余己卯　　　小股
　　三　赤道余切危氐【即亢虚】　大句　【女氐即女乙赤道之余】四　黄道余切心己【即癸斗】　小句　【牛癸即牛乙黄道之余】右以赤道转求黄道亦为以股求句
　　论曰赤道求黄道用句股于赤道平面即郭太史员容方直之理但郭法起二至则此所谓余弧乃郭法之正弧又郭法只用正而此用切线为差别耳
　　又论曰正切线法亦可用于半象限以上余切线亦可用于半象限以下此因方堑堵之底正方则所用切线至方角而止故各用其所宜【云半象限者主赤道而言若黄道以四十七度二十九分为断一平一斜故其比例如与句】
　　又论曰正切线法即句股锥形也余切线法即句股方锥也以对角斜线分堑堵为两成此二种锥形遂兼两法














　　次解员堑堵
　　方堑堵内容割浑员之分体以癸牛丙乙黄道为其斜面之界以氐女甲乙赤道为其底之界而以癸氐大距弧及牛女丙甲等逐度距弧为其髙髙之势曲抱如浑员之分斜面平面皆为平员四之一【其髙自癸氐大距渐杀至春分乙角而合为一防】
　　员堑堵者虽亦在方堑堵之内然又在所容割浑员分体之外与割浑员体同底亦以赤道为界而不同面其面自乙春分过子过奎至亢其形卯乙短而亢卯长如割平撱员面四之一其撱员邉之距心皆以逐度距纬【如丙甲牛女等】之割线所至为其界【如卯子为丙甲距弧割线卯奎为牛女距弧割线之类】而以逐度距纬之切线为其髙【如子甲为丙甲距弧切线奎女为牛女距弧切线之类】
　　法以赤道为围作员柱置浑员在员柱之内对赤道横剖之则所剖员柱之平员底即赤道平面也又自夏至依大距二十三度三十分半之切线为髙斜对春秋分剖至心则黄道半周在所剖之斜面矣
　　然黄道半周虽在所剖斜面而黄道自为半平员所剖斜面则为半撱员黄道平员在撱员内两端同而中广异【两端是二分如乙为平撱同用之防中广是夏至如黄道癸在撱面亢之内其距为癸亢】此员堑堵之全体也
　　于是又从亢癸对卯心直剖到底则成员堑堵之半体即方堑堵所容也此员堑堵斜面之髙俱为其所当距纬弧之切线浑员上弧三角法以距纬切线与赤道平面之正相连为句股而生比例是此形体中所具之理
　　此堑堵体与前图同惟多一亢奎子乙撱弧以此为撱员界立剖至底令各度俱至赤道而去其外方则成员堑堵真体
　　此员堑堵为用子甲丑句股形之所頼子甲为距弧切线甲丑为赤道正也又子甲如股甲丑如句法为子甲与甲丑若亢氐与氐卯








　　前图为从心眎邉此为从邉眎心盖因欲显圆堑堵内方直形故为右观之象与前图一理惟多一己庚辛乙撱弧【前图亢奎子乙撱弧在黄道斜面此图己庚辛乙撱弧在赤道平面】
　　员堑堵有二
　　若自斜面之黄道象限各度直剖至赤道平面亦成员堑堵象限然又在剖浑员体分之内其体以斜面为正象限但斜立耳其底在赤道者转成撱员
　　此撱员形在赤道象限之内惟乙点相连此即简平仪之理
　　其撱之法则以卯乙半径为大径癸氐距弧之余卯巳为小径小径当二至大径当二分与前法正相反然其比例等何也割线与全数若全数与余也
　　此员堑堵以撱形为底象限为斜面以距度逐度之正为其髙乃黄道距纬相求用两正之所頼也此员堑堵内又容小方堑堵乃郭太史所用员容方直也
　　浑员因斜剖作角而生比例成方员堑堵形其角自○度一分以至九十度凡五千四百则方员堑堵亦五千四百矣【乙角以春分为例则其度二十三度半强其实自一分至九十度并得为乙角合计之则五千四百】
　　每一堑堵依度对心剖之成立句股锥及方句股锥之眠体自○度一分至大距止亦五千四百
　　以五千四百自乗凡二千九百一十六万而浑员之体之势乃尽得其比例乌呼至矣
　　每度分有方堑堵方堑堵内函赤道所生撱体赤道撱体内又函黄道所生撱体黄道撱体内又函小方堑堵每度分有此四者则一象限内为五千四百者四共二万一千六百【以乙角五四○○乗之则一一六六四○○○○】
　　每度有正有余对心斜分则正度成句股锥余度成方底句股锥之眠体一象限凡四万三千二百【以五四○○乘之则二三三二八○○○○】









　　员容方直简法序
　　古未有预立算数以尽句股之变者有之自西洋八线表始古未有作为仪器以写浑员内句股之形者自愚所撰立三角始立三角之仪分之曰句股锥形曰句股方锥形合之则成堑堵形其称名也小其取类也大径寸之物以状浑员而弧三角之理如指诸掌即古法之通于弧三角者亦如指诸掌矣虽然犹无解于古法之不用割切也故复作此简法以互征之而授时厯三图附焉盖理得数而彰数得图而显图得器而真草野无诸仪象借兹以自释其疑不敢自私故以公之同好云尔【句股锥形是以西法通国法句鈠方锥形是以郭法通西法今此简法是専解郭法而两法相同之故自具其中】




　　员容方直仪简法【即句股方锥之方直仪而不用割切线祗以各弧正矢度相求其用己足亦不须用角】





　　立面中有句股形二其一大句股形【癸巳乙】以黄道半径【癸乙】为大距度正【癸巳】为股大距度余【巳乙】为句其一小句股形【壬戊乙】以黄道余【壬乙】为距纬正【壬戊】为股楞线【戊乙】为句





　　平面中亦有句股形二其一小句股形【庚戊乙】以距纬丙甲之余【庚乙】为以黄道正【戊庚】为股楞线【戊乙】为句其一大句股形【甲辛乙】以赤道半径【甲乙】为以赤道正【甲辛】为股赤道余【辛乙】为句【戊乙线于弧度无取然平立二形并得此补成句股谓之楞线】黄道正本在斜平面而能移于平面者有相望两立线【丙庚壬戊】为之限也距度正本在斜立面而能移于立面者有上下两横线【丙壬庚戊】为之限也此四线【两立两横】相得成长方其立
　　如堵故又曰弧容直濶也







　　有大距有黄道而求距纬　更之可求大距　反之可求黄道一　半径　　　癸乙　一　黄道余　一　大距正二　大距正　癸己　二　距纬正　二　半径三　黄道余　壬乙　三　半径　　　三　距纬正四　距纬正　壬戊　四　大距正　四　黄道余
　　有赤道有距纬而求黄道　更之可求赤道　反之可求距纬一　半径　　　甲乙　一　距纬余　一　赤道正二　赤道正　甲辛　二　黄道正　二　半径三　距纬余　庚乙　三　半径　　　三　黄道正四　黄道正　庚戊　四　赤道正　四　距纬余






　　郭太史本法
　　弧矢割员图【见授时厯草下并同】
　　凡浑员中割成平员任割平
　　员之一分成弧矢形皆有弧
　　背有弧有矢割弧背之形
　　而半之则有半弧背有半弧
　　有矢　因弧矢生句股形
　　以半弧为句【即正】矢减半
　　径之余为股【即余】半径则常为　句股内又成小句股则有小句小股小而大小可以互求或立或平可以互用【平视侧视二图皆从此出】





　　侧视之图
　　横者为赤道【赤道一规因旁视如一直线黄
　　道同】
　　斜者为黄道
　　因二至黄赤之距成大句股
　　【即外圈】
　　因各度黄赤之距成小句股

　　平视之图
　　外大员为赤道
　　内撱者黄道【从两极平视则黄道在赤道内
　　而成撱形】
　　有赤道各度即各其有半弧
　　以生大句股
　　又各有其相当之黄道半弧
　　以生小句股【此二者皆可互求】
　　授时厯求黄赤内外度及黄赤道差法
　　置黄道矢【本法用带从三乗方求各度矢】去减周天半径【即立面黄道半径】余为黄赤道小【即黄道余也半径为大故此为小】置黄赤道小以二至内外半弧【即二至大距度正当时实测为二十三度九十分】乘之为实黄赤大【即周天半径以其为立面大句股之故称大】为法除之得黄赤道内外半弧【即各度黄赤距度正也原法以矢度度半背差加入半弧得内外半弧背今省】
　　又置黄赤道小以黄赤道大股【即二至内外度余也在立面大句股形为大股】乗之为实黄赤道大为法除之【解见前】得黄赤道小股【即立面平面两小句股同用之楞线在立面与大股相比故称小股】置黄道半弧【即黄道正也原法以黄道矢求半背差减黄道度得之】自乗为股幂黄赤小股自乗为句幂【即楞线也先在立面为小句股形之股今又为平面句股形之句故其幂称句幂】两幂并之为实开平方法除之为赤道小【即各度黄赤距度余也周天半径为平面上大句股之故称大则此为小句股当称小】置黄道半弧以周天半径乗之为实赤道小为法除之得赤道半弧【即赤道正也原法求半背差以加半弧得赤道今省】
　　论曰弧矢割员者平员法也以测浑员则有四用一曰立弧矢势如张弓以量黄赤道二至内外度即侧立图也一曰平弧矢形如伏弩以量赤道即平视图也一曰斜弧矢与平弧矢同法而平面邉髙邉下其庋起处如二至内外之度以量黄道即平视图中小句股也一曰斜立弧矢与立弧矢同法而其立稍偏以量黄赤道各度之内外度即侧立图中小句股也自离二至一度起至近二分一度止一象限中逐度皆有之但皆小于二至之距邢台郭太史弧矢平立三图中具此四法即弧三角之理无不可通言简而意尽包举无穷好古者所当珤爱而翫也
　　又论曰割员之算始于魏刘徽至刘宋祖冲之父子尤精其术唐宋以算学设科古书犹未尽亡邢台葢有所本厥后授时厯承用三百余年未加修改测箕之讲求益稀学士大夫既视为不急之务而台官株守成法鲜谙厥故骤见西术羣相骇诧而不知旧法中理本相同也畴人子弟多不能自读其书又忌人之读而各私其本久之而书亦不可问矣攷元史厯成之后所进之书凡百有余卷【郭守敬传有修改源流及测騐等书齐履谦传有经串演撰诸书明厯法之所以然】今其存轶并不可攷良可浩叹然天下之人岂无有能藏弆遗文以待后学者庶几出以相证予于斯图之义类多通而深有望于同志矣
　　问元初有回回厯法与今西法大同小异邢台葢防通其説而为之故其法相通若是与曰九章句股作于首为测量之根本三代以上学有専家大司徒以三物教民而数居六艺之一秦火以后吾中土失之而彼反存之至于流逺分遂以各名其学而不知其本之同也况东西共戴一天即同此句股测员之法当其心思所极与理相符虽在数万里不容不合亦其必然者矣攷元初有西域人进万年厯未经试用迨明洪武年间始命词臣吴伯宗西域大师马沙亦黒等译回回厯书三卷然亦粗具筭法立成并不言立法之原究竟不知其所用何法或即今三角八线或更有他法俱无可攷虽其子孙莫能言之攷元史所载西域人晷影堂诸制与郭法所用简仪髙表诸器无一同者或测量之理触类増智容当有之然未见其有防通之处也徐文定公言回回厯纬度凌犯稍为详宻然无片言只字言其立法之故使后来入室无因更张无术盖以此也又据厯书言新法之善系近数十年中所造则亦非元初之西法矣而与郭图之理反有相通岂非论其传各有本末而精求其理本无异同耶且郭法用员容方直起算冬至西法用三角起算春分郭用三乗方以先得矢西用八线故先得又西専用角而郭只用弧西兼用割切而郭只用种种各别而不害其同有所以同者在耳且夫数者所以合理也厯者所以顺天也法有可采何论东西理所当明何分新旧在善学者知其所以异又知其所以同去中西之见以平心观理则弧三角之详明郭图之简括皆足以资探索而啓深思务集众长以观其防通毋拘名相而取其精粹其于古圣人创法流传之意庶几无负而羲和之学无难再见于今日矣














　　角即弧解
　　问古法只用弧而西法用角有以异乎曰角之度在弧故用角实用弧也何以明其然也假如辰庚己三角形有庚钝角有己庚辰庚二邉欲求诸数依垂弧法于不知之辰角打线线先补求辰辛及辛庚成辰辛庚三角虚形此必用庚角以求之而庚角之度为丙丁是用庚角者实用丙丁也其法庚丙九
　　十度之正【即半径】与丙丁弧之正弧【即庚角正】若庚辰正与辰辛正是以大句股之例例小句股也又丙丁弧之割线【即庚角割线】与庚丁九十度之正【亦即半径凡角度所当弧其两边并九十度】若庚辰之切线与庚辛之切线亦是以大句股之例例小句股也
　　既补成辰辛巳三角形可求巳角而巳角之度为乙甲是求巳角者实求乙甲也其法辛己弧之正与辰辛弧之切线若己甲象弧之正【即半径】与乙甲弧之切线【即己角切线】是以小句股例大句股也
　　又如己辰庚形庚为鋭角当自不知之辰角打线分为二形以求诸数其一辰辛庚分形先用庚角而庚角之度为丙丁用庚角实用丙丁也法为丙庚象弧之正【即半径】于丙丁弧之正【即庚角正】若辰庚之正与辰辛之
　　正又丙庚象弧之正弧【即半径】与丙丁弧之余【即庚角余】若辰庚之切线与辛庚之切线是以大句股例小句股也
　　其一辰辛己分形【以庚辛减己庚得己辛】有辰辛己辛二邉可求己角而己角之度为乙甲求己角实求乙甲也法为己辛之正与辰辛之切线若己甲象之正【即半径】与乙甲弧之切线【即己角切线】是以小句股例大句股也一系　用角求弧是以大句股比例比小句股用弧求角是以小句股比例比大句股
　　厯算全书卷六十
